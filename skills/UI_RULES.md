# UI_RULES.md — UI/UX 동작 규칙

---

## 전체 레이아웃

```
┌──────┬──────────────────────────────────┬─────────────────────┐
│56px  │          캔버스 (flex-1)          │      320px          │
│      │                                  │                     │
│ Left │     React Flow NodeCanvas        │  Inspector Panel    │
│ Side │                                  │                     │
│ bar  │                                  │                     │
│      │                                  │                     │
│      │                                  │                     │
├──────┴──────────────────────────────────┴─────────────────────┤
│ [프롬프트 입력]                                  [✅ Make] Cr:N│
│                           48px 높이                            │
└───────────────────────────────────────────────────────────────┘
```

---

## 좌측 사이드바 (56px)

아이콘 세로 배치. 상단 그룹 + 하단 그룹.

| 위치 | 아이콘 | 동작 |
|---|---|---|
| 상단 1 | 🖼️ Render | 노드 캔버스 뷰 (기본) |
| 상단 2 | 🕐 History | History 페이지로 전환 |
| 상단 3 | 👤 Account | Account 설정 |
| 상단 4 | 📖 Tutorial | Tutorial 페이지 |
| 하단 1 | 💬 Support | Support 링크 |
| 하단 2 | ⚙️ Settings | Settings 패널 |

활성 아이콘: 좌측에 청록색(#00d4aa) 세로 바 표시.

---

## 노드 캔버스 동작

### 이미지 로드 → Source 노드 생성

| 트리거 | 동작 |
|---|---|
| 캔버스에 이미지 드래그 앤 드롭 | Source 노드 생성 (드롭 위치) |
| Browse 버튼 클릭 (빈 캔버스) | 파일 선택 → Source 노드 생성 (캔버스 중앙) |
| SketchUp 플러그인 전송 | Source 노드 자동 생성 (origin: "sketchup") |
| Ctrl+V (빈 캔버스) | 클립보드 이미지 → Source 노드 생성 |

빈 캔버스 상태에서는 중앙에 "Drag and drop an image to get started, or" + [Browse] 버튼을 표시한다.

### 노드 클릭

| 동작 | 결과 |
|---|---|
| 단일 클릭 | selectedNodeId 갱신 → Inspector에 해당 노드 표시 |
| 더블 클릭 | Preview를 캔버스 전체로 확대 표시 (Enlarge 모드) |

### 노드 연결

| 동작 | 결과 |
|---|---|
| 출력 포트 드래그 → 기존 노드 입력 포트에 드롭 | 엣지 생성 |
| 출력 포트 드래그 → 빈 캔버스에 드롭 | Render Mode 선택 메뉴 → 노드 생성 + 자동 연결 |
| 순환 연결 시도 | 빨간색 하이라이트 → 연결 거부 |

### 캔버스 우클릭 (빈 영역)

| 메뉴 항목 | 동작 |
|---|---|
| Load image... | 파일 선택 → Source 노드 생성 |
| Clear all | 모든 노드 + 엣지 삭제 |
| Rearrange nodes | DAG 기반 자동 정렬 |

### 노드 우클릭

| 메뉴 항목 | 동작 |
|---|---|
| Make | 해당 노드 기준으로 파이프라인 실행 |
| Duplicate | 노드 복제 (파라미터 복사, 결과 미포함) |
| Delete | 노드 삭제 + 연결된 엣지 삭제 |
| Compare A | CompareTab A 슬롯에 할당 |
| Compare B | CompareTab B 슬롯에 할당 |

---

## Inspector Panel (우측 320px)

### 구조 (위에서 아래로)

```
┌───────────────────────┐
│ [Enlarge] 버튼         │
├───────────────────────┤
│ Preview | Compare | Draw  (탭)
├───────────────────────┤
│ 결과 이미지 / 미니 그래프  │
│ (확대율 %, 해상도 표시)   │
├───────────────────────┤
│ Render Settings       │
│ ┌───────────────────┐ │
│ │ Render Mode: [▼]  │ │
│ │ (노드별 추가 설정)  │ │
│ └───────────────────┘ │
├───────────────────────┤
│ Prompt Presets        │
│ ┌───┬───┬───┐        │
│ │   │   │   │ 3열 그리드│
│ ├───┼───┼───┤        │
│ │   │   │   │        │
│ └───┴───┴───┘        │
└───────────────────────┘
```

### 탭별 동작

**Preview 탭:**
- 선택 노드의 결과 이미지 표시
- 결과 없으면 빈 상태
- 우측 상단: 확대율 (예: "65%") + 해상도 (예: "832 × 1048")
- 마우스 휠: 확대/축소
- 드래그: 이미지 팬

**Compare 탭:**
- A/B 슬라이더 비교
- 좌측: A 슬롯 이미지, 우측: B 슬롯 이미지
- 중앙 슬라이더 드래그로 비교

**Draw 탭:**
- 이미지 위 자유 드로잉
- 상단 도구바: Pen | Eraser | Move | Delete | Size 슬라이더 | Color 드롭다운
- 색상: Red / Green / Blue / Yellow
- Ctrl+V: 이미지 붙여넣기 (위치 조정 가능)
- 드로잉 결과 → mask 파라미터로 저장

### Render Settings 동적 변경

노드 타입별로 표시 내용이 변경된다:

| 선택 노드 | Render Mode 드롭다운 값 | 추가 설정 |
|---|---|---|
| SOURCE | (표시 안 함) | — |
| RENDER (main) | 1. Main renderer | — |
| RENDER (exp-ext) | (experimental) Exterior render | — |
| RENDER (exp-int) | (experimental) Interior render | — |
| MODIFIER | 2. Details editor | — |
| UPSCALE | 3. Creative upscaler | Upscale(2x/4x), Optimized for, Creativity, Detail strength, Similarity, Prompt strength 슬라이더 |
| VIDEO | 4. Image to video | Engine(Kling/Seedance), Video duration(5s/10s) |
| COMPARE | (표시 안 함) | — |

### Prompt Presets 동적 변경

노드 타입별로 표시되는 프리셋 아이콘 그리드가 변경된다.
→ PROMPT_PRESETS.md의 "프리셋 ↔ 노드 타입 매핑 요약" 참조.

---

## 하단 바

```
┌────────────────────────────────────────┬──────────────┐
│ [프롬프트 입력 텍스트]            [×]   │ [✅ Make] Cr:N│
└────────────────────────────────────────┴──────────────┘
```

- 플레이스홀더: "Enter your image prompt here..."
- 프리셋 클릭 시 자동 채워짐
- [×] 버튼: 프롬프트 초기화
- Make 버튼: 청록색(#00d4aa), 좌측에 ✅ 아이콘
- Make 버튼 하단: "Credits: N" 텍스트 (회색)
- 실행 중: Make 버튼 비활성 + 로딩 스피너
- 크레딧 부족: Make 버튼 비활성 + "Not enough credits"
- 진행률: 프롬프트 바 하단에 핑크/레드 프로그레스 바 표시 (Vizmaker 스크린샷 참조)

---

## History 페이지

좌측 사이드바 History 아이콘 클릭 시 전환.

```
┌───────────────────────────────────────────────────────┐
│ History                                               │
│ ℹ️ Hint: You can get more details about generated     │
│    image by clicking on the image                     │
├───┬───┬───┬───┬───┬───┬───────────────────────────────┤
│   │   │   │   │   │   │                               │
│ 📷│ 📷│ 📷│ 📷│ 📷│ 📷│  결과 이미지 그리드              │
│   │   │   │   │   │   │                               │
│ 2m│ 3m│ 4m│ 4m│ 4m│ 4m│  타임스탬프                    │
├───┼───┼───┼───┼───┼───┤                               │
│   │   │   │   │   │   │                               │
│   │   │   │   │   │   │                               │
├───┴───┴───┴───┴───┴───┴───────────────────────────────┤
│                [Load More]                             │
└───────────────────────────────────────────────────────┘
```

각 카드 hover 시:
- [Use] 버튼: 해당 시점의 전체 그래프를 현재 워크스페이스에 복원
- [Save] 버튼: 결과 이미지를 로컬에 다운로드

카드 클릭 시: 프롬프트, 소스, 파라미터 상세 표시.

---

## Undo/Redo

| 대상 | Undo/Redo |
|---|---|
| 노드 추가/삭제 | ⭕ |
| 엣지 추가/삭제 | ⭕ |
| 노드 위치 이동 | ⭕ |
| 파라미터 변경 | ⭕ |
| AI 실행 결과 | ❌ (히스토리에서 복원) |

- Ctrl+Z: Undo
- Ctrl+Shift+Z: Redo
- 스택 최대 50개

---

## 노드 자동 정렬 (Rearrange)

- 수평 방향: 왼쪽(Source) → 오른쪽(Output)
- 같은 깊이(depth)의 노드는 수직으로 배치
- 수평 간격: 250px
- 수직 간격: 150px
- 분기가 많은 노드(허브)가 상단에 배치
- 연결이 적은 노드(말단)가 하단에 배치

---

## 비디오 노드 재생

- VIDEO 노드 결과가 있는 경우: 노드에 ▶ 오버레이 표시
- 노드 클릭 → Preview 탭에서 비디오 재생
- 비디오 하단: 재생 컨트롤 (재생/일시정지, 타임라인, 전체화면)
- 시간 표시: "00:02 / 00:05" 형식

---

## 미니 노드 그래프 (Inspector 내부)

Inspector의 Preview 탭 아래에 미니 노드 그래프를 표시한다.
- 현재 선택 노드가 하이라이트 표시
- 각 노드에 결과 이미지 썸네일 포함
- 클릭 시 해당 노드로 선택 전환
- 수평 스크롤 가능
