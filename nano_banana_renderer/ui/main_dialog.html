<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NanoBanana Renderer</title>
  <link rel="stylesheet" href="styles/main-base.css">
  <link rel="stylesheet" href="styles/main-render.css">
  <link rel="stylesheet" href="styles/main-mix.css">
  <link rel="stylesheet" href="styles/main-node-editor.css">
</head>
<body>
  <!-- ì´ˆê¸° ë¡œë”© í™”ë©´ -->
  <div class="app-loader" id="app-loader">
    <div class="app-loader-logo">Nano<span>Banana</span></div>
    <div class="app-loader-spinner"></div>
    <div class="app-loader-text">Loading renderer...</div>
  </div>

  <!-- ì¢Œì¸¡ ì•„ì´ì½˜ ë©”ë‰´ë°” -->
  <nav class="icon-menu">
    <button class="icon-menu-item active" id="menu-render" title="Render">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M.968 9.027l7.717 4.428-.006 1.32-4.39-2.518-2.763 1.57 7.148 4.12.005 1.27-7.658-4.405c.02.516.488 2.106 1.383 3.337.91 1.247 1.946 1.776 1.946 1.776L11.428 24V11.849L.975 5.846zm22.064-3.8L15.22.723S13.982 0 12.008 0C9.952 0 8.76.746 8.76.746l-7.236 4.14 11.009 6.328V24l7.245-4.136s1.295-.715 2.279-2.414c.867-1.496.975-2.943.975-2.943zM11.251 7.308s1.615-.298 2.98.49l2.171 1.25s.003 1.097.003 2.736c0 1.313-1.112 2.674-1.112 2.674l.002-4.816zm6.402 10.562l-2.358 1.353v-1.269l1.835-1.05c1.748-1.26 2.037-3.117 2.037-3.761l-.007-5.705-5.006-2.881s-.76-.499-2.129-.499c-1.367 0-2.113.461-2.113.461L8.154 5.53l-1.11-.641L9.473 3.5s.95-.527 2.544-.527c1.462 0 2.6.571 2.6.571L20.27 6.81l-.007 6.226c.04.957-.406 3.296-2.61 4.835z"/>
      </svg>
    </button>
    <button class="icon-menu-item" id="menu-camera" title="Camera">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M18 3C19.6569 3 21 4.34315 21 6C21 7.65685 19.6569 9 18 9H15C13.6941 9 12.5831 8.16562 12.171 7.0009L11 7C9.9 7 9 7.9 9 9L9.0009 9.17102C10.1656 9.58312 11 10.6941 11 12C11 13.3059 10.1656 14.4169 9.0009 14.829L9 15C9 16.1 9.9 17 11 17L12.1707 17.0001C12.5825 15.8349 13.6937 15 15 15H18C19.6569 15 21 16.3431 21 18C21 19.6569 19.6569 21 18 21H15C13.6941 21 12.5831 20.1656 12.171 19.0009L11 19C8.79 19 7 17.21 7 15H5C3.34315 15 2 13.6569 2 12C2 10.3431 3.34315 9 5 9H7C7 6.79086 8.79086 5 11 5L12.1707 5.00009C12.5825 3.83485 13.6937 3 15 3H18ZM18 17H15C14.4477 17 14 17.4477 14 18C14 18.5523 14.4477 19 15 19H18C18.5523 19 19 18.5523 19 18C19 17.4477 18.5523 17 18 17ZM8 11H5C4.44772 11 4 11.4477 4 12C4 12.5523 4.44772 13 5 13H8C8.55228 13 9 12.5523 9 12C9 11.4477 8.55228 11 8 11ZM18 5H15C14.4477 5 14 5.44772 14 6C14 6.55228 14.4477 7 15 7H18C18.5523 7 19 6.55228 19 6C19 5.44772 18.5523 5 18 5Z"/>
      </svg>
    </button>
    <button class="icon-menu-item" id="menu-mix" title="Mix">
      <svg viewBox="0 0 15 15" fill="currentColor">
        <path d="M1.59979 8.82434C1.59991 8.32473 2.10284 7.99678 2.54999 8.17004L2.63885 8.21204L6.57245 10.3878L6.65741 10.4425C7.02571 10.7193 7.02591 11.282 6.65741 11.5587L6.57245 11.6134L2.63885 13.7892C2.17257 14.0469 1.60035 13.7095 1.59979 13.1769V8.82434ZM13.0002 8.29993C13.3867 8.30002 13.7004 8.61358 13.7004 9.00012V13.0001C13.7003 13.3866 13.3867 13.7002 13.0002 13.7003H9.00018C8.61362 13.7003 8.30004 13.3867 8.29999 13.0001V9.00012C8.29999 8.61352 8.61358 8.29993 9.00018 8.29993H13.0002ZM2.50018 12.8361L5.81952 11.0001L2.50018 9.16321V12.8361ZM9.20038 12.7999H12.8V9.20032H9.20038V12.7999ZM4.00018 1.24915C5.51931 1.24925 6.75114 2.48097 6.75116 4.00012C6.75105 5.5192 5.51926 6.75099 4.00018 6.7511C2.48103 6.75108 1.24931 5.51925 1.24921 4.00012C1.24922 2.48091 2.48098 1.24916 4.00018 1.24915ZM12.8068 1.55676C12.9826 1.38103 13.2678 1.38103 13.4435 1.55676C13.6191 1.73251 13.6192 2.01781 13.4435 2.19348L11.6369 4.00012L13.4435 5.80676L13.5012 5.87708C13.6165 6.05174 13.5973 6.2897 13.4435 6.44348C13.2898 6.59725 13.0518 6.61646 12.8771 6.5011L12.8068 6.44348L11.0002 4.63684L9.19354 6.44348C9.01787 6.61913 8.73257 6.61902 8.55682 6.44348C8.38109 6.26775 8.38111 5.9825 8.55682 5.80676L10.3635 4.00012L8.55682 2.19348L8.49921 2.12317C8.38371 1.94849 8.403 1.7106 8.55682 1.55676C8.71066 1.40293 8.94854 1.38364 9.12323 1.49915L9.19354 1.55676L11.0002 3.3634L12.8068 1.55676ZM4.00018 2.14954C2.97803 2.14955 2.14961 2.97797 2.1496 4.00012C2.1497 5.0222 2.97809 5.85069 4.00018 5.85071C5.0222 5.8506 5.85066 5.02214 5.85077 4.00012C5.85075 2.97803 5.02226 2.14964 4.00018 2.14954Z"/>
      </svg>
    </button>
    <button class="icon-menu-item" id="menu-history" title="History">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
    </button>
    <div class="icon-menu-divider"></div>
    <div class="icon-menu-spacer"></div>
    <button class="icon-menu-item" id="menu-help" title="Help">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
    </button>
    <button class="icon-menu-item" id="menu-settings" title="Settings">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"></circle>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
      </svg>
    </button>
  </nav>

  <!-- Mix ëª¨ë“œ ì¢Œì¸¡ íŒ¨ë„ -->
  <aside class="mix-mode-panel" id="mix-mode-panel">
    <div class="mix-mode-header">
      <div class="mix-mode-title">Mix Mode</div>
      <div class="mix-mode-subtitle">AI Scene Mixing System</div>
    </div>
    <div class="mix-mode-list">
      <div class="mix-mode-item active" data-mixmode="add-remove">
        <div class="mix-mode-item-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="16"></line>
            <line x1="8" y1="12" x2="16" y2="12"></line>
          </svg>
          Object Insert & Remove
          <span class="mix-mode-item-badge">3D</span>
        </div>
        <div class="mix-mode-item-desc">3D ì›”ë“œ ì¢Œí‘œ ê¸°ë°˜ìœ¼ë¡œ ê°€êµ¬/ì†Œí’ˆì„ ì •í™•í•œ ìœ„ì¹˜ì— ë°°ì¹˜í•˜ê±°ë‚˜ ì œê±°í•©ë‹ˆë‹¤.</div>
      </div>
      <div class="mix-mode-item" data-mixmode="inpaint">
        <div class="mix-mode-item-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 19l7-7 3 3-7 7-3-3z"></path>
            <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path>
          </svg>
          Inpainting
        </div>
        <div class="mix-mode-item-desc">ë§ˆìŠ¤í‚¹ ì˜ì—­ë§Œ ìˆ˜ì •í•˜ê³  ë‚˜ë¨¸ì§€ ì”¬ì€ í”½ì…€ ë‹¨ìœ„ê¹Œì§€ ê·¸ëŒ€ë¡œ ìœ ì§€í•©ë‹ˆë‹¤.</div>
      </div>
      <div class="mix-mode-item" data-mixmode="material">
        <div class="mix-mode-item-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="3" y1="9" x2="21" y2="9"></line>
            <line x1="9" y1="21" x2="9" y2="9"></line>
          </svg>
          Material Replace
        </div>
        <div class="mix-mode-item-desc">ë²½/ë°”ë‹¥/ì²œì¥ì— ìƒˆë¡œìš´ ì¬ì§ˆì„ ì‹¤ì œ ê³µê°„ì— ë§ê²Œ íˆ¬ì˜í•©ë‹ˆë‹¤.</div>
      </div>
      <div class="mix-mode-item" data-mixmode="floorplan">
        <div class="mix-mode-item-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon>
            <line x1="8" y1="2" x2="8" y2="18"></line>
            <line x1="16" y1="6" x2="16" y2="22"></line>
          </svg>
          Floorplan to Isometric
        </div>
        <div class="mix-mode-item-desc">2D í‰ë©´ë„ë¥¼ ë¶„ì„í•˜ì—¬ 3D ì•„ì´ì†Œë©”íŠ¸ë¦­ ë·°ë¡œ ìë™ ë³€í™˜í•©ë‹ˆë‹¤.</div>
      </div>
    </div>
  </aside>

  <!-- ì¢Œì¸¡ ì‚¬ì´ë“œë°” -->
  <aside class="sidebar" id="render-sidebar">
    <div class="sidebar-header">
      <div class="logo">NanoBanana</div>
    </div>

    <div class="sidebar-content">
      <div class="control-section">
        <span class="section-label">Time</span>
        <div class="segmented" id="time-group">
          <button class="seg-btn active" data-time="day">Day</button>
          <button class="seg-btn" data-time="evening">Eve</button>
          <button class="seg-btn" data-time="night">Night</button>
        </div>
      </div>

      <div class="control-section">
        <span class="section-label">Lights</span>
        <div class="segmented" id="light-group">
          <button class="seg-btn active" data-light="on">On</button>
          <button class="seg-btn" data-light="off">Off</button>
        </div>
      </div>

      <div class="control-section">
        <span class="section-label">Engine</span>
        <div class="segmented" id="engine-group">
          <button class="seg-btn active" data-engine="gemini">Gemini</button>
          <button class="seg-btn" data-engine="replicate">Replicate</button>
        </div>
      </div>

      <div class="control-section">
        <span class="section-label">Model</span>
        <div class="custom-dropdown" id="model-dropdown">
          <div class="dropdown-selected" id="model-dropdown-selected">
            <span id="model-selected-text">Flash 2.0 (ì¶”ì²œ)</span>
            <span class="dropdown-arrow"></span>
          </div>
          <div class="dropdown-menu" id="model-dropdown-menu">
            <div class="dropdown-group-label">Gemini</div>
            <div class="dropdown-item selected" data-value="gemini-2.0-flash-exp" data-engine="gemini">
              Flash 2.0 (ì¶”ì²œ)
              <div class="dropdown-item-desc">20~40ì´ˆ, ê³ ì†</div>
            </div>
            <div class="dropdown-item" data-value="gemini-2.5-flash-image" data-engine="gemini">
              Flash 2.5
              <div class="dropdown-item-desc">30~60ì´ˆ</div>
            </div>
            <div class="dropdown-item" data-value="gemini-3-pro-image" data-engine="gemini">
              Gemini 3 Pro
              <div class="dropdown-item-desc">1~2ë¶„, ìµœê³ í’ˆì§ˆ</div>
            </div>
            <div class="dropdown-group-label">Imagen</div>
            <div class="dropdown-item" data-value="imagen-4.0-fast-generate-001" data-engine="gemini">
              Imagen 4 Fast
              <div class="dropdown-item-desc">20~40ì´ˆ, ê³ ì†</div>
            </div>
            <div class="dropdown-item" data-value="imagen-4.0-generate-001" data-engine="gemini">
              Imagen 4
              <div class="dropdown-item-desc">1~2ë¶„, ê³ í’ˆì§ˆ</div>
            </div>
            <div class="dropdown-group-label">Replicate (ControlNet)</div>
            <div class="dropdown-item" data-value="photorealistic-fx" data-engine="replicate">
              PhotoFX
              <div class="dropdown-item-desc">10ì´ˆ, êµ¬ë„ ìœ ì§€</div>
            </div>
            <div class="dropdown-item" data-value="sdxl-controlnet" data-engine="replicate">
              SDXL ControlNet
              <div class="dropdown-item-desc">20ì´ˆ, ê³ í’ˆì§ˆ</div>
            </div>
            <div class="dropdown-item" data-value="flux-canny" data-engine="replicate">
              Flux Canny
              <div class="dropdown-item-desc">15ì´ˆ, ìœ¤ê³½ì„  ê¸°ë°˜</div>
            </div>
          </div>
        </div>
      </div>

      <div class="control-section">
        <span class="section-label">Size</span>
        <div class="segmented" id="size-group">
          <button class="seg-btn active" data-size="1024">ì†ë„</button>
          <button class="seg-btn" data-size="1536">ë°¸ëŸ°ìŠ¤</button>
          <button class="seg-btn" data-size="1920">ê³ í’ˆì§ˆ</button>
        </div>
      </div>

      <div class="control-section">
        <span class="section-label">Camera</span>
        <div class="camera-btns-row">
          <button class="btn btn-mirror" id="btn-mirror">Mirror</button>
          <button class="btn btn-2point" id="btn-2point" title="2ì  íˆ¬ì‹œ ìë™ ë³´ì •">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <line x1="12" y1="3" x2="12" y2="21"/>
              <line x1="3" y1="12" x2="21" y2="12"/>
            </svg>
          </button>
        </div>
        <div class="camera-controls">
          <div class="camera-move">
            <div class="move-row">
              <button class="cam-btn wasd" id="cam-forward" title="Forward (W)">W</button>
            </div>
            <div class="move-row">
              <button class="cam-btn wasd" id="cam-left" title="Left (A)">A</button>
              <button class="cam-btn wasd" id="cam-back" title="Back (S)">S</button>
              <button class="cam-btn wasd" id="cam-right" title="Right (D)">D</button>
            </div>
          </div>
          <div class="camera-height">
            <button class="cam-btn small" id="cam-up" title="Up (Q)">Q</button>
            <button class="cam-btn small" id="cam-down" title="Down (E)">E</button>
          </div>
          <div class="camera-rotate">
            <button class="cam-btn small" id="cam-rot-left" title="Rotate Left (Z)">Z</button>
            <button class="cam-btn small" id="cam-rot-right" title="Rotate Right (X)">X</button>
          </div>
        </div>
        <div class="keyboard-hint">WASD ì´ë™ | QE ë†’ì´ | ZX íšŒì „</div>
      </div>

      <div class="control-section">
        <span class="section-label">Height</span>
        <div class="segmented" id="height-group">
          <button class="seg-btn" data-height="standing">ì„œê¸°</button>
          <button class="seg-btn active" data-height="seated">ì•‰ê¸°</button>
          <button class="seg-btn" data-height="low_angle">ë‚®ìŒ</button>
        </div>
      </div>

      <div class="control-section">
        <span class="section-label">FOV</span>
        <div class="segmented" id="fov-group">
          <button class="seg-btn" data-fov="wide">ê´‘ê°</button>
          <button class="seg-btn active" data-fov="standard">í‘œì¤€</button>
          <button class="seg-btn" data-fov="telephoto">ë§ì›</button>
        </div>
      </div>
    </div>

    <div class="sidebar-actions">
      <button class="btn btn-secondary" id="btn-capture">Convert</button>
      <button class="btn btn-secondary" id="btn-edit" disabled>Edit</button>
      <button class="btn btn-secondary" id="btn-save" disabled>Export</button>
    </div>

    <div class="sidebar-footer">
      <div class="status-indicator">
        <span class="status-dot" id="status-dot"></span>
        <span id="api-status">Checking...</span>
      </div>
      <button class="icon-btn" id="btn-settings" title="Settings">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
        </svg>
      </button>
    </div>
  </aside>

  <!-- Mix ì˜µì…˜ íŒ¨ë„ (ìš°ì¸¡) -->
  <aside class="mix-options-panel" id="mix-options-panel">
    <div class="mix-options-header">
      <div class="mix-options-title" id="mix-options-title">Object Insert & Remove</div>
      <div class="mix-options-subtitle" id="mix-options-subtitle">3D ì¢Œí‘œ ê¸°ë°˜ ì˜¤ë¸Œì íŠ¸ ë°°ì¹˜</div>
    </div>

    <div class="mix-options-content">
      <!-- Add/Remove ì˜µì…˜ -->
      <div class="mix-options-mode" id="mix-options-add-remove">
        <div class="mix-option-section">
          <span class="mix-option-label">
            Reference Image
            <span class="mix-option-label-badge">Required</span>
          </span>
          <div class="mix-upload-area" id="mix-upload-object">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            <p>Click to upload furniture/object image</p>
            <img class="mix-upload-preview hidden" id="mix-object-preview">
          </div>
          <input type="file" id="mix-object-file" accept="image/*" style="display:none">
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Object Name</span>
          <input type="text" class="mix-option-input" id="mix-object-name" placeholder="e.g., Modern Dining Chair">
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Estimated Size (mm)</span>
          <div class="mix-param-grid">
            <div class="mix-param-item">
              <label>Width</label>
              <input type="number" id="mix-object-width" value="500" min="100" max="5000">
            </div>
            <div class="mix-param-item">
              <label>Height</label>
              <input type="number" id="mix-object-height" value="800" min="100" max="5000">
            </div>
            <div class="mix-param-item">
              <label>Depth</label>
              <input type="number" id="mix-object-depth" value="500" min="100" max="5000">
            </div>
          </div>
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Placement Instructions</span>
          <textarea class="mix-option-textarea" id="mix-object-instruction" placeholder="e.g., Place naturally on the floor, facing the window."></textarea>
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Hotspots (3D Positions)</span>
          <div class="mix-hotspot-list" id="mix-hotspot-list">
            <div class="mix-empty-state" style="font-size:11px;padding:16px;color:#555;">
              ìŠ¤ì¼€ì¹˜ì—… ë·°í¬íŠ¸ì—ì„œ í´ë¦­í•˜ì—¬ í•«ìŠ¤íŒŸì„ ì¶”ê°€í•˜ì„¸ìš”
            </div>
          </div>
        </div>
      </div>

      <!-- Inpaint ì˜µì…˜ -->
      <div class="mix-options-mode hidden" id="mix-options-inpaint">
        <div class="mix-option-section">
          <span class="mix-option-label">Brush Size</span>
          <div class="mix-slider-container">
            <input type="range" class="mix-slider" id="mix-brush-size" min="5" max="100" value="30">
            <span class="mix-slider-value" id="mix-brush-size-value">30px</span>
          </div>
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Mask Color</span>
          <div class="mix-color-picker-row">
            <button class="mix-color-btn red active" data-color="rgba(255, 59, 48, 0.5)"></button>
            <button class="mix-color-btn blue" data-color="rgba(0, 102, 255, 0.5)"></button>
            <button class="mix-color-btn green" data-color="rgba(48, 209, 88, 0.5)"></button>
            <button class="mix-color-btn yellow" data-color="rgba(255, 214, 10, 0.5)"></button>
          </div>
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">
            Edit Instruction
            <span class="mix-option-label-badge">Required</span>
          </span>
          <textarea class="mix-option-textarea" id="mix-inpaint-instruction" placeholder="e.g., Change the sofa to a vintage brown leather chesterfield sofa"></textarea>
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Preserve Settings</span>
          <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:#ccc;margin-top:4px;">
            <input type="checkbox" id="mix-preserve-lighting" checked> Lighting & Shadows
          </label>
          <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:#ccc;margin-top:4px;">
            <input type="checkbox" id="mix-preserve-style" checked> Material Style & Tone
          </label>
        </div>
      </div>

      <!-- Material ì˜µì…˜ -->
      <div class="mix-options-mode hidden" id="mix-options-material">
        <div class="mix-option-section">
          <span class="mix-option-label">Brush Size</span>
          <div class="mix-slider-container">
            <input type="range" class="mix-slider" id="mix-material-brush-size" min="5" max="100" value="40">
            <span class="mix-slider-value" id="mix-material-brush-size-value">40px</span>
          </div>
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">
            Material Texture Image
            <span class="mix-option-label-badge">Required</span>
          </span>
          <div class="mix-upload-area" id="mix-upload-material">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            <p>Click to upload material texture</p>
            <img class="mix-upload-preview hidden" id="mix-material-preview">
          </div>
          <input type="file" id="mix-material-file" accept="image/*" style="display:none">
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Material Description</span>
          <textarea class="mix-option-textarea" id="mix-material-description" placeholder="e.g., Herringbone oak wood flooring, natural matte finish"></textarea>
        </div>
      </div>

      <!-- Floorplan ì˜µì…˜ -->
      <div class="mix-options-mode hidden" id="mix-options-floorplan">
        <div class="mix-option-section">
          <span class="mix-option-label">
            2D Floorplan Image
            <span class="mix-option-label-badge">Required</span>
          </span>
          <div class="mix-upload-area" id="mix-upload-floorplan">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            <p>Click to upload 2D floorplan (PNG/PDF)</p>
            <img class="mix-upload-preview hidden" id="mix-floorplan-preview">
          </div>
          <input type="file" id="mix-floorplan-file" accept="image/*,.pdf" style="display:none">
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Space Parameters</span>
          <div class="mix-param-grid">
            <div class="mix-param-item">
              <label>Wall Height (mm)</label>
              <input type="number" id="mix-wall-height" value="2400" min="2000" max="5000">
            </div>
            <div class="mix-param-item">
              <label>Wall Thickness (mm)</label>
              <input type="number" id="mix-wall-thickness" value="100" min="50" max="500">
            </div>
          </div>
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Interior Style</span>
          <select class="mix-option-input" id="mix-floorplan-style">
            <option value="modern">Modern Minimalist</option>
            <option value="scandinavian">Scandinavian</option>
            <option value="industrial">Industrial</option>
            <option value="classic">Classic Traditional</option>
            <option value="luxury">Luxury High-End</option>
            <option value="japandi">Japandi</option>
          </select>
        </div>

        <div class="mix-option-section">
          <span class="mix-option-label">Additional Instructions</span>
          <textarea class="mix-option-textarea" id="mix-floorplan-instruction" placeholder="e.g., Add appropriate furniture for each room, warm artificial lighting"></textarea>
        </div>
      </div>
    </div>

    <div class="mix-options-actions">
      <button class="btn btn-primary" id="mix-btn-apply" disabled>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        Apply Mix
      </button>
      <button class="btn btn-secondary" id="mix-btn-back">Back to Render</button>
    </div>
  </aside>

  <!-- Mix ë©”ì¸ ì‘ì—… ì˜ì—­ -->
  <main class="mix-main-area" id="mix-main-area">
    <div class="mix-toolbar">
      <!-- Add/Remove ëª¨ë“œ íˆ´ë°” -->
      <div class="mix-toolbar-group" id="mix-toolbar-add-remove">
        <button class="mix-tool-btn active" id="mix-tool-hotspot" title="í•«ìŠ¤íŒŸ ì¶”ê°€ (ìŠ¤ì¼€ì¹˜ì—… ë·°ì—ì„œ í´ë¦­)">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"></circle>
            <line x1="12" y1="2" x2="12" y2="6"></line>
            <line x1="12" y1="18" x2="12" y2="22"></line>
            <line x1="2" y1="12" x2="6" y2="12"></line>
            <line x1="18" y1="12" x2="22" y2="12"></line>
          </svg>
        </button>
        <span class="mix-tool-label">Click on SketchUp viewport to add hotspot</span>
      </div>

      <!-- Inpaint/Material ëª¨ë“œ íˆ´ë°” -->
      <div class="mix-toolbar-group hidden" id="mix-toolbar-mask">
        <button class="mix-tool-btn active" id="mix-tool-brush" title="ë¸ŒëŸ¬ì‹œ">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9.06 11.9l8.07-8.06a2.85 2.85 0 1 1 4.03 4.03l-8.06 8.08"></path>
            <path d="M7.07 14.94c-1.66 0-3 1.35-3 3.02 0 1.33-2.5 1.52-2 2.02 1.08 1.1 2.49 2.02 4 2.02 2.2 0 4-1.8 4-4.04a3.01 3.01 0 0 0-3-3.02z"></path>
          </svg>
        </button>
        <button class="mix-tool-btn" id="mix-tool-eraser" title="ì§€ìš°ê°œ">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 20H7L3 16l10-10 7 7-4 4"></path>
          </svg>
        </button>
        <div class="mix-tool-divider"></div>
        <button class="mix-tool-btn" id="mix-tool-clear-mask" title="ë§ˆìŠ¤í¬ ì´ˆê¸°í™”">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
        </button>
      </div>

      <!-- Floorplan ëª¨ë“œ íˆ´ë°” -->
      <div class="mix-toolbar-group hidden" id="mix-toolbar-floorplan">
        <span class="mix-tool-label">Upload 2D floorplan to generate isometric view</span>
      </div>
    </div>

    <div class="mix-canvas-container">
      <div class="mix-empty-state" id="mix-empty-state">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <circle cx="8.5" cy="8.5" r="1.5"></circle>
          <polyline points="21 15 16 10 5 21"></polyline>
        </svg>
        <p>ë¨¼ì € ë©”ì¸ í™”ë©´ì—ì„œ ì”¬ì„ ìº¡ì²˜(Convert)í•˜ì„¸ìš”</p>
        <p style="margin-top:4px;color:#555;">ìº¡ì²˜ í›„ Mix ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
      </div>
      <div class="mix-canvas-wrapper hidden" id="mix-canvas-wrapper">
        <canvas id="mix-main-canvas"></canvas>
        <canvas id="mix-mask-canvas" class="mix-overlay-canvas"></canvas>
        <canvas id="mix-draw-canvas" class="mix-overlay-canvas"></canvas>
      </div>

      <div class="mix-coord-overlay" id="mix-coord-overlay">
        <div>World: <span id="mix-coord-world">X: 0 Y: 0 Z: 0</span></div>
        <div>Screen: <span id="mix-coord-screen">X: 0 Y: 0</span></div>
      </div>

      <div class="mix-loading-overlay hidden" id="mix-loading">
        <div class="spinner"></div>
        <div class="loading-text" id="mix-loading-text">Processing...</div>
        <div class="loading-subtext" id="mix-loading-subtext">AIê°€ ì”¬ì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤</div>
      </div>
    </div>

    <div class="mix-status-bar">
      <span id="mix-status-text">Ready</span>
      <span id="mix-scene-info">Scene context loaded</span>
    </div>
  </main>

  <!-- ì„¤ì • ë©”ì¸ ì˜ì—­ -->
  <main class="main-area settings-main-area" id="settings-main-area" style="display:none;">
    <div class="settings-container">
      <div class="settings-header">
        <h2>Settings</h2>
        <button class="settings-close-btn" id="btn-close-settings">âœ•</button>
      </div>
      <div class="settings-content">
        <div class="settings-section">
          <label class="settings-label">Google Gemini API Key</label>
          <div class="settings-input-row">
            <input type="password" id="settings-api-key" class="settings-input" placeholder="API Keyë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            <button class="settings-toggle-btn" id="btn-toggle-api-key">ğŸ‘ï¸</button>
          </div>
          <p class="settings-help">API KeyëŠ” <a href="https://aistudio.google.com/apikey" target="_blank">Google AI Studio</a>ì—ì„œ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
        <div class="settings-section">
          <label class="settings-label">ì—°ê²° ìƒíƒœ</label>
          <div class="settings-status">
            <span class="settings-status-dot" id="settings-status-dot"></span>
            <span id="settings-status-text">í™•ì¸ í•„ìš”</span>
          </div>
          <button class="settings-btn" id="btn-test-api">ğŸ”— ì—°ê²° í…ŒìŠ¤íŠ¸</button>
        </div>
        <div class="settings-actions">
          <button class="settings-btn settings-btn-primary" id="btn-save-settings">ì €ì¥</button>
        </div>
      </div>
    </div>
  </main>

  <!-- ìš°ì¸¡ ë©”ì¸ ì˜ì—­ -->
  <main class="main-area" id="render-main-area">
    <!-- ì”¬ íƒ­ ë°” -->
    <div class="scene-tabs" id="scene-tabs">
      <button class="scene-add-btn" id="btn-add-scene" title="í˜„ì¬ ë·°ë¥¼ ì”¬ìœ¼ë¡œ ì €ì¥">+</button>
    </div>

    <div class="image-container" id="image-container">
      <div class="image-panel" id="source-panel">
        <div class="panel-label">
          <span>Source</span>
          <button class="panel-guide-btn" id="btn-guide" title="ê°€ì´ë“œ í‘œì‹œ">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="2" x2="12" y2="22"></line>
              <line x1="2" y1="12" x2="22" y2="12"></line>
            </svg>
          </button>
          <button class="panel-expand-btn" id="btn-expand-source" title="Expand">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="15 3 21 3 21 9"></polyline>
              <polyline points="9 21 3 21 3 15"></polyline>
              <line x1="21" y1="3" x2="14" y2="10"></line>
              <line x1="3" y1="21" x2="10" y2="14"></line>
            </svg>
          </button>
        </div>
        <div class="panel-content">
          <div class="empty-state" id="original-empty">No image</div>
          <div class="image-zoom-container" id="zoom-container-source">
            <div class="image-zoom-wrapper" id="zoom-wrapper-source">
              <img id="original-image" style="display:none;">
              <canvas class="guide-grid-canvas" id="guide-canvas-source" style="display:none;"></canvas>
            </div>
          </div>
          <div class="guide-controls hidden" id="guide-controls-source">
            <label>Grid</label>
            <input type="range" class="guide-slider" id="guide-slider-source" min="10" max="100" value="40">
            <span class="guide-value" id="guide-value-source">40px</span>
            <button class="guide-lock-btn" id="guide-lock-source" title="Lock">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
            </button>
            <label style="margin-left:8px;">Zoom</label>
            <input type="range" class="guide-zoom-slider" id="guide-zoom-source" min="50" max="150" value="100">
          </div>
          <div class="loading-overlay hidden" id="loading-source">
            <div class="loading-spinner"></div>
            <div class="loading-text" id="loading-text-source">Converting... <span id="loading-percent-source">0%</span></div>
            <div class="loading-subtext" id="loading-subtext-source">Preparing</div>
            <div class="loading-progress"><div class="loading-progress-bar" id="loading-bar-source"></div></div>
          </div>
        </div>
        <div class="prompt-area" id="prompt-area-source">
          <div class="prompt-header">
            <div class="prompt-tabs">
              <button class="prompt-tab active" data-tab="main">Prompt</button>
              <button class="prompt-tab negative" data-tab="negative">Negative</button>
            </div>
            <button class="prompt-auto-btn" id="btn-auto-prompt" title="AI ìë™ ìƒì„±" disabled>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                <path d="M2 17l10 5 10-5"></path>
                <path d="M2 12l10 5 10-5"></path>
              </svg>
              Auto
            </button>
          </div>
          <div class="prompt-content active" data-content="main">
            <div class="prompt-input-wrapper">
              <textarea id="prompt-source" placeholder="Convert í›„ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜ Auto ë²„íŠ¼ìœ¼ë¡œ ìë™ ìƒì„±í•˜ì„¸ìš”." disabled></textarea>
              <div class="prompt-btn-group">
                <button class="prompt-attach-btn" id="btn-attach-source" title="ì´ë¯¸ì§€ ì²¨ë¶€" disabled>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                  </svg>
                </button>
                <button class="prompt-generate-btn" id="btn-generate-source" title="ì´ë¯¸ì§€ ìƒì„±" disabled>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          <div class="prompt-content" data-content="negative">
            <div class="prompt-input-wrapper">
              <textarea id="prompt-source-negative" class="negative" placeholder="ìƒì„± ê¸ˆì§€ í•­ëª© (ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸)" disabled></textarea>
            </div>
          </div>
        </div>
      </div>

      <div class="image-panel result-panel" id="result-panel-1" data-result-index="1">
        <div class="panel-label">
          <span>Result 1</span>
          <button class="panel-guide-btn" id="btn-guide-result" title="ê°€ì´ë“œ í‘œì‹œ">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="2" x2="12" y2="22"></line>
              <line x1="2" y1="12" x2="22" y2="12"></line>
            </svg>
          </button>
          <button class="panel-expand-btn" id="btn-expand-result" title="Expand">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="15 3 21 3 21 9"></polyline>
              <polyline points="9 21 3 21 3 15"></polyline>
              <line x1="21" y1="3" x2="14" y2="10"></line>
              <line x1="3" y1="21" x2="10" y2="14"></line>
            </svg>
          </button>
        </div>
        <div class="panel-content">
          <div class="empty-state" id="render-empty">Ready</div>
          <!-- ì´ë¯¸ì§€+ê·¸ë¦¬ë“œ ì¤Œ ì»¨í…Œì´ë„ˆ -->
          <div class="image-zoom-container" id="zoom-container-result">
            <div class="image-zoom-wrapper" id="zoom-wrapper-result">
              <img id="render-image" style="display:none;">
              <canvas class="guide-grid-canvas" id="guide-canvas-result" style="display:none;"></canvas>
            </div>
          </div>
          <!-- ê·¸ë¦¬ë“œ ì»¨íŠ¸ë¡¤ -->
          <div class="guide-controls hidden" id="guide-controls-result">
            <label>Grid</label>
            <input type="range" class="guide-slider" id="guide-slider-result" min="10" max="100" value="40">
            <span class="guide-value" id="guide-value-result">40px</span>
            <button class="guide-lock-btn" id="guide-lock-result" title="Lock">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
            </button>
            <label style="margin-left:8px;">Zoom</label>
            <input type="range" class="guide-zoom-slider" id="guide-zoom-result" min="50" max="150" value="100">
          </div>
          <div class="loading-overlay hidden" id="loading">
            <div class="loading-spinner"></div>
            <div class="loading-text" id="loading-text">Generating...</div>
            <div class="loading-subtext">AI rendering in progress</div>
            <div class="loading-progress"><div class="loading-progress-bar"></div></div>
          </div>
        </div>
        <div class="prompt-area" id="prompt-area-result">
          <div class="prompt-header">
            <div class="prompt-tabs">
              <button class="prompt-tab active" data-tab="main">Prompt</button>
              <button class="prompt-tab negative" data-tab="negative">Negative</button>
            </div>
            <button class="prompt-auto-btn" id="btn-auto-prompt-result" title="AI ìë™ ìƒì„±" disabled>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                <path d="M2 17l10 5 10-5"></path>
                <path d="M2 12l10 5 10-5"></path>
              </svg>
              Auto
            </button>
          </div>
          <div class="prompt-content active" data-content="main">
            <div class="prompt-input-wrapper">
              <textarea id="prompt-result" placeholder="ë Œë”ë§ ì™„ë£Œ í›„ 2ì°¨ ìƒì„±ìš© í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”." disabled></textarea>
              <div class="prompt-btn-group">
                <button class="prompt-attach-btn" id="btn-attach-result" title="ì´ë¯¸ì§€ ì²¨ë¶€" disabled>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                  </svg>
                </button>
                <button class="prompt-generate-btn" id="btn-regenerate-1" title="2ì°¨ ìƒì„±" disabled>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          <div class="prompt-content" data-content="negative">
            <div class="prompt-input-wrapper">
              <textarea id="prompt-result-negative" class="negative" placeholder="2ì°¨ ìƒì„± ë„¤ê±°í‹°ë¸Œ í”„ë¡¬í”„íŠ¸" disabled></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="status-bar">
      <span id="status-text">Ready</span>
    </div>

  </main>

  <!-- ========================================
       Node Editor Mode - VizMaker Style
       ======================================== -->
  <div class="node-editor-container" id="node-editor-container">
    <!-- ìº”ë²„ìŠ¤ Wrapper (ìº”ë²„ìŠ¤ + Inspector) -->
    <div class="node-canvas-wrapper">
      <!-- í™•ëŒ€ í”„ë¦¬ë·° ì˜¤ë²„ë ˆì´ (Enlarge ëª¨ë“œ) -->
      <div class="node-enlarged-preview" id="node-enlarged-preview">
        <div class="node-enlarged-topbar">
          <div class="node-enlarged-tabs">
            <button class="node-enlarged-tab active" data-tab="preview">Preview</button>
            <button class="node-enlarged-tab" data-tab="compare">Compare</button>
            <button class="node-enlarged-tab" data-tab="draw">Draw</button>
          </div>
          <div class="node-enlarged-info">
            <span class="node-enlarged-zoom" id="node-enlarged-zoom">100%</span>
          </div>
        </div>
        <div class="node-enlarged-image" id="node-enlarged-image">
          <span class="node-inspector-preview-empty">No preview</span>
        </div>
      </div>

      <!-- ë…¸ë“œ ìº”ë²„ìŠ¤ -->
      <div class="node-canvas-area" id="node-canvas-area">
        <div class="node-canvas-grid"></div>
        <svg class="node-connections" id="node-connections"></svg>
        <div class="node-canvas" id="node-canvas">
          <!-- ë…¸ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
        </div>

        <!-- ìƒë‹¨ ë²„íŠ¼ -->
        <div class="node-canvas-topbar">
          <button class="node-canvas-btn" id="node-add-source" title="Add Source">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <line x1="12" y1="8" x2="12" y2="16"/>
              <line x1="8" y1="12" x2="16" y2="12"/>
            </svg>
            Source
          </button>
          <button class="node-canvas-btn" id="node-add-renderer" title="Add Renderer">
            <svg viewBox="0 0 24 24" fill="currentColor" style="width:12px;height:12px;">
              <path d="M.968 9.027l7.717 4.428-.006 1.32-4.39-2.518-2.763 1.57 7.148 4.12.005 1.27-7.658-4.405c.02.516.488 2.106 1.383 3.337.91 1.247 1.946 1.776 1.946 1.776L11.428 24V11.849L.975 5.846zm22.064-3.8L15.22.723S13.982 0 12.008 0C9.952 0 8.76.746 8.76.746l-7.236 4.14 11.009 6.328V24l7.245-4.136s1.295-.715 2.279-2.414c.867-1.496.975-2.943.975-2.943z"/>
            </svg>
            Renderer
          </button>
          <button class="node-canvas-btn" id="node-delete" title="Delete Selected">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3 6 5 6 21 6"/>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
            </svg>
          </button>
          <button class="node-canvas-btn" id="node-fit" title="Fit View">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- ë…¸ë“œ Inspector íŒ¨ë„ - VizMaker Style -->
      <aside class="node-inspector" id="node-inspector">
        <!-- Preview ì˜ì—­ -->
        <div class="node-inspector-preview">
          <!-- Enlarge ë²„íŠ¼ -->
          <button class="node-enlarge-btn" id="node-enlarge-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;">
              <path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"/>
            </svg>
            Enlarge
          </button>
          <!-- íƒ­ -->
          <div class="node-inspector-tabs">
            <button class="node-inspector-tab active" data-tab="preview">Preview</button>
            <button class="node-inspector-tab" data-tab="compare">Compare</button>
            <button class="node-inspector-tab" data-tab="draw">Draw</button>
          </div>
          <!-- Preview íƒ­ ì»¨í…ì¸  -->
          <div class="node-preview-tab-content active" data-content="preview">
            <div class="node-inspector-preview-image" id="node-preview-image">
              <span class="node-inspector-preview-empty">No preview</span>
            </div>
          </div>
          <!-- Compare íƒ­ ì»¨í…ì¸  -->
          <div class="node-preview-tab-content" data-content="compare">
            <div class="node-inspector-preview-image node-compare-view" id="node-compare-view">
              <span class="node-inspector-preview-empty">No images to compare</span>
            </div>
          </div>
          <!-- Draw íƒ­ ì»¨í…ì¸  -->
          <div class="node-preview-tab-content" data-content="draw">
            <div class="node-inspector-preview-image node-draw-view" id="node-draw-view">
              <span class="node-inspector-preview-empty">Draw mode (coming soon)</span>
            </div>
          </div>
          <div class="node-inspector-preview-progress">
            <div class="node-inspector-preview-progress-bar" id="node-preview-progress"></div>
          </div>
        </div>

        <!-- ë…¸ë“œ ë¯¸ì„ íƒ ì‹œ -->
        <div class="node-inspector-empty" id="node-inspector-empty">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M18 3C19.6569 3 21 4.34315 21 6C21 7.65685 19.6569 9 18 9H15C13.6941 9 12.5831 8.16562 12.171 7.0009L11 7C9.9 7 9 7.9 9 9L9.0009 9.17102C10.1656 9.58312 11 10.6941 11 12C11 13.3059 10.1656 14.4169 9.0009 14.829L9 15C9 16.1 9.9 17 11 17L12.1707 17.0001C12.5825 15.8349 13.6937 15 15 15H18C19.6569 15 21 16.3431 21 18C21 19.6569 19.6569 21 18 21H15C13.6941 21 12.5831 20.1656 12.171 19.0009L11 19C8.79 19 7 17.21 7 15H5C3.34315 15 2 13.6569 2 12C2 10.3431 3.34315 9 5 9H7C7 6.79086 8.79086 5 11 5L12.1707 5.00009C12.5825 3.83485 13.6937 3 15 3H18Z"/>
          </svg>
          <div>Select a node to edit</div>
          <div style="font-size: 11px; margin-top: 8px;">Click on a node or add a new one</div>
        </div>

        <!-- Inspector ì»¨í…ì¸  (ìŠ¤í¬ë¡¤ ì˜ì—­) -->
        <div class="node-inspector-content" id="node-inspector-content">
          <!-- Source ë…¸ë“œ Inspector -->
          <div class="hidden" id="inspector-source">
            <!-- Camera ì•„ì½”ë””ì–¸ -->
            <div class="node-inspector-accordion open">
              <div class="node-inspector-accordion-header">
                <div class="node-inspector-accordion-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                    <circle cx="12" cy="13" r="4"/>
                  </svg>
                </div>
                <span class="node-inspector-accordion-title">Camera</span>
                <div class="node-inspector-accordion-toggle">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"/>
                  </svg>
                </div>
              </div>
              <div class="node-inspector-accordion-body">
                <div class="control-section">
                  <span class="section-label">View</span>
                  <div class="dropdown-selected" id="node-source-view">Current View</div>
                </div>
              </div>
            </div>

            <!-- Time & Lighting ì•„ì½”ë””ì–¸ -->
            <div class="node-inspector-accordion open">
              <div class="node-inspector-accordion-header">
                <div class="node-inspector-accordion-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="5"/>
                    <line x1="12" y1="1" x2="12" y2="3"/>
                    <line x1="12" y1="21" x2="12" y2="23"/>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                  </svg>
                </div>
                <span class="node-inspector-accordion-title">Time & Lighting</span>
                <div class="node-inspector-accordion-toggle">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"/>
                  </svg>
                </div>
              </div>
              <div class="node-inspector-accordion-body">
                <div class="control-section">
                  <span class="section-label">Time</span>
                  <div class="segmented">
                    <button class="seg-btn active" data-time="day">Day</button>
                    <button class="seg-btn" data-time="sunset">Sunset</button>
                    <button class="seg-btn" data-time="night">Night</button>
                  </div>
                </div>
                <div class="control-section">
                  <span class="section-label">Lights</span>
                  <div class="segmented">
                    <button class="seg-btn active" data-light="on">On</button>
                    <button class="seg-btn" data-light="off">Off</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Capture ë²„íŠ¼ -->
            <div style="padding: 16px;">
              <button class="btn btn-primary" id="node-source-capture" style="width: 100%;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;margin-right:6px;">
                  <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                  <circle cx="12" cy="13" r="4"/>
                </svg>
                Capture View
              </button>
            </div>
          </div>

          <!-- Renderer ë…¸ë“œ Inspector -->
          <div class="hidden" id="inspector-renderer">
            <!-- Render Settings ì•„ì½”ë””ì–¸ -->
            <div class="node-inspector-accordion open">
              <div class="node-inspector-accordion-header">
                <div class="node-inspector-accordion-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                  </svg>
                </div>
                <span class="node-inspector-accordion-title">Render Settings</span>
                <div class="node-inspector-accordion-toggle">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"/>
                  </svg>
                </div>
              </div>
              <div class="node-inspector-accordion-body">
                <div class="control-section">
                  <span class="section-label">Render Mode</span>
                  <div class="dropdown-selected" id="node-render-mode">Nanobanana Pro</div>
                </div>
                <div class="control-section">
                  <span class="section-label">Resolution</span>
                  <div class="segmented">
                    <button class="seg-btn" data-res="1024">1K</button>
                    <button class="seg-btn active" data-res="2048">2K</button>
                    <button class="seg-btn" data-res="4096">4K</button>
                  </div>
                </div>
                <div class="control-section">
                  <span class="section-label">Aspect Ratio</span>
                  <div class="segmented">
                    <button class="seg-btn active" data-aspect="original">Original</button>
                    <button class="seg-btn" data-aspect="16:9">16:9</button>
                    <button class="seg-btn" data-aspect="1:1">1:1</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Prompt Presets ì•„ì½”ë””ì–¸ -->
            <div class="node-inspector-accordion open">
              <div class="node-inspector-accordion-header">
                <div class="node-inspector-accordion-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="4" y1="21" x2="4" y2="14"/>
                    <line x1="4" y1="10" x2="4" y2="3"/>
                    <line x1="12" y1="21" x2="12" y2="12"/>
                    <line x1="12" y1="8" x2="12" y2="3"/>
                    <line x1="20" y1="21" x2="20" y2="16"/>
                    <line x1="20" y1="12" x2="20" y2="3"/>
                  </svg>
                </div>
                <span class="node-inspector-accordion-title">Prompt Presets</span>
                <div class="node-inspector-accordion-toggle">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"/>
                  </svg>
                </div>
              </div>
              <div class="node-inspector-accordion-body">
                <div class="prompt-presets-grid">
                  <button class="prompt-preset-btn" data-preset="realism">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                    </svg>
                    <span>Realism</span>
                  </button>
                  <button class="prompt-preset-btn" data-preset="closeup">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <circle cx="11" cy="11" r="8"/>
                      <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                      <line x1="11" y1="8" x2="11" y2="14"/>
                      <line x1="8" y1="11" x2="14" y2="11"/>
                    </svg>
                    <span>Closeup</span>
                  </button>
                  <button class="prompt-preset-btn" data-preset="day-night">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    </svg>
                    <span>Dayâ†’Night</span>
                  </button>
                  <button class="prompt-preset-btn" data-preset="night-day">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <circle cx="12" cy="12" r="5"/>
                      <line x1="12" y1="1" x2="12" y2="3"/>
                      <line x1="12" y1="21" x2="12" y2="23"/>
                    </svg>
                    <span>Nightâ†’Day</span>
                  </button>
                  <button class="prompt-preset-btn" data-preset="brighter">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <circle cx="12" cy="12" r="5"/>
                      <line x1="12" y1="1" x2="12" y2="3"/>
                      <line x1="21" y1="12" x2="23" y2="12"/>
                    </svg>
                    <span>Brighter</span>
                  </button>
                  <button class="prompt-preset-btn" data-preset="volumetric">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"/>
                    </svg>
                    <span>Volumetric</span>
                  </button>
                  <button class="prompt-preset-btn" data-preset="fog">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <line x1="3" y1="8" x2="21" y2="8"/>
                      <line x1="3" y1="12" x2="21" y2="12"/>
                      <line x1="3" y1="16" x2="21" y2="16"/>
                    </svg>
                    <span>Fog</span>
                  </button>
                  <button class="prompt-preset-btn" data-preset="people">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                      <circle cx="9" cy="7" r="4"/>
                    </svg>
                    <span>People</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- Custom Prompt ì•„ì½”ë””ì–¸ -->
            <div class="node-inspector-accordion">
              <div class="node-inspector-accordion-header">
                <div class="node-inspector-accordion-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="17" y1="10" x2="3" y2="10"/>
                    <line x1="21" y1="6" x2="3" y2="6"/>
                    <line x1="21" y1="14" x2="3" y2="14"/>
                    <line x1="17" y1="18" x2="3" y2="18"/>
                  </svg>
                </div>
                <span class="node-inspector-accordion-title">Custom Prompt</span>
                <div class="node-inspector-accordion-toggle">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"/>
                  </svg>
                </div>
              </div>
              <div class="node-inspector-accordion-body">
                <textarea class="prompt-input" id="node-custom-prompt" placeholder="Enter custom prompt..." style="width:100%;min-height:80px;background:#0d1117;border:1px solid #30363d;border-radius:6px;padding:10px;color:#e6edf3;font-size:11px;resize:vertical;"></textarea>
              </div>
            </div>
          </div>
        </div>
      </aside>
    </div><!-- .node-canvas-wrapper -->

    <!-- í•˜ë‹¨ í”„ë¡¬í”„íŠ¸ ë°” -->
    <div class="node-bottom-bar">
      <div class="node-bottom-prompt-area">
        <div class="node-prompt-row">
          <textarea class="node-prompt-input" id="node-prompt-input" rows="2" placeholder="Select a Renderer node to enter prompt..."></textarea>
          <button class="node-prompt-auto-btn" id="node-prompt-auto-btn" title="Auto Generate">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;">
              <path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/>
            </svg>
            Auto
          </button>
        </div>
        <div class="node-prompt-row node-prompt-negative-row">
          <textarea class="node-prompt-input node-prompt-negative" id="node-prompt-negative-input" rows="1" placeholder="Negative prompt (optional)"></textarea>
        </div>
      </div>
      <button class="node-make-btn" id="node-make-btn">
        <svg viewBox="0 0 24 24" fill="currentColor" style="width:16px;height:16px;">
          <path d="M13 10V3L4 14h7v7l9-11h-7z"/>
        </svg>
        Make
      </button>
    </div>
  </div>

  <script src="scripts/core.js"></script>
  <script src="scripts/render-mode.js"></script>
  <script src="scripts/mix-mode.js"></script>
  <script src="scripts/node-editor.js"></script>
</body>
</html>
