(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=e(o);fetch(o.href,a)}})();function H1(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ng={exports:{}},La={};var Rv;function Gw(){if(Rv)return La;Rv=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,o,a){var c=null;if(a!==void 0&&(c=""+a),o.key!==void 0&&(c=""+o.key),"key"in o){a={};for(var h in o)h!=="key"&&(a[h]=o[h])}else a=o;return o=a.ref,{$$typeof:s,type:i,key:c,ref:o!==void 0?o:null,props:a}}return La.Fragment=t,La.jsx=e,La.jsxs=e,La}var zv;function $w(){return zv||(zv=1,ng.exports=Gw()),ng.exports}var _=$w(),ig={exports:{}},Ct={};var Lv;function qw(){if(Lv)return Ct;Lv=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),v=Symbol.iterator;function x(k){return k===null||typeof k!="object"?null:(k=v&&k[v]||k["@@iterator"],typeof k=="function"?k:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,T={};function E(k,P,et){this.props=k,this.context=P,this.refs=T,this.updater=et||b}E.prototype.isReactComponent={},E.prototype.setState=function(k,P){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,P,"setState")},E.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function M(){}M.prototype=E.prototype;function C(k,P,et){this.props=k,this.context=P,this.refs=T,this.updater=et||b}var D=C.prototype=new M;D.constructor=C,w(D,E.prototype),D.isPureReactComponent=!0;var j=Array.isArray;function R(){}var z={H:null,A:null,T:null,S:null},U=Object.prototype.hasOwnProperty;function G(k,P,et){var nt=et.ref;return{$$typeof:s,type:k,key:P,ref:nt!==void 0?nt:null,props:et}}function ut(k,P){return G(k.type,P,k.props)}function W(k){return typeof k=="object"&&k!==null&&k.$$typeof===s}function Z(k){var P={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(et){return P[et]})}var rt=/\/+/g;function N(k,P){return typeof k=="object"&&k!==null&&k.key!=null?Z(""+k.key):P.toString(36)}function I(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(R,R):(k.status="pending",k.then(function(P){k.status==="pending"&&(k.status="fulfilled",k.value=P)},function(P){k.status==="pending"&&(k.status="rejected",k.reason=P)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function A(k,P,et,nt,ht){var dt=typeof k;(dt==="undefined"||dt==="boolean")&&(k=null);var ft=!1;if(k===null)ft=!0;else switch(dt){case"bigint":case"string":case"number":ft=!0;break;case"object":switch(k.$$typeof){case s:case t:ft=!0;break;case p:return ft=k._init,A(ft(k._payload),P,et,nt,ht)}}if(ft)return ht=ht(k),ft=nt===""?"."+N(k,0):nt,j(ht)?(et="",ft!=null&&(et=ft.replace(rt,"$&/")+"/"),A(ht,P,et,"",function(gt){return gt})):ht!=null&&(W(ht)&&(ht=ut(ht,et+(ht.key==null||k&&k.key===ht.key?"":(""+ht.key).replace(rt,"$&/")+"/")+ft)),P.push(ht)),1;ft=0;var X=nt===""?".":nt+":";if(j(k))for(var ot=0;ot<k.length;ot++)nt=k[ot],dt=X+N(nt,ot),ft+=A(nt,P,et,dt,ht);else if(ot=x(k),typeof ot=="function")for(k=ot.call(k),ot=0;!(nt=k.next()).done;)nt=nt.value,dt=X+N(nt,ot++),ft+=A(nt,P,et,dt,ht);else if(dt==="object"){if(typeof k.then=="function")return A(I(k),P,et,nt,ht);throw P=String(k),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return ft}function L(k,P,et){if(k==null)return k;var nt=[],ht=0;return A(k,nt,"","",function(dt){return P.call(et,dt,ht++)}),nt}function H(k){if(k._status===-1){var P=k._result;P=P(),P.then(function(et){(k._status===0||k._status===-1)&&(k._status=1,k._result=et)},function(et){(k._status===0||k._status===-1)&&(k._status=2,k._result=et)}),k._status===-1&&(k._status=0,k._result=P)}if(k._status===1)return k._result.default;throw k._result}var q=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},st={map:L,forEach:function(k,P,et){L(k,function(){P.apply(this,arguments)},et)},count:function(k){var P=0;return L(k,function(){P++}),P},toArray:function(k){return L(k,function(P){return P})||[]},only:function(k){if(!W(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return Ct.Activity=y,Ct.Children=st,Ct.Component=E,Ct.Fragment=e,Ct.Profiler=o,Ct.PureComponent=C,Ct.StrictMode=i,Ct.Suspense=f,Ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=z,Ct.__COMPILER_RUNTIME={__proto__:null,c:function(k){return z.H.useMemoCache(k)}},Ct.cache=function(k){return function(){return k.apply(null,arguments)}},Ct.cacheSignal=function(){return null},Ct.cloneElement=function(k,P,et){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var nt=w({},k.props),ht=k.key;if(P!=null)for(dt in P.key!==void 0&&(ht=""+P.key),P)!U.call(P,dt)||dt==="key"||dt==="__self"||dt==="__source"||dt==="ref"&&P.ref===void 0||(nt[dt]=P[dt]);var dt=arguments.length-2;if(dt===1)nt.children=et;else if(1<dt){for(var ft=Array(dt),X=0;X<dt;X++)ft[X]=arguments[X+2];nt.children=ft}return G(k.type,ht,nt)},Ct.createContext=function(k){return k={$$typeof:c,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:a,_context:k},k},Ct.createElement=function(k,P,et){var nt,ht={},dt=null;if(P!=null)for(nt in P.key!==void 0&&(dt=""+P.key),P)U.call(P,nt)&&nt!=="key"&&nt!=="__self"&&nt!=="__source"&&(ht[nt]=P[nt]);var ft=arguments.length-2;if(ft===1)ht.children=et;else if(1<ft){for(var X=Array(ft),ot=0;ot<ft;ot++)X[ot]=arguments[ot+2];ht.children=X}if(k&&k.defaultProps)for(nt in ft=k.defaultProps,ft)ht[nt]===void 0&&(ht[nt]=ft[nt]);return G(k,dt,ht)},Ct.createRef=function(){return{current:null}},Ct.forwardRef=function(k){return{$$typeof:h,render:k}},Ct.isValidElement=W,Ct.lazy=function(k){return{$$typeof:p,_payload:{_status:-1,_result:k},_init:H}},Ct.memo=function(k,P){return{$$typeof:d,type:k,compare:P===void 0?null:P}},Ct.startTransition=function(k){var P=z.T,et={};z.T=et;try{var nt=k(),ht=z.S;ht!==null&&ht(et,nt),typeof nt=="object"&&nt!==null&&typeof nt.then=="function"&&nt.then(R,q)}catch(dt){q(dt)}finally{P!==null&&et.types!==null&&(P.types=et.types),z.T=P}},Ct.unstable_useCacheRefresh=function(){return z.H.useCacheRefresh()},Ct.use=function(k){return z.H.use(k)},Ct.useActionState=function(k,P,et){return z.H.useActionState(k,P,et)},Ct.useCallback=function(k,P){return z.H.useCallback(k,P)},Ct.useContext=function(k){return z.H.useContext(k)},Ct.useDebugValue=function(){},Ct.useDeferredValue=function(k,P){return z.H.useDeferredValue(k,P)},Ct.useEffect=function(k,P){return z.H.useEffect(k,P)},Ct.useEffectEvent=function(k){return z.H.useEffectEvent(k)},Ct.useId=function(){return z.H.useId()},Ct.useImperativeHandle=function(k,P,et){return z.H.useImperativeHandle(k,P,et)},Ct.useInsertionEffect=function(k,P){return z.H.useInsertionEffect(k,P)},Ct.useLayoutEffect=function(k,P){return z.H.useLayoutEffect(k,P)},Ct.useMemo=function(k,P){return z.H.useMemo(k,P)},Ct.useOptimistic=function(k,P){return z.H.useOptimistic(k,P)},Ct.useReducer=function(k,P,et){return z.H.useReducer(k,P,et)},Ct.useRef=function(k){return z.H.useRef(k)},Ct.useState=function(k){return z.H.useState(k)},Ct.useSyncExternalStore=function(k,P,et){return z.H.useSyncExternalStore(k,P,et)},Ct.useTransition=function(){return z.H.useTransition()},Ct.version="19.2.4",Ct}var Bv;function pl(){return Bv||(Bv=1,ig.exports=qw()),ig.exports}var Y=pl();const Xa=H1(Y);var sg={exports:{}},Ba={},rg={exports:{}},og={};var Hv;function Ww(){return Hv||(Hv=1,(function(s){function t(A,L){var H=A.length;A.push(L);t:for(;0<H;){var q=H-1>>>1,st=A[q];if(0<o(st,L))A[q]=L,A[H]=st,H=q;else break t}}function e(A){return A.length===0?null:A[0]}function i(A){if(A.length===0)return null;var L=A[0],H=A.pop();if(H!==L){A[0]=H;t:for(var q=0,st=A.length,k=st>>>1;q<k;){var P=2*(q+1)-1,et=A[P],nt=P+1,ht=A[nt];if(0>o(et,H))nt<st&&0>o(ht,et)?(A[q]=ht,A[nt]=H,q=nt):(A[q]=et,A[P]=H,q=P);else if(nt<st&&0>o(ht,H))A[q]=ht,A[nt]=H,q=nt;else break t}}return L}function o(A,L){var H=A.sortIndex-L.sortIndex;return H!==0?H:A.id-L.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var c=Date,h=c.now();s.unstable_now=function(){return c.now()-h}}var f=[],d=[],p=1,y=null,v=3,x=!1,b=!1,w=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function D(A){for(var L=e(d);L!==null;){if(L.callback===null)i(d);else if(L.startTime<=A)i(d),L.sortIndex=L.expirationTime,t(f,L);else break;L=e(d)}}function j(A){if(w=!1,D(A),!b)if(e(f)!==null)b=!0,R||(R=!0,Z());else{var L=e(d);L!==null&&I(j,L.startTime-A)}}var R=!1,z=-1,U=5,G=-1;function ut(){return T?!0:!(s.unstable_now()-G<U)}function W(){if(T=!1,R){var A=s.unstable_now();G=A;var L=!0;try{t:{b=!1,w&&(w=!1,M(z),z=-1),x=!0;var H=v;try{e:{for(D(A),y=e(f);y!==null&&!(y.expirationTime>A&&ut());){var q=y.callback;if(typeof q=="function"){y.callback=null,v=y.priorityLevel;var st=q(y.expirationTime<=A);if(A=s.unstable_now(),typeof st=="function"){y.callback=st,D(A),L=!0;break e}y===e(f)&&i(f),D(A)}else i(f);y=e(f)}if(y!==null)L=!0;else{var k=e(d);k!==null&&I(j,k.startTime-A),L=!1}}break t}finally{y=null,v=H,x=!1}L=void 0}}finally{L?Z():R=!1}}}var Z;if(typeof C=="function")Z=function(){C(W)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,N=rt.port2;rt.port1.onmessage=W,Z=function(){N.postMessage(null)}}else Z=function(){E(W,0)};function I(A,L){z=E(function(){A(s.unstable_now())},L)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(A){A.callback=null},s.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<A?Math.floor(1e3/A):5},s.unstable_getCurrentPriorityLevel=function(){return v},s.unstable_next=function(A){switch(v){case 1:case 2:case 3:var L=3;break;default:L=v}var H=v;v=L;try{return A()}finally{v=H}},s.unstable_requestPaint=function(){T=!0},s.unstable_runWithPriority=function(A,L){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var H=v;v=A;try{return L()}finally{v=H}},s.unstable_scheduleCallback=function(A,L,H){var q=s.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?q+H:q):H=q,A){case 1:var st=-1;break;case 2:st=250;break;case 5:st=1073741823;break;case 4:st=1e4;break;default:st=5e3}return st=H+st,A={id:p++,callback:L,priorityLevel:A,startTime:H,expirationTime:st,sortIndex:-1},H>q?(A.sortIndex=H,t(d,A),e(f)===null&&A===e(d)&&(w?(M(z),z=-1):w=!0,I(j,H-q))):(A.sortIndex=st,t(f,A),b||x||(b=!0,R||(R=!0,Z()))),A},s.unstable_shouldYield=ut,s.unstable_wrapCallback=function(A){var L=v;return function(){var H=v;v=L;try{return A.apply(this,arguments)}finally{v=H}}}})(og)),og}var Uv;function Zw(){return Uv||(Uv=1,rg.exports=Ww()),rg.exports}var ag={exports:{}},Ae={};var Pv;function Kw(){if(Pv)return Ae;Pv=1;var s=pl();function t(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},o=Symbol.for("react.portal");function a(f,d,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:y==null?null:""+y,children:f,containerInfo:d,implementation:p}}var c=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ae.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ae.createPortal=function(f,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return a(f,d,null,p)},Ae.flushSync=function(f){var d=c.T,p=i.p;try{if(c.T=null,i.p=2,f)return f()}finally{c.T=d,i.p=p,i.d.f()}},Ae.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(f,d))},Ae.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},Ae.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var p=d.as,y=h(p,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,x=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?i.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:y,integrity:v,fetchPriority:x}):p==="script"&&i.d.X(f,{crossOrigin:y,integrity:v,fetchPriority:x,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ae.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=h(d.as,d.crossOrigin);i.d.M(f,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(f)},Ae.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,y=h(p,d.crossOrigin);i.d.L(f,p,{crossOrigin:y,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ae.preloadModule=function(f,d){if(typeof f=="string")if(d){var p=h(d.as,d.crossOrigin);i.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(f)},Ae.requestFormReset=function(f){i.d.r(f)},Ae.unstable_batchedUpdates=function(f,d){return f(d)},Ae.useFormState=function(f,d,p){return c.H.useFormState(f,d,p)},Ae.useFormStatus=function(){return c.H.useHostTransitionStatus()},Ae.version="19.2.4",Ae}var Yv;function U1(){if(Yv)return ag.exports;Yv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),ag.exports=Kw(),ag.exports}var Vv;function Qw(){if(Vv)return Ba;Vv=1;var s=Zw(),t=pl(),e=U1();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function a(n){var r=n,l=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(l=r.return),n=r.return;while(n)}return r.tag===3?l:null}function c(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function h(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function f(n){if(a(n)!==n)throw Error(i(188))}function d(n){var r=n.alternate;if(!r){if(r=a(n),r===null)throw Error(i(188));return r!==n?null:n}for(var l=n,u=r;;){var g=l.return;if(g===null)break;var m=g.alternate;if(m===null){if(u=g.return,u!==null){l=u;continue}break}if(g.child===m.child){for(m=g.child;m;){if(m===l)return f(g),n;if(m===u)return f(g),r;m=m.sibling}throw Error(i(188))}if(l.return!==u.return)l=g,u=m;else{for(var S=!1,O=g.child;O;){if(O===l){S=!0,l=g,u=m;break}if(O===u){S=!0,u=g,l=m;break}O=O.sibling}if(!S){for(O=m.child;O;){if(O===l){S=!0,l=m,u=g;break}if(O===u){S=!0,u=m,l=g;break}O=O.sibling}if(!S)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?n:r}function p(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=p(n),r!==null)return r;n=n.sibling}return null}var y=Object.assign,v=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),C=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),ut=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function Z(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var rt=Symbol.for("react.client.reference");function N(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===rt?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case w:return"Fragment";case E:return"Profiler";case T:return"StrictMode";case j:return"Suspense";case R:return"SuspenseList";case G:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case b:return"Portal";case C:return n.displayName||"Context";case M:return(n._context.displayName||"Context")+".Consumer";case D:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case z:return r=n.displayName||null,r!==null?r:N(n.type)||"Memo";case U:r=n._payload,n=n._init;try{return N(n(r))}catch{}}return null}var I=Array.isArray,A=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H={pending:!1,data:null,method:null,action:null},q=[],st=-1;function k(n){return{current:n}}function P(n){0>st||(n.current=q[st],q[st]=null,st--)}function et(n,r){st++,q[st]=n.current,n.current=r}var nt=k(null),ht=k(null),dt=k(null),ft=k(null);function X(n,r){switch(et(dt,r),et(ht,n),et(nt,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?iv(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=iv(r),n=sv(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}P(nt),et(nt,n)}function ot(){P(nt),P(ht),P(dt)}function gt(n){n.memoizedState!==null&&et(ft,n);var r=nt.current,l=sv(r,n.type);r!==l&&(et(ht,n),et(nt,l))}function xt(n){ht.current===n&&(P(nt),P(ht)),ft.current===n&&(P(ft),ja._currentValue=H)}var pt,_t;function Ot(n){if(pt===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);pt=r&&r[1]||"",_t=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+pt+n+_t}var It=!1;function Vt(n,r){if(!n||It)return"";It=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var ct=function(){throw Error()};if(Object.defineProperty(ct.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ct,[])}catch(it){var J=it}Reflect.construct(n,[],ct)}else{try{ct.call()}catch(it){J=it}n.call(ct.prototype)}}else{try{throw Error()}catch(it){J=it}(ct=n())&&typeof ct.catch=="function"&&ct.catch(function(){})}}catch(it){if(it&&J&&typeof it.stack=="string")return[it.stack,J.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=u.DetermineComponentFrameRoot(),S=m[0],O=m[1];if(S&&O){var B=S.split(`
`),Q=O.split(`
`);for(g=u=0;u<B.length&&!B[u].includes("DetermineComponentFrameRoot");)u++;for(;g<Q.length&&!Q[g].includes("DetermineComponentFrameRoot");)g++;if(u===B.length||g===Q.length)for(u=B.length-1,g=Q.length-1;1<=u&&0<=g&&B[u]!==Q[g];)g--;for(;1<=u&&0<=g;u--,g--)if(B[u]!==Q[g]){if(u!==1||g!==1)do if(u--,g--,0>g||B[u]!==Q[g]){var at=`
`+B[u].replace(" at new "," at ");return n.displayName&&at.includes("<anonymous>")&&(at=at.replace("<anonymous>",n.displayName)),at}while(1<=u&&0<=g);break}}}finally{It=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?Ot(l):""}function xe(n,r){switch(n.tag){case 26:case 27:case 5:return Ot(n.type);case 16:return Ot("Lazy");case 13:return n.child!==r&&r!==null?Ot("Suspense Fallback"):Ot("Suspense");case 19:return Ot("SuspenseList");case 0:case 15:return Vt(n.type,!1);case 11:return Vt(n.type.render,!1);case 1:return Vt(n.type,!0);case 31:return Ot("Activity");default:return""}}function Tn(n){try{var r="",l=null;do r+=xe(n,l),l=n,n=n.return;while(n);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Je=Object.prototype.hasOwnProperty,En=s.unstable_scheduleCallback,si=s.unstable_cancelCallback,Os=s.unstable_shouldYield,As=s.unstable_requestPaint,_e=s.unstable_now,Sr=s.unstable_getCurrentPriorityLevel,ri=s.unstable_ImmediatePriority,Fi=s.unstable_UserBlockingPriority,ks=s.unstable_NormalPriority,Hh=s.unstable_LowPriority,_r=s.unstable_IdlePriority,Uh=s.log,Ph=s.unstable_setDisableYieldValue,js=null,Ne=null;function Vn(n){if(typeof Uh=="function"&&Ph(n),Ne&&typeof Ne.setStrictMode=="function")try{Ne.setStrictMode(js,n)}catch{}}var Re=Math.clz32?Math.clz32:Xh,Yh=Math.log,Vh=Math.LN2;function Xh(n){return n>>>=0,n===0?32:31-(Yh(n)/Vh|0)|0}var wr=256,Cr=262144,Tr=4194304;function oi(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Er(n,r,l){var u=n.pendingLanes;if(u===0)return 0;var g=0,m=n.suspendedLanes,S=n.pingedLanes;n=n.warmLanes;var O=u&134217727;return O!==0?(u=O&~m,u!==0?g=oi(u):(S&=O,S!==0?g=oi(S):l||(l=O&~n,l!==0&&(g=oi(l))))):(O=u&~m,O!==0?g=oi(O):S!==0?g=oi(S):l||(l=u&~n,l!==0&&(g=oi(l)))),g===0?0:r!==0&&r!==g&&(r&m)===0&&(m=g&-g,l=r&-r,m>=l||m===32&&(l&4194048)!==0)?r:g}function Ns(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function Fh(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tl(){var n=Tr;return Tr<<=1,(Tr&62914560)===0&&(Tr=4194304),n}function Xo(n){for(var r=[],l=0;31>l;l++)r.push(n);return r}function Rs(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Ih(n,r,l,u,g,m){var S=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var O=n.entanglements,B=n.expirationTimes,Q=n.hiddenUpdates;for(l=S&~l;0<l;){var at=31-Re(l),ct=1<<at;O[at]=0,B[at]=-1;var J=Q[at];if(J!==null)for(Q[at]=null,at=0;at<J.length;at++){var it=J[at];it!==null&&(it.lane&=-536870913)}l&=~ct}u!==0&&El(n,u,0),m!==0&&g===0&&n.tag!==0&&(n.suspendedLanes|=m&~(S&~r))}function El(n,r,l){n.pendingLanes|=r,n.suspendedLanes&=~r;var u=31-Re(r);n.entangledLanes|=r,n.entanglements[u]=n.entanglements[u]|1073741824|l&261930}function Ml(n,r){var l=n.entangledLanes|=r;for(n=n.entanglements;l;){var u=31-Re(l),g=1<<u;g&r|n[u]&r&&(n[u]|=r),l&=~g}}function Dl(n,r){var l=r&-r;return l=(l&42)!==0?1:Fo(l),(l&(n.suspendedLanes|r))!==0?0:l}function Fo(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Io(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ol(){var n=L.p;return n!==0?n:(n=window.event,n===void 0?32:Mv(n.type))}function Al(n,r){var l=L.p;try{return L.p=n,r()}finally{L.p=l}}var Xn=Math.random().toString(36).slice(2),me="__reactFiber$"+Xn,Oe="__reactProps$"+Xn,ai="__reactContainer$"+Xn,Mr="__reactEvents$"+Xn,kl="__reactListeners$"+Xn,Gh="__reactHandles$"+Xn,jl="__reactResources$"+Xn,zs="__reactMarker$"+Xn;function Go(n){delete n[me],delete n[Oe],delete n[Mr],delete n[kl],delete n[Gh]}function Ii(n){var r=n[me];if(r)return r;for(var l=n.parentNode;l;){if(r=l[ai]||l[me]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(n=hv(n);n!==null;){if(l=n[me])return l;n=hv(n)}return r}n=l,l=n.parentNode}return null}function Gi(n){if(n=n[me]||n[ai]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function $i(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function qi(n){var r=n[jl];return r||(r=n[jl]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function ue(n){n[zs]=!0}var Nl=new Set,Rl={};function li(n,r){Wi(n,r),Wi(n+"Capture",r)}function Wi(n,r){for(Rl[n]=r,n=0;n<r.length;n++)Nl.add(r[n])}var $h=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$o={},zl={};function qh(n){return Je.call(zl,n)?!0:Je.call($o,n)?!1:$h.test(n)?zl[n]=!0:($o[n]=!0,!1)}function Dr(n,r,l){if(qh(r))if(l===null)n.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+l)}}function Or(n,r,l){if(l===null)n.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+l)}}function Mn(n,r,l,u){if(u===null)n.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(r,l,""+u)}}function Pe(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ll(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Wh(n,r,l){var u=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,m=u.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return g.call(this)},set:function(S){l=""+S,m.call(this,S)}}),Object.defineProperty(n,r,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(S){l=""+S},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Ar(n){if(!n._valueTracker){var r=Ll(n)?"checked":"value";n._valueTracker=Wh(n,r,""+n[r])}}function Bl(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return n&&(u=Ll(n)?n.checked?"true":"false":n.value),n=u,n!==l?(r.setValue(n),!0):!1}function Ls(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Zh=/[\n"\\]/g;function Ye(n){return n.replace(Zh,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Bs(n,r,l,u,g,m,S,O){n.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?n.type=S:n.removeAttribute("type"),r!=null?S==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Pe(r)):n.value!==""+Pe(r)&&(n.value=""+Pe(r)):S!=="submit"&&S!=="reset"||n.removeAttribute("value"),r!=null?qo(n,S,Pe(r)):l!=null?qo(n,S,Pe(l)):u!=null&&n.removeAttribute("value"),g==null&&m!=null&&(n.defaultChecked=!!m),g!=null&&(n.checked=g&&typeof g!="function"&&typeof g!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?n.name=""+Pe(O):n.removeAttribute("name")}function Hl(n,r,l,u,g,m,S,O){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||l!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Ar(n);return}l=l!=null?""+Pe(l):"",r=r!=null?""+Pe(r):l,O||r===n.value||(n.value=r),n.defaultValue=r}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=O?n.checked:!!u,n.defaultChecked=!!u,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(n.name=S),Ar(n)}function qo(n,r,l){r==="number"&&Ls(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function ci(n,r,l,u){if(n=n.options,r){r={};for(var g=0;g<l.length;g++)r["$"+l[g]]=!0;for(l=0;l<n.length;l++)g=r.hasOwnProperty("$"+n[l].value),n[l].selected!==g&&(n[l].selected=g),g&&u&&(n[l].defaultSelected=!0)}else{for(l=""+Pe(l),r=null,g=0;g<n.length;g++){if(n[g].value===l){n[g].selected=!0,u&&(n[g].defaultSelected=!0);return}r!==null||n[g].disabled||(r=n[g])}r!==null&&(r.selected=!0)}}function Qp(n,r,l){if(r!=null&&(r=""+Pe(r),r!==n.value&&(n.value=r),l==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=l!=null?""+Pe(l):""}function Jp(n,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(i(92));if(I(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=Pe(r),n.defaultValue=l,u=n.textContent,u===l&&u!==""&&u!==null&&(n.value=u),Ar(n)}function kr(n,r){if(r){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=r;return}}n.textContent=r}var Y_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tm(n,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":u?n.setProperty(r,l):typeof l!="number"||l===0||Y_.has(r)?r==="float"?n.cssFloat=l:n[r]=(""+l).trim():n[r]=l+"px"}function em(n,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var g in r)u=r[g],r.hasOwnProperty(g)&&l[g]!==u&&tm(n,g,u)}else for(var m in r)r.hasOwnProperty(m)&&tm(n,m,r[m])}function Kh(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var V_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),X_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ul(n){return X_.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function ui(){}var Qh=null;function Jh(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var jr=null,Nr=null;function nm(n){var r=Gi(n);if(r&&(n=r.stateNode)){var l=n[Oe]||null;t:switch(n=r.stateNode,r.type){case"input":if(Bs(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ye(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==n&&u.form===n.form){var g=u[Oe]||null;if(!g)throw Error(i(90));Bs(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===n.form&&Bl(u)}break t;case"textarea":Qp(n,l.value,l.defaultValue);break t;case"select":r=l.value,r!=null&&ci(n,!!l.multiple,r,!1)}}}var tf=!1;function im(n,r,l){if(tf)return n(r,l);tf=!0;try{var u=n(r);return u}finally{if(tf=!1,(jr!==null||Nr!==null)&&(Ec(),jr&&(r=jr,n=Nr,Nr=jr=null,nm(r),n)))for(r=0;r<n.length;r++)nm(n[r])}}function Wo(n,r){var l=n.stateNode;if(l===null)return null;var u=l[Oe]||null;if(u===null)return null;l=u[r];t:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break t;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ef=!1;if(hi)try{var Zo={};Object.defineProperty(Zo,"passive",{get:function(){ef=!0}}),window.addEventListener("test",Zo,Zo),window.removeEventListener("test",Zo,Zo)}catch{ef=!1}var Zi=null,nf=null,Pl=null;function sm(){if(Pl)return Pl;var n,r=nf,l=r.length,u,g="value"in Zi?Zi.value:Zi.textContent,m=g.length;for(n=0;n<l&&r[n]===g[n];n++);var S=l-n;for(u=1;u<=S&&r[l-u]===g[m-u];u++);return Pl=g.slice(n,1<u?1-u:void 0)}function Yl(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Vl(){return!0}function rm(){return!1}function Ve(n){function r(l,u,g,m,S){this._reactName=l,this._targetInst=g,this.type=u,this.nativeEvent=m,this.target=S,this.currentTarget=null;for(var O in n)n.hasOwnProperty(O)&&(l=n[O],this[O]=l?l(m):m[O]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Vl:rm,this.isPropagationStopped=rm,this}return y(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Vl)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Vl)},persist:function(){},isPersistent:Vl}),r}var Hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xl=Ve(Hs),Ko=y({},Hs,{view:0,detail:0}),F_=Ve(Ko),sf,rf,Qo,Fl=y({},Ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:af,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Qo&&(Qo&&n.type==="mousemove"?(sf=n.screenX-Qo.screenX,rf=n.screenY-Qo.screenY):rf=sf=0,Qo=n),sf)},movementY:function(n){return"movementY"in n?n.movementY:rf}}),om=Ve(Fl),I_=y({},Fl,{dataTransfer:0}),G_=Ve(I_),$_=y({},Ko,{relatedTarget:0}),of=Ve($_),q_=y({},Hs,{animationName:0,elapsedTime:0,pseudoElement:0}),W_=Ve(q_),Z_=y({},Hs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),K_=Ve(Z_),Q_=y({},Hs,{data:0}),am=Ve(Q_),J_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},t2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},e2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function n2(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=e2[n])?!!r[n]:!1}function af(){return n2}var i2=y({},Ko,{key:function(n){if(n.key){var r=J_[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Yl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?t2[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:af,charCode:function(n){return n.type==="keypress"?Yl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Yl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),s2=Ve(i2),r2=y({},Fl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lm=Ve(r2),o2=y({},Ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:af}),a2=Ve(o2),l2=y({},Hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),c2=Ve(l2),u2=y({},Fl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),h2=Ve(u2),f2=y({},Hs,{newState:0,oldState:0}),d2=Ve(f2),g2=[9,13,27,32],lf=hi&&"CompositionEvent"in window,Jo=null;hi&&"documentMode"in document&&(Jo=document.documentMode);var p2=hi&&"TextEvent"in window&&!Jo,cm=hi&&(!lf||Jo&&8<Jo&&11>=Jo),um=" ",hm=!1;function fm(n,r){switch(n){case"keyup":return g2.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dm(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Rr=!1;function m2(n,r){switch(n){case"compositionend":return dm(r);case"keypress":return r.which!==32?null:(hm=!0,um);case"textInput":return n=r.data,n===um&&hm?null:n;default:return null}}function y2(n,r){if(Rr)return n==="compositionend"||!lf&&fm(n,r)?(n=sm(),Pl=nf=Zi=null,Rr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return cm&&r.locale!=="ko"?null:r.data;default:return null}}var v2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gm(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!v2[n.type]:r==="textarea"}function pm(n,r,l,u){jr?Nr?Nr.push(u):Nr=[u]:jr=u,r=Nc(r,"onChange"),0<r.length&&(l=new Xl("onChange","change",null,l,u),n.push({event:l,listeners:r}))}var ta=null,ea=null;function x2(n){Ky(n,0)}function Il(n){var r=$i(n);if(Bl(r))return n}function mm(n,r){if(n==="change")return r}var ym=!1;if(hi){var cf;if(hi){var uf="oninput"in document;if(!uf){var vm=document.createElement("div");vm.setAttribute("oninput","return;"),uf=typeof vm.oninput=="function"}cf=uf}else cf=!1;ym=cf&&(!document.documentMode||9<document.documentMode)}function xm(){ta&&(ta.detachEvent("onpropertychange",bm),ea=ta=null)}function bm(n){if(n.propertyName==="value"&&Il(ea)){var r=[];pm(r,ea,n,Jh(n)),im(x2,r)}}function b2(n,r,l){n==="focusin"?(xm(),ta=r,ea=l,ta.attachEvent("onpropertychange",bm)):n==="focusout"&&xm()}function S2(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Il(ea)}function _2(n,r){if(n==="click")return Il(r)}function w2(n,r){if(n==="input"||n==="change")return Il(r)}function C2(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var tn=typeof Object.is=="function"?Object.is:C2;function na(n,r){if(tn(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var l=Object.keys(n),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var g=l[u];if(!Je.call(r,g)||!tn(n[g],r[g]))return!1}return!0}function Sm(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function _m(n,r){var l=Sm(n);n=0;for(var u;l;){if(l.nodeType===3){if(u=n+l.textContent.length,n<=r&&u>=r)return{node:l,offset:r-n};n=u}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=Sm(l)}}function wm(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?wm(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function Cm(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=Ls(n.document);r instanceof n.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)n=r.contentWindow;else break;r=Ls(n.document)}return r}function hf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var T2=hi&&"documentMode"in document&&11>=document.documentMode,zr=null,ff=null,ia=null,df=!1;function Tm(n,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;df||zr==null||zr!==Ls(u)||(u=zr,"selectionStart"in u&&hf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),ia&&na(ia,u)||(ia=u,u=Nc(ff,"onSelect"),0<u.length&&(r=new Xl("onSelect","select",null,r,l),n.push({event:r,listeners:u}),r.target=zr)))}function Us(n,r){var l={};return l[n.toLowerCase()]=r.toLowerCase(),l["Webkit"+n]="webkit"+r,l["Moz"+n]="moz"+r,l}var Lr={animationend:Us("Animation","AnimationEnd"),animationiteration:Us("Animation","AnimationIteration"),animationstart:Us("Animation","AnimationStart"),transitionrun:Us("Transition","TransitionRun"),transitionstart:Us("Transition","TransitionStart"),transitioncancel:Us("Transition","TransitionCancel"),transitionend:Us("Transition","TransitionEnd")},gf={},Em={};hi&&(Em=document.createElement("div").style,"AnimationEvent"in window||(delete Lr.animationend.animation,delete Lr.animationiteration.animation,delete Lr.animationstart.animation),"TransitionEvent"in window||delete Lr.transitionend.transition);function Ps(n){if(gf[n])return gf[n];if(!Lr[n])return n;var r=Lr[n],l;for(l in r)if(r.hasOwnProperty(l)&&l in Em)return gf[n]=r[l];return n}var Mm=Ps("animationend"),Dm=Ps("animationiteration"),Om=Ps("animationstart"),E2=Ps("transitionrun"),M2=Ps("transitionstart"),D2=Ps("transitioncancel"),Am=Ps("transitionend"),km=new Map,pf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pf.push("scrollEnd");function Dn(n,r){km.set(n,r),li(r,[n])}var Gl=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},fn=[],Br=0,mf=0;function $l(){for(var n=Br,r=mf=Br=0;r<n;){var l=fn[r];fn[r++]=null;var u=fn[r];fn[r++]=null;var g=fn[r];fn[r++]=null;var m=fn[r];if(fn[r++]=null,u!==null&&g!==null){var S=u.pending;S===null?g.next=g:(g.next=S.next,S.next=g),u.pending=g}m!==0&&jm(l,g,m)}}function ql(n,r,l,u){fn[Br++]=n,fn[Br++]=r,fn[Br++]=l,fn[Br++]=u,mf|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function yf(n,r,l,u){return ql(n,r,l,u),Wl(n)}function Ys(n,r){return ql(n,null,null,r),Wl(n)}function jm(n,r,l){n.lanes|=l;var u=n.alternate;u!==null&&(u.lanes|=l);for(var g=!1,m=n.return;m!==null;)m.childLanes|=l,u=m.alternate,u!==null&&(u.childLanes|=l),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(g=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,g&&r!==null&&(g=31-Re(l),n=m.hiddenUpdates,u=n[g],u===null?n[g]=[r]:u.push(r),r.lane=l|536870912),m):null}function Wl(n){if(50<Ta)throw Ta=0,Ed=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var Hr={};function O2(n,r,l,u){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(n,r,l,u){return new O2(n,r,l,u)}function vf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function fi(n,r){var l=n.alternate;return l===null?(l=en(n.tag,r,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=r,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,r=n.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function Nm(n,r){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,r=l.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function Zl(n,r,l,u,g,m){var S=0;if(u=n,typeof n=="function")vf(n)&&(S=1);else if(typeof n=="string")S=Rw(n,l,nt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case G:return n=en(31,l,r,g),n.elementType=G,n.lanes=m,n;case w:return Vs(l.children,g,m,r);case T:S=8,g|=24;break;case E:return n=en(12,l,r,g|2),n.elementType=E,n.lanes=m,n;case j:return n=en(13,l,r,g),n.elementType=j,n.lanes=m,n;case R:return n=en(19,l,r,g),n.elementType=R,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case C:S=10;break t;case M:S=9;break t;case D:S=11;break t;case z:S=14;break t;case U:S=16,u=null;break t}S=29,l=Error(i(130,n===null?"null":typeof n,"")),u=null}return r=en(S,l,r,g),r.elementType=n,r.type=u,r.lanes=m,r}function Vs(n,r,l,u){return n=en(7,n,u,r),n.lanes=l,n}function xf(n,r,l){return n=en(6,n,null,r),n.lanes=l,n}function Rm(n){var r=en(18,null,null,0);return r.stateNode=n,r}function bf(n,r,l){return r=en(4,n.children!==null?n.children:[],n.key,r),r.lanes=l,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var zm=new WeakMap;function dn(n,r){if(typeof n=="object"&&n!==null){var l=zm.get(n);return l!==void 0?l:(r={value:n,source:r,stack:Tn(r)},zm.set(n,r),r)}return{value:n,source:r,stack:Tn(r)}}var Ur=[],Pr=0,Kl=null,sa=0,gn=[],pn=0,Ki=null,Fn=1,In="";function di(n,r){Ur[Pr++]=sa,Ur[Pr++]=Kl,Kl=n,sa=r}function Lm(n,r,l){gn[pn++]=Fn,gn[pn++]=In,gn[pn++]=Ki,Ki=n;var u=Fn;n=In;var g=32-Re(u)-1;u&=~(1<<g),l+=1;var m=32-Re(r)+g;if(30<m){var S=g-g%5;m=(u&(1<<S)-1).toString(32),u>>=S,g-=S,Fn=1<<32-Re(r)+g|l<<g|u,In=m+n}else Fn=1<<m|l<<g|u,In=n}function Sf(n){n.return!==null&&(di(n,1),Lm(n,1,0))}function _f(n){for(;n===Kl;)Kl=Ur[--Pr],Ur[Pr]=null,sa=Ur[--Pr],Ur[Pr]=null;for(;n===Ki;)Ki=gn[--pn],gn[pn]=null,In=gn[--pn],gn[pn]=null,Fn=gn[--pn],gn[pn]=null}function Bm(n,r){gn[pn++]=Fn,gn[pn++]=In,gn[pn++]=Ki,Fn=r.id,In=r.overflow,Ki=n}var we=null,Qt=null,Rt=!1,Qi=null,mn=!1,wf=Error(i(519));function Ji(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ra(dn(r,n)),wf}function Hm(n){var r=n.stateNode,l=n.type,u=n.memoizedProps;switch(r[me]=n,r[Oe]=u,l){case"dialog":kt("cancel",r),kt("close",r);break;case"iframe":case"object":case"embed":kt("load",r);break;case"video":case"audio":for(l=0;l<Ma.length;l++)kt(Ma[l],r);break;case"source":kt("error",r);break;case"img":case"image":case"link":kt("error",r),kt("load",r);break;case"details":kt("toggle",r);break;case"input":kt("invalid",r),Hl(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":kt("invalid",r);break;case"textarea":kt("invalid",r),Jp(r,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||ev(r.textContent,l)?(u.popover!=null&&(kt("beforetoggle",r),kt("toggle",r)),u.onScroll!=null&&kt("scroll",r),u.onScrollEnd!=null&&kt("scrollend",r),u.onClick!=null&&(r.onclick=ui),r=!0):r=!1,r||Ji(n,!0)}function Um(n){for(we=n.return;we;)switch(we.tag){case 5:case 31:case 13:mn=!1;return;case 27:case 3:mn=!0;return;default:we=we.return}}function Yr(n){if(n!==we)return!1;if(!Rt)return Um(n),Rt=!0,!1;var r=n.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||Yd(n.type,n.memoizedProps)),l=!l),l&&Qt&&Ji(n),Um(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Qt=uv(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Qt=uv(n)}else r===27?(r=Qt,ds(n.type)?(n=Gd,Gd=null,Qt=n):Qt=r):Qt=we?vn(n.stateNode.nextSibling):null;return!0}function Xs(){Qt=we=null,Rt=!1}function Cf(){var n=Qi;return n!==null&&(Ge===null?Ge=n:Ge.push.apply(Ge,n),Qi=null),n}function ra(n){Qi===null?Qi=[n]:Qi.push(n)}var Tf=k(null),Fs=null,gi=null;function ts(n,r,l){et(Tf,r._currentValue),r._currentValue=l}function pi(n){n._currentValue=Tf.current,P(Tf)}function Ef(n,r,l){for(;n!==null;){var u=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),n===l)break;n=n.return}}function Mf(n,r,l,u){var g=n.child;for(g!==null&&(g.return=n);g!==null;){var m=g.dependencies;if(m!==null){var S=g.child;m=m.firstContext;t:for(;m!==null;){var O=m;m=g;for(var B=0;B<r.length;B++)if(O.context===r[B]){m.lanes|=l,O=m.alternate,O!==null&&(O.lanes|=l),Ef(m.return,l,n),u||(S=null);break t}m=O.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(i(341));S.lanes|=l,m=S.alternate,m!==null&&(m.lanes|=l),Ef(S,l,n),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===n){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function Vr(n,r,l,u){n=null;for(var g=r,m=!1;g!==null;){if(!m){if((g.flags&524288)!==0)m=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(i(387));if(S=S.memoizedProps,S!==null){var O=g.type;tn(g.pendingProps.value,S.value)||(n!==null?n.push(O):n=[O])}}else if(g===ft.current){if(S=g.alternate,S===null)throw Error(i(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(n!==null?n.push(ja):n=[ja])}g=g.return}n!==null&&Mf(r,n,l,u),r.flags|=262144}function Ql(n){for(n=n.firstContext;n!==null;){if(!tn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Is(n){Fs=n,gi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ce(n){return Pm(Fs,n)}function Jl(n,r){return Fs===null&&Is(n),Pm(n,r)}function Pm(n,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},gi===null){if(n===null)throw Error(i(308));gi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else gi=gi.next=r;return l}var A2=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(l,u){n.push(u)}};this.abort=function(){r.aborted=!0,n.forEach(function(l){return l()})}},k2=s.unstable_scheduleCallback,j2=s.unstable_NormalPriority,he={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Df(){return{controller:new A2,data:new Map,refCount:0}}function oa(n){n.refCount--,n.refCount===0&&k2(j2,function(){n.controller.abort()})}var aa=null,Of=0,Xr=0,Fr=null;function N2(n,r){if(aa===null){var l=aa=[];Of=0,Xr=jd(),Fr={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Of++,r.then(Ym,Ym),r}function Ym(){if(--Of===0&&aa!==null){Fr!==null&&(Fr.status="fulfilled");var n=aa;aa=null,Xr=0,Fr=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function R2(n,r){var l=[],u={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return n.then(function(){u.status="fulfilled",u.value=r;for(var g=0;g<l.length;g++)(0,l[g])(r)},function(g){for(u.status="rejected",u.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),u}var Vm=A.S;A.S=function(n,r){Ty=_e(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&N2(n,r),Vm!==null&&Vm(n,r)};var Gs=k(null);function Af(){var n=Gs.current;return n!==null?n:Zt.pooledCache}function tc(n,r){r===null?et(Gs,Gs.current):et(Gs,r.pool)}function Xm(){var n=Af();return n===null?null:{parent:he._currentValue,pool:n}}var Ir=Error(i(460)),kf=Error(i(474)),ec=Error(i(542)),nc={then:function(){}};function Fm(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Im(n,r,l){switch(l=n[l],l===void 0?n.push(r):l!==r&&(r.then(ui,ui),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,$m(n),n;default:if(typeof r.status=="string")r.then(ui,ui);else{if(n=Zt,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(u){if(r.status==="pending"){var g=r;g.status="fulfilled",g.value=u}},function(u){if(r.status==="pending"){var g=r;g.status="rejected",g.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,$m(n),n}throw qs=r,Ir}}function $s(n){try{var r=n._init;return r(n._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(qs=l,Ir):l}}var qs=null;function Gm(){if(qs===null)throw Error(i(459));var n=qs;return qs=null,n}function $m(n){if(n===Ir||n===ec)throw Error(i(483))}var Gr=null,la=0;function ic(n){var r=la;return la+=1,Gr===null&&(Gr=[]),Im(Gr,n,r)}function ca(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function sc(n,r){throw r.$$typeof===v?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function qm(n){function r($,F){if(n){var K=$.deletions;K===null?($.deletions=[F],$.flags|=16):K.push(F)}}function l($,F){if(!n)return null;for(;F!==null;)r($,F),F=F.sibling;return null}function u($){for(var F=new Map;$!==null;)$.key!==null?F.set($.key,$):F.set($.index,$),$=$.sibling;return F}function g($,F){return $=fi($,F),$.index=0,$.sibling=null,$}function m($,F,K){return $.index=K,n?(K=$.alternate,K!==null?(K=K.index,K<F?($.flags|=67108866,F):K):($.flags|=67108866,F)):($.flags|=1048576,F)}function S($){return n&&$.alternate===null&&($.flags|=67108866),$}function O($,F,K,lt){return F===null||F.tag!==6?(F=xf(K,$.mode,lt),F.return=$,F):(F=g(F,K),F.return=$,F)}function B($,F,K,lt){var St=K.type;return St===w?at($,F,K.props.children,lt,K.key):F!==null&&(F.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===U&&$s(St)===F.type)?(F=g(F,K.props),ca(F,K),F.return=$,F):(F=Zl(K.type,K.key,K.props,null,$.mode,lt),ca(F,K),F.return=$,F)}function Q($,F,K,lt){return F===null||F.tag!==4||F.stateNode.containerInfo!==K.containerInfo||F.stateNode.implementation!==K.implementation?(F=bf(K,$.mode,lt),F.return=$,F):(F=g(F,K.children||[]),F.return=$,F)}function at($,F,K,lt,St){return F===null||F.tag!==7?(F=Vs(K,$.mode,lt,St),F.return=$,F):(F=g(F,K),F.return=$,F)}function ct($,F,K){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=xf(""+F,$.mode,K),F.return=$,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case x:return K=Zl(F.type,F.key,F.props,null,$.mode,K),ca(K,F),K.return=$,K;case b:return F=bf(F,$.mode,K),F.return=$,F;case U:return F=$s(F),ct($,F,K)}if(I(F)||Z(F))return F=Vs(F,$.mode,K,null),F.return=$,F;if(typeof F.then=="function")return ct($,ic(F),K);if(F.$$typeof===C)return ct($,Jl($,F),K);sc($,F)}return null}function J($,F,K,lt){var St=F!==null?F.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return St!==null?null:O($,F,""+K,lt);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case x:return K.key===St?B($,F,K,lt):null;case b:return K.key===St?Q($,F,K,lt):null;case U:return K=$s(K),J($,F,K,lt)}if(I(K)||Z(K))return St!==null?null:at($,F,K,lt,null);if(typeof K.then=="function")return J($,F,ic(K),lt);if(K.$$typeof===C)return J($,F,Jl($,K),lt);sc($,K)}return null}function it($,F,K,lt,St){if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return $=$.get(K)||null,O(F,$,""+lt,St);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case x:return $=$.get(lt.key===null?K:lt.key)||null,B(F,$,lt,St);case b:return $=$.get(lt.key===null?K:lt.key)||null,Q(F,$,lt,St);case U:return lt=$s(lt),it($,F,K,lt,St)}if(I(lt)||Z(lt))return $=$.get(K)||null,at(F,$,lt,St,null);if(typeof lt.then=="function")return it($,F,K,ic(lt),St);if(lt.$$typeof===C)return it($,F,K,Jl(F,lt),St);sc(F,lt)}return null}function yt($,F,K,lt){for(var St=null,Ht=null,vt=F,Et=F=0,Nt=null;vt!==null&&Et<K.length;Et++){vt.index>Et?(Nt=vt,vt=null):Nt=vt.sibling;var Ut=J($,vt,K[Et],lt);if(Ut===null){vt===null&&(vt=Nt);break}n&&vt&&Ut.alternate===null&&r($,vt),F=m(Ut,F,Et),Ht===null?St=Ut:Ht.sibling=Ut,Ht=Ut,vt=Nt}if(Et===K.length)return l($,vt),Rt&&di($,Et),St;if(vt===null){for(;Et<K.length;Et++)vt=ct($,K[Et],lt),vt!==null&&(F=m(vt,F,Et),Ht===null?St=vt:Ht.sibling=vt,Ht=vt);return Rt&&di($,Et),St}for(vt=u(vt);Et<K.length;Et++)Nt=it(vt,$,Et,K[Et],lt),Nt!==null&&(n&&Nt.alternate!==null&&vt.delete(Nt.key===null?Et:Nt.key),F=m(Nt,F,Et),Ht===null?St=Nt:Ht.sibling=Nt,Ht=Nt);return n&&vt.forEach(function(vs){return r($,vs)}),Rt&&di($,Et),St}function wt($,F,K,lt){if(K==null)throw Error(i(151));for(var St=null,Ht=null,vt=F,Et=F=0,Nt=null,Ut=K.next();vt!==null&&!Ut.done;Et++,Ut=K.next()){vt.index>Et?(Nt=vt,vt=null):Nt=vt.sibling;var vs=J($,vt,Ut.value,lt);if(vs===null){vt===null&&(vt=Nt);break}n&&vt&&vs.alternate===null&&r($,vt),F=m(vs,F,Et),Ht===null?St=vs:Ht.sibling=vs,Ht=vs,vt=Nt}if(Ut.done)return l($,vt),Rt&&di($,Et),St;if(vt===null){for(;!Ut.done;Et++,Ut=K.next())Ut=ct($,Ut.value,lt),Ut!==null&&(F=m(Ut,F,Et),Ht===null?St=Ut:Ht.sibling=Ut,Ht=Ut);return Rt&&di($,Et),St}for(vt=u(vt);!Ut.done;Et++,Ut=K.next())Ut=it(vt,$,Et,Ut.value,lt),Ut!==null&&(n&&Ut.alternate!==null&&vt.delete(Ut.key===null?Et:Ut.key),F=m(Ut,F,Et),Ht===null?St=Ut:Ht.sibling=Ut,Ht=Ut);return n&&vt.forEach(function(Iw){return r($,Iw)}),Rt&&di($,Et),St}function qt($,F,K,lt){if(typeof K=="object"&&K!==null&&K.type===w&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case x:t:{for(var St=K.key;F!==null;){if(F.key===St){if(St=K.type,St===w){if(F.tag===7){l($,F.sibling),lt=g(F,K.props.children),lt.return=$,$=lt;break t}}else if(F.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===U&&$s(St)===F.type){l($,F.sibling),lt=g(F,K.props),ca(lt,K),lt.return=$,$=lt;break t}l($,F);break}else r($,F);F=F.sibling}K.type===w?(lt=Vs(K.props.children,$.mode,lt,K.key),lt.return=$,$=lt):(lt=Zl(K.type,K.key,K.props,null,$.mode,lt),ca(lt,K),lt.return=$,$=lt)}return S($);case b:t:{for(St=K.key;F!==null;){if(F.key===St)if(F.tag===4&&F.stateNode.containerInfo===K.containerInfo&&F.stateNode.implementation===K.implementation){l($,F.sibling),lt=g(F,K.children||[]),lt.return=$,$=lt;break t}else{l($,F);break}else r($,F);F=F.sibling}lt=bf(K,$.mode,lt),lt.return=$,$=lt}return S($);case U:return K=$s(K),qt($,F,K,lt)}if(I(K))return yt($,F,K,lt);if(Z(K)){if(St=Z(K),typeof St!="function")throw Error(i(150));return K=St.call(K),wt($,F,K,lt)}if(typeof K.then=="function")return qt($,F,ic(K),lt);if(K.$$typeof===C)return qt($,F,Jl($,K),lt);sc($,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,F!==null&&F.tag===6?(l($,F.sibling),lt=g(F,K),lt.return=$,$=lt):(l($,F),lt=xf(K,$.mode,lt),lt.return=$,$=lt),S($)):l($,F)}return function($,F,K,lt){try{la=0;var St=qt($,F,K,lt);return Gr=null,St}catch(vt){if(vt===Ir||vt===ec)throw vt;var Ht=en(29,vt,null,$.mode);return Ht.lanes=lt,Ht.return=$,Ht}}}var Ws=qm(!0),Wm=qm(!1),es=!1;function jf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Nf(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function ns(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function is(n,r,l){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(Pt&2)!==0){var g=u.pending;return g===null?r.next=r:(r.next=g.next,g.next=r),u.pending=r,r=Wl(n),jm(n,null,l),r}return ql(n,u,r,l),Wl(n)}function ua(n,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=n.pendingLanes,l|=u,r.lanes=l,Ml(n,l)}}function Rf(n,r){var l=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var g=null,m=null;if(l=l.firstBaseUpdate,l!==null){do{var S={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};m===null?g=m=S:m=m.next=S,l=l.next}while(l!==null);m===null?g=m=r:m=m.next=r}else g=m=r;l={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:m,shared:u.shared,callbacks:u.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=r:n.next=r,l.lastBaseUpdate=r}var zf=!1;function ha(){if(zf){var n=Fr;if(n!==null)throw n}}function fa(n,r,l,u){zf=!1;var g=n.updateQueue;es=!1;var m=g.firstBaseUpdate,S=g.lastBaseUpdate,O=g.shared.pending;if(O!==null){g.shared.pending=null;var B=O,Q=B.next;B.next=null,S===null?m=Q:S.next=Q,S=B;var at=n.alternate;at!==null&&(at=at.updateQueue,O=at.lastBaseUpdate,O!==S&&(O===null?at.firstBaseUpdate=Q:O.next=Q,at.lastBaseUpdate=B))}if(m!==null){var ct=g.baseState;S=0,at=Q=B=null,O=m;do{var J=O.lane&-536870913,it=J!==O.lane;if(it?(jt&J)===J:(u&J)===J){J!==0&&J===Xr&&(zf=!0),at!==null&&(at=at.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});t:{var yt=n,wt=O;J=r;var qt=l;switch(wt.tag){case 1:if(yt=wt.payload,typeof yt=="function"){ct=yt.call(qt,ct,J);break t}ct=yt;break t;case 3:yt.flags=yt.flags&-65537|128;case 0:if(yt=wt.payload,J=typeof yt=="function"?yt.call(qt,ct,J):yt,J==null)break t;ct=y({},ct,J);break t;case 2:es=!0}}J=O.callback,J!==null&&(n.flags|=64,it&&(n.flags|=8192),it=g.callbacks,it===null?g.callbacks=[J]:it.push(J))}else it={lane:J,tag:O.tag,payload:O.payload,callback:O.callback,next:null},at===null?(Q=at=it,B=ct):at=at.next=it,S|=J;if(O=O.next,O===null){if(O=g.shared.pending,O===null)break;it=O,O=it.next,it.next=null,g.lastBaseUpdate=it,g.shared.pending=null}}while(!0);at===null&&(B=ct),g.baseState=B,g.firstBaseUpdate=Q,g.lastBaseUpdate=at,m===null&&(g.shared.lanes=0),ls|=S,n.lanes=S,n.memoizedState=ct}}function Zm(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function Km(n,r){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)Zm(l[n],r)}var $r=k(null),rc=k(0);function Qm(n,r){n=Ci,et(rc,n),et($r,r),Ci=n|r.baseLanes}function Lf(){et(rc,Ci),et($r,$r.current)}function Bf(){Ci=rc.current,P($r),P(rc)}var nn=k(null),yn=null;function ss(n){var r=n.alternate;et(oe,oe.current&1),et(nn,n),yn===null&&(r===null||$r.current!==null||r.memoizedState!==null)&&(yn=n)}function Hf(n){et(oe,oe.current),et(nn,n),yn===null&&(yn=n)}function Jm(n){n.tag===22?(et(oe,oe.current),et(nn,n),yn===null&&(yn=n)):rs()}function rs(){et(oe,oe.current),et(nn,nn.current)}function sn(n){P(nn),yn===n&&(yn=null),P(oe)}var oe=k(0);function oc(n){for(var r=n;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Fd(l)||Id(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var mi=0,Tt=null,Gt=null,fe=null,ac=!1,qr=!1,Zs=!1,lc=0,da=0,Wr=null,z2=0;function se(){throw Error(i(321))}function Uf(n,r){if(r===null)return!1;for(var l=0;l<r.length&&l<n.length;l++)if(!tn(n[l],r[l]))return!1;return!0}function Pf(n,r,l,u,g,m){return mi=m,Tt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,A.H=n===null||n.memoizedState===null?L0:ed,Zs=!1,m=l(u,g),Zs=!1,qr&&(m=e0(r,l,u,g)),t0(n),m}function t0(n){A.H=ma;var r=Gt!==null&&Gt.next!==null;if(mi=0,fe=Gt=Tt=null,ac=!1,da=0,Wr=null,r)throw Error(i(300));n===null||de||(n=n.dependencies,n!==null&&Ql(n)&&(de=!0))}function e0(n,r,l,u){Tt=n;var g=0;do{if(qr&&(Wr=null),da=0,qr=!1,25<=g)throw Error(i(301));if(g+=1,fe=Gt=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}A.H=B0,m=r(l,u)}while(qr);return m}function L2(){var n=A.H,r=n.useState()[0];return r=typeof r.then=="function"?ga(r):r,n=n.useState()[0],(Gt!==null?Gt.memoizedState:null)!==n&&(Tt.flags|=1024),r}function Yf(){var n=lc!==0;return lc=0,n}function Vf(n,r,l){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~l}function Xf(n){if(ac){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}ac=!1}mi=0,fe=Gt=Tt=null,qr=!1,da=lc=0,Wr=null}function ze(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fe===null?Tt.memoizedState=fe=n:fe=fe.next=n,fe}function ae(){if(Gt===null){var n=Tt.alternate;n=n!==null?n.memoizedState:null}else n=Gt.next;var r=fe===null?Tt.memoizedState:fe.next;if(r!==null)fe=r,Gt=n;else{if(n===null)throw Tt.alternate===null?Error(i(467)):Error(i(310));Gt=n,n={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},fe===null?Tt.memoizedState=fe=n:fe=fe.next=n}return fe}function cc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ga(n){var r=da;return da+=1,Wr===null&&(Wr=[]),n=Im(Wr,n,r),r=Tt,(fe===null?r.memoizedState:fe.next)===null&&(r=r.alternate,A.H=r===null||r.memoizedState===null?L0:ed),n}function uc(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return ga(n);if(n.$$typeof===C)return Ce(n)}throw Error(i(438,String(n)))}function Ff(n){var r=null,l=Tt.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=Tt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(g){return g.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=cc(),Tt.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(n),u=0;u<n;u++)l[u]=ut;return r.index++,l}function yi(n,r){return typeof r=="function"?r(n):r}function hc(n){var r=ae();return If(r,Gt,n)}function If(n,r,l){var u=n.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var g=n.baseQueue,m=u.pending;if(m!==null){if(g!==null){var S=g.next;g.next=m.next,m.next=S}r.baseQueue=g=m,u.pending=null}if(m=n.baseState,g===null)n.memoizedState=m;else{r=g.next;var O=S=null,B=null,Q=r,at=!1;do{var ct=Q.lane&-536870913;if(ct!==Q.lane?(jt&ct)===ct:(mi&ct)===ct){var J=Q.revertLane;if(J===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),ct===Xr&&(at=!0);else if((mi&J)===J){Q=Q.next,J===Xr&&(at=!0);continue}else ct={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},B===null?(O=B=ct,S=m):B=B.next=ct,Tt.lanes|=J,ls|=J;ct=Q.action,Zs&&l(m,ct),m=Q.hasEagerState?Q.eagerState:l(m,ct)}else J={lane:ct,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},B===null?(O=B=J,S=m):B=B.next=J,Tt.lanes|=ct,ls|=ct;Q=Q.next}while(Q!==null&&Q!==r);if(B===null?S=m:B.next=O,!tn(m,n.memoizedState)&&(de=!0,at&&(l=Fr,l!==null)))throw l;n.memoizedState=m,n.baseState=S,n.baseQueue=B,u.lastRenderedState=m}return g===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function Gf(n){var r=ae(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var u=l.dispatch,g=l.pending,m=r.memoizedState;if(g!==null){l.pending=null;var S=g=g.next;do m=n(m,S.action),S=S.next;while(S!==g);tn(m,r.memoizedState)||(de=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),l.lastRenderedState=m}return[m,u]}function n0(n,r,l){var u=Tt,g=ae(),m=Rt;if(m){if(l===void 0)throw Error(i(407));l=l()}else l=r();var S=!tn((Gt||g).memoizedState,l);if(S&&(g.memoizedState=l,de=!0),g=g.queue,Wf(r0.bind(null,u,g,n),[n]),g.getSnapshot!==r||S||fe!==null&&fe.memoizedState.tag&1){if(u.flags|=2048,Zr(9,{destroy:void 0},s0.bind(null,u,g,l,r),null),Zt===null)throw Error(i(349));m||(mi&127)!==0||i0(u,r,l)}return l}function i0(n,r,l){n.flags|=16384,n={getSnapshot:r,value:l},r=Tt.updateQueue,r===null?(r=cc(),Tt.updateQueue=r,r.stores=[n]):(l=r.stores,l===null?r.stores=[n]:l.push(n))}function s0(n,r,l,u){r.value=l,r.getSnapshot=u,o0(r)&&a0(n)}function r0(n,r,l){return l(function(){o0(r)&&a0(n)})}function o0(n){var r=n.getSnapshot;n=n.value;try{var l=r();return!tn(n,l)}catch{return!0}}function a0(n){var r=Ys(n,2);r!==null&&$e(r,n,2)}function $f(n){var r=ze();if(typeof n=="function"){var l=n;if(n=l(),Zs){Vn(!0);try{l()}finally{Vn(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:n},r}function l0(n,r,l,u){return n.baseState=l,If(n,Gt,typeof u=="function"?u:yi)}function B2(n,r,l,u,g){if(gc(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:g,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){m.listeners.push(S)}};A.T!==null?l(!0):m.isTransition=!1,u(m),l=r.pending,l===null?(m.next=r.pending=m,c0(r,m)):(m.next=l.next,r.pending=l.next=m)}}function c0(n,r){var l=r.action,u=r.payload,g=n.state;if(r.isTransition){var m=A.T,S={};A.T=S;try{var O=l(g,u),B=A.S;B!==null&&B(S,O),u0(n,r,O)}catch(Q){qf(n,r,Q)}finally{m!==null&&S.types!==null&&(m.types=S.types),A.T=m}}else try{m=l(g,u),u0(n,r,m)}catch(Q){qf(n,r,Q)}}function u0(n,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){h0(n,r,u)},function(u){return qf(n,r,u)}):h0(n,r,l)}function h0(n,r,l){r.status="fulfilled",r.value=l,f0(r),n.state=l,r=n.pending,r!==null&&(l=r.next,l===r?n.pending=null:(l=l.next,r.next=l,c0(n,l)))}function qf(n,r,l){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,f0(r),r=r.next;while(r!==u)}n.action=null}function f0(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function d0(n,r){return r}function g0(n,r){if(Rt){var l=Zt.formState;if(l!==null){t:{var u=Tt;if(Rt){if(Qt){e:{for(var g=Qt,m=mn;g.nodeType!==8;){if(!m){g=null;break e}if(g=vn(g.nextSibling),g===null){g=null;break e}}m=g.data,g=m==="F!"||m==="F"?g:null}if(g){Qt=vn(g.nextSibling),u=g.data==="F!";break t}}Ji(u)}u=!1}u&&(r=l[0])}}return l=ze(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d0,lastRenderedState:r},l.queue=u,l=N0.bind(null,Tt,u),u.dispatch=l,u=$f(!1),m=td.bind(null,Tt,!1,u.queue),u=ze(),g={state:r,dispatch:null,action:n,pending:null},u.queue=g,l=B2.bind(null,Tt,g,m,l),g.dispatch=l,u.memoizedState=n,[r,l,!1]}function p0(n){var r=ae();return m0(r,Gt,n)}function m0(n,r,l){if(r=If(n,r,d0)[0],n=hc(yi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=ga(r)}catch(S){throw S===Ir?ec:S}else u=r;r=ae();var g=r.queue,m=g.dispatch;return l!==r.memoizedState&&(Tt.flags|=2048,Zr(9,{destroy:void 0},H2.bind(null,g,l),null)),[u,m,n]}function H2(n,r){n.action=r}function y0(n){var r=ae(),l=Gt;if(l!==null)return m0(r,l,n);ae(),r=r.memoizedState,l=ae();var u=l.queue.dispatch;return l.memoizedState=n,[r,u,!1]}function Zr(n,r,l,u){return n={tag:n,create:l,deps:u,inst:r,next:null},r=Tt.updateQueue,r===null&&(r=cc(),Tt.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=n.next=n:(u=l.next,l.next=n,n.next=u,r.lastEffect=n),n}function v0(){return ae().memoizedState}function fc(n,r,l,u){var g=ze();Tt.flags|=n,g.memoizedState=Zr(1|r,{destroy:void 0},l,u===void 0?null:u)}function dc(n,r,l,u){var g=ae();u=u===void 0?null:u;var m=g.memoizedState.inst;Gt!==null&&u!==null&&Uf(u,Gt.memoizedState.deps)?g.memoizedState=Zr(r,m,l,u):(Tt.flags|=n,g.memoizedState=Zr(1|r,m,l,u))}function x0(n,r){fc(8390656,8,n,r)}function Wf(n,r){dc(2048,8,n,r)}function U2(n){Tt.flags|=4;var r=Tt.updateQueue;if(r===null)r=cc(),Tt.updateQueue=r,r.events=[n];else{var l=r.events;l===null?r.events=[n]:l.push(n)}}function b0(n){var r=ae().memoizedState;return U2({ref:r,nextImpl:n}),function(){if((Pt&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function S0(n,r){return dc(4,2,n,r)}function _0(n,r){return dc(4,4,n,r)}function w0(n,r){if(typeof r=="function"){n=n();var l=r(n);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function C0(n,r,l){l=l!=null?l.concat([n]):null,dc(4,4,w0.bind(null,r,n),l)}function Zf(){}function T0(n,r){var l=ae();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&Uf(r,u[1])?u[0]:(l.memoizedState=[n,r],n)}function E0(n,r){var l=ae();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&Uf(r,u[1]))return u[0];if(u=n(),Zs){Vn(!0);try{n()}finally{Vn(!1)}}return l.memoizedState=[u,r],u}function Kf(n,r,l){return l===void 0||(mi&1073741824)!==0&&(jt&261930)===0?n.memoizedState=r:(n.memoizedState=l,n=My(),Tt.lanes|=n,ls|=n,l)}function M0(n,r,l,u){return tn(l,r)?l:$r.current!==null?(n=Kf(n,l,u),tn(n,r)||(de=!0),n):(mi&42)===0||(mi&1073741824)!==0&&(jt&261930)===0?(de=!0,n.memoizedState=l):(n=My(),Tt.lanes|=n,ls|=n,r)}function D0(n,r,l,u,g){var m=L.p;L.p=m!==0&&8>m?m:8;var S=A.T,O={};A.T=O,td(n,!1,r,l);try{var B=g(),Q=A.S;if(Q!==null&&Q(O,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var at=R2(B,u);pa(n,r,at,an(n))}else pa(n,r,u,an(n))}catch(ct){pa(n,r,{then:function(){},status:"rejected",reason:ct},an())}finally{L.p=m,S!==null&&O.types!==null&&(S.types=O.types),A.T=S}}function P2(){}function Qf(n,r,l,u){if(n.tag!==5)throw Error(i(476));var g=O0(n).queue;D0(n,g,r,H,l===null?P2:function(){return A0(n),l(u)})}function O0(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:H,baseState:H,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:H},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:l},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function A0(n){var r=O0(n);r.next===null&&(r=n.alternate.memoizedState),pa(n,r.next.queue,{},an())}function Jf(){return Ce(ja)}function k0(){return ae().memoizedState}function j0(){return ae().memoizedState}function Y2(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var l=an();n=ns(l);var u=is(r,n,l);u!==null&&($e(u,r,l),ua(u,r,l)),r={cache:Df()},n.payload=r;return}r=r.return}}function V2(n,r,l){var u=an();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},gc(n)?R0(r,l):(l=yf(n,r,l,u),l!==null&&($e(l,n,u),z0(l,r,u)))}function N0(n,r,l){var u=an();pa(n,r,l,u)}function pa(n,r,l,u){var g={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(gc(n))R0(r,g);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var S=r.lastRenderedState,O=m(S,l);if(g.hasEagerState=!0,g.eagerState=O,tn(O,S))return ql(n,r,g,0),Zt===null&&$l(),!1}catch{}if(l=yf(n,r,g,u),l!==null)return $e(l,n,u),z0(l,r,u),!0}return!1}function td(n,r,l,u){if(u={lane:2,revertLane:jd(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},gc(n)){if(r)throw Error(i(479))}else r=yf(n,l,u,2),r!==null&&$e(r,n,2)}function gc(n){var r=n.alternate;return n===Tt||r!==null&&r===Tt}function R0(n,r){qr=ac=!0;var l=n.pending;l===null?r.next=r:(r.next=l.next,l.next=r),n.pending=r}function z0(n,r,l){if((l&4194048)!==0){var u=r.lanes;u&=n.pendingLanes,l|=u,r.lanes=l,Ml(n,l)}}var ma={readContext:Ce,use:uc,useCallback:se,useContext:se,useEffect:se,useImperativeHandle:se,useLayoutEffect:se,useInsertionEffect:se,useMemo:se,useReducer:se,useRef:se,useState:se,useDebugValue:se,useDeferredValue:se,useTransition:se,useSyncExternalStore:se,useId:se,useHostTransitionStatus:se,useFormState:se,useActionState:se,useOptimistic:se,useMemoCache:se,useCacheRefresh:se};ma.useEffectEvent=se;var L0={readContext:Ce,use:uc,useCallback:function(n,r){return ze().memoizedState=[n,r===void 0?null:r],n},useContext:Ce,useEffect:x0,useImperativeHandle:function(n,r,l){l=l!=null?l.concat([n]):null,fc(4194308,4,w0.bind(null,r,n),l)},useLayoutEffect:function(n,r){return fc(4194308,4,n,r)},useInsertionEffect:function(n,r){fc(4,2,n,r)},useMemo:function(n,r){var l=ze();r=r===void 0?null:r;var u=n();if(Zs){Vn(!0);try{n()}finally{Vn(!1)}}return l.memoizedState=[u,r],u},useReducer:function(n,r,l){var u=ze();if(l!==void 0){var g=l(r);if(Zs){Vn(!0);try{l(r)}finally{Vn(!1)}}}else g=r;return u.memoizedState=u.baseState=g,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:g},u.queue=n,n=n.dispatch=V2.bind(null,Tt,n),[u.memoizedState,n]},useRef:function(n){var r=ze();return n={current:n},r.memoizedState=n},useState:function(n){n=$f(n);var r=n.queue,l=N0.bind(null,Tt,r);return r.dispatch=l,[n.memoizedState,l]},useDebugValue:Zf,useDeferredValue:function(n,r){var l=ze();return Kf(l,n,r)},useTransition:function(){var n=$f(!1);return n=D0.bind(null,Tt,n.queue,!0,!1),ze().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,l){var u=Tt,g=ze();if(Rt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),Zt===null)throw Error(i(349));(jt&127)!==0||i0(u,r,l)}g.memoizedState=l;var m={value:l,getSnapshot:r};return g.queue=m,x0(r0.bind(null,u,m,n),[n]),u.flags|=2048,Zr(9,{destroy:void 0},s0.bind(null,u,m,l,r),null),l},useId:function(){var n=ze(),r=Zt.identifierPrefix;if(Rt){var l=In,u=Fn;l=(u&~(1<<32-Re(u)-1)).toString(32)+l,r="_"+r+"R_"+l,l=lc++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=z2++,r="_"+r+"r_"+l.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:Jf,useFormState:g0,useActionState:g0,useOptimistic:function(n){var r=ze();r.memoizedState=r.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=td.bind(null,Tt,!0,l),l.dispatch=r,[n,r]},useMemoCache:Ff,useCacheRefresh:function(){return ze().memoizedState=Y2.bind(null,Tt)},useEffectEvent:function(n){var r=ze(),l={impl:n};return r.memoizedState=l,function(){if((Pt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},ed={readContext:Ce,use:uc,useCallback:T0,useContext:Ce,useEffect:Wf,useImperativeHandle:C0,useInsertionEffect:S0,useLayoutEffect:_0,useMemo:E0,useReducer:hc,useRef:v0,useState:function(){return hc(yi)},useDebugValue:Zf,useDeferredValue:function(n,r){var l=ae();return M0(l,Gt.memoizedState,n,r)},useTransition:function(){var n=hc(yi)[0],r=ae().memoizedState;return[typeof n=="boolean"?n:ga(n),r]},useSyncExternalStore:n0,useId:k0,useHostTransitionStatus:Jf,useFormState:p0,useActionState:p0,useOptimistic:function(n,r){var l=ae();return l0(l,Gt,n,r)},useMemoCache:Ff,useCacheRefresh:j0};ed.useEffectEvent=b0;var B0={readContext:Ce,use:uc,useCallback:T0,useContext:Ce,useEffect:Wf,useImperativeHandle:C0,useInsertionEffect:S0,useLayoutEffect:_0,useMemo:E0,useReducer:Gf,useRef:v0,useState:function(){return Gf(yi)},useDebugValue:Zf,useDeferredValue:function(n,r){var l=ae();return Gt===null?Kf(l,n,r):M0(l,Gt.memoizedState,n,r)},useTransition:function(){var n=Gf(yi)[0],r=ae().memoizedState;return[typeof n=="boolean"?n:ga(n),r]},useSyncExternalStore:n0,useId:k0,useHostTransitionStatus:Jf,useFormState:y0,useActionState:y0,useOptimistic:function(n,r){var l=ae();return Gt!==null?l0(l,Gt,n,r):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:Ff,useCacheRefresh:j0};B0.useEffectEvent=b0;function nd(n,r,l,u){r=n.memoizedState,l=l(u,r),l=l==null?r:y({},r,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var id={enqueueSetState:function(n,r,l){n=n._reactInternals;var u=an(),g=ns(u);g.payload=r,l!=null&&(g.callback=l),r=is(n,g,u),r!==null&&($e(r,n,u),ua(r,n,u))},enqueueReplaceState:function(n,r,l){n=n._reactInternals;var u=an(),g=ns(u);g.tag=1,g.payload=r,l!=null&&(g.callback=l),r=is(n,g,u),r!==null&&($e(r,n,u),ua(r,n,u))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var l=an(),u=ns(l);u.tag=2,r!=null&&(u.callback=r),r=is(n,u,l),r!==null&&($e(r,n,l),ua(r,n,l))}};function H0(n,r,l,u,g,m,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,m,S):r.prototype&&r.prototype.isPureReactComponent?!na(l,u)||!na(g,m):!0}function U0(n,r,l,u){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==n&&id.enqueueReplaceState(r,r.state,null)}function Ks(n,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(n=n.defaultProps){l===r&&(l=y({},l));for(var g in n)l[g]===void 0&&(l[g]=n[g])}return l}function P0(n){Gl(n)}function Y0(n){console.error(n)}function V0(n){Gl(n)}function pc(n,r){try{var l=n.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function X0(n,r,l){try{var u=n.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function sd(n,r,l){return l=ns(l),l.tag=3,l.payload={element:null},l.callback=function(){pc(n,r)},l}function F0(n){return n=ns(n),n.tag=3,n}function I0(n,r,l,u){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var m=u.value;n.payload=function(){return g(m)},n.callback=function(){X0(r,l,u)}}var S=l.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(n.callback=function(){X0(r,l,u),typeof g!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var O=u.stack;this.componentDidCatch(u.value,{componentStack:O!==null?O:""})})}function X2(n,r,l,u,g){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&Vr(r,l,g,!0),l=nn.current,l!==null){switch(l.tag){case 31:case 13:return yn===null?Mc():l.alternate===null&&re===0&&(re=3),l.flags&=-257,l.flags|=65536,l.lanes=g,u===nc?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),Od(n,u,g)),!1;case 22:return l.flags|=65536,u===nc?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),Od(n,u,g)),!1}throw Error(i(435,l.tag))}return Od(n,u,g),Mc(),!1}if(Rt)return r=nn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=g,u!==wf&&(n=Error(i(422),{cause:u}),ra(dn(n,l)))):(u!==wf&&(r=Error(i(423),{cause:u}),ra(dn(r,l))),n=n.current.alternate,n.flags|=65536,g&=-g,n.lanes|=g,u=dn(u,l),g=sd(n.stateNode,u,g),Rf(n,g),re!==4&&(re=2)),!1;var m=Error(i(520),{cause:u});if(m=dn(m,l),Ca===null?Ca=[m]:Ca.push(m),re!==4&&(re=2),r===null)return!0;u=dn(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,n=g&-g,l.lanes|=n,n=sd(l.stateNode,u,n),Rf(l,n),!1;case 1:if(r=l.type,m=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(cs===null||!cs.has(m))))return l.flags|=65536,g&=-g,l.lanes|=g,g=F0(g),I0(g,n,l,u),Rf(l,g),!1}l=l.return}while(l!==null);return!1}var rd=Error(i(461)),de=!1;function Te(n,r,l,u){r.child=n===null?Wm(r,null,l,u):Ws(r,n.child,l,u)}function G0(n,r,l,u,g){l=l.render;var m=r.ref;if("ref"in u){var S={};for(var O in u)O!=="ref"&&(S[O]=u[O])}else S=u;return Is(r),u=Pf(n,r,l,S,m,g),O=Yf(),n!==null&&!de?(Vf(n,r,g),vi(n,r,g)):(Rt&&O&&Sf(r),r.flags|=1,Te(n,r,u,g),r.child)}function $0(n,r,l,u,g){if(n===null){var m=l.type;return typeof m=="function"&&!vf(m)&&m.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=m,q0(n,r,m,u,g)):(n=Zl(l.type,null,u,r,r.mode,g),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!dd(n,g)){var S=m.memoizedProps;if(l=l.compare,l=l!==null?l:na,l(S,u)&&n.ref===r.ref)return vi(n,r,g)}return r.flags|=1,n=fi(m,u),n.ref=r.ref,n.return=r,r.child=n}function q0(n,r,l,u,g){if(n!==null){var m=n.memoizedProps;if(na(m,u)&&n.ref===r.ref)if(de=!1,r.pendingProps=u=m,dd(n,g))(n.flags&131072)!==0&&(de=!0);else return r.lanes=n.lanes,vi(n,r,g)}return od(n,r,l,u,g)}function W0(n,r,l,u){var g=u.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|l:l,n!==null){for(u=r.child=n.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~m}else u=0,r.child=null;return Z0(n,r,m,l,u)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&tc(r,m!==null?m.cachePool:null),m!==null?Qm(r,m):Lf(),Jm(r);else return u=r.lanes=536870912,Z0(n,r,m!==null?m.baseLanes|l:l,l,u)}else m!==null?(tc(r,m.cachePool),Qm(r,m),rs(),r.memoizedState=null):(n!==null&&tc(r,null),Lf(),rs());return Te(n,r,g,l),r.child}function ya(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Z0(n,r,l,u,g){var m=Af();return m=m===null?null:{parent:he._currentValue,pool:m},r.memoizedState={baseLanes:l,cachePool:m},n!==null&&tc(r,null),Lf(),Jm(r),n!==null&&Vr(n,r,u,!0),r.childLanes=g,null}function mc(n,r){return r=vc({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function K0(n,r,l){return Ws(r,n.child,null,l),n=mc(r,r.pendingProps),n.flags|=2,sn(r),r.memoizedState=null,n}function F2(n,r,l){var u=r.pendingProps,g=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(Rt){if(u.mode==="hidden")return n=mc(r,u),r.lanes=536870912,ya(null,n);if(Hf(r),(n=Qt)?(n=cv(n,mn),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Ki!==null?{id:Fn,overflow:In}:null,retryLane:536870912,hydrationErrors:null},l=Rm(n),l.return=r,r.child=l,we=r,Qt=null)):n=null,n===null)throw Ji(r);return r.lanes=536870912,null}return mc(r,u)}var m=n.memoizedState;if(m!==null){var S=m.dehydrated;if(Hf(r),g)if(r.flags&256)r.flags&=-257,r=K0(n,r,l);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(de||Vr(n,r,l,!1),g=(l&n.childLanes)!==0,de||g){if(u=Zt,u!==null&&(S=Dl(u,l),S!==0&&S!==m.retryLane))throw m.retryLane=S,Ys(n,S),$e(u,n,S),rd;Mc(),r=K0(n,r,l)}else n=m.treeContext,Qt=vn(S.nextSibling),we=r,Rt=!0,Qi=null,mn=!1,n!==null&&Bm(r,n),r=mc(r,u),r.flags|=4096;return r}return n=fi(n.child,{mode:u.mode,children:u.children}),n.ref=r.ref,r.child=n,n.return=r,n}function yc(n,r){var l=r.ref;if(l===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(n===null||n.ref!==l)&&(r.flags|=4194816)}}function od(n,r,l,u,g){return Is(r),l=Pf(n,r,l,u,void 0,g),u=Yf(),n!==null&&!de?(Vf(n,r,g),vi(n,r,g)):(Rt&&u&&Sf(r),r.flags|=1,Te(n,r,l,g),r.child)}function Q0(n,r,l,u,g,m){return Is(r),r.updateQueue=null,l=e0(r,u,l,g),t0(n),u=Yf(),n!==null&&!de?(Vf(n,r,m),vi(n,r,m)):(Rt&&u&&Sf(r),r.flags|=1,Te(n,r,l,m),r.child)}function J0(n,r,l,u,g){if(Is(r),r.stateNode===null){var m=Hr,S=l.contextType;typeof S=="object"&&S!==null&&(m=Ce(S)),m=new l(u,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=id,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=u,m.state=r.memoizedState,m.refs={},jf(r),S=l.contextType,m.context=typeof S=="object"&&S!==null?Ce(S):Hr,m.state=r.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(nd(r,l,S,u),m.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(S=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),S!==m.state&&id.enqueueReplaceState(m,m.state,null),fa(r,u,m,g),ha(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(n===null){m=r.stateNode;var O=r.memoizedProps,B=Ks(l,O);m.props=B;var Q=m.context,at=l.contextType;S=Hr,typeof at=="object"&&at!==null&&(S=Ce(at));var ct=l.getDerivedStateFromProps;at=typeof ct=="function"||typeof m.getSnapshotBeforeUpdate=="function",O=r.pendingProps!==O,at||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(O||Q!==S)&&U0(r,m,u,S),es=!1;var J=r.memoizedState;m.state=J,fa(r,u,m,g),ha(),Q=r.memoizedState,O||J!==Q||es?(typeof ct=="function"&&(nd(r,l,ct,u),Q=r.memoizedState),(B=es||H0(r,l,B,u,J,Q,S))?(at||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=Q),m.props=u,m.state=Q,m.context=S,u=B):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{m=r.stateNode,Nf(n,r),S=r.memoizedProps,at=Ks(l,S),m.props=at,ct=r.pendingProps,J=m.context,Q=l.contextType,B=Hr,typeof Q=="object"&&Q!==null&&(B=Ce(Q)),O=l.getDerivedStateFromProps,(Q=typeof O=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(S!==ct||J!==B)&&U0(r,m,u,B),es=!1,J=r.memoizedState,m.state=J,fa(r,u,m,g),ha();var it=r.memoizedState;S!==ct||J!==it||es||n!==null&&n.dependencies!==null&&Ql(n.dependencies)?(typeof O=="function"&&(nd(r,l,O,u),it=r.memoizedState),(at=es||H0(r,l,at,u,J,it,B)||n!==null&&n.dependencies!==null&&Ql(n.dependencies))?(Q||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(u,it,B),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(u,it,B)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||S===n.memoizedProps&&J===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||S===n.memoizedProps&&J===n.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=it),m.props=u,m.state=it,m.context=B,u=at):(typeof m.componentDidUpdate!="function"||S===n.memoizedProps&&J===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||S===n.memoizedProps&&J===n.memoizedState||(r.flags|=1024),u=!1)}return m=u,yc(n,r),u=(r.flags&128)!==0,m||u?(m=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&u?(r.child=Ws(r,n.child,null,g),r.child=Ws(r,null,l,g)):Te(n,r,l,g),r.memoizedState=m.state,n=r.child):n=vi(n,r,g),n}function ty(n,r,l,u){return Xs(),r.flags|=256,Te(n,r,l,u),r.child}var ad={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ld(n){return{baseLanes:n,cachePool:Xm()}}function cd(n,r,l){return n=n!==null?n.childLanes&~l:0,r&&(n|=on),n}function ey(n,r,l){var u=r.pendingProps,g=!1,m=(r.flags&128)!==0,S;if((S=m)||(S=n!==null&&n.memoizedState===null?!1:(oe.current&2)!==0),S&&(g=!0,r.flags&=-129),S=(r.flags&32)!==0,r.flags&=-33,n===null){if(Rt){if(g?ss(r):rs(),(n=Qt)?(n=cv(n,mn),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Ki!==null?{id:Fn,overflow:In}:null,retryLane:536870912,hydrationErrors:null},l=Rm(n),l.return=r,r.child=l,we=r,Qt=null)):n=null,n===null)throw Ji(r);return Id(n)?r.lanes=32:r.lanes=536870912,null}var O=u.children;return u=u.fallback,g?(rs(),g=r.mode,O=vc({mode:"hidden",children:O},g),u=Vs(u,g,l,null),O.return=r,u.return=r,O.sibling=u,r.child=O,u=r.child,u.memoizedState=ld(l),u.childLanes=cd(n,S,l),r.memoizedState=ad,ya(null,u)):(ss(r),ud(r,O))}var B=n.memoizedState;if(B!==null&&(O=B.dehydrated,O!==null)){if(m)r.flags&256?(ss(r),r.flags&=-257,r=hd(n,r,l)):r.memoizedState!==null?(rs(),r.child=n.child,r.flags|=128,r=null):(rs(),O=u.fallback,g=r.mode,u=vc({mode:"visible",children:u.children},g),O=Vs(O,g,l,null),O.flags|=2,u.return=r,O.return=r,u.sibling=O,r.child=u,Ws(r,n.child,null,l),u=r.child,u.memoizedState=ld(l),u.childLanes=cd(n,S,l),r.memoizedState=ad,r=ya(null,u));else if(ss(r),Id(O)){if(S=O.nextSibling&&O.nextSibling.dataset,S)var Q=S.dgst;S=Q,u=Error(i(419)),u.stack="",u.digest=S,ra({value:u,source:null,stack:null}),r=hd(n,r,l)}else if(de||Vr(n,r,l,!1),S=(l&n.childLanes)!==0,de||S){if(S=Zt,S!==null&&(u=Dl(S,l),u!==0&&u!==B.retryLane))throw B.retryLane=u,Ys(n,u),$e(S,n,u),rd;Fd(O)||Mc(),r=hd(n,r,l)}else Fd(O)?(r.flags|=192,r.child=n.child,r=null):(n=B.treeContext,Qt=vn(O.nextSibling),we=r,Rt=!0,Qi=null,mn=!1,n!==null&&Bm(r,n),r=ud(r,u.children),r.flags|=4096);return r}return g?(rs(),O=u.fallback,g=r.mode,B=n.child,Q=B.sibling,u=fi(B,{mode:"hidden",children:u.children}),u.subtreeFlags=B.subtreeFlags&65011712,Q!==null?O=fi(Q,O):(O=Vs(O,g,l,null),O.flags|=2),O.return=r,u.return=r,u.sibling=O,r.child=u,ya(null,u),u=r.child,O=n.child.memoizedState,O===null?O=ld(l):(g=O.cachePool,g!==null?(B=he._currentValue,g=g.parent!==B?{parent:B,pool:B}:g):g=Xm(),O={baseLanes:O.baseLanes|l,cachePool:g}),u.memoizedState=O,u.childLanes=cd(n,S,l),r.memoizedState=ad,ya(n.child,u)):(ss(r),l=n.child,n=l.sibling,l=fi(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,n!==null&&(S=r.deletions,S===null?(r.deletions=[n],r.flags|=16):S.push(n)),r.child=l,r.memoizedState=null,l)}function ud(n,r){return r=vc({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function vc(n,r){return n=en(22,n,null,r),n.lanes=0,n}function hd(n,r,l){return Ws(r,n.child,null,l),n=ud(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function ny(n,r,l){n.lanes|=r;var u=n.alternate;u!==null&&(u.lanes|=r),Ef(n.return,r,l)}function fd(n,r,l,u,g,m){var S=n.memoizedState;S===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:g,treeForkCount:m}:(S.isBackwards=r,S.rendering=null,S.renderingStartTime=0,S.last=u,S.tail=l,S.tailMode=g,S.treeForkCount=m)}function iy(n,r,l){var u=r.pendingProps,g=u.revealOrder,m=u.tail;u=u.children;var S=oe.current,O=(S&2)!==0;if(O?(S=S&1|2,r.flags|=128):S&=1,et(oe,S),Te(n,r,u,l),u=Rt?sa:0,!O&&n!==null&&(n.flags&128)!==0)t:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&ny(n,l,r);else if(n.tag===19)ny(n,l,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break t;for(;n.sibling===null;){if(n.return===null||n.return===r)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(g){case"forwards":for(l=r.child,g=null;l!==null;)n=l.alternate,n!==null&&oc(n)===null&&(g=l),l=l.sibling;l=g,l===null?(g=r.child,r.child=null):(g=l.sibling,l.sibling=null),fd(r,!1,g,l,m,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,g=r.child,r.child=null;g!==null;){if(n=g.alternate,n!==null&&oc(n)===null){r.child=g;break}n=g.sibling,g.sibling=l,l=g,g=n}fd(r,!0,l,null,m,u);break;case"together":fd(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function vi(n,r,l){if(n!==null&&(r.dependencies=n.dependencies),ls|=r.lanes,(l&r.childLanes)===0)if(n!==null){if(Vr(n,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,l=fi(n,n.pendingProps),r.child=l,l.return=r;n.sibling!==null;)n=n.sibling,l=l.sibling=fi(n,n.pendingProps),l.return=r;l.sibling=null}return r.child}function dd(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&Ql(n)))}function I2(n,r,l){switch(r.tag){case 3:X(r,r.stateNode.containerInfo),ts(r,he,n.memoizedState.cache),Xs();break;case 27:case 5:gt(r);break;case 4:X(r,r.stateNode.containerInfo);break;case 10:ts(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Hf(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(ss(r),r.flags|=128,null):(l&r.child.childLanes)!==0?ey(n,r,l):(ss(r),n=vi(n,r,l),n!==null?n.sibling:null);ss(r);break;case 19:var g=(n.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||(Vr(n,r,l,!1),u=(l&r.childLanes)!==0),g){if(u)return iy(n,r,l);r.flags|=128}if(g=r.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),et(oe,oe.current),u)break;return null;case 22:return r.lanes=0,W0(n,r,l,r.pendingProps);case 24:ts(r,he,n.memoizedState.cache)}return vi(n,r,l)}function sy(n,r,l){if(n!==null)if(n.memoizedProps!==r.pendingProps)de=!0;else{if(!dd(n,l)&&(r.flags&128)===0)return de=!1,I2(n,r,l);de=(n.flags&131072)!==0}else de=!1,Rt&&(r.flags&1048576)!==0&&Lm(r,sa,r.index);switch(r.lanes=0,r.tag){case 16:t:{var u=r.pendingProps;if(n=$s(r.elementType),r.type=n,typeof n=="function")vf(n)?(u=Ks(n,u),r.tag=1,r=J0(null,r,n,u,l)):(r.tag=0,r=od(null,r,n,u,l));else{if(n!=null){var g=n.$$typeof;if(g===D){r.tag=11,r=G0(null,r,n,u,l);break t}else if(g===z){r.tag=14,r=$0(null,r,n,u,l);break t}}throw r=N(n)||n,Error(i(306,r,""))}}return r;case 0:return od(n,r,r.type,r.pendingProps,l);case 1:return u=r.type,g=Ks(u,r.pendingProps),J0(n,r,u,g,l);case 3:t:{if(X(r,r.stateNode.containerInfo),n===null)throw Error(i(387));u=r.pendingProps;var m=r.memoizedState;g=m.element,Nf(n,r),fa(r,u,null,l);var S=r.memoizedState;if(u=S.cache,ts(r,he,u),u!==m.cache&&Mf(r,[he],l,!0),ha(),u=S.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:S.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=ty(n,r,u,l);break t}else if(u!==g){g=dn(Error(i(424)),r),ra(g),r=ty(n,r,u,l);break t}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Qt=vn(n.firstChild),we=r,Rt=!0,Qi=null,mn=!0,l=Wm(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Xs(),u===g){r=vi(n,r,l);break t}Te(n,r,u,l)}r=r.child}return r;case 26:return yc(n,r),n===null?(l=pv(r.type,null,r.pendingProps,null))?r.memoizedState=l:Rt||(l=r.type,n=r.pendingProps,u=Rc(dt.current).createElement(l),u[me]=r,u[Oe]=n,Ee(u,l,n),ue(u),r.stateNode=u):r.memoizedState=pv(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return gt(r),n===null&&Rt&&(u=r.stateNode=fv(r.type,r.pendingProps,dt.current),we=r,mn=!0,g=Qt,ds(r.type)?(Gd=g,Qt=vn(u.firstChild)):Qt=g),Te(n,r,r.pendingProps.children,l),yc(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&Rt&&((g=u=Qt)&&(u=Sw(u,r.type,r.pendingProps,mn),u!==null?(r.stateNode=u,we=r,Qt=vn(u.firstChild),mn=!1,g=!0):g=!1),g||Ji(r)),gt(r),g=r.type,m=r.pendingProps,S=n!==null?n.memoizedProps:null,u=m.children,Yd(g,m)?u=null:S!==null&&Yd(g,S)&&(r.flags|=32),r.memoizedState!==null&&(g=Pf(n,r,L2,null,null,l),ja._currentValue=g),yc(n,r),Te(n,r,u,l),r.child;case 6:return n===null&&Rt&&((n=l=Qt)&&(l=_w(l,r.pendingProps,mn),l!==null?(r.stateNode=l,we=r,Qt=null,n=!0):n=!1),n||Ji(r)),null;case 13:return ey(n,r,l);case 4:return X(r,r.stateNode.containerInfo),u=r.pendingProps,n===null?r.child=Ws(r,null,u,l):Te(n,r,u,l),r.child;case 11:return G0(n,r,r.type,r.pendingProps,l);case 7:return Te(n,r,r.pendingProps,l),r.child;case 8:return Te(n,r,r.pendingProps.children,l),r.child;case 12:return Te(n,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,ts(r,r.type,u.value),Te(n,r,u.children,l),r.child;case 9:return g=r.type._context,u=r.pendingProps.children,Is(r),g=Ce(g),u=u(g),r.flags|=1,Te(n,r,u,l),r.child;case 14:return $0(n,r,r.type,r.pendingProps,l);case 15:return q0(n,r,r.type,r.pendingProps,l);case 19:return iy(n,r,l);case 31:return F2(n,r,l);case 22:return W0(n,r,l,r.pendingProps);case 24:return Is(r),u=Ce(he),n===null?(g=Af(),g===null&&(g=Zt,m=Df(),g.pooledCache=m,m.refCount++,m!==null&&(g.pooledCacheLanes|=l),g=m),r.memoizedState={parent:u,cache:g},jf(r),ts(r,he,g)):((n.lanes&l)!==0&&(Nf(n,r),fa(r,null,null,l),ha()),g=n.memoizedState,m=r.memoizedState,g.parent!==u?(g={parent:u,cache:u},r.memoizedState=g,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=g),ts(r,he,u)):(u=m.cache,ts(r,he,u),u!==g.cache&&Mf(r,[he],l,!0))),Te(n,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function xi(n){n.flags|=4}function gd(n,r,l,u,g){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(g&335544128)===g)if(n.stateNode.complete)n.flags|=8192;else if(ky())n.flags|=8192;else throw qs=nc,kf}else n.flags&=-16777217}function ry(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!bv(r))if(ky())n.flags|=8192;else throw qs=nc,kf}function xc(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?Tl():536870912,n.lanes|=r,to|=r)}function va(n,r){if(!Rt)switch(n.tailMode){case"hidden":r=n.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function Jt(n){var r=n.alternate!==null&&n.alternate.child===n.child,l=0,u=0;if(r)for(var g=n.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=u,n.childLanes=l,r}function G2(n,r,l){var u=r.pendingProps;switch(_f(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(r),null;case 1:return Jt(r),null;case 3:return l=r.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),pi(he),ot(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(Yr(r)?xi(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Cf())),Jt(r),null;case 26:var g=r.type,m=r.memoizedState;return n===null?(xi(r),m!==null?(Jt(r),ry(r,m)):(Jt(r),gd(r,g,null,u,l))):m?m!==n.memoizedState?(xi(r),Jt(r),ry(r,m)):(Jt(r),r.flags&=-16777217):(n=n.memoizedProps,n!==u&&xi(r),Jt(r),gd(r,g,n,u,l)),null;case 27:if(xt(r),l=dt.current,g=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==u&&xi(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Jt(r),null}n=nt.current,Yr(r)?Hm(r):(n=fv(g,u,l),r.stateNode=n,xi(r))}return Jt(r),null;case 5:if(xt(r),g=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==u&&xi(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Jt(r),null}if(m=nt.current,Yr(r))Hm(r);else{var S=Rc(dt.current);switch(m){case 1:m=S.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:m=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":m=S.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":m=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":m=S.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof u.is=="string"?S.createElement("select",{is:u.is}):S.createElement("select"),u.multiple?m.multiple=!0:u.size&&(m.size=u.size);break;default:m=typeof u.is=="string"?S.createElement(g,{is:u.is}):S.createElement(g)}}m[me]=r,m[Oe]=u;t:for(S=r.child;S!==null;){if(S.tag===5||S.tag===6)m.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===r)break t;for(;S.sibling===null;){if(S.return===null||S.return===r)break t;S=S.return}S.sibling.return=S.return,S=S.sibling}r.stateNode=m;t:switch(Ee(m,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break t;case"img":u=!0;break t;default:u=!1}u&&xi(r)}}return Jt(r),gd(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,l),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==u&&xi(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(n=dt.current,Yr(r)){if(n=r.stateNode,l=r.memoizedProps,u=null,g=we,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}n[me]=r,n=!!(n.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||ev(n.nodeValue,l)),n||Ji(r,!0)}else n=Rc(n).createTextNode(u),n[me]=r,r.stateNode=n}return Jt(r),null;case 31:if(l=r.memoizedState,n===null||n.memoizedState!==null){if(u=Yr(r),l!==null){if(n===null){if(!u)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[me]=r}else Xs(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Jt(r),n=!1}else l=Cf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=l),n=!0;if(!n)return r.flags&256?(sn(r),r):(sn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Jt(r),null;case 13:if(u=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(g=Yr(r),u!==null&&u.dehydrated!==null){if(n===null){if(!g)throw Error(i(318));if(g=r.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[me]=r}else Xs(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Jt(r),g=!1}else g=Cf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=g),g=!0;if(!g)return r.flags&256?(sn(r),r):(sn(r),null)}return sn(r),(r.flags&128)!==0?(r.lanes=l,r):(l=u!==null,n=n!==null&&n.memoizedState!==null,l&&(u=r.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),m=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),m!==g&&(u.flags|=2048)),l!==n&&l&&(r.child.flags|=8192),xc(r,r.updateQueue),Jt(r),null);case 4:return ot(),n===null&&Ld(r.stateNode.containerInfo),Jt(r),null;case 10:return pi(r.type),Jt(r),null;case 19:if(P(oe),u=r.memoizedState,u===null)return Jt(r),null;if(g=(r.flags&128)!==0,m=u.rendering,m===null)if(g)va(u,!1);else{if(re!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=oc(n),m!==null){for(r.flags|=128,va(u,!1),n=m.updateQueue,r.updateQueue=n,xc(r,n),r.subtreeFlags=0,n=l,l=r.child;l!==null;)Nm(l,n),l=l.sibling;return et(oe,oe.current&1|2),Rt&&di(r,u.treeForkCount),r.child}n=n.sibling}u.tail!==null&&_e()>Cc&&(r.flags|=128,g=!0,va(u,!1),r.lanes=4194304)}else{if(!g)if(n=oc(m),n!==null){if(r.flags|=128,g=!0,n=n.updateQueue,r.updateQueue=n,xc(r,n),va(u,!0),u.tail===null&&u.tailMode==="hidden"&&!m.alternate&&!Rt)return Jt(r),null}else 2*_e()-u.renderingStartTime>Cc&&l!==536870912&&(r.flags|=128,g=!0,va(u,!1),r.lanes=4194304);u.isBackwards?(m.sibling=r.child,r.child=m):(n=u.last,n!==null?n.sibling=m:r.child=m,u.last=m)}return u.tail!==null?(n=u.tail,u.rendering=n,u.tail=n.sibling,u.renderingStartTime=_e(),n.sibling=null,l=oe.current,et(oe,g?l&1|2:l&1),Rt&&di(r,u.treeForkCount),n):(Jt(r),null);case 22:case 23:return sn(r),Bf(),u=r.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(Jt(r),r.subtreeFlags&6&&(r.flags|=8192)):Jt(r),l=r.updateQueue,l!==null&&xc(r,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),n!==null&&P(Gs),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),pi(he),Jt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function $2(n,r){switch(_f(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return pi(he),ot(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return xt(r),null;case 31:if(r.memoizedState!==null){if(sn(r),r.alternate===null)throw Error(i(340));Xs()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(sn(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Xs()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return P(oe),null;case 4:return ot(),null;case 10:return pi(r.type),null;case 22:case 23:return sn(r),Bf(),n!==null&&P(Gs),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return pi(he),null;case 25:return null;default:return null}}function oy(n,r){switch(_f(r),r.tag){case 3:pi(he),ot();break;case 26:case 27:case 5:xt(r);break;case 4:ot();break;case 31:r.memoizedState!==null&&sn(r);break;case 13:sn(r);break;case 19:P(oe);break;case 10:pi(r.type);break;case 22:case 23:sn(r),Bf(),n!==null&&P(Gs);break;case 24:pi(he)}}function xa(n,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var g=u.next;l=g;do{if((l.tag&n)===n){u=void 0;var m=l.create,S=l.inst;u=m(),S.destroy=u}l=l.next}while(l!==g)}}catch(O){Ft(r,r.return,O)}}function os(n,r,l){try{var u=r.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var m=g.next;u=m;do{if((u.tag&n)===n){var S=u.inst,O=S.destroy;if(O!==void 0){S.destroy=void 0,g=r;var B=l,Q=O;try{Q()}catch(at){Ft(g,B,at)}}}u=u.next}while(u!==m)}}catch(at){Ft(r,r.return,at)}}function ay(n){var r=n.updateQueue;if(r!==null){var l=n.stateNode;try{Km(r,l)}catch(u){Ft(n,n.return,u)}}}function ly(n,r,l){l.props=Ks(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(u){Ft(n,r,u)}}function ba(n,r){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof l=="function"?n.refCleanup=l(u):l.current=u}}catch(g){Ft(n,r,g)}}function Gn(n,r){var l=n.ref,u=n.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(g){Ft(n,r,g)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){Ft(n,r,g)}else l.current=null}function cy(n){var r=n.type,l=n.memoizedProps,u=n.stateNode;try{t:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break t;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(g){Ft(n,n.return,g)}}function pd(n,r,l){try{var u=n.stateNode;pw(u,n.type,l,r),u[Oe]=r}catch(g){Ft(n,n.return,g)}}function uy(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&ds(n.type)||n.tag===4}function md(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||uy(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&ds(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function yd(n,r,l){var u=n.tag;if(u===5||u===6)n=n.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(n),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=ui));else if(u!==4&&(u===27&&ds(n.type)&&(l=n.stateNode,r=null),n=n.child,n!==null))for(yd(n,r,l),n=n.sibling;n!==null;)yd(n,r,l),n=n.sibling}function bc(n,r,l){var u=n.tag;if(u===5||u===6)n=n.stateNode,r?l.insertBefore(n,r):l.appendChild(n);else if(u!==4&&(u===27&&ds(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(bc(n,r,l),n=n.sibling;n!==null;)bc(n,r,l),n=n.sibling}function hy(n){var r=n.stateNode,l=n.memoizedProps;try{for(var u=n.type,g=r.attributes;g.length;)r.removeAttributeNode(g[0]);Ee(r,u,l),r[me]=n,r[Oe]=l}catch(m){Ft(n,n.return,m)}}var bi=!1,ge=!1,vd=!1,fy=typeof WeakSet=="function"?WeakSet:Set,be=null;function q2(n,r){if(n=n.containerInfo,Ud=Yc,n=Cm(n),hf(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else t:{l=(l=n.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var g=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{l.nodeType,m.nodeType}catch{l=null;break t}var S=0,O=-1,B=-1,Q=0,at=0,ct=n,J=null;e:for(;;){for(var it;ct!==l||g!==0&&ct.nodeType!==3||(O=S+g),ct!==m||u!==0&&ct.nodeType!==3||(B=S+u),ct.nodeType===3&&(S+=ct.nodeValue.length),(it=ct.firstChild)!==null;)J=ct,ct=it;for(;;){if(ct===n)break e;if(J===l&&++Q===g&&(O=S),J===m&&++at===u&&(B=S),(it=ct.nextSibling)!==null)break;ct=J,J=ct.parentNode}ct=it}l=O===-1||B===-1?null:{start:O,end:B}}else l=null}l=l||{start:0,end:0}}else l=null;for(Pd={focusedElem:n,selectionRange:l},Yc=!1,be=r;be!==null;)if(r=be,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,be=n;else for(;be!==null;){switch(r=be,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(l=0;l<n.length;l++)g=n[l],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,l=r,g=m.memoizedProps,m=m.memoizedState,u=l.stateNode;try{var yt=Ks(l.type,g);n=u.getSnapshotBeforeUpdate(yt,m),u.__reactInternalSnapshotBeforeUpdate=n}catch(wt){Ft(l,l.return,wt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,l=n.nodeType,l===9)Xd(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Xd(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,be=n;break}be=r.return}}function dy(n,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:_i(n,l),u&4&&xa(5,l);break;case 1:if(_i(n,l),u&4)if(n=l.stateNode,r===null)try{n.componentDidMount()}catch(S){Ft(l,l.return,S)}else{var g=Ks(l.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(g,r,n.__reactInternalSnapshotBeforeUpdate)}catch(S){Ft(l,l.return,S)}}u&64&&ay(l),u&512&&ba(l,l.return);break;case 3:if(_i(n,l),u&64&&(n=l.updateQueue,n!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Km(n,r)}catch(S){Ft(l,l.return,S)}}break;case 27:r===null&&u&4&&hy(l);case 26:case 5:_i(n,l),r===null&&u&4&&cy(l),u&512&&ba(l,l.return);break;case 12:_i(n,l);break;case 31:_i(n,l),u&4&&my(n,l);break;case 13:_i(n,l),u&4&&yy(n,l),u&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=iw.bind(null,l),ww(n,l))));break;case 22:if(u=l.memoizedState!==null||bi,!u){r=r!==null&&r.memoizedState!==null||ge,g=bi;var m=ge;bi=u,(ge=r)&&!m?wi(n,l,(l.subtreeFlags&8772)!==0):_i(n,l),bi=g,ge=m}break;case 30:break;default:_i(n,l)}}function gy(n){var r=n.alternate;r!==null&&(n.alternate=null,gy(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Go(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var te=null,Xe=!1;function Si(n,r,l){for(l=l.child;l!==null;)py(n,r,l),l=l.sibling}function py(n,r,l){if(Ne&&typeof Ne.onCommitFiberUnmount=="function")try{Ne.onCommitFiberUnmount(js,l)}catch{}switch(l.tag){case 26:ge||Gn(l,r),Si(n,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ge||Gn(l,r);var u=te,g=Xe;ds(l.type)&&(te=l.stateNode,Xe=!1),Si(n,r,l),Oa(l.stateNode),te=u,Xe=g;break;case 5:ge||Gn(l,r);case 6:if(u=te,g=Xe,te=null,Si(n,r,l),te=u,Xe=g,te!==null)if(Xe)try{(te.nodeType===9?te.body:te.nodeName==="HTML"?te.ownerDocument.body:te).removeChild(l.stateNode)}catch(m){Ft(l,r,m)}else try{te.removeChild(l.stateNode)}catch(m){Ft(l,r,m)}break;case 18:te!==null&&(Xe?(n=te,av(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),lo(n)):av(te,l.stateNode));break;case 4:u=te,g=Xe,te=l.stateNode.containerInfo,Xe=!0,Si(n,r,l),te=u,Xe=g;break;case 0:case 11:case 14:case 15:os(2,l,r),ge||os(4,l,r),Si(n,r,l);break;case 1:ge||(Gn(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&ly(l,r,u)),Si(n,r,l);break;case 21:Si(n,r,l);break;case 22:ge=(u=ge)||l.memoizedState!==null,Si(n,r,l),ge=u;break;default:Si(n,r,l)}}function my(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{lo(n)}catch(l){Ft(r,r.return,l)}}}function yy(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{lo(n)}catch(l){Ft(r,r.return,l)}}function W2(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new fy),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new fy),r;default:throw Error(i(435,n.tag))}}function Sc(n,r){var l=W2(n);r.forEach(function(u){if(!l.has(u)){l.add(u);var g=sw.bind(null,n,u);u.then(g,g)}})}function Fe(n,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var g=l[u],m=n,S=r,O=S;t:for(;O!==null;){switch(O.tag){case 27:if(ds(O.type)){te=O.stateNode,Xe=!1;break t}break;case 5:te=O.stateNode,Xe=!1;break t;case 3:case 4:te=O.stateNode.containerInfo,Xe=!0;break t}O=O.return}if(te===null)throw Error(i(160));py(m,S,g),te=null,Xe=!1,m=g.alternate,m!==null&&(m.return=null),g.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)vy(r,n),r=r.sibling}var On=null;function vy(n,r){var l=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Fe(r,n),Ie(n),u&4&&(os(3,n,n.return),xa(3,n),os(5,n,n.return));break;case 1:Fe(r,n),Ie(n),u&512&&(ge||l===null||Gn(l,l.return)),u&64&&bi&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var g=On;if(Fe(r,n),Ie(n),u&512&&(ge||l===null||Gn(l,l.return)),u&4){var m=l!==null?l.memoizedState:null;if(u=n.memoizedState,l===null)if(u===null)if(n.stateNode===null){t:{u=n.type,l=n.memoizedProps,g=g.ownerDocument||g;e:switch(u){case"title":m=g.getElementsByTagName("title")[0],(!m||m[zs]||m[me]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=g.createElement(u),g.head.insertBefore(m,g.querySelector("head > title"))),Ee(m,u,l),m[me]=n,ue(m),u=m;break t;case"link":var S=vv("link","href",g).get(u+(l.href||""));if(S){for(var O=0;O<S.length;O++)if(m=S[O],m.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&m.getAttribute("rel")===(l.rel==null?null:l.rel)&&m.getAttribute("title")===(l.title==null?null:l.title)&&m.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){S.splice(O,1);break e}}m=g.createElement(u),Ee(m,u,l),g.head.appendChild(m);break;case"meta":if(S=vv("meta","content",g).get(u+(l.content||""))){for(O=0;O<S.length;O++)if(m=S[O],m.getAttribute("content")===(l.content==null?null:""+l.content)&&m.getAttribute("name")===(l.name==null?null:l.name)&&m.getAttribute("property")===(l.property==null?null:l.property)&&m.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&m.getAttribute("charset")===(l.charSet==null?null:l.charSet)){S.splice(O,1);break e}}m=g.createElement(u),Ee(m,u,l),g.head.appendChild(m);break;default:throw Error(i(468,u))}m[me]=n,ue(m),u=m}n.stateNode=u}else xv(g,n.type,n.stateNode);else n.stateNode=yv(g,u,n.memoizedProps);else m!==u?(m===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):m.count--,u===null?xv(g,n.type,n.stateNode):yv(g,u,n.memoizedProps)):u===null&&n.stateNode!==null&&pd(n,n.memoizedProps,l.memoizedProps)}break;case 27:Fe(r,n),Ie(n),u&512&&(ge||l===null||Gn(l,l.return)),l!==null&&u&4&&pd(n,n.memoizedProps,l.memoizedProps);break;case 5:if(Fe(r,n),Ie(n),u&512&&(ge||l===null||Gn(l,l.return)),n.flags&32){g=n.stateNode;try{kr(g,"")}catch(yt){Ft(n,n.return,yt)}}u&4&&n.stateNode!=null&&(g=n.memoizedProps,pd(n,g,l!==null?l.memoizedProps:g)),u&1024&&(vd=!0);break;case 6:if(Fe(r,n),Ie(n),u&4){if(n.stateNode===null)throw Error(i(162));u=n.memoizedProps,l=n.stateNode;try{l.nodeValue=u}catch(yt){Ft(n,n.return,yt)}}break;case 3:if(Bc=null,g=On,On=zc(r.containerInfo),Fe(r,n),On=g,Ie(n),u&4&&l!==null&&l.memoizedState.isDehydrated)try{lo(r.containerInfo)}catch(yt){Ft(n,n.return,yt)}vd&&(vd=!1,xy(n));break;case 4:u=On,On=zc(n.stateNode.containerInfo),Fe(r,n),Ie(n),On=u;break;case 12:Fe(r,n),Ie(n);break;case 31:Fe(r,n),Ie(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Sc(n,u)));break;case 13:Fe(r,n),Ie(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(wc=_e()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Sc(n,u)));break;case 22:g=n.memoizedState!==null;var B=l!==null&&l.memoizedState!==null,Q=bi,at=ge;if(bi=Q||g,ge=at||B,Fe(r,n),ge=at,bi=Q,Ie(n),u&8192)t:for(r=n.stateNode,r._visibility=g?r._visibility&-2:r._visibility|1,g&&(l===null||B||bi||ge||Qs(n)),l=null,r=n;;){if(r.tag===5||r.tag===26){if(l===null){B=l=r;try{if(m=B.stateNode,g)S=m.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{O=B.stateNode;var ct=B.memoizedProps.style,J=ct!=null&&ct.hasOwnProperty("display")?ct.display:null;O.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(yt){Ft(B,B.return,yt)}}}else if(r.tag===6){if(l===null){B=r;try{B.stateNode.nodeValue=g?"":B.memoizedProps}catch(yt){Ft(B,B.return,yt)}}}else if(r.tag===18){if(l===null){B=r;try{var it=B.stateNode;g?lv(it,!0):lv(B.stateNode,!1)}catch(yt){Ft(B,B.return,yt)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break t;for(;r.sibling===null;){if(r.return===null||r.return===n)break t;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=n.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Sc(n,l))));break;case 19:Fe(r,n),Ie(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Sc(n,u)));break;case 30:break;case 21:break;default:Fe(r,n),Ie(n)}}function Ie(n){var r=n.flags;if(r&2){try{for(var l,u=n.return;u!==null;){if(uy(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var g=l.stateNode,m=md(n);bc(n,m,g);break;case 5:var S=l.stateNode;l.flags&32&&(kr(S,""),l.flags&=-33);var O=md(n);bc(n,O,S);break;case 3:case 4:var B=l.stateNode.containerInfo,Q=md(n);yd(n,Q,B);break;default:throw Error(i(161))}}catch(at){Ft(n,n.return,at)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function xy(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;xy(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function _i(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)dy(n,r.alternate,r),r=r.sibling}function Qs(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:os(4,r,r.return),Qs(r);break;case 1:Gn(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&ly(r,r.return,l),Qs(r);break;case 27:Oa(r.stateNode);case 26:case 5:Gn(r,r.return),Qs(r);break;case 22:r.memoizedState===null&&Qs(r);break;case 30:Qs(r);break;default:Qs(r)}n=n.sibling}}function wi(n,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,g=n,m=r,S=m.flags;switch(m.tag){case 0:case 11:case 15:wi(g,m,l),xa(4,m);break;case 1:if(wi(g,m,l),u=m,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(Q){Ft(u,u.return,Q)}if(u=m,g=u.updateQueue,g!==null){var O=u.stateNode;try{var B=g.shared.hiddenCallbacks;if(B!==null)for(g.shared.hiddenCallbacks=null,g=0;g<B.length;g++)Zm(B[g],O)}catch(Q){Ft(u,u.return,Q)}}l&&S&64&&ay(m),ba(m,m.return);break;case 27:hy(m);case 26:case 5:wi(g,m,l),l&&u===null&&S&4&&cy(m),ba(m,m.return);break;case 12:wi(g,m,l);break;case 31:wi(g,m,l),l&&S&4&&my(g,m);break;case 13:wi(g,m,l),l&&S&4&&yy(g,m);break;case 22:m.memoizedState===null&&wi(g,m,l),ba(m,m.return);break;case 30:break;default:wi(g,m,l)}r=r.sibling}}function xd(n,r){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&oa(l))}function bd(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&oa(n))}function An(n,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)by(n,r,l,u),r=r.sibling}function by(n,r,l,u){var g=r.flags;switch(r.tag){case 0:case 11:case 15:An(n,r,l,u),g&2048&&xa(9,r);break;case 1:An(n,r,l,u);break;case 3:An(n,r,l,u),g&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&oa(n)));break;case 12:if(g&2048){An(n,r,l,u),n=r.stateNode;try{var m=r.memoizedProps,S=m.id,O=m.onPostCommit;typeof O=="function"&&O(S,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(B){Ft(r,r.return,B)}}else An(n,r,l,u);break;case 31:An(n,r,l,u);break;case 13:An(n,r,l,u);break;case 23:break;case 22:m=r.stateNode,S=r.alternate,r.memoizedState!==null?m._visibility&2?An(n,r,l,u):Sa(n,r):m._visibility&2?An(n,r,l,u):(m._visibility|=2,Kr(n,r,l,u,(r.subtreeFlags&10256)!==0||!1)),g&2048&&xd(S,r);break;case 24:An(n,r,l,u),g&2048&&bd(r.alternate,r);break;default:An(n,r,l,u)}}function Kr(n,r,l,u,g){for(g=g&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,S=r,O=l,B=u,Q=S.flags;switch(S.tag){case 0:case 11:case 15:Kr(m,S,O,B,g),xa(8,S);break;case 23:break;case 22:var at=S.stateNode;S.memoizedState!==null?at._visibility&2?Kr(m,S,O,B,g):Sa(m,S):(at._visibility|=2,Kr(m,S,O,B,g)),g&&Q&2048&&xd(S.alternate,S);break;case 24:Kr(m,S,O,B,g),g&&Q&2048&&bd(S.alternate,S);break;default:Kr(m,S,O,B,g)}r=r.sibling}}function Sa(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=n,u=r,g=u.flags;switch(u.tag){case 22:Sa(l,u),g&2048&&xd(u.alternate,u);break;case 24:Sa(l,u),g&2048&&bd(u.alternate,u);break;default:Sa(l,u)}r=r.sibling}}var _a=8192;function Qr(n,r,l){if(n.subtreeFlags&_a)for(n=n.child;n!==null;)Sy(n,r,l),n=n.sibling}function Sy(n,r,l){switch(n.tag){case 26:Qr(n,r,l),n.flags&_a&&n.memoizedState!==null&&zw(l,On,n.memoizedState,n.memoizedProps);break;case 5:Qr(n,r,l);break;case 3:case 4:var u=On;On=zc(n.stateNode.containerInfo),Qr(n,r,l),On=u;break;case 22:n.memoizedState===null&&(u=n.alternate,u!==null&&u.memoizedState!==null?(u=_a,_a=16777216,Qr(n,r,l),_a=u):Qr(n,r,l));break;default:Qr(n,r,l)}}function _y(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function wa(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];be=u,Cy(u,n)}_y(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)wy(n),n=n.sibling}function wy(n){switch(n.tag){case 0:case 11:case 15:wa(n),n.flags&2048&&os(9,n,n.return);break;case 3:wa(n);break;case 12:wa(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,_c(n)):wa(n);break;default:wa(n)}}function _c(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];be=u,Cy(u,n)}_y(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:os(8,r,r.return),_c(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,_c(r));break;default:_c(r)}n=n.sibling}}function Cy(n,r){for(;be!==null;){var l=be;switch(l.tag){case 0:case 11:case 15:os(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:oa(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,be=u;else t:for(l=n;be!==null;){u=be;var g=u.sibling,m=u.return;if(gy(u),u===l){be=null;break t}if(g!==null){g.return=m,be=g;break t}be=m}}}var Z2={getCacheForType:function(n){var r=Ce(he),l=r.data.get(n);return l===void 0&&(l=n(),r.data.set(n,l)),l},cacheSignal:function(){return Ce(he).controller.signal}},K2=typeof WeakMap=="function"?WeakMap:Map,Pt=0,Zt=null,At=null,jt=0,Xt=0,rn=null,as=!1,Jr=!1,Sd=!1,Ci=0,re=0,ls=0,Js=0,_d=0,on=0,to=0,Ca=null,Ge=null,wd=!1,wc=0,Ty=0,Cc=1/0,Tc=null,cs=null,ye=0,us=null,eo=null,Ti=0,Cd=0,Td=null,Ey=null,Ta=0,Ed=null;function an(){return(Pt&2)!==0&&jt!==0?jt&-jt:A.T!==null?jd():Ol()}function My(){if(on===0)if((jt&536870912)===0||Rt){var n=Cr;Cr<<=1,(Cr&3932160)===0&&(Cr=262144),on=n}else on=536870912;return n=nn.current,n!==null&&(n.flags|=32),on}function $e(n,r,l){(n===Zt&&(Xt===2||Xt===9)||n.cancelPendingCommit!==null)&&(no(n,0),hs(n,jt,on,!1)),Rs(n,l),((Pt&2)===0||n!==Zt)&&(n===Zt&&((Pt&2)===0&&(Js|=l),re===4&&hs(n,jt,on,!1)),$n(n))}function Dy(n,r,l){if((Pt&6)!==0)throw Error(i(327));var u=!l&&(r&127)===0&&(r&n.expiredLanes)===0||Ns(n,r),g=u?tw(n,r):Dd(n,r,!0),m=u;do{if(g===0){Jr&&!u&&hs(n,r,0,!1);break}else{if(l=n.current.alternate,m&&!Q2(l)){g=Dd(n,r,!1),m=!1;continue}if(g===2){if(m=r,n.errorRecoveryDisabledLanes&m)var S=0;else S=n.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){r=S;t:{var O=n;g=Ca;var B=O.current.memoizedState.isDehydrated;if(B&&(no(O,S).flags|=256),S=Dd(O,S,!1),S!==2){if(Sd&&!B){O.errorRecoveryDisabledLanes|=m,Js|=m,g=4;break t}m=Ge,Ge=g,m!==null&&(Ge===null?Ge=m:Ge.push.apply(Ge,m))}g=S}if(m=!1,g!==2)continue}}if(g===1){no(n,0),hs(n,r,0,!0);break}t:{switch(u=n,m=g,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:hs(u,r,on,!as);break t;case 2:Ge=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(g=wc+300-_e(),10<g)){if(hs(u,r,on,!as),Er(u,0,!0)!==0)break t;Ti=r,u.timeoutHandle=rv(Oy.bind(null,u,l,Ge,Tc,wd,r,on,Js,to,as,m,"Throttled",-0,0),g);break t}Oy(u,l,Ge,Tc,wd,r,on,Js,to,as,m,null,-0,0)}}break}while(!0);$n(n)}function Oy(n,r,l,u,g,m,S,O,B,Q,at,ct,J,it){if(n.timeoutHandle=-1,ct=r.subtreeFlags,ct&8192||(ct&16785408)===16785408){ct={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ui},Sy(r,m,ct);var yt=(m&62914560)===m?wc-_e():(m&4194048)===m?Ty-_e():0;if(yt=Lw(ct,yt),yt!==null){Ti=m,n.cancelPendingCommit=yt(By.bind(null,n,r,m,l,u,g,S,O,B,at,ct,null,J,it)),hs(n,m,S,!Q);return}}By(n,r,m,l,u,g,S,O,B)}function Q2(n){for(var r=n;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var g=l[u],m=g.getSnapshot;g=g.value;try{if(!tn(m(),g))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function hs(n,r,l,u){r&=~_d,r&=~Js,n.suspendedLanes|=r,n.pingedLanes&=~r,u&&(n.warmLanes|=r),u=n.expirationTimes;for(var g=r;0<g;){var m=31-Re(g),S=1<<m;u[m]=-1,g&=~S}l!==0&&El(n,l,r)}function Ec(){return(Pt&6)===0?(Ea(0),!1):!0}function Md(){if(At!==null){if(Xt===0)var n=At.return;else n=At,gi=Fs=null,Xf(n),Gr=null,la=0,n=At;for(;n!==null;)oy(n.alternate,n),n=n.return;At=null}}function no(n,r){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,vw(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),Ti=0,Md(),Zt=n,At=l=fi(n.current,null),jt=r,Xt=0,rn=null,as=!1,Jr=Ns(n,r),Sd=!1,to=on=_d=Js=ls=re=0,Ge=Ca=null,wd=!1,(r&8)!==0&&(r|=r&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=r;0<u;){var g=31-Re(u),m=1<<g;r|=n[g],u&=~m}return Ci=r,$l(),l}function Ay(n,r){Tt=null,A.H=ma,r===Ir||r===ec?(r=Gm(),Xt=3):r===kf?(r=Gm(),Xt=4):Xt=r===rd?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,rn=r,At===null&&(re=1,pc(n,dn(r,n.current)))}function ky(){var n=nn.current;return n===null?!0:(jt&4194048)===jt?yn===null:(jt&62914560)===jt||(jt&536870912)!==0?n===yn:!1}function jy(){var n=A.H;return A.H=ma,n===null?ma:n}function Ny(){var n=A.A;return A.A=Z2,n}function Mc(){re=4,as||(jt&4194048)!==jt&&nn.current!==null||(Jr=!0),(ls&134217727)===0&&(Js&134217727)===0||Zt===null||hs(Zt,jt,on,!1)}function Dd(n,r,l){var u=Pt;Pt|=2;var g=jy(),m=Ny();(Zt!==n||jt!==r)&&(Tc=null,no(n,r)),r=!1;var S=re;t:do try{if(Xt!==0&&At!==null){var O=At,B=rn;switch(Xt){case 8:Md(),S=6;break t;case 3:case 2:case 9:case 6:nn.current===null&&(r=!0);var Q=Xt;if(Xt=0,rn=null,io(n,O,B,Q),l&&Jr){S=0;break t}break;default:Q=Xt,Xt=0,rn=null,io(n,O,B,Q)}}J2(),S=re;break}catch(at){Ay(n,at)}while(!0);return r&&n.shellSuspendCounter++,gi=Fs=null,Pt=u,A.H=g,A.A=m,At===null&&(Zt=null,jt=0,$l()),S}function J2(){for(;At!==null;)Ry(At)}function tw(n,r){var l=Pt;Pt|=2;var u=jy(),g=Ny();Zt!==n||jt!==r?(Tc=null,Cc=_e()+500,no(n,r)):Jr=Ns(n,r);t:do try{if(Xt!==0&&At!==null){r=At;var m=rn;e:switch(Xt){case 1:Xt=0,rn=null,io(n,r,m,1);break;case 2:case 9:if(Fm(m)){Xt=0,rn=null,zy(r);break}r=function(){Xt!==2&&Xt!==9||Zt!==n||(Xt=7),$n(n)},m.then(r,r);break t;case 3:Xt=7;break t;case 4:Xt=5;break t;case 7:Fm(m)?(Xt=0,rn=null,zy(r)):(Xt=0,rn=null,io(n,r,m,7));break;case 5:var S=null;switch(At.tag){case 26:S=At.memoizedState;case 5:case 27:var O=At;if(S?bv(S):O.stateNode.complete){Xt=0,rn=null;var B=O.sibling;if(B!==null)At=B;else{var Q=O.return;Q!==null?(At=Q,Dc(Q)):At=null}break e}}Xt=0,rn=null,io(n,r,m,5);break;case 6:Xt=0,rn=null,io(n,r,m,6);break;case 8:Md(),re=6;break t;default:throw Error(i(462))}}ew();break}catch(at){Ay(n,at)}while(!0);return gi=Fs=null,A.H=u,A.A=g,Pt=l,At!==null?0:(Zt=null,jt=0,$l(),re)}function ew(){for(;At!==null&&!Os();)Ry(At)}function Ry(n){var r=sy(n.alternate,n,Ci);n.memoizedProps=n.pendingProps,r===null?Dc(n):At=r}function zy(n){var r=n,l=r.alternate;switch(r.tag){case 15:case 0:r=Q0(l,r,r.pendingProps,r.type,void 0,jt);break;case 11:r=Q0(l,r,r.pendingProps,r.type.render,r.ref,jt);break;case 5:Xf(r);default:oy(l,r),r=At=Nm(r,Ci),r=sy(l,r,Ci)}n.memoizedProps=n.pendingProps,r===null?Dc(n):At=r}function io(n,r,l,u){gi=Fs=null,Xf(r),Gr=null,la=0;var g=r.return;try{if(X2(n,g,r,l,jt)){re=1,pc(n,dn(l,n.current)),At=null;return}}catch(m){if(g!==null)throw At=g,m;re=1,pc(n,dn(l,n.current)),At=null;return}r.flags&32768?(Rt||u===1?n=!0:Jr||(jt&536870912)!==0?n=!1:(as=n=!0,(u===2||u===9||u===3||u===6)&&(u=nn.current,u!==null&&u.tag===13&&(u.flags|=16384))),Ly(r,n)):Dc(r)}function Dc(n){var r=n;do{if((r.flags&32768)!==0){Ly(r,as);return}n=r.return;var l=G2(r.alternate,r,Ci);if(l!==null){At=l;return}if(r=r.sibling,r!==null){At=r;return}At=r=n}while(r!==null);re===0&&(re=5)}function Ly(n,r){do{var l=$2(n.alternate,n);if(l!==null){l.flags&=32767,At=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(n=n.sibling,n!==null)){At=n;return}At=n=l}while(n!==null);re=6,At=null}function By(n,r,l,u,g,m,S,O,B){n.cancelPendingCommit=null;do Oc();while(ye!==0);if((Pt&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=mf,Ih(n,l,m,S,O,B),n===Zt&&(At=Zt=null,jt=0),eo=r,us=n,Ti=l,Cd=m,Td=g,Ey=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,rw(ks,function(){return Vy(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=A.T,A.T=null,g=L.p,L.p=2,S=Pt,Pt|=4;try{q2(n,r,l)}finally{Pt=S,L.p=g,A.T=u}}ye=1,Hy(),Uy(),Py()}}function Hy(){if(ye===1){ye=0;var n=us,r=eo,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=A.T,A.T=null;var u=L.p;L.p=2;var g=Pt;Pt|=4;try{vy(r,n);var m=Pd,S=Cm(n.containerInfo),O=m.focusedElem,B=m.selectionRange;if(S!==O&&O&&O.ownerDocument&&wm(O.ownerDocument.documentElement,O)){if(B!==null&&hf(O)){var Q=B.start,at=B.end;if(at===void 0&&(at=Q),"selectionStart"in O)O.selectionStart=Q,O.selectionEnd=Math.min(at,O.value.length);else{var ct=O.ownerDocument||document,J=ct&&ct.defaultView||window;if(J.getSelection){var it=J.getSelection(),yt=O.textContent.length,wt=Math.min(B.start,yt),qt=B.end===void 0?wt:Math.min(B.end,yt);!it.extend&&wt>qt&&(S=qt,qt=wt,wt=S);var $=_m(O,wt),F=_m(O,qt);if($&&F&&(it.rangeCount!==1||it.anchorNode!==$.node||it.anchorOffset!==$.offset||it.focusNode!==F.node||it.focusOffset!==F.offset)){var K=ct.createRange();K.setStart($.node,$.offset),it.removeAllRanges(),wt>qt?(it.addRange(K),it.extend(F.node,F.offset)):(K.setEnd(F.node,F.offset),it.addRange(K))}}}}for(ct=[],it=O;it=it.parentNode;)it.nodeType===1&&ct.push({element:it,left:it.scrollLeft,top:it.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<ct.length;O++){var lt=ct[O];lt.element.scrollLeft=lt.left,lt.element.scrollTop=lt.top}}Yc=!!Ud,Pd=Ud=null}finally{Pt=g,L.p=u,A.T=l}}n.current=r,ye=2}}function Uy(){if(ye===2){ye=0;var n=us,r=eo,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=A.T,A.T=null;var u=L.p;L.p=2;var g=Pt;Pt|=4;try{dy(n,r.alternate,r)}finally{Pt=g,L.p=u,A.T=l}}ye=3}}function Py(){if(ye===4||ye===3){ye=0,As();var n=us,r=eo,l=Ti,u=Ey;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?ye=5:(ye=0,eo=us=null,Yy(n,n.pendingLanes));var g=n.pendingLanes;if(g===0&&(cs=null),Io(l),r=r.stateNode,Ne&&typeof Ne.onCommitFiberRoot=="function")try{Ne.onCommitFiberRoot(js,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=A.T,g=L.p,L.p=2,A.T=null;try{for(var m=n.onRecoverableError,S=0;S<u.length;S++){var O=u[S];m(O.value,{componentStack:O.stack})}}finally{A.T=r,L.p=g}}(Ti&3)!==0&&Oc(),$n(n),g=n.pendingLanes,(l&261930)!==0&&(g&42)!==0?n===Ed?Ta++:(Ta=0,Ed=n):Ta=0,Ea(0)}}function Yy(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,oa(r)))}function Oc(){return Hy(),Uy(),Py(),Vy()}function Vy(){if(ye!==5)return!1;var n=us,r=Cd;Cd=0;var l=Io(Ti),u=A.T,g=L.p;try{L.p=32>l?32:l,A.T=null,l=Td,Td=null;var m=us,S=Ti;if(ye=0,eo=us=null,Ti=0,(Pt&6)!==0)throw Error(i(331));var O=Pt;if(Pt|=4,wy(m.current),by(m,m.current,S,l),Pt=O,Ea(0,!1),Ne&&typeof Ne.onPostCommitFiberRoot=="function")try{Ne.onPostCommitFiberRoot(js,m)}catch{}return!0}finally{L.p=g,A.T=u,Yy(n,r)}}function Xy(n,r,l){r=dn(l,r),r=sd(n.stateNode,r,2),n=is(n,r,2),n!==null&&(Rs(n,2),$n(n))}function Ft(n,r,l){if(n.tag===3)Xy(n,n,l);else for(;r!==null;){if(r.tag===3){Xy(r,n,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(cs===null||!cs.has(u))){n=dn(l,n),l=F0(2),u=is(r,l,2),u!==null&&(I0(l,u,r,n),Rs(u,2),$n(u));break}}r=r.return}}function Od(n,r,l){var u=n.pingCache;if(u===null){u=n.pingCache=new K2;var g=new Set;u.set(r,g)}else g=u.get(r),g===void 0&&(g=new Set,u.set(r,g));g.has(l)||(Sd=!0,g.add(l),n=nw.bind(null,n,r,l),r.then(n,n))}function nw(n,r,l){var u=n.pingCache;u!==null&&u.delete(r),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,Zt===n&&(jt&l)===l&&(re===4||re===3&&(jt&62914560)===jt&&300>_e()-wc?(Pt&2)===0&&no(n,0):_d|=l,to===jt&&(to=0)),$n(n)}function Fy(n,r){r===0&&(r=Tl()),n=Ys(n,r),n!==null&&(Rs(n,r),$n(n))}function iw(n){var r=n.memoizedState,l=0;r!==null&&(l=r.retryLane),Fy(n,l)}function sw(n,r){var l=0;switch(n.tag){case 31:case 13:var u=n.stateNode,g=n.memoizedState;g!==null&&(l=g.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),Fy(n,l)}function rw(n,r){return En(n,r)}var Ac=null,so=null,Ad=!1,kc=!1,kd=!1,fs=0;function $n(n){n!==so&&n.next===null&&(so===null?Ac=so=n:so=so.next=n),kc=!0,Ad||(Ad=!0,aw())}function Ea(n,r){if(!kd&&kc){kd=!0;do for(var l=!1,u=Ac;u!==null;){if(n!==0){var g=u.pendingLanes;if(g===0)var m=0;else{var S=u.suspendedLanes,O=u.pingedLanes;m=(1<<31-Re(42|n)+1)-1,m&=g&~(S&~O),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(l=!0,qy(u,m))}else m=jt,m=Er(u,u===Zt?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(m&3)===0||Ns(u,m)||(l=!0,qy(u,m));u=u.next}while(l);kd=!1}}function ow(){Iy()}function Iy(){kc=Ad=!1;var n=0;fs!==0&&yw()&&(n=fs);for(var r=_e(),l=null,u=Ac;u!==null;){var g=u.next,m=Gy(u,r);m===0?(u.next=null,l===null?Ac=g:l.next=g,g===null&&(so=l)):(l=u,(n!==0||(m&3)!==0)&&(kc=!0)),u=g}ye!==0&&ye!==5||Ea(n),fs!==0&&(fs=0)}function Gy(n,r){for(var l=n.suspendedLanes,u=n.pingedLanes,g=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var S=31-Re(m),O=1<<S,B=g[S];B===-1?((O&l)===0||(O&u)!==0)&&(g[S]=Fh(O,r)):B<=r&&(n.expiredLanes|=O),m&=~O}if(r=Zt,l=jt,l=Er(n,n===r?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,l===0||n===r&&(Xt===2||Xt===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&si(u),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||Ns(n,l)){if(r=l&-l,r===n.callbackPriority)return r;switch(u!==null&&si(u),Io(l)){case 2:case 8:l=Fi;break;case 32:l=ks;break;case 268435456:l=_r;break;default:l=ks}return u=$y.bind(null,n),l=En(l,u),n.callbackPriority=r,n.callbackNode=l,r}return u!==null&&u!==null&&si(u),n.callbackPriority=2,n.callbackNode=null,2}function $y(n,r){if(ye!==0&&ye!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(Oc()&&n.callbackNode!==l)return null;var u=jt;return u=Er(n,n===Zt?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:(Dy(n,u,r),Gy(n,_e()),n.callbackNode!=null&&n.callbackNode===l?$y.bind(null,n):null)}function qy(n,r){if(Oc())return null;Dy(n,r,!0)}function aw(){xw(function(){(Pt&6)!==0?En(ri,ow):Iy()})}function jd(){if(fs===0){var n=Xr;n===0&&(n=wr,wr<<=1,(wr&261888)===0&&(wr=256)),fs=n}return fs}function Wy(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Ul(""+n)}function Zy(n,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,n.id&&l.setAttribute("form",n.id),r.parentNode.insertBefore(l,r),n=new FormData(n),l.parentNode.removeChild(l),n}function lw(n,r,l,u,g){if(r==="submit"&&l&&l.stateNode===g){var m=Wy((g[Oe]||null).action),S=u.submitter;S&&(r=(r=S[Oe]||null)?Wy(r.formAction):S.getAttribute("formAction"),r!==null&&(m=r,S=null));var O=new Xl("action","action",null,u,g);n.push({event:O,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(fs!==0){var B=S?Zy(g,S):new FormData(g);Qf(l,{pending:!0,data:B,method:g.method,action:m},null,B)}}else typeof m=="function"&&(O.preventDefault(),B=S?Zy(g,S):new FormData(g),Qf(l,{pending:!0,data:B,method:g.method,action:m},m,B))},currentTarget:g}]})}}for(var Nd=0;Nd<pf.length;Nd++){var Rd=pf[Nd],cw=Rd.toLowerCase(),uw=Rd[0].toUpperCase()+Rd.slice(1);Dn(cw,"on"+uw)}Dn(Mm,"onAnimationEnd"),Dn(Dm,"onAnimationIteration"),Dn(Om,"onAnimationStart"),Dn("dblclick","onDoubleClick"),Dn("focusin","onFocus"),Dn("focusout","onBlur"),Dn(E2,"onTransitionRun"),Dn(M2,"onTransitionStart"),Dn(D2,"onTransitionCancel"),Dn(Am,"onTransitionEnd"),Wi("onMouseEnter",["mouseout","mouseover"]),Wi("onMouseLeave",["mouseout","mouseover"]),Wi("onPointerEnter",["pointerout","pointerover"]),Wi("onPointerLeave",["pointerout","pointerover"]),li("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),li("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),li("onBeforeInput",["compositionend","keypress","textInput","paste"]),li("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),li("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),li("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ma));function Ky(n,r){r=(r&4)!==0;for(var l=0;l<n.length;l++){var u=n[l],g=u.event;u=u.listeners;t:{var m=void 0;if(r)for(var S=u.length-1;0<=S;S--){var O=u[S],B=O.instance,Q=O.currentTarget;if(O=O.listener,B!==m&&g.isPropagationStopped())break t;m=O,g.currentTarget=Q;try{m(g)}catch(at){Gl(at)}g.currentTarget=null,m=B}else for(S=0;S<u.length;S++){if(O=u[S],B=O.instance,Q=O.currentTarget,O=O.listener,B!==m&&g.isPropagationStopped())break t;m=O,g.currentTarget=Q;try{m(g)}catch(at){Gl(at)}g.currentTarget=null,m=B}}}}function kt(n,r){var l=r[Mr];l===void 0&&(l=r[Mr]=new Set);var u=n+"__bubble";l.has(u)||(Qy(r,n,2,!1),l.add(u))}function zd(n,r,l){var u=0;r&&(u|=4),Qy(l,n,u,r)}var jc="_reactListening"+Math.random().toString(36).slice(2);function Ld(n){if(!n[jc]){n[jc]=!0,Nl.forEach(function(l){l!=="selectionchange"&&(hw.has(l)||zd(l,!1,n),zd(l,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[jc]||(r[jc]=!0,zd("selectionchange",!1,r))}}function Qy(n,r,l,u){switch(Mv(r)){case 2:var g=Uw;break;case 8:g=Pw;break;default:g=Kd}l=g.bind(null,r,l,n),g=void 0,!ef||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(g=!0),u?g!==void 0?n.addEventListener(r,l,{capture:!0,passive:g}):n.addEventListener(r,l,!0):g!==void 0?n.addEventListener(r,l,{passive:g}):n.addEventListener(r,l,!1)}function Bd(n,r,l,u,g){var m=u;if((r&1)===0&&(r&2)===0&&u!==null)t:for(;;){if(u===null)return;var S=u.tag;if(S===3||S===4){var O=u.stateNode.containerInfo;if(O===g)break;if(S===4)for(S=u.return;S!==null;){var B=S.tag;if((B===3||B===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;O!==null;){if(S=Ii(O),S===null)return;if(B=S.tag,B===5||B===6||B===26||B===27){u=m=S;continue t}O=O.parentNode}}u=u.return}im(function(){var Q=m,at=Jh(l),ct=[];t:{var J=km.get(n);if(J!==void 0){var it=Xl,yt=n;switch(n){case"keypress":if(Yl(l)===0)break t;case"keydown":case"keyup":it=s2;break;case"focusin":yt="focus",it=of;break;case"focusout":yt="blur",it=of;break;case"beforeblur":case"afterblur":it=of;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":it=om;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":it=G_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":it=a2;break;case Mm:case Dm:case Om:it=W_;break;case Am:it=c2;break;case"scroll":case"scrollend":it=F_;break;case"wheel":it=h2;break;case"copy":case"cut":case"paste":it=K_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":it=lm;break;case"toggle":case"beforetoggle":it=d2}var wt=(r&4)!==0,qt=!wt&&(n==="scroll"||n==="scrollend"),$=wt?J!==null?J+"Capture":null:J;wt=[];for(var F=Q,K;F!==null;){var lt=F;if(K=lt.stateNode,lt=lt.tag,lt!==5&&lt!==26&&lt!==27||K===null||$===null||(lt=Wo(F,$),lt!=null&&wt.push(Da(F,lt,K))),qt)break;F=F.return}0<wt.length&&(J=new it(J,yt,null,l,at),ct.push({event:J,listeners:wt}))}}if((r&7)===0){t:{if(J=n==="mouseover"||n==="pointerover",it=n==="mouseout"||n==="pointerout",J&&l!==Qh&&(yt=l.relatedTarget||l.fromElement)&&(Ii(yt)||yt[ai]))break t;if((it||J)&&(J=at.window===at?at:(J=at.ownerDocument)?J.defaultView||J.parentWindow:window,it?(yt=l.relatedTarget||l.toElement,it=Q,yt=yt?Ii(yt):null,yt!==null&&(qt=a(yt),wt=yt.tag,yt!==qt||wt!==5&&wt!==27&&wt!==6)&&(yt=null)):(it=null,yt=Q),it!==yt)){if(wt=om,lt="onMouseLeave",$="onMouseEnter",F="mouse",(n==="pointerout"||n==="pointerover")&&(wt=lm,lt="onPointerLeave",$="onPointerEnter",F="pointer"),qt=it==null?J:$i(it),K=yt==null?J:$i(yt),J=new wt(lt,F+"leave",it,l,at),J.target=qt,J.relatedTarget=K,lt=null,Ii(at)===Q&&(wt=new wt($,F+"enter",yt,l,at),wt.target=K,wt.relatedTarget=qt,lt=wt),qt=lt,it&&yt)e:{for(wt=fw,$=it,F=yt,K=0,lt=$;lt;lt=wt(lt))K++;lt=0;for(var St=F;St;St=wt(St))lt++;for(;0<K-lt;)$=wt($),K--;for(;0<lt-K;)F=wt(F),lt--;for(;K--;){if($===F||F!==null&&$===F.alternate){wt=$;break e}$=wt($),F=wt(F)}wt=null}else wt=null;it!==null&&Jy(ct,J,it,wt,!1),yt!==null&&qt!==null&&Jy(ct,qt,yt,wt,!0)}}t:{if(J=Q?$i(Q):window,it=J.nodeName&&J.nodeName.toLowerCase(),it==="select"||it==="input"&&J.type==="file")var Ht=mm;else if(gm(J))if(ym)Ht=w2;else{Ht=S2;var vt=b2}else it=J.nodeName,!it||it.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?Q&&Kh(Q.elementType)&&(Ht=mm):Ht=_2;if(Ht&&(Ht=Ht(n,Q))){pm(ct,Ht,l,at);break t}vt&&vt(n,J,Q),n==="focusout"&&Q&&J.type==="number"&&Q.memoizedProps.value!=null&&qo(J,"number",J.value)}switch(vt=Q?$i(Q):window,n){case"focusin":(gm(vt)||vt.contentEditable==="true")&&(zr=vt,ff=Q,ia=null);break;case"focusout":ia=ff=zr=null;break;case"mousedown":df=!0;break;case"contextmenu":case"mouseup":case"dragend":df=!1,Tm(ct,l,at);break;case"selectionchange":if(T2)break;case"keydown":case"keyup":Tm(ct,l,at)}var Et;if(lf)t:{switch(n){case"compositionstart":var Nt="onCompositionStart";break t;case"compositionend":Nt="onCompositionEnd";break t;case"compositionupdate":Nt="onCompositionUpdate";break t}Nt=void 0}else Rr?fm(n,l)&&(Nt="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(Nt="onCompositionStart");Nt&&(cm&&l.locale!=="ko"&&(Rr||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&Rr&&(Et=sm()):(Zi=at,nf="value"in Zi?Zi.value:Zi.textContent,Rr=!0)),vt=Nc(Q,Nt),0<vt.length&&(Nt=new am(Nt,n,null,l,at),ct.push({event:Nt,listeners:vt}),Et?Nt.data=Et:(Et=dm(l),Et!==null&&(Nt.data=Et)))),(Et=p2?m2(n,l):y2(n,l))&&(Nt=Nc(Q,"onBeforeInput"),0<Nt.length&&(vt=new am("onBeforeInput","beforeinput",null,l,at),ct.push({event:vt,listeners:Nt}),vt.data=Et)),lw(ct,n,Q,l,at)}Ky(ct,r)})}function Da(n,r,l){return{instance:n,listener:r,currentTarget:l}}function Nc(n,r){for(var l=r+"Capture",u=[];n!==null;){var g=n,m=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||m===null||(g=Wo(n,l),g!=null&&u.unshift(Da(n,g,m)),g=Wo(n,r),g!=null&&u.push(Da(n,g,m))),n.tag===3)return u;n=n.return}return[]}function fw(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Jy(n,r,l,u,g){for(var m=r._reactName,S=[];l!==null&&l!==u;){var O=l,B=O.alternate,Q=O.stateNode;if(O=O.tag,B!==null&&B===u)break;O!==5&&O!==26&&O!==27||Q===null||(B=Q,g?(Q=Wo(l,m),Q!=null&&S.unshift(Da(l,Q,B))):g||(Q=Wo(l,m),Q!=null&&S.push(Da(l,Q,B)))),l=l.return}S.length!==0&&n.push({event:r,listeners:S})}var dw=/\r\n?/g,gw=/\u0000|\uFFFD/g;function tv(n){return(typeof n=="string"?n:""+n).replace(dw,`
`).replace(gw,"")}function ev(n,r){return r=tv(r),tv(n)===r}function $t(n,r,l,u,g,m){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||kr(n,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&kr(n,""+u);break;case"className":Or(n,"class",u);break;case"tabIndex":Or(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Or(n,l,u);break;case"style":em(n,u,m);break;case"data":if(r!=="object"){Or(n,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){n.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(l);break}u=Ul(""+u),n.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(l==="formAction"?(r!=="input"&&$t(n,r,"name",g.name,g,null),$t(n,r,"formEncType",g.formEncType,g,null),$t(n,r,"formMethod",g.formMethod,g,null),$t(n,r,"formTarget",g.formTarget,g,null)):($t(n,r,"encType",g.encType,g,null),$t(n,r,"method",g.method,g,null),$t(n,r,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(l);break}u=Ul(""+u),n.setAttribute(l,u);break;case"onClick":u!=null&&(n.onclick=ui);break;case"onScroll":u!=null&&kt("scroll",n);break;case"onScrollEnd":u!=null&&kt("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}l=Ul(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,""+u):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":u===!0?n.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,u):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(l,u):n.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(l):n.setAttribute(l,u);break;case"popover":kt("beforetoggle",n),kt("toggle",n),Dr(n,"popover",u);break;case"xlinkActuate":Mn(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Mn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Mn(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Mn(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Mn(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Mn(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Mn(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Mn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Mn(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Dr(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=V_.get(l)||l,Dr(n,l,u))}}function Hd(n,r,l,u,g,m){switch(l){case"style":em(n,u,m);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"children":typeof u=="string"?kr(n,u):(typeof u=="number"||typeof u=="bigint")&&kr(n,""+u);break;case"onScroll":u!=null&&kt("scroll",n);break;case"onScrollEnd":u!=null&&kt("scrollend",n);break;case"onClick":u!=null&&(n.onclick=ui);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Rl.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),r=l.slice(2,g?l.length-7:void 0),m=n[Oe]||null,m=m!=null?m[l]:null,typeof m=="function"&&n.removeEventListener(r,m,g),typeof u=="function")){typeof m!="function"&&m!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(r,u,g);break t}l in n?n[l]=u:u===!0?n.setAttribute(l,""):Dr(n,l,u)}}}function Ee(n,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kt("error",n),kt("load",n);var u=!1,g=!1,m;for(m in l)if(l.hasOwnProperty(m)){var S=l[m];if(S!=null)switch(m){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:$t(n,r,m,S,l,null)}}g&&$t(n,r,"srcSet",l.srcSet,l,null),u&&$t(n,r,"src",l.src,l,null);return;case"input":kt("invalid",n);var O=m=S=g=null,B=null,Q=null;for(u in l)if(l.hasOwnProperty(u)){var at=l[u];if(at!=null)switch(u){case"name":g=at;break;case"type":S=at;break;case"checked":B=at;break;case"defaultChecked":Q=at;break;case"value":m=at;break;case"defaultValue":O=at;break;case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(i(137,r));break;default:$t(n,r,u,at,l,null)}}Hl(n,m,O,B,Q,S,g,!1);return;case"select":kt("invalid",n),u=S=m=null;for(g in l)if(l.hasOwnProperty(g)&&(O=l[g],O!=null))switch(g){case"value":m=O;break;case"defaultValue":S=O;break;case"multiple":u=O;default:$t(n,r,g,O,l,null)}r=m,l=S,n.multiple=!!u,r!=null?ci(n,!!u,r,!1):l!=null&&ci(n,!!u,l,!0);return;case"textarea":kt("invalid",n),m=g=u=null;for(S in l)if(l.hasOwnProperty(S)&&(O=l[S],O!=null))switch(S){case"value":u=O;break;case"defaultValue":g=O;break;case"children":m=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(i(91));break;default:$t(n,r,S,O,l,null)}Jp(n,u,g,m);return;case"option":for(B in l)l.hasOwnProperty(B)&&(u=l[B],u!=null)&&(B==="selected"?n.selected=u&&typeof u!="function"&&typeof u!="symbol":$t(n,r,B,u,l,null));return;case"dialog":kt("beforetoggle",n),kt("toggle",n),kt("cancel",n),kt("close",n);break;case"iframe":case"object":kt("load",n);break;case"video":case"audio":for(u=0;u<Ma.length;u++)kt(Ma[u],n);break;case"image":kt("error",n),kt("load",n);break;case"details":kt("toggle",n);break;case"embed":case"source":case"link":kt("error",n),kt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in l)if(l.hasOwnProperty(Q)&&(u=l[Q],u!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:$t(n,r,Q,u,l,null)}return;default:if(Kh(r)){for(at in l)l.hasOwnProperty(at)&&(u=l[at],u!==void 0&&Hd(n,r,at,u,l,void 0));return}}for(O in l)l.hasOwnProperty(O)&&(u=l[O],u!=null&&$t(n,r,O,u,l,null))}function pw(n,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,m=null,S=null,O=null,B=null,Q=null,at=null;for(it in l){var ct=l[it];if(l.hasOwnProperty(it)&&ct!=null)switch(it){case"checked":break;case"value":break;case"defaultValue":B=ct;default:u.hasOwnProperty(it)||$t(n,r,it,null,u,ct)}}for(var J in u){var it=u[J];if(ct=l[J],u.hasOwnProperty(J)&&(it!=null||ct!=null))switch(J){case"type":m=it;break;case"name":g=it;break;case"checked":Q=it;break;case"defaultChecked":at=it;break;case"value":S=it;break;case"defaultValue":O=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(i(137,r));break;default:it!==ct&&$t(n,r,J,it,u,ct)}}Bs(n,S,O,B,Q,at,m,g);return;case"select":it=S=O=J=null;for(m in l)if(B=l[m],l.hasOwnProperty(m)&&B!=null)switch(m){case"value":break;case"multiple":it=B;default:u.hasOwnProperty(m)||$t(n,r,m,null,u,B)}for(g in u)if(m=u[g],B=l[g],u.hasOwnProperty(g)&&(m!=null||B!=null))switch(g){case"value":J=m;break;case"defaultValue":O=m;break;case"multiple":S=m;default:m!==B&&$t(n,r,g,m,u,B)}r=O,l=S,u=it,J!=null?ci(n,!!l,J,!1):!!u!=!!l&&(r!=null?ci(n,!!l,r,!0):ci(n,!!l,l?[]:"",!1));return;case"textarea":it=J=null;for(O in l)if(g=l[O],l.hasOwnProperty(O)&&g!=null&&!u.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:$t(n,r,O,null,u,g)}for(S in u)if(g=u[S],m=l[S],u.hasOwnProperty(S)&&(g!=null||m!=null))switch(S){case"value":J=g;break;case"defaultValue":it=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==m&&$t(n,r,S,g,u,m)}Qp(n,J,it);return;case"option":for(var yt in l)J=l[yt],l.hasOwnProperty(yt)&&J!=null&&!u.hasOwnProperty(yt)&&(yt==="selected"?n.selected=!1:$t(n,r,yt,null,u,J));for(B in u)J=u[B],it=l[B],u.hasOwnProperty(B)&&J!==it&&(J!=null||it!=null)&&(B==="selected"?n.selected=J&&typeof J!="function"&&typeof J!="symbol":$t(n,r,B,J,u,it));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wt in l)J=l[wt],l.hasOwnProperty(wt)&&J!=null&&!u.hasOwnProperty(wt)&&$t(n,r,wt,null,u,J);for(Q in u)if(J=u[Q],it=l[Q],u.hasOwnProperty(Q)&&J!==it&&(J!=null||it!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,r));break;default:$t(n,r,Q,J,u,it)}return;default:if(Kh(r)){for(var qt in l)J=l[qt],l.hasOwnProperty(qt)&&J!==void 0&&!u.hasOwnProperty(qt)&&Hd(n,r,qt,void 0,u,J);for(at in u)J=u[at],it=l[at],!u.hasOwnProperty(at)||J===it||J===void 0&&it===void 0||Hd(n,r,at,J,u,it);return}}for(var $ in l)J=l[$],l.hasOwnProperty($)&&J!=null&&!u.hasOwnProperty($)&&$t(n,r,$,null,u,J);for(ct in u)J=u[ct],it=l[ct],!u.hasOwnProperty(ct)||J===it||J==null&&it==null||$t(n,r,ct,J,u,it)}function nv(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function mw(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var g=l[u],m=g.transferSize,S=g.initiatorType,O=g.duration;if(m&&O&&nv(S)){for(S=0,O=g.responseEnd,u+=1;u<l.length;u++){var B=l[u],Q=B.startTime;if(Q>O)break;var at=B.transferSize,ct=B.initiatorType;at&&nv(ct)&&(B=B.responseEnd,S+=at*(B<O?1:(O-Q)/(B-Q)))}if(--u,r+=8*(m+S)/(g.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Ud=null,Pd=null;function Rc(n){return n.nodeType===9?n:n.ownerDocument}function iv(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sv(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function Yd(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Vd=null;function yw(){var n=window.event;return n&&n.type==="popstate"?n===Vd?!1:(Vd=n,!0):(Vd=null,!1)}var rv=typeof setTimeout=="function"?setTimeout:void 0,vw=typeof clearTimeout=="function"?clearTimeout:void 0,ov=typeof Promise=="function"?Promise:void 0,xw=typeof queueMicrotask=="function"?queueMicrotask:typeof ov<"u"?function(n){return ov.resolve(null).then(n).catch(bw)}:rv;function bw(n){setTimeout(function(){throw n})}function ds(n){return n==="head"}function av(n,r){var l=r,u=0;do{var g=l.nextSibling;if(n.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"||l==="/&"){if(u===0){n.removeChild(g),lo(r);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Oa(n.ownerDocument.documentElement);else if(l==="head"){l=n.ownerDocument.head,Oa(l);for(var m=l.firstChild;m;){var S=m.nextSibling,O=m.nodeName;m[zs]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&m.rel.toLowerCase()==="stylesheet"||l.removeChild(m),m=S}}else l==="body"&&Oa(n.ownerDocument.body);l=g}while(l);lo(r)}function lv(n,r){var l=n;n=0;do{var u=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(n===0)break;n--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||n++;l=u}while(l)}function Xd(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Xd(l),Go(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function Sw(n,r,l,u){for(;n.nodeType===1;){var g=l;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[zs])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==g.rel||n.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||n.getAttribute("title")!==(g.title==null?null:g.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(g.src==null?null:g.src)||n.getAttribute("type")!==(g.type==null?null:g.type)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=g.name==null?null:""+g.name;if(g.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=vn(n.nextSibling),n===null)break}return null}function _w(n,r,l){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=vn(n.nextSibling),n===null))return null;return n}function cv(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=vn(n.nextSibling),n===null))return null;return n}function Fd(n){return n.data==="$?"||n.data==="$~"}function Id(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function ww(n,r){var l=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||l.readyState!=="loading")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function vn(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var Gd=null;function uv(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"||l==="/&"){if(r===0)return vn(n.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}n=n.nextSibling}return null}function hv(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return n;r--}else l!=="/$"&&l!=="/&"||r++}n=n.previousSibling}return null}function fv(n,r,l){switch(r=Rc(l),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Oa(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Go(n)}var xn=new Map,dv=new Set;function zc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ei=L.d;L.d={f:Cw,r:Tw,D:Ew,C:Mw,L:Dw,m:Ow,X:kw,S:Aw,M:jw};function Cw(){var n=Ei.f(),r=Ec();return n||r}function Tw(n){var r=Gi(n);r!==null&&r.tag===5&&r.type==="form"?A0(r):Ei.r(n)}var ro=typeof document>"u"?null:document;function gv(n,r,l){var u=ro;if(u&&typeof r=="string"&&r){var g=Ye(r);g='link[rel="'+n+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),dv.has(g)||(dv.add(g),n={rel:n,crossOrigin:l,href:r},u.querySelector(g)===null&&(r=u.createElement("link"),Ee(r,"link",n),ue(r),u.head.appendChild(r)))}}function Ew(n){Ei.D(n),gv("dns-prefetch",n,null)}function Mw(n,r){Ei.C(n,r),gv("preconnect",n,r)}function Dw(n,r,l){Ei.L(n,r,l);var u=ro;if(u&&n&&r){var g='link[rel="preload"][as="'+Ye(r)+'"]';r==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+Ye(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+Ye(l.imageSizes)+'"]')):g+='[href="'+Ye(n)+'"]';var m=g;switch(r){case"style":m=oo(n);break;case"script":m=ao(n)}xn.has(m)||(n=y({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:n,as:r},l),xn.set(m,n),u.querySelector(g)!==null||r==="style"&&u.querySelector(Aa(m))||r==="script"&&u.querySelector(ka(m))||(r=u.createElement("link"),Ee(r,"link",n),ue(r),u.head.appendChild(r)))}}function Ow(n,r){Ei.m(n,r);var l=ro;if(l&&n){var u=r&&typeof r.as=="string"?r.as:"script",g='link[rel="modulepreload"][as="'+Ye(u)+'"][href="'+Ye(n)+'"]',m=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=ao(n)}if(!xn.has(m)&&(n=y({rel:"modulepreload",href:n},r),xn.set(m,n),l.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(ka(m)))return}u=l.createElement("link"),Ee(u,"link",n),ue(u),l.head.appendChild(u)}}}function Aw(n,r,l){Ei.S(n,r,l);var u=ro;if(u&&n){var g=qi(u).hoistableStyles,m=oo(n);r=r||"default";var S=g.get(m);if(!S){var O={loading:0,preload:null};if(S=u.querySelector(Aa(m)))O.loading=5;else{n=y({rel:"stylesheet",href:n,"data-precedence":r},l),(l=xn.get(m))&&$d(n,l);var B=S=u.createElement("link");ue(B),Ee(B,"link",n),B._p=new Promise(function(Q,at){B.onload=Q,B.onerror=at}),B.addEventListener("load",function(){O.loading|=1}),B.addEventListener("error",function(){O.loading|=2}),O.loading|=4,Lc(S,r,u)}S={type:"stylesheet",instance:S,count:1,state:O},g.set(m,S)}}}function kw(n,r){Ei.X(n,r);var l=ro;if(l&&n){var u=qi(l).hoistableScripts,g=ao(n),m=u.get(g);m||(m=l.querySelector(ka(g)),m||(n=y({src:n,async:!0},r),(r=xn.get(g))&&qd(n,r),m=l.createElement("script"),ue(m),Ee(m,"link",n),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(g,m))}}function jw(n,r){Ei.M(n,r);var l=ro;if(l&&n){var u=qi(l).hoistableScripts,g=ao(n),m=u.get(g);m||(m=l.querySelector(ka(g)),m||(n=y({src:n,async:!0,type:"module"},r),(r=xn.get(g))&&qd(n,r),m=l.createElement("script"),ue(m),Ee(m,"link",n),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(g,m))}}function pv(n,r,l,u){var g=(g=dt.current)?zc(g):null;if(!g)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=oo(l.href),l=qi(g).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=oo(l.href);var m=qi(g).hoistableStyles,S=m.get(n);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,S),(m=g.querySelector(Aa(n)))&&!m._p&&(S.instance=m,S.state.loading=5),xn.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},xn.set(n,l),m||Nw(g,n,l,S.state))),r&&u===null)throw Error(i(528,""));return S}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ao(l),l=qi(g).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function oo(n){return'href="'+Ye(n)+'"'}function Aa(n){return'link[rel="stylesheet"]['+n+"]"}function mv(n){return y({},n,{"data-precedence":n.precedence,precedence:null})}function Nw(n,r,l,u){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=n.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),Ee(r,"link",l),ue(r),n.head.appendChild(r))}function ao(n){return'[src="'+Ye(n)+'"]'}function ka(n){return"script[async]"+n}function yv(n,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=n.querySelector('style[data-href~="'+Ye(l.href)+'"]');if(u)return r.instance=u,ue(u),u;var g=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),ue(u),Ee(u,"style",g),Lc(u,l.precedence,n),r.instance=u;case"stylesheet":g=oo(l.href);var m=n.querySelector(Aa(g));if(m)return r.state.loading|=4,r.instance=m,ue(m),m;u=mv(l),(g=xn.get(g))&&$d(u,g),m=(n.ownerDocument||n).createElement("link"),ue(m);var S=m;return S._p=new Promise(function(O,B){S.onload=O,S.onerror=B}),Ee(m,"link",u),r.state.loading|=4,Lc(m,l.precedence,n),r.instance=m;case"script":return m=ao(l.src),(g=n.querySelector(ka(m)))?(r.instance=g,ue(g),g):(u=l,(g=xn.get(m))&&(u=y({},l),qd(u,g)),n=n.ownerDocument||n,g=n.createElement("script"),ue(g),Ee(g,"link",u),n.head.appendChild(g),r.instance=g);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Lc(u,l.precedence,n));return r.instance}function Lc(n,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,m=g,S=0;S<u.length;S++){var O=u[S];if(O.dataset.precedence===r)m=O;else if(m!==g)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(n,r.firstChild))}function $d(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function qd(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Bc=null;function vv(n,r,l){if(Bc===null){var u=new Map,g=Bc=new Map;g.set(l,u)}else g=Bc,u=g.get(l),u||(u=new Map,g.set(l,u));if(u.has(n))return u;for(u.set(n,null),l=l.getElementsByTagName(n),g=0;g<l.length;g++){var m=l[g];if(!(m[zs]||m[me]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var S=m.getAttribute(r)||"";S=n+S;var O=u.get(S);O?O.push(m):u.set(S,[m])}}return u}function xv(n,r,l){n=n.ownerDocument||n,n.head.insertBefore(l,r==="title"?n.querySelector("head > title"):null)}function Rw(n,r,l){if(l===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function bv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function zw(n,r,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var g=oo(u.href),m=r.querySelector(Aa(g));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Hc.bind(n),r.then(n,n)),l.state.loading|=4,l.instance=m,ue(m);return}m=r.ownerDocument||r,u=mv(u),(g=xn.get(g))&&$d(u,g),m=m.createElement("link"),ue(m);var S=m;S._p=new Promise(function(O,B){S.onload=O,S.onerror=B}),Ee(m,"link",u),l.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(n.count++,l=Hc.bind(n),r.addEventListener("load",l),r.addEventListener("error",l))}}var Wd=0;function Lw(n,r){return n.stylesheets&&n.count===0&&Pc(n,n.stylesheets),0<n.count||0<n.imgCount?function(l){var u=setTimeout(function(){if(n.stylesheets&&Pc(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&Wd===0&&(Wd=62500*mw());var g=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Pc(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>Wd?50:800)+r);return n.unsuspend=l,function(){n.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function Hc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Pc(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Uc=null;function Pc(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Uc=new Map,r.forEach(Bw,n),Uc=null,Hc.call(n))}function Bw(n,r){if(!(r.state.loading&4)){var l=Uc.get(n);if(l)var u=l.get(null);else{l=new Map,Uc.set(n,l);for(var g=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<g.length;m++){var S=g[m];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(l.set(S.dataset.precedence,S),u=S)}u&&l.set(null,u)}g=r.instance,S=g.getAttribute("data-precedence"),m=l.get(S)||u,m===u&&l.set(null,g),l.set(S,g),this.count++,u=Hc.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),m?m.parentNode.insertBefore(g,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(g,n.firstChild)),r.state.loading|=4}}var ja={$$typeof:C,Provider:null,Consumer:null,_currentValue:H,_currentValue2:H,_threadCount:0};function Hw(n,r,l,u,g,m,S,O,B){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Xo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xo(0),this.hiddenUpdates=Xo(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=m,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function Sv(n,r,l,u,g,m,S,O,B,Q,at,ct){return n=new Hw(n,r,l,S,B,Q,at,ct,O),r=1,m===!0&&(r|=24),m=en(3,null,null,r),n.current=m,m.stateNode=n,r=Df(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:u,isDehydrated:l,cache:r},jf(m),n}function _v(n){return n?(n=Hr,n):Hr}function wv(n,r,l,u,g,m){g=_v(g),u.context===null?u.context=g:u.pendingContext=g,u=ns(r),u.payload={element:l},m=m===void 0?null:m,m!==null&&(u.callback=m),l=is(n,u,r),l!==null&&($e(l,n,r),ua(l,n,r))}function Cv(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<r?l:r}}function Zd(n,r){Cv(n,r),(n=n.alternate)&&Cv(n,r)}function Tv(n){if(n.tag===13||n.tag===31){var r=Ys(n,67108864);r!==null&&$e(r,n,67108864),Zd(n,67108864)}}function Ev(n){if(n.tag===13||n.tag===31){var r=an();r=Fo(r);var l=Ys(n,r);l!==null&&$e(l,n,r),Zd(n,r)}}var Yc=!0;function Uw(n,r,l,u){var g=A.T;A.T=null;var m=L.p;try{L.p=2,Kd(n,r,l,u)}finally{L.p=m,A.T=g}}function Pw(n,r,l,u){var g=A.T;A.T=null;var m=L.p;try{L.p=8,Kd(n,r,l,u)}finally{L.p=m,A.T=g}}function Kd(n,r,l,u){if(Yc){var g=Qd(u);if(g===null)Bd(n,r,u,Vc,l),Dv(n,u);else if(Vw(g,n,r,l,u))u.stopPropagation();else if(Dv(n,u),r&4&&-1<Yw.indexOf(n)){for(;g!==null;){var m=Gi(g);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var S=oi(m.pendingLanes);if(S!==0){var O=m;for(O.pendingLanes|=2,O.entangledLanes|=2;S;){var B=1<<31-Re(S);O.entanglements[1]|=B,S&=~B}$n(m),(Pt&6)===0&&(Cc=_e()+500,Ea(0))}}break;case 31:case 13:O=Ys(m,2),O!==null&&$e(O,m,2),Ec(),Zd(m,2)}if(m=Qd(u),m===null&&Bd(n,r,u,Vc,l),m===g)break;g=m}g!==null&&u.stopPropagation()}else Bd(n,r,u,null,l)}}function Qd(n){return n=Jh(n),Jd(n)}var Vc=null;function Jd(n){if(Vc=null,n=Ii(n),n!==null){var r=a(n);if(r===null)n=null;else{var l=r.tag;if(l===13){if(n=c(r),n!==null)return n;n=null}else if(l===31){if(n=h(r),n!==null)return n;n=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Vc=n,null}function Mv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Sr()){case ri:return 2;case Fi:return 8;case ks:case Hh:return 32;case _r:return 268435456;default:return 32}default:return 32}}var tg=!1,gs=null,ps=null,ms=null,Na=new Map,Ra=new Map,ys=[],Yw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dv(n,r){switch(n){case"focusin":case"focusout":gs=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":Na.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ra.delete(r.pointerId)}}function za(n,r,l,u,g,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:m,targetContainers:[g]},r!==null&&(r=Gi(r),r!==null&&Tv(r)),n):(n.eventSystemFlags|=u,r=n.targetContainers,g!==null&&r.indexOf(g)===-1&&r.push(g),n)}function Vw(n,r,l,u,g){switch(r){case"focusin":return gs=za(gs,n,r,l,u,g),!0;case"dragenter":return ps=za(ps,n,r,l,u,g),!0;case"mouseover":return ms=za(ms,n,r,l,u,g),!0;case"pointerover":var m=g.pointerId;return Na.set(m,za(Na.get(m)||null,n,r,l,u,g)),!0;case"gotpointercapture":return m=g.pointerId,Ra.set(m,za(Ra.get(m)||null,n,r,l,u,g)),!0}return!1}function Ov(n){var r=Ii(n.target);if(r!==null){var l=a(r);if(l!==null){if(r=l.tag,r===13){if(r=c(l),r!==null){n.blockedOn=r,Al(n.priority,function(){Ev(l)});return}}else if(r===31){if(r=h(l),r!==null){n.blockedOn=r,Al(n.priority,function(){Ev(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Xc(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var l=Qd(n.nativeEvent);if(l===null){l=n.nativeEvent;var u=new l.constructor(l.type,l);Qh=u,l.target.dispatchEvent(u),Qh=null}else return r=Gi(l),r!==null&&Tv(r),n.blockedOn=l,!1;r.shift()}return!0}function Av(n,r,l){Xc(n)&&l.delete(r)}function Xw(){tg=!1,gs!==null&&Xc(gs)&&(gs=null),ps!==null&&Xc(ps)&&(ps=null),ms!==null&&Xc(ms)&&(ms=null),Na.forEach(Av),Ra.forEach(Av)}function Fc(n,r){n.blockedOn===r&&(n.blockedOn=null,tg||(tg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Xw)))}var Ic=null;function kv(n){Ic!==n&&(Ic=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Ic===n&&(Ic=null);for(var r=0;r<n.length;r+=3){var l=n[r],u=n[r+1],g=n[r+2];if(typeof u!="function"){if(Jd(u||l)===null)continue;break}var m=Gi(l);m!==null&&(n.splice(r,3),r-=3,Qf(m,{pending:!0,data:g,method:l.method,action:u},u,g))}}))}function lo(n){function r(B){return Fc(B,n)}gs!==null&&Fc(gs,n),ps!==null&&Fc(ps,n),ms!==null&&Fc(ms,n),Na.forEach(r),Ra.forEach(r);for(var l=0;l<ys.length;l++){var u=ys[l];u.blockedOn===n&&(u.blockedOn=null)}for(;0<ys.length&&(l=ys[0],l.blockedOn===null);)Ov(l),l.blockedOn===null&&ys.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var g=l[u],m=l[u+1],S=g[Oe]||null;if(typeof m=="function")S||kv(l);else if(S){var O=null;if(m&&m.hasAttribute("formAction")){if(g=m,S=m[Oe]||null)O=S.formAction;else if(Jd(g)!==null)continue}else O=S.action;typeof O=="function"?l[u+1]=O:(l.splice(u,3),u-=3),kv(l)}}}function jv(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(S){return g=S})},focusReset:"manual",scroll:"manual"})}function r(){g!==null&&(g(),g=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),g!==null&&(g(),g=null)}}}function eg(n){this._internalRoot=n}Gc.prototype.render=eg.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,u=an();wv(l,u,n,r,null,null)},Gc.prototype.unmount=eg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;wv(n.current,2,null,n,null,null),Ec(),r[ai]=null}};function Gc(n){this._internalRoot=n}Gc.prototype.unstable_scheduleHydration=function(n){if(n){var r=Ol();n={blockedOn:null,target:n,priority:r};for(var l=0;l<ys.length&&r!==0&&r<ys[l].priority;l++);ys.splice(l,0,n),l===0&&Ov(n)}};var Nv=t.version;if(Nv!=="19.2.4")throw Error(i(527,Nv,"19.2.4"));L.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=d(r),n=n!==null?p(n):null,n=n===null?null:n.stateNode,n};var Fw={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:A,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$c.isDisabled&&$c.supportsFiber)try{js=$c.inject(Fw),Ne=$c}catch{}}return Ba.createRoot=function(n,r){if(!o(n))throw Error(i(299));var l=!1,u="",g=P0,m=Y0,S=V0;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(g=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(S=r.onRecoverableError)),r=Sv(n,1,!1,null,null,l,u,null,g,m,S,jv),n[ai]=r.current,Ld(n),new eg(r)},Ba.hydrateRoot=function(n,r,l){if(!o(n))throw Error(i(299));var u=!1,g="",m=P0,S=Y0,O=V0,B=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(O=l.onRecoverableError),l.formState!==void 0&&(B=l.formState)),r=Sv(n,1,!0,r,l??null,u,g,B,m,S,O,jv),r.context=_v(null),l=r.current,u=an(),u=Fo(u),g=ns(u),g.callback=null,is(l,g,u),l=u,r.current.lanes=l,Rs(r,l),$n(r),n[ai]=r.current,Ld(n),new Gc(r)},Ba.version="19.2.4",Ba}var Xv;function Jw(){if(Xv)return sg.exports;Xv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),sg.exports=Qw(),sg.exports}var tC=Jw();const P1=(...s)=>s.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim();const eC=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const nC=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase());const Fv=s=>{const t=nC(s);return t.charAt(0).toUpperCase()+t.slice(1)};var iC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const sC=s=>{for(const t in s)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const rC=Y.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:o="",children:a,iconNode:c,...h},f)=>Y.createElement("svg",{ref:f,...iC,width:t,height:t,stroke:s,strokeWidth:i?Number(e)*24/Number(t):e,className:P1("lucide",o),...!a&&!sC(h)&&{"aria-hidden":"true"},...h},[...c.map(([d,p])=>Y.createElement(d,p)),...Array.isArray(a)?a:[a]]));const zt=(s,t)=>{const e=Y.forwardRef(({className:i,...o},a)=>Y.createElement(rC,{ref:a,iconNode:t,className:P1(`lucide-${eC(Fv(s))}`,`lucide-${s}`,i),...o}));return e.displayName=Fv(s),e};const oC=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],aC=zt("arrow-down-to-line",oC);const lC=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],cC=zt("car",lC);const uC=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],hC=zt("check",uC);const fC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],dh=zt("chevron-down",fC);const dC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Vu=zt("chevron-up",dC);const gC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],pC=zt("circle-question-mark",gC);const mC=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Iv=zt("clipboard-list",mC);const yC=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],vC=zt("clock",yC);const xC=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],bC=zt("download",xC);const SC=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],_C=zt("eraser",SC);const wC=[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]],CC=zt("flower-2",wC);const TC=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],EC=zt("folder-open",TC);const MC=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],DC=zt("image",MC);const OC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],AC=zt("info",OC);const kC=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],jC=zt("leaf",kC);const NC=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],RC=zt("link",NC);const zC=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Y1=zt("loader-circle",zC);const LC=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],BC=zt("maximize-2",LC);const HC=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Lg=zt("monitor",HC);const UC=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],PC=zt("moon",UC);const YC=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],VC=zt("mouse-pointer",YC);const XC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],FC=zt("pen",XC);const IC=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],GC=zt("play",IC);const $C=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],qC=zt("rotate-ccw",$C);const WC=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ZC=zt("search",WC);const KC=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],QC=zt("settings",KC);const JC=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],tT=zt("snowflake",JC);const eT=[["path",{d:"M14 9.536V7a4 4 0 0 1 4-4h1.5a.5.5 0 0 1 .5.5V5a4 4 0 0 1-4 4 4 4 0 0 0-4 4c0 2 1 3 1 5a5 5 0 0 1-1 3",key:"139s4v"}],["path",{d:"M4 9a5 5 0 0 1 8 4 5 5 0 0 1-8-4",key:"1dlkgp"}],["path",{d:"M5 21h14",key:"11awu3"}]],nT=zt("sprout",eT);const iT=[["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}],["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}]],sT=zt("square-play",iT);const rT=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Gv=zt("sun",rT);const oT=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],aT=zt("trash-2",oT);const lT=[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]],cT=zt("tree-pine",lT);const uT=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],hT=zt("triangle-alert",uT);const fT=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],V1=zt("users",fT);const dT=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X1=zt("x",dT),$v=s=>{let t;const e=new Set,i=(d,p)=>{const y=typeof d=="function"?d(t):d;if(!Object.is(y,t)){const v=t;t=p??(typeof y!="object"||y===null)?y:Object.assign({},t,y),e.forEach(x=>x(t,v))}},o=()=>t,h={setState:i,getState:o,getInitialState:()=>f,subscribe:d=>(e.add(d),()=>e.delete(d))},f=t=s(i,o,h);return h},gT=(s=>s?$v(s):$v),pT=s=>s;function mT(s,t=pT){const e=Xa.useSyncExternalStore(s.subscribe,Xa.useCallback(()=>t(s.getState()),[s,t]),Xa.useCallback(()=>t(s.getInitialState()),[s,t]));return Xa.useDebugValue(e),e}const qv=s=>{const t=gT(s),e=i=>mT(t,i);return Object.assign(e,t),e},Ro=(s=>s?qv(s):qv),je=Ro(s=>({activeSidebarItem:"render",activeTab:"preview",zoom:1,pan:{x:0,y:0},promptText:"",compareANodeId:null,compareBNodeId:null,sketchUpStatus:"disconnected",setActiveSidebarItem:t=>s({activeSidebarItem:t}),setActiveTab:t=>s({activeTab:t}),setZoom:t=>s({zoom:t}),setPan:t=>s({pan:t}),setPromptText:t=>s({promptText:t}),setCompareA:t=>s({compareANodeId:t}),setCompareB:t=>s({compareBNodeId:t}),setSketchUpStatus:t=>s({sketchUpStatus:t})})),yT=[{id:"render",icon:Lg,label:"Render"},{id:"history",icon:qC,label:"History"},{id:"account",icon:V1,label:"Account"},{id:"tutorial",icon:sT,label:"Tutorial"}],vT=[{id:"support",icon:pC,label:"Support"},{id:"settings",icon:QC,label:"Settings"}];function Wv({button:s}){const t=je(a=>a.activeSidebarItem),e=je(a=>a.setActiveSidebarItem),i=t===s.id,o=s.icon;return _.jsxs("button",{onClick:()=>e(s.id),className:"relative flex w-full flex-col items-center justify-center py-2",style:{height:56},children:[i&&_.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 rounded-r-sm",style:{width:3,height:40,backgroundColor:"#00c9a7"}}),_.jsx(o,{size:20,color:i?"#ffffff":"#666666",className:"transition-colors duration-150"}),_.jsx("span",{className:"mt-1 text-center leading-none transition-colors duration-150",style:{fontSize:10,color:i?"#ffffff":"#666666"},children:s.label})]})}function xT(){return _.jsxs("aside",{className:"flex h-full flex-col",style:{width:56,minWidth:56,backgroundColor:"#0f0f1a",borderRight:"1px solid #222233"},children:[_.jsx("div",{className:"flex flex-col",children:yT.map(s=>_.jsx(Wv,{button:s},s.id))}),_.jsx("div",{className:"flex-1"}),_.jsx("div",{className:"flex flex-col",children:vT.map(s=>_.jsx(Wv,{button:s},s.id))})]})}function pe(s){if(typeof s=="string"||typeof s=="number")return""+s;let t="";if(Array.isArray(s))for(let e=0,i;e<s.length;e++)(i=pe(s[e]))!==""&&(t+=(t&&" ")+i);else for(let e in s)s[e]&&(t+=(t&&" ")+e);return t}var bT={value:()=>{}};function gh(){for(var s=0,t=arguments.length,e={},i;s<t;++s){if(!(i=arguments[s]+"")||i in e||/[\s.]/.test(i))throw new Error("illegal type: "+i);e[i]=[]}return new ku(e)}function ku(s){this._=s}function ST(s,t){return s.trim().split(/^|\s+/).map(function(e){var i="",o=e.indexOf(".");if(o>=0&&(i=e.slice(o+1),e=e.slice(0,o)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:i}})}ku.prototype=gh.prototype={constructor:ku,on:function(s,t){var e=this._,i=ST(s+"",e),o,a=-1,c=i.length;if(arguments.length<2){for(;++a<c;)if((o=(s=i[a]).type)&&(o=_T(e[o],s.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<c;)if(o=(s=i[a]).type)e[o]=Zv(e[o],s.name,t);else if(t==null)for(o in e)e[o]=Zv(e[o],s.name,null);return this},copy:function(){var s={},t=this._;for(var e in t)s[e]=t[e].slice();return new ku(s)},call:function(s,t){if((o=arguments.length-2)>0)for(var e=new Array(o),i=0,o,a;i<o;++i)e[i]=arguments[i+2];if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(a=this._[s],i=0,o=a.length;i<o;++i)a[i].value.apply(t,e)},apply:function(s,t,e){if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(var i=this._[s],o=0,a=i.length;o<a;++o)i[o].value.apply(t,e)}};function _T(s,t){for(var e=0,i=s.length,o;e<i;++e)if((o=s[e]).name===t)return o.value}function Zv(s,t,e){for(var i=0,o=s.length;i<o;++i)if(s[i].name===t){s[i]=bT,s=s.slice(0,i).concat(s.slice(i+1));break}return e!=null&&s.push({name:t,value:e}),s}var Bg="http://www.w3.org/1999/xhtml";const Kv={svg:"http://www.w3.org/2000/svg",xhtml:Bg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ph(s){var t=s+="",e=t.indexOf(":");return e>=0&&(t=s.slice(0,e))!=="xmlns"&&(s=s.slice(e+1)),Kv.hasOwnProperty(t)?{space:Kv[t],local:s}:s}function wT(s){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===Bg&&t.documentElement.namespaceURI===Bg?t.createElement(s):t.createElementNS(e,s)}}function CT(s){return function(){return this.ownerDocument.createElementNS(s.space,s.local)}}function F1(s){var t=ph(s);return(t.local?CT:wT)(t)}function TT(){}function hp(s){return s==null?TT:function(){return this.querySelector(s)}}function ET(s){typeof s!="function"&&(s=hp(s));for(var t=this._groups,e=t.length,i=new Array(e),o=0;o<e;++o)for(var a=t[o],c=a.length,h=i[o]=new Array(c),f,d,p=0;p<c;++p)(f=a[p])&&(d=s.call(f,f.__data__,p,a))&&("__data__"in f&&(d.__data__=f.__data__),h[p]=d);return new hn(i,this._parents)}function MT(s){return s==null?[]:Array.isArray(s)?s:Array.from(s)}function DT(){return[]}function I1(s){return s==null?DT:function(){return this.querySelectorAll(s)}}function OT(s){return function(){return MT(s.apply(this,arguments))}}function AT(s){typeof s=="function"?s=OT(s):s=I1(s);for(var t=this._groups,e=t.length,i=[],o=[],a=0;a<e;++a)for(var c=t[a],h=c.length,f,d=0;d<h;++d)(f=c[d])&&(i.push(s.call(f,f.__data__,d,c)),o.push(f));return new hn(i,o)}function G1(s){return function(){return this.matches(s)}}function $1(s){return function(t){return t.matches(s)}}var kT=Array.prototype.find;function jT(s){return function(){return kT.call(this.children,s)}}function NT(){return this.firstElementChild}function RT(s){return this.select(s==null?NT:jT(typeof s=="function"?s:$1(s)))}var zT=Array.prototype.filter;function LT(){return Array.from(this.children)}function BT(s){return function(){return zT.call(this.children,s)}}function HT(s){return this.selectAll(s==null?LT:BT(typeof s=="function"?s:$1(s)))}function UT(s){typeof s!="function"&&(s=G1(s));for(var t=this._groups,e=t.length,i=new Array(e),o=0;o<e;++o)for(var a=t[o],c=a.length,h=i[o]=[],f,d=0;d<c;++d)(f=a[d])&&s.call(f,f.__data__,d,a)&&h.push(f);return new hn(i,this._parents)}function q1(s){return new Array(s.length)}function PT(){return new hn(this._enter||this._groups.map(q1),this._parents)}function Xu(s,t){this.ownerDocument=s.ownerDocument,this.namespaceURI=s.namespaceURI,this._next=null,this._parent=s,this.__data__=t}Xu.prototype={constructor:Xu,appendChild:function(s){return this._parent.insertBefore(s,this._next)},insertBefore:function(s,t){return this._parent.insertBefore(s,t)},querySelector:function(s){return this._parent.querySelector(s)},querySelectorAll:function(s){return this._parent.querySelectorAll(s)}};function YT(s){return function(){return s}}function VT(s,t,e,i,o,a){for(var c=0,h,f=t.length,d=a.length;c<d;++c)(h=t[c])?(h.__data__=a[c],i[c]=h):e[c]=new Xu(s,a[c]);for(;c<f;++c)(h=t[c])&&(o[c]=h)}function XT(s,t,e,i,o,a,c){var h,f,d=new Map,p=t.length,y=a.length,v=new Array(p),x;for(h=0;h<p;++h)(f=t[h])&&(v[h]=x=c.call(f,f.__data__,h,t)+"",d.has(x)?o[h]=f:d.set(x,f));for(h=0;h<y;++h)x=c.call(s,a[h],h,a)+"",(f=d.get(x))?(i[h]=f,f.__data__=a[h],d.delete(x)):e[h]=new Xu(s,a[h]);for(h=0;h<p;++h)(f=t[h])&&d.get(v[h])===f&&(o[h]=f)}function FT(s){return s.__data__}function IT(s,t){if(!arguments.length)return Array.from(this,FT);var e=t?XT:VT,i=this._parents,o=this._groups;typeof s!="function"&&(s=YT(s));for(var a=o.length,c=new Array(a),h=new Array(a),f=new Array(a),d=0;d<a;++d){var p=i[d],y=o[d],v=y.length,x=GT(s.call(p,p&&p.__data__,d,i)),b=x.length,w=h[d]=new Array(b),T=c[d]=new Array(b),E=f[d]=new Array(v);e(p,y,w,T,E,x,t);for(var M=0,C=0,D,j;M<b;++M)if(D=w[M]){for(M>=C&&(C=M+1);!(j=T[C])&&++C<b;);D._next=j||null}}return c=new hn(c,i),c._enter=h,c._exit=f,c}function GT(s){return typeof s=="object"&&"length"in s?s:Array.from(s)}function $T(){return new hn(this._exit||this._groups.map(q1),this._parents)}function qT(s,t,e){var i=this.enter(),o=this,a=this.exit();return typeof s=="function"?(i=s(i),i&&(i=i.selection())):i=i.append(s+""),t!=null&&(o=t(o),o&&(o=o.selection())),e==null?a.remove():e(a),i&&o?i.merge(o).order():o}function WT(s){for(var t=s.selection?s.selection():s,e=this._groups,i=t._groups,o=e.length,a=i.length,c=Math.min(o,a),h=new Array(o),f=0;f<c;++f)for(var d=e[f],p=i[f],y=d.length,v=h[f]=new Array(y),x,b=0;b<y;++b)(x=d[b]||p[b])&&(v[b]=x);for(;f<o;++f)h[f]=e[f];return new hn(h,this._parents)}function ZT(){for(var s=this._groups,t=-1,e=s.length;++t<e;)for(var i=s[t],o=i.length-1,a=i[o],c;--o>=0;)(c=i[o])&&(a&&c.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(c,a),a=c);return this}function KT(s){s||(s=QT);function t(y,v){return y&&v?s(y.__data__,v.__data__):!y-!v}for(var e=this._groups,i=e.length,o=new Array(i),a=0;a<i;++a){for(var c=e[a],h=c.length,f=o[a]=new Array(h),d,p=0;p<h;++p)(d=c[p])&&(f[p]=d);f.sort(t)}return new hn(o,this._parents).order()}function QT(s,t){return s<t?-1:s>t?1:s>=t?0:NaN}function JT(){var s=arguments[0];return arguments[0]=this,s.apply(null,arguments),this}function tE(){return Array.from(this)}function eE(){for(var s=this._groups,t=0,e=s.length;t<e;++t)for(var i=s[t],o=0,a=i.length;o<a;++o){var c=i[o];if(c)return c}return null}function nE(){let s=0;for(const t of this)++s;return s}function iE(){return!this.node()}function sE(s){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var o=t[e],a=0,c=o.length,h;a<c;++a)(h=o[a])&&s.call(h,h.__data__,a,o);return this}function rE(s){return function(){this.removeAttribute(s)}}function oE(s){return function(){this.removeAttributeNS(s.space,s.local)}}function aE(s,t){return function(){this.setAttribute(s,t)}}function lE(s,t){return function(){this.setAttributeNS(s.space,s.local,t)}}function cE(s,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttribute(s):this.setAttribute(s,e)}}function uE(s,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttributeNS(s.space,s.local):this.setAttributeNS(s.space,s.local,e)}}function hE(s,t){var e=ph(s);if(arguments.length<2){var i=this.node();return e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}return this.each((t==null?e.local?oE:rE:typeof t=="function"?e.local?uE:cE:e.local?lE:aE)(e,t))}function W1(s){return s.ownerDocument&&s.ownerDocument.defaultView||s.document&&s||s.defaultView}function fE(s){return function(){this.style.removeProperty(s)}}function dE(s,t,e){return function(){this.style.setProperty(s,t,e)}}function gE(s,t,e){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(s):this.style.setProperty(s,i,e)}}function pE(s,t,e){return arguments.length>1?this.each((t==null?fE:typeof t=="function"?gE:dE)(s,t,e??"")):wo(this.node(),s)}function wo(s,t){return s.style.getPropertyValue(t)||W1(s).getComputedStyle(s,null).getPropertyValue(t)}function mE(s){return function(){delete this[s]}}function yE(s,t){return function(){this[s]=t}}function vE(s,t){return function(){var e=t.apply(this,arguments);e==null?delete this[s]:this[s]=e}}function xE(s,t){return arguments.length>1?this.each((t==null?mE:typeof t=="function"?vE:yE)(s,t)):this.node()[s]}function Z1(s){return s.trim().split(/^|\s+/)}function fp(s){return s.classList||new K1(s)}function K1(s){this._node=s,this._names=Z1(s.getAttribute("class")||"")}K1.prototype={add:function(s){var t=this._names.indexOf(s);t<0&&(this._names.push(s),this._node.setAttribute("class",this._names.join(" ")))},remove:function(s){var t=this._names.indexOf(s);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(s){return this._names.indexOf(s)>=0}};function Q1(s,t){for(var e=fp(s),i=-1,o=t.length;++i<o;)e.add(t[i])}function J1(s,t){for(var e=fp(s),i=-1,o=t.length;++i<o;)e.remove(t[i])}function bE(s){return function(){Q1(this,s)}}function SE(s){return function(){J1(this,s)}}function _E(s,t){return function(){(t.apply(this,arguments)?Q1:J1)(this,s)}}function wE(s,t){var e=Z1(s+"");if(arguments.length<2){for(var i=fp(this.node()),o=-1,a=e.length;++o<a;)if(!i.contains(e[o]))return!1;return!0}return this.each((typeof t=="function"?_E:t?bE:SE)(e,t))}function CE(){this.textContent=""}function TE(s){return function(){this.textContent=s}}function EE(s){return function(){var t=s.apply(this,arguments);this.textContent=t??""}}function ME(s){return arguments.length?this.each(s==null?CE:(typeof s=="function"?EE:TE)(s)):this.node().textContent}function DE(){this.innerHTML=""}function OE(s){return function(){this.innerHTML=s}}function AE(s){return function(){var t=s.apply(this,arguments);this.innerHTML=t??""}}function kE(s){return arguments.length?this.each(s==null?DE:(typeof s=="function"?AE:OE)(s)):this.node().innerHTML}function jE(){this.nextSibling&&this.parentNode.appendChild(this)}function NE(){return this.each(jE)}function RE(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function zE(){return this.each(RE)}function LE(s){var t=typeof s=="function"?s:F1(s);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function BE(){return null}function HE(s,t){var e=typeof s=="function"?s:F1(s),i=t==null?BE:typeof t=="function"?t:hp(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)})}function UE(){var s=this.parentNode;s&&s.removeChild(this)}function PE(){return this.each(UE)}function YE(){var s=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(s,this.nextSibling):s}function VE(){var s=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(s,this.nextSibling):s}function XE(s){return this.select(s?VE:YE)}function FE(s){return arguments.length?this.property("__data__",s):this.node().__data__}function IE(s){return function(t){s.call(this,t,this.__data__)}}function GE(s){return s.trim().split(/^|\s+/).map(function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}})}function $E(s){return function(){var t=this.__on;if(t){for(var e=0,i=-1,o=t.length,a;e<o;++e)a=t[e],(!s.type||a.type===s.type)&&a.name===s.name?this.removeEventListener(a.type,a.listener,a.options):t[++i]=a;++i?t.length=i:delete this.__on}}}function qE(s,t,e){return function(){var i=this.__on,o,a=IE(t);if(i){for(var c=0,h=i.length;c<h;++c)if((o=i[c]).type===s.type&&o.name===s.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=a,o.options=e),o.value=t;return}}this.addEventListener(s.type,a,e),o={type:s.type,name:s.name,value:t,listener:a,options:e},i?i.push(o):this.__on=[o]}}function WE(s,t,e){var i=GE(s+""),o,a=i.length,c;if(arguments.length<2){var h=this.node().__on;if(h){for(var f=0,d=h.length,p;f<d;++f)for(o=0,p=h[f];o<a;++o)if((c=i[o]).type===p.type&&c.name===p.name)return p.value}return}for(h=t?qE:$E,o=0;o<a;++o)this.each(h(i[o],t,e));return this}function tb(s,t,e){var i=W1(s),o=i.CustomEvent;typeof o=="function"?o=new o(t,e):(o=i.document.createEvent("Event"),e?(o.initEvent(t,e.bubbles,e.cancelable),o.detail=e.detail):o.initEvent(t,!1,!1)),s.dispatchEvent(o)}function ZE(s,t){return function(){return tb(this,s,t)}}function KE(s,t){return function(){return tb(this,s,t.apply(this,arguments))}}function QE(s,t){return this.each((typeof t=="function"?KE:ZE)(s,t))}function*JE(){for(var s=this._groups,t=0,e=s.length;t<e;++t)for(var i=s[t],o=0,a=i.length,c;o<a;++o)(c=i[o])&&(yield c)}var eb=[null];function hn(s,t){this._groups=s,this._parents=t}function ml(){return new hn([[document.documentElement]],eb)}function tM(){return this}hn.prototype=ml.prototype={constructor:hn,select:ET,selectAll:AT,selectChild:RT,selectChildren:HT,filter:UT,data:IT,enter:PT,exit:$T,join:qT,merge:WT,selection:tM,order:ZT,sort:KT,call:JT,nodes:tE,node:eE,size:nE,empty:iE,each:sE,attr:hE,style:pE,property:xE,classed:wE,text:ME,html:kE,raise:NE,lower:zE,append:LE,insert:HE,remove:PE,clone:XE,datum:FE,on:WE,dispatch:QE,[Symbol.iterator]:JE};function cn(s){return typeof s=="string"?new hn([[document.querySelector(s)]],[document.documentElement]):new hn([[s]],eb)}function eM(s){let t;for(;t=s.sourceEvent;)s=t;return s}function Nn(s,t){if(s=eM(s),t===void 0&&(t=s.currentTarget),t){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var i=e.createSVGPoint();return i.x=s.clientX,i.y=s.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[s.clientX-o.left-t.clientLeft,s.clientY-o.top-t.clientTop]}}return[s.pageX,s.pageY]}const nM={passive:!1},tl={capture:!0,passive:!1};function lg(s){s.stopImmediatePropagation()}function vo(s){s.preventDefault(),s.stopImmediatePropagation()}function nb(s){var t=s.document.documentElement,e=cn(s).on("dragstart.drag",vo,tl);"onselectstart"in t?e.on("selectstart.drag",vo,tl):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ib(s,t){var e=s.document.documentElement,i=cn(s).on("dragstart.drag",null);t&&(i.on("click.drag",vo,tl),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in e?i.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}const qc=s=>()=>s;function Hg(s,{sourceEvent:t,subject:e,target:i,identifier:o,active:a,x:c,y:h,dx:f,dy:d,dispatch:p}){Object.defineProperties(this,{type:{value:s,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:h,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:p}})}Hg.prototype.on=function(){var s=this._.on.apply(this._,arguments);return s===this._?this:s};function iM(s){return!s.ctrlKey&&!s.button}function sM(){return this.parentNode}function rM(s,t){return t??{x:s.x,y:s.y}}function oM(){return navigator.maxTouchPoints||"ontouchstart"in this}function sb(){var s=iM,t=sM,e=rM,i=oM,o={},a=gh("start","drag","end"),c=0,h,f,d,p,y=0;function v(D){D.on("mousedown.drag",x).filter(i).on("touchstart.drag",T).on("touchmove.drag",E,nM).on("touchend.drag touchcancel.drag",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function x(D,j){if(!(p||!s.call(this,D,j))){var R=C(this,t.call(this,D,j),D,j,"mouse");R&&(cn(D.view).on("mousemove.drag",b,tl).on("mouseup.drag",w,tl),nb(D.view),lg(D),d=!1,h=D.clientX,f=D.clientY,R("start",D))}}function b(D){if(vo(D),!d){var j=D.clientX-h,R=D.clientY-f;d=j*j+R*R>y}o.mouse("drag",D)}function w(D){cn(D.view).on("mousemove.drag mouseup.drag",null),ib(D.view,d),vo(D),o.mouse("end",D)}function T(D,j){if(s.call(this,D,j)){var R=D.changedTouches,z=t.call(this,D,j),U=R.length,G,ut;for(G=0;G<U;++G)(ut=C(this,z,D,j,R[G].identifier,R[G]))&&(lg(D),ut("start",D,R[G]))}}function E(D){var j=D.changedTouches,R=j.length,z,U;for(z=0;z<R;++z)(U=o[j[z].identifier])&&(vo(D),U("drag",D,j[z]))}function M(D){var j=D.changedTouches,R=j.length,z,U;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),z=0;z<R;++z)(U=o[j[z].identifier])&&(lg(D),U("end",D,j[z]))}function C(D,j,R,z,U,G){var ut=a.copy(),W=Nn(G||R,j),Z,rt,N;if((N=e.call(D,new Hg("beforestart",{sourceEvent:R,target:v,identifier:U,active:c,x:W[0],y:W[1],dx:0,dy:0,dispatch:ut}),z))!=null)return Z=N.x-W[0]||0,rt=N.y-W[1]||0,function I(A,L,H){var q=W,st;switch(A){case"start":o[U]=I,st=c++;break;case"end":delete o[U],--c;case"drag":W=Nn(H||L,j),st=c;break}ut.call(A,D,new Hg(A,{sourceEvent:L,subject:N,target:v,identifier:U,active:st,x:W[0]+Z,y:W[1]+rt,dx:W[0]-q[0],dy:W[1]-q[1],dispatch:ut}),z)}}return v.filter=function(D){return arguments.length?(s=typeof D=="function"?D:qc(!!D),v):s},v.container=function(D){return arguments.length?(t=typeof D=="function"?D:qc(D),v):t},v.subject=function(D){return arguments.length?(e=typeof D=="function"?D:qc(D),v):e},v.touchable=function(D){return arguments.length?(i=typeof D=="function"?D:qc(!!D),v):i},v.on=function(){var D=a.on.apply(a,arguments);return D===a?v:D},v.clickDistance=function(D){return arguments.length?(y=(D=+D)*D,v):Math.sqrt(y)},v}function dp(s,t,e){s.prototype=t.prototype=e,e.constructor=s}function rb(s,t){var e=Object.create(s.prototype);for(var i in t)e[i]=t[i];return e}function yl(){}var el=.7,Fu=1/el,xo="\\s*([+-]?\\d+)\\s*",nl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Jn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",aM=/^#([0-9a-f]{3,8})$/,lM=new RegExp(`^rgb\\(${xo},${xo},${xo}\\)$`),cM=new RegExp(`^rgb\\(${Jn},${Jn},${Jn}\\)$`),uM=new RegExp(`^rgba\\(${xo},${xo},${xo},${nl}\\)$`),hM=new RegExp(`^rgba\\(${Jn},${Jn},${Jn},${nl}\\)$`),fM=new RegExp(`^hsl\\(${nl},${Jn},${Jn}\\)$`),dM=new RegExp(`^hsla\\(${nl},${Jn},${Jn},${nl}\\)$`),Qv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};dp(yl,gr,{copy(s){return Object.assign(new this.constructor,this,s)},displayable(){return this.rgb().displayable()},hex:Jv,formatHex:Jv,formatHex8:gM,formatHsl:pM,formatRgb:tx,toString:tx});function Jv(){return this.rgb().formatHex()}function gM(){return this.rgb().formatHex8()}function pM(){return ob(this).formatHsl()}function tx(){return this.rgb().formatRgb()}function gr(s){var t,e;return s=(s+"").trim().toLowerCase(),(t=aM.exec(s))?(e=t[1].length,t=parseInt(t[1],16),e===6?ex(t):e===3?new We(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?Wc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?Wc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=lM.exec(s))?new We(t[1],t[2],t[3],1):(t=cM.exec(s))?new We(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=uM.exec(s))?Wc(t[1],t[2],t[3],t[4]):(t=hM.exec(s))?Wc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=fM.exec(s))?sx(t[1],t[2]/100,t[3]/100,1):(t=dM.exec(s))?sx(t[1],t[2]/100,t[3]/100,t[4]):Qv.hasOwnProperty(s)?ex(Qv[s]):s==="transparent"?new We(NaN,NaN,NaN,0):null}function ex(s){return new We(s>>16&255,s>>8&255,s&255,1)}function Wc(s,t,e,i){return i<=0&&(s=t=e=NaN),new We(s,t,e,i)}function mM(s){return s instanceof yl||(s=gr(s)),s?(s=s.rgb(),new We(s.r,s.g,s.b,s.opacity)):new We}function Ug(s,t,e,i){return arguments.length===1?mM(s):new We(s,t,e,i??1)}function We(s,t,e,i){this.r=+s,this.g=+t,this.b=+e,this.opacity=+i}dp(We,Ug,rb(yl,{brighter(s){return s=s==null?Fu:Math.pow(Fu,s),new We(this.r*s,this.g*s,this.b*s,this.opacity)},darker(s){return s=s==null?el:Math.pow(el,s),new We(this.r*s,this.g*s,this.b*s,this.opacity)},rgb(){return this},clamp(){return new We(cr(this.r),cr(this.g),cr(this.b),Iu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nx,formatHex:nx,formatHex8:yM,formatRgb:ix,toString:ix}));function nx(){return`#${rr(this.r)}${rr(this.g)}${rr(this.b)}`}function yM(){return`#${rr(this.r)}${rr(this.g)}${rr(this.b)}${rr((isNaN(this.opacity)?1:this.opacity)*255)}`}function ix(){const s=Iu(this.opacity);return`${s===1?"rgb(":"rgba("}${cr(this.r)}, ${cr(this.g)}, ${cr(this.b)}${s===1?")":`, ${s})`}`}function Iu(s){return isNaN(s)?1:Math.max(0,Math.min(1,s))}function cr(s){return Math.max(0,Math.min(255,Math.round(s)||0))}function rr(s){return s=cr(s),(s<16?"0":"")+s.toString(16)}function sx(s,t,e,i){return i<=0?s=t=e=NaN:e<=0||e>=1?s=t=NaN:t<=0&&(s=NaN),new zn(s,t,e,i)}function ob(s){if(s instanceof zn)return new zn(s.h,s.s,s.l,s.opacity);if(s instanceof yl||(s=gr(s)),!s)return new zn;if(s instanceof zn)return s;s=s.rgb();var t=s.r/255,e=s.g/255,i=s.b/255,o=Math.min(t,e,i),a=Math.max(t,e,i),c=NaN,h=a-o,f=(a+o)/2;return h?(t===a?c=(e-i)/h+(e<i)*6:e===a?c=(i-t)/h+2:c=(t-e)/h+4,h/=f<.5?a+o:2-a-o,c*=60):h=f>0&&f<1?0:c,new zn(c,h,f,s.opacity)}function vM(s,t,e,i){return arguments.length===1?ob(s):new zn(s,t,e,i??1)}function zn(s,t,e,i){this.h=+s,this.s=+t,this.l=+e,this.opacity=+i}dp(zn,vM,rb(yl,{brighter(s){return s=s==null?Fu:Math.pow(Fu,s),new zn(this.h,this.s,this.l*s,this.opacity)},darker(s){return s=s==null?el:Math.pow(el,s),new zn(this.h,this.s,this.l*s,this.opacity)},rgb(){var s=this.h%360+(this.h<0)*360,t=isNaN(s)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*t,o=2*e-i;return new We(cg(s>=240?s-240:s+120,o,i),cg(s,o,i),cg(s<120?s+240:s-120,o,i),this.opacity)},clamp(){return new zn(rx(this.h),Zc(this.s),Zc(this.l),Iu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const s=Iu(this.opacity);return`${s===1?"hsl(":"hsla("}${rx(this.h)}, ${Zc(this.s)*100}%, ${Zc(this.l)*100}%${s===1?")":`, ${s})`}`}}));function rx(s){return s=(s||0)%360,s<0?s+360:s}function Zc(s){return Math.max(0,Math.min(1,s||0))}function cg(s,t,e){return(s<60?t+(e-t)*s/60:s<180?e:s<240?t+(e-t)*(240-s)/60:t)*255}const gp=s=>()=>s;function xM(s,t){return function(e){return s+e*t}}function bM(s,t,e){return s=Math.pow(s,e),t=Math.pow(t,e)-s,e=1/e,function(i){return Math.pow(s+i*t,e)}}function SM(s){return(s=+s)==1?ab:function(t,e){return e-t?bM(t,e,s):gp(isNaN(t)?e:t)}}function ab(s,t){var e=t-s;return e?xM(s,e):gp(isNaN(s)?t:s)}const Gu=(function s(t){var e=SM(t);function i(o,a){var c=e((o=Ug(o)).r,(a=Ug(a)).r),h=e(o.g,a.g),f=e(o.b,a.b),d=ab(o.opacity,a.opacity);return function(p){return o.r=c(p),o.g=h(p),o.b=f(p),o.opacity=d(p),o+""}}return i.gamma=s,i})(1);function _M(s,t){t||(t=[]);var e=s?Math.min(t.length,s.length):0,i=t.slice(),o;return function(a){for(o=0;o<e;++o)i[o]=s[o]*(1-a)+t[o]*a;return i}}function wM(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function CM(s,t){var e=t?t.length:0,i=s?Math.min(e,s.length):0,o=new Array(i),a=new Array(e),c;for(c=0;c<i;++c)o[c]=$a(s[c],t[c]);for(;c<e;++c)a[c]=t[c];return function(h){for(c=0;c<i;++c)a[c]=o[c](h);return a}}function TM(s,t){var e=new Date;return s=+s,t=+t,function(i){return e.setTime(s*(1-i)+t*i),e}}function Wn(s,t){return s=+s,t=+t,function(e){return s*(1-e)+t*e}}function EM(s,t){var e={},i={},o;(s===null||typeof s!="object")&&(s={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in s?e[o]=$a(s[o],t[o]):i[o]=t[o];return function(a){for(o in e)i[o]=e[o](a);return i}}var Pg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ug=new RegExp(Pg.source,"g");function MM(s){return function(){return s}}function DM(s){return function(t){return s(t)+""}}function lb(s,t){var e=Pg.lastIndex=ug.lastIndex=0,i,o,a,c=-1,h=[],f=[];for(s=s+"",t=t+"";(i=Pg.exec(s))&&(o=ug.exec(t));)(a=o.index)>e&&(a=t.slice(e,a),h[c]?h[c]+=a:h[++c]=a),(i=i[0])===(o=o[0])?h[c]?h[c]+=o:h[++c]=o:(h[++c]=null,f.push({i:c,x:Wn(i,o)})),e=ug.lastIndex;return e<t.length&&(a=t.slice(e),h[c]?h[c]+=a:h[++c]=a),h.length<2?f[0]?DM(f[0].x):MM(t):(t=f.length,function(d){for(var p=0,y;p<t;++p)h[(y=f[p]).i]=y.x(d);return h.join("")})}function $a(s,t){var e=typeof t,i;return t==null||e==="boolean"?gp(t):(e==="number"?Wn:e==="string"?(i=gr(t))?(t=i,Gu):lb:t instanceof gr?Gu:t instanceof Date?TM:wM(t)?_M:Array.isArray(t)?CM:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?EM:Wn)(s,t)}var ox=180/Math.PI,Yg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function cb(s,t,e,i,o,a){var c,h,f;return(c=Math.sqrt(s*s+t*t))&&(s/=c,t/=c),(f=s*e+t*i)&&(e-=s*f,i-=t*f),(h=Math.sqrt(e*e+i*i))&&(e/=h,i/=h,f/=h),s*i<t*e&&(s=-s,t=-t,f=-f,c=-c),{translateX:o,translateY:a,rotate:Math.atan2(t,s)*ox,skewX:Math.atan(f)*ox,scaleX:c,scaleY:h}}var Kc;function OM(s){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(s+"");return t.isIdentity?Yg:cb(t.a,t.b,t.c,t.d,t.e,t.f)}function AM(s){return s==null||(Kc||(Kc=document.createElementNS("http://www.w3.org/2000/svg","g")),Kc.setAttribute("transform",s),!(s=Kc.transform.baseVal.consolidate()))?Yg:(s=s.matrix,cb(s.a,s.b,s.c,s.d,s.e,s.f))}function ub(s,t,e,i){function o(d){return d.length?d.pop()+" ":""}function a(d,p,y,v,x,b){if(d!==y||p!==v){var w=x.push("translate(",null,t,null,e);b.push({i:w-4,x:Wn(d,y)},{i:w-2,x:Wn(p,v)})}else(y||v)&&x.push("translate("+y+t+v+e)}function c(d,p,y,v){d!==p?(d-p>180?p+=360:p-d>180&&(d+=360),v.push({i:y.push(o(y)+"rotate(",null,i)-2,x:Wn(d,p)})):p&&y.push(o(y)+"rotate("+p+i)}function h(d,p,y,v){d!==p?v.push({i:y.push(o(y)+"skewX(",null,i)-2,x:Wn(d,p)}):p&&y.push(o(y)+"skewX("+p+i)}function f(d,p,y,v,x,b){if(d!==y||p!==v){var w=x.push(o(x)+"scale(",null,",",null,")");b.push({i:w-4,x:Wn(d,y)},{i:w-2,x:Wn(p,v)})}else(y!==1||v!==1)&&x.push(o(x)+"scale("+y+","+v+")")}return function(d,p){var y=[],v=[];return d=s(d),p=s(p),a(d.translateX,d.translateY,p.translateX,p.translateY,y,v),c(d.rotate,p.rotate,y,v),h(d.skewX,p.skewX,y,v),f(d.scaleX,d.scaleY,p.scaleX,p.scaleY,y,v),d=p=null,function(x){for(var b=-1,w=v.length,T;++b<w;)y[(T=v[b]).i]=T.x(x);return y.join("")}}}var kM=ub(OM,"px, ","px)","deg)"),jM=ub(AM,", ",")",")"),NM=1e-12;function ax(s){return((s=Math.exp(s))+1/s)/2}function RM(s){return((s=Math.exp(s))-1/s)/2}function zM(s){return((s=Math.exp(2*s))-1)/(s+1)}const ju=(function s(t,e,i){function o(a,c){var h=a[0],f=a[1],d=a[2],p=c[0],y=c[1],v=c[2],x=p-h,b=y-f,w=x*x+b*b,T,E;if(w<NM)E=Math.log(v/d)/t,T=function(z){return[h+z*x,f+z*b,d*Math.exp(t*z*E)]};else{var M=Math.sqrt(w),C=(v*v-d*d+i*w)/(2*d*e*M),D=(v*v-d*d-i*w)/(2*v*e*M),j=Math.log(Math.sqrt(C*C+1)-C),R=Math.log(Math.sqrt(D*D+1)-D);E=(R-j)/t,T=function(z){var U=z*E,G=ax(j),ut=d/(e*M)*(G*zM(t*U+j)-RM(j));return[h+ut*x,f+ut*b,d*G/ax(t*U+j)]}}return T.duration=E*1e3*t/Math.SQRT2,T}return o.rho=function(a){var c=Math.max(.001,+a),h=c*c,f=h*h;return s(c,h,f)},o})(Math.SQRT2,2,4);var Co=0,Fa=0,Ha=0,hb=1e3,$u,Ia,qu=0,pr=0,mh=0,il=typeof performance=="object"&&performance.now?performance:Date,fb=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(s){setTimeout(s,17)};function pp(){return pr||(fb(LM),pr=il.now()+mh)}function LM(){pr=0}function Wu(){this._call=this._time=this._next=null}Wu.prototype=db.prototype={constructor:Wu,restart:function(s,t,e){if(typeof s!="function")throw new TypeError("callback is not a function");e=(e==null?pp():+e)+(t==null?0:+t),!this._next&&Ia!==this&&(Ia?Ia._next=this:$u=this,Ia=this),this._call=s,this._time=e,Vg()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vg())}};function db(s,t,e){var i=new Wu;return i.restart(s,t,e),i}function BM(){pp(),++Co;for(var s=$u,t;s;)(t=pr-s._time)>=0&&s._call.call(void 0,t),s=s._next;--Co}function lx(){pr=(qu=il.now())+mh,Co=Fa=0;try{BM()}finally{Co=0,UM(),pr=0}}function HM(){var s=il.now(),t=s-qu;t>hb&&(mh-=t,qu=s)}function UM(){for(var s,t=$u,e,i=1/0;t;)t._call?(i>t._time&&(i=t._time),s=t,t=t._next):(e=t._next,t._next=null,t=s?s._next=e:$u=e);Ia=s,Vg(i)}function Vg(s){if(!Co){Fa&&(Fa=clearTimeout(Fa));var t=s-pr;t>24?(s<1/0&&(Fa=setTimeout(lx,s-il.now()-mh)),Ha&&(Ha=clearInterval(Ha))):(Ha||(qu=il.now(),Ha=setInterval(HM,hb)),Co=1,fb(lx))}}function cx(s,t,e){var i=new Wu;return t=t==null?0:+t,i.restart(o=>{i.stop(),s(o+t)},t,e),i}var PM=gh("start","end","cancel","interrupt"),YM=[],gb=0,ux=1,Xg=2,Nu=3,hx=4,Fg=5,Ru=6;function yh(s,t,e,i,o,a){var c=s.__transition;if(!c)s.__transition={};else if(e in c)return;VM(s,e,{name:t,index:i,group:o,on:PM,tween:YM,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:gb})}function mp(s,t){var e=Yn(s,t);if(e.state>gb)throw new Error("too late; already scheduled");return e}function ii(s,t){var e=Yn(s,t);if(e.state>Nu)throw new Error("too late; already running");return e}function Yn(s,t){var e=s.__transition;if(!e||!(e=e[t]))throw new Error("transition not found");return e}function VM(s,t,e){var i=s.__transition,o;i[t]=e,e.timer=db(a,0,e.time);function a(d){e.state=ux,e.timer.restart(c,e.delay,e.time),e.delay<=d&&c(d-e.delay)}function c(d){var p,y,v,x;if(e.state!==ux)return f();for(p in i)if(x=i[p],x.name===e.name){if(x.state===Nu)return cx(c);x.state===hx?(x.state=Ru,x.timer.stop(),x.on.call("interrupt",s,s.__data__,x.index,x.group),delete i[p]):+p<t&&(x.state=Ru,x.timer.stop(),x.on.call("cancel",s,s.__data__,x.index,x.group),delete i[p])}if(cx(function(){e.state===Nu&&(e.state=hx,e.timer.restart(h,e.delay,e.time),h(d))}),e.state=Xg,e.on.call("start",s,s.__data__,e.index,e.group),e.state===Xg){for(e.state=Nu,o=new Array(v=e.tween.length),p=0,y=-1;p<v;++p)(x=e.tween[p].value.call(s,s.__data__,e.index,e.group))&&(o[++y]=x);o.length=y+1}}function h(d){for(var p=d<e.duration?e.ease.call(null,d/e.duration):(e.timer.restart(f),e.state=Fg,1),y=-1,v=o.length;++y<v;)o[y].call(s,p);e.state===Fg&&(e.on.call("end",s,s.__data__,e.index,e.group),f())}function f(){e.state=Ru,e.timer.stop(),delete i[t];for(var d in i)return;delete s.__transition}}function zu(s,t){var e=s.__transition,i,o,a=!0,c;if(e){t=t==null?null:t+"";for(c in e){if((i=e[c]).name!==t){a=!1;continue}o=i.state>Xg&&i.state<Fg,i.state=Ru,i.timer.stop(),i.on.call(o?"interrupt":"cancel",s,s.__data__,i.index,i.group),delete e[c]}a&&delete s.__transition}}function XM(s){return this.each(function(){zu(this,s)})}function FM(s,t){var e,i;return function(){var o=ii(this,s),a=o.tween;if(a!==e){i=e=a;for(var c=0,h=i.length;c<h;++c)if(i[c].name===t){i=i.slice(),i.splice(c,1);break}}o.tween=i}}function IM(s,t,e){var i,o;if(typeof e!="function")throw new Error;return function(){var a=ii(this,s),c=a.tween;if(c!==i){o=(i=c).slice();for(var h={name:t,value:e},f=0,d=o.length;f<d;++f)if(o[f].name===t){o[f]=h;break}f===d&&o.push(h)}a.tween=o}}function GM(s,t){var e=this._id;if(s+="",arguments.length<2){for(var i=Yn(this.node(),e).tween,o=0,a=i.length,c;o<a;++o)if((c=i[o]).name===s)return c.value;return null}return this.each((t==null?FM:IM)(e,s,t))}function yp(s,t,e){var i=s._id;return s.each(function(){var o=ii(this,i);(o.value||(o.value={}))[t]=e.apply(this,arguments)}),function(o){return Yn(o,i).value[t]}}function pb(s,t){var e;return(typeof t=="number"?Wn:t instanceof gr?Gu:(e=gr(t))?(t=e,Gu):lb)(s,t)}function $M(s){return function(){this.removeAttribute(s)}}function qM(s){return function(){this.removeAttributeNS(s.space,s.local)}}function WM(s,t,e){var i,o=e+"",a;return function(){var c=this.getAttribute(s);return c===o?null:c===i?a:a=t(i=c,e)}}function ZM(s,t,e){var i,o=e+"",a;return function(){var c=this.getAttributeNS(s.space,s.local);return c===o?null:c===i?a:a=t(i=c,e)}}function KM(s,t,e){var i,o,a;return function(){var c,h=e(this),f;return h==null?void this.removeAttribute(s):(c=this.getAttribute(s),f=h+"",c===f?null:c===i&&f===o?a:(o=f,a=t(i=c,h)))}}function QM(s,t,e){var i,o,a;return function(){var c,h=e(this),f;return h==null?void this.removeAttributeNS(s.space,s.local):(c=this.getAttributeNS(s.space,s.local),f=h+"",c===f?null:c===i&&f===o?a:(o=f,a=t(i=c,h)))}}function JM(s,t){var e=ph(s),i=e==="transform"?jM:pb;return this.attrTween(s,typeof t=="function"?(e.local?QM:KM)(e,i,yp(this,"attr."+s,t)):t==null?(e.local?qM:$M)(e):(e.local?ZM:WM)(e,i,t))}function tD(s,t){return function(e){this.setAttribute(s,t.call(this,e))}}function eD(s,t){return function(e){this.setAttributeNS(s.space,s.local,t.call(this,e))}}function nD(s,t){var e,i;function o(){var a=t.apply(this,arguments);return a!==i&&(e=(i=a)&&eD(s,a)),e}return o._value=t,o}function iD(s,t){var e,i;function o(){var a=t.apply(this,arguments);return a!==i&&(e=(i=a)&&tD(s,a)),e}return o._value=t,o}function sD(s,t){var e="attr."+s;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;var i=ph(s);return this.tween(e,(i.local?nD:iD)(i,t))}function rD(s,t){return function(){mp(this,s).delay=+t.apply(this,arguments)}}function oD(s,t){return t=+t,function(){mp(this,s).delay=t}}function aD(s){var t=this._id;return arguments.length?this.each((typeof s=="function"?rD:oD)(t,s)):Yn(this.node(),t).delay}function lD(s,t){return function(){ii(this,s).duration=+t.apply(this,arguments)}}function cD(s,t){return t=+t,function(){ii(this,s).duration=t}}function uD(s){var t=this._id;return arguments.length?this.each((typeof s=="function"?lD:cD)(t,s)):Yn(this.node(),t).duration}function hD(s,t){if(typeof t!="function")throw new Error;return function(){ii(this,s).ease=t}}function fD(s){var t=this._id;return arguments.length?this.each(hD(t,s)):Yn(this.node(),t).ease}function dD(s,t){return function(){var e=t.apply(this,arguments);if(typeof e!="function")throw new Error;ii(this,s).ease=e}}function gD(s){if(typeof s!="function")throw new Error;return this.each(dD(this._id,s))}function pD(s){typeof s!="function"&&(s=G1(s));for(var t=this._groups,e=t.length,i=new Array(e),o=0;o<e;++o)for(var a=t[o],c=a.length,h=i[o]=[],f,d=0;d<c;++d)(f=a[d])&&s.call(f,f.__data__,d,a)&&h.push(f);return new Bi(i,this._parents,this._name,this._id)}function mD(s){if(s._id!==this._id)throw new Error;for(var t=this._groups,e=s._groups,i=t.length,o=e.length,a=Math.min(i,o),c=new Array(i),h=0;h<a;++h)for(var f=t[h],d=e[h],p=f.length,y=c[h]=new Array(p),v,x=0;x<p;++x)(v=f[x]||d[x])&&(y[x]=v);for(;h<i;++h)c[h]=t[h];return new Bi(c,this._parents,this._name,this._id)}function yD(s){return(s+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||t==="start"})}function vD(s,t,e){var i,o,a=yD(t)?mp:ii;return function(){var c=a(this,s),h=c.on;h!==i&&(o=(i=h).copy()).on(t,e),c.on=o}}function xD(s,t){var e=this._id;return arguments.length<2?Yn(this.node(),e).on.on(s):this.each(vD(e,s,t))}function bD(s){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==s)return;t&&t.removeChild(this)}}function SD(){return this.on("end.remove",bD(this._id))}function _D(s){var t=this._name,e=this._id;typeof s!="function"&&(s=hp(s));for(var i=this._groups,o=i.length,a=new Array(o),c=0;c<o;++c)for(var h=i[c],f=h.length,d=a[c]=new Array(f),p,y,v=0;v<f;++v)(p=h[v])&&(y=s.call(p,p.__data__,v,h))&&("__data__"in p&&(y.__data__=p.__data__),d[v]=y,yh(d[v],t,e,v,d,Yn(p,e)));return new Bi(a,this._parents,t,e)}function wD(s){var t=this._name,e=this._id;typeof s!="function"&&(s=I1(s));for(var i=this._groups,o=i.length,a=[],c=[],h=0;h<o;++h)for(var f=i[h],d=f.length,p,y=0;y<d;++y)if(p=f[y]){for(var v=s.call(p,p.__data__,y,f),x,b=Yn(p,e),w=0,T=v.length;w<T;++w)(x=v[w])&&yh(x,t,e,w,v,b);a.push(v),c.push(p)}return new Bi(a,c,t,e)}var CD=ml.prototype.constructor;function TD(){return new CD(this._groups,this._parents)}function ED(s,t){var e,i,o;return function(){var a=wo(this,s),c=(this.style.removeProperty(s),wo(this,s));return a===c?null:a===e&&c===i?o:o=t(e=a,i=c)}}function mb(s){return function(){this.style.removeProperty(s)}}function MD(s,t,e){var i,o=e+"",a;return function(){var c=wo(this,s);return c===o?null:c===i?a:a=t(i=c,e)}}function DD(s,t,e){var i,o,a;return function(){var c=wo(this,s),h=e(this),f=h+"";return h==null&&(f=h=(this.style.removeProperty(s),wo(this,s))),c===f?null:c===i&&f===o?a:(o=f,a=t(i=c,h))}}function OD(s,t){var e,i,o,a="style."+t,c="end."+a,h;return function(){var f=ii(this,s),d=f.on,p=f.value[a]==null?h||(h=mb(t)):void 0;(d!==e||o!==p)&&(i=(e=d).copy()).on(c,o=p),f.on=i}}function AD(s,t,e){var i=(s+="")=="transform"?kM:pb;return t==null?this.styleTween(s,ED(s,i)).on("end.style."+s,mb(s)):typeof t=="function"?this.styleTween(s,DD(s,i,yp(this,"style."+s,t))).each(OD(this._id,s)):this.styleTween(s,MD(s,i,t),e).on("end.style."+s,null)}function kD(s,t,e){return function(i){this.style.setProperty(s,t.call(this,i),e)}}function jD(s,t,e){var i,o;function a(){var c=t.apply(this,arguments);return c!==o&&(i=(o=c)&&kD(s,c,e)),i}return a._value=t,a}function ND(s,t,e){var i="style."+(s+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,jD(s,t,e??""))}function RD(s){return function(){this.textContent=s}}function zD(s){return function(){var t=s(this);this.textContent=t??""}}function LD(s){return this.tween("text",typeof s=="function"?zD(yp(this,"text",s)):RD(s==null?"":s+""))}function BD(s){return function(t){this.textContent=s.call(this,t)}}function HD(s){var t,e;function i(){var o=s.apply(this,arguments);return o!==e&&(t=(e=o)&&BD(o)),t}return i._value=s,i}function UD(s){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(s==null)return this.tween(t,null);if(typeof s!="function")throw new Error;return this.tween(t,HD(s))}function PD(){for(var s=this._name,t=this._id,e=yb(),i=this._groups,o=i.length,a=0;a<o;++a)for(var c=i[a],h=c.length,f,d=0;d<h;++d)if(f=c[d]){var p=Yn(f,t);yh(f,s,e,d,c,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Bi(i,this._parents,s,e)}function YD(){var s,t,e=this,i=e._id,o=e.size();return new Promise(function(a,c){var h={value:c},f={value:function(){--o===0&&a()}};e.each(function(){var d=ii(this,i),p=d.on;p!==s&&(t=(s=p).copy(),t._.cancel.push(h),t._.interrupt.push(h),t._.end.push(f)),d.on=t}),o===0&&a()})}var VD=0;function Bi(s,t,e,i){this._groups=s,this._parents=t,this._name=e,this._id=i}function yb(){return++VD}var Mi=ml.prototype;Bi.prototype={constructor:Bi,select:_D,selectAll:wD,selectChild:Mi.selectChild,selectChildren:Mi.selectChildren,filter:pD,merge:mD,selection:TD,transition:PD,call:Mi.call,nodes:Mi.nodes,node:Mi.node,size:Mi.size,empty:Mi.empty,each:Mi.each,on:xD,attr:JM,attrTween:sD,style:AD,styleTween:ND,text:LD,textTween:UD,remove:SD,tween:GM,delay:aD,duration:uD,ease:fD,easeVarying:gD,end:YD,[Symbol.iterator]:Mi[Symbol.iterator]};function XD(s){return((s*=2)<=1?s*s*s:(s-=2)*s*s+2)/2}var FD={time:null,delay:0,duration:250,ease:XD};function ID(s,t){for(var e;!(e=s.__transition)||!(e=e[t]);)if(!(s=s.parentNode))throw new Error(`transition ${t} not found`);return e}function GD(s){var t,e;s instanceof Bi?(t=s._id,s=s._name):(t=yb(),(e=FD).time=pp(),s=s==null?null:s+"");for(var i=this._groups,o=i.length,a=0;a<o;++a)for(var c=i[a],h=c.length,f,d=0;d<h;++d)(f=c[d])&&yh(f,s,t,d,c,e||ID(f,t));return new Bi(i,this._parents,s,t)}ml.prototype.interrupt=XM;ml.prototype.transition=GD;const Qc=s=>()=>s;function $D(s,{sourceEvent:t,target:e,transform:i,dispatch:o}){Object.defineProperties(this,{type:{value:s,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function ji(s,t,e){this.k=s,this.x=t,this.y=e}ji.prototype={constructor:ji,scale:function(s){return s===1?this:new ji(this.k*s,this.x,this.y)},translate:function(s,t){return s===0&t===0?this:new ji(this.k,this.x+this.k*s,this.y+this.k*t)},apply:function(s){return[s[0]*this.k+this.x,s[1]*this.k+this.y]},applyX:function(s){return s*this.k+this.x},applyY:function(s){return s*this.k+this.y},invert:function(s){return[(s[0]-this.x)/this.k,(s[1]-this.y)/this.k]},invertX:function(s){return(s-this.x)/this.k},invertY:function(s){return(s-this.y)/this.k},rescaleX:function(s){return s.copy().domain(s.range().map(this.invertX,this).map(s.invert,s))},rescaleY:function(s){return s.copy().domain(s.range().map(this.invertY,this).map(s.invert,s))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var vh=new ji(1,0,0);vb.prototype=ji.prototype;function vb(s){for(;!s.__zoom;)if(!(s=s.parentNode))return vh;return s.__zoom}function hg(s){s.stopImmediatePropagation()}function Ua(s){s.preventDefault(),s.stopImmediatePropagation()}function qD(s){return(!s.ctrlKey||s.type==="wheel")&&!s.button}function WD(){var s=this;return s instanceof SVGElement?(s=s.ownerSVGElement||s,s.hasAttribute("viewBox")?(s=s.viewBox.baseVal,[[s.x,s.y],[s.x+s.width,s.y+s.height]]):[[0,0],[s.width.baseVal.value,s.height.baseVal.value]]):[[0,0],[s.clientWidth,s.clientHeight]]}function fx(){return this.__zoom||vh}function ZD(s){return-s.deltaY*(s.deltaMode===1?.05:s.deltaMode?1:.002)*(s.ctrlKey?10:1)}function KD(){return navigator.maxTouchPoints||"ontouchstart"in this}function QD(s,t,e){var i=s.invertX(t[0][0])-e[0][0],o=s.invertX(t[1][0])-e[1][0],a=s.invertY(t[0][1])-e[0][1],c=s.invertY(t[1][1])-e[1][1];return s.translate(o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o),c>a?(a+c)/2:Math.min(0,a)||Math.max(0,c))}function xb(){var s=qD,t=WD,e=QD,i=ZD,o=KD,a=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],h=250,f=ju,d=gh("start","zoom","end"),p,y,v,x=500,b=150,w=0,T=10;function E(N){N.property("__zoom",fx).on("wheel.zoom",U,{passive:!1}).on("mousedown.zoom",G).on("dblclick.zoom",ut).filter(o).on("touchstart.zoom",W).on("touchmove.zoom",Z).on("touchend.zoom touchcancel.zoom",rt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}E.transform=function(N,I,A,L){var H=N.selection?N.selection():N;H.property("__zoom",fx),N!==H?j(N,I,A,L):H.interrupt().each(function(){R(this,arguments).event(L).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},E.scaleBy=function(N,I,A,L){E.scaleTo(N,function(){var H=this.__zoom.k,q=typeof I=="function"?I.apply(this,arguments):I;return H*q},A,L)},E.scaleTo=function(N,I,A,L){E.transform(N,function(){var H=t.apply(this,arguments),q=this.__zoom,st=A==null?D(H):typeof A=="function"?A.apply(this,arguments):A,k=q.invert(st),P=typeof I=="function"?I.apply(this,arguments):I;return e(C(M(q,P),st,k),H,c)},A,L)},E.translateBy=function(N,I,A,L){E.transform(N,function(){return e(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),c)},null,L)},E.translateTo=function(N,I,A,L,H){E.transform(N,function(){var q=t.apply(this,arguments),st=this.__zoom,k=L==null?D(q):typeof L=="function"?L.apply(this,arguments):L;return e(vh.translate(k[0],k[1]).scale(st.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof A=="function"?-A.apply(this,arguments):-A),q,c)},L,H)};function M(N,I){return I=Math.max(a[0],Math.min(a[1],I)),I===N.k?N:new ji(I,N.x,N.y)}function C(N,I,A){var L=I[0]-A[0]*N.k,H=I[1]-A[1]*N.k;return L===N.x&&H===N.y?N:new ji(N.k,L,H)}function D(N){return[(+N[0][0]+ +N[1][0])/2,(+N[0][1]+ +N[1][1])/2]}function j(N,I,A,L){N.on("start.zoom",function(){R(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){R(this,arguments).event(L).end()}).tween("zoom",function(){var H=this,q=arguments,st=R(H,q).event(L),k=t.apply(H,q),P=A==null?D(k):typeof A=="function"?A.apply(H,q):A,et=Math.max(k[1][0]-k[0][0],k[1][1]-k[0][1]),nt=H.__zoom,ht=typeof I=="function"?I.apply(H,q):I,dt=f(nt.invert(P).concat(et/nt.k),ht.invert(P).concat(et/ht.k));return function(ft){if(ft===1)ft=ht;else{var X=dt(ft),ot=et/X[2];ft=new ji(ot,P[0]-X[0]*ot,P[1]-X[1]*ot)}st.zoom(null,ft)}})}function R(N,I,A){return!A&&N.__zooming||new z(N,I)}function z(N,I){this.that=N,this.args=I,this.active=0,this.sourceEvent=null,this.extent=t.apply(N,I),this.taps=0}z.prototype={event:function(N){return N&&(this.sourceEvent=N),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(N,I){return this.mouse&&N!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&N!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&N!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(N){var I=cn(this.that).datum();d.call(N,this.that,new $D(N,{sourceEvent:this.sourceEvent,target:E,transform:this.that.__zoom,dispatch:d}),I)}};function U(N,...I){if(!s.apply(this,arguments))return;var A=R(this,I).event(N),L=this.__zoom,H=Math.max(a[0],Math.min(a[1],L.k*Math.pow(2,i.apply(this,arguments)))),q=Nn(N);if(A.wheel)(A.mouse[0][0]!==q[0]||A.mouse[0][1]!==q[1])&&(A.mouse[1]=L.invert(A.mouse[0]=q)),clearTimeout(A.wheel);else{if(L.k===H)return;A.mouse=[q,L.invert(q)],zu(this),A.start()}Ua(N),A.wheel=setTimeout(st,b),A.zoom("mouse",e(C(M(L,H),A.mouse[0],A.mouse[1]),A.extent,c));function st(){A.wheel=null,A.end()}}function G(N,...I){if(v||!s.apply(this,arguments))return;var A=N.currentTarget,L=R(this,I,!0).event(N),H=cn(N.view).on("mousemove.zoom",P,!0).on("mouseup.zoom",et,!0),q=Nn(N,A),st=N.clientX,k=N.clientY;nb(N.view),hg(N),L.mouse=[q,this.__zoom.invert(q)],zu(this),L.start();function P(nt){if(Ua(nt),!L.moved){var ht=nt.clientX-st,dt=nt.clientY-k;L.moved=ht*ht+dt*dt>w}L.event(nt).zoom("mouse",e(C(L.that.__zoom,L.mouse[0]=Nn(nt,A),L.mouse[1]),L.extent,c))}function et(nt){H.on("mousemove.zoom mouseup.zoom",null),ib(nt.view,L.moved),Ua(nt),L.event(nt).end()}}function ut(N,...I){if(s.apply(this,arguments)){var A=this.__zoom,L=Nn(N.changedTouches?N.changedTouches[0]:N,this),H=A.invert(L),q=A.k*(N.shiftKey?.5:2),st=e(C(M(A,q),L,H),t.apply(this,I),c);Ua(N),h>0?cn(this).transition().duration(h).call(j,st,L,N):cn(this).call(E.transform,st,L,N)}}function W(N,...I){if(s.apply(this,arguments)){var A=N.touches,L=A.length,H=R(this,I,N.changedTouches.length===L).event(N),q,st,k,P;for(hg(N),st=0;st<L;++st)k=A[st],P=Nn(k,this),P=[P,this.__zoom.invert(P),k.identifier],H.touch0?!H.touch1&&H.touch0[2]!==P[2]&&(H.touch1=P,H.taps=0):(H.touch0=P,q=!0,H.taps=1+!!p);p&&(p=clearTimeout(p)),q&&(H.taps<2&&(y=P[0],p=setTimeout(function(){p=null},x)),zu(this),H.start())}}function Z(N,...I){if(this.__zooming){var A=R(this,I).event(N),L=N.changedTouches,H=L.length,q,st,k,P;for(Ua(N),q=0;q<H;++q)st=L[q],k=Nn(st,this),A.touch0&&A.touch0[2]===st.identifier?A.touch0[0]=k:A.touch1&&A.touch1[2]===st.identifier&&(A.touch1[0]=k);if(st=A.that.__zoom,A.touch1){var et=A.touch0[0],nt=A.touch0[1],ht=A.touch1[0],dt=A.touch1[1],ft=(ft=ht[0]-et[0])*ft+(ft=ht[1]-et[1])*ft,X=(X=dt[0]-nt[0])*X+(X=dt[1]-nt[1])*X;st=M(st,Math.sqrt(ft/X)),k=[(et[0]+ht[0])/2,(et[1]+ht[1])/2],P=[(nt[0]+dt[0])/2,(nt[1]+dt[1])/2]}else if(A.touch0)k=A.touch0[0],P=A.touch0[1];else return;A.zoom("touch",e(C(st,k,P),A.extent,c))}}function rt(N,...I){if(this.__zooming){var A=R(this,I).event(N),L=N.changedTouches,H=L.length,q,st;for(hg(N),v&&clearTimeout(v),v=setTimeout(function(){v=null},x),q=0;q<H;++q)st=L[q],A.touch0&&A.touch0[2]===st.identifier?delete A.touch0:A.touch1&&A.touch1[2]===st.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(st=Nn(st,this),Math.hypot(y[0]-st[0],y[1]-st[1])<T)){var k=cn(this).on("dblclick.zoom");k&&k.apply(this,arguments)}}}return E.wheelDelta=function(N){return arguments.length?(i=typeof N=="function"?N:Qc(+N),E):i},E.filter=function(N){return arguments.length?(s=typeof N=="function"?N:Qc(!!N),E):s},E.touchable=function(N){return arguments.length?(o=typeof N=="function"?N:Qc(!!N),E):o},E.extent=function(N){return arguments.length?(t=typeof N=="function"?N:Qc([[+N[0][0],+N[0][1]],[+N[1][0],+N[1][1]]]),E):t},E.scaleExtent=function(N){return arguments.length?(a[0]=+N[0],a[1]=+N[1],E):[a[0],a[1]]},E.translateExtent=function(N){return arguments.length?(c[0][0]=+N[0][0],c[1][0]=+N[1][0],c[0][1]=+N[0][1],c[1][1]=+N[1][1],E):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},E.constrain=function(N){return arguments.length?(e=N,E):e},E.duration=function(N){return arguments.length?(h=+N,E):h},E.interpolate=function(N){return arguments.length?(f=N,E):f},E.on=function(){var N=d.on.apply(d,arguments);return N===d?E:N},E.clickDistance=function(N){return arguments.length?(w=(N=+N)*N,E):Math.sqrt(w)},E.tapDistance=function(N){return arguments.length?(T=+N,E):T},E}const ei={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:s=>`Node type "${s}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:s=>`The old edge with id=${s} does not exist.`,error009:s=>`Marker type "${s}" doesn't exist.`,error008:(s,{id:t,sourceHandle:e,targetHandle:i})=>`Couldn't create edge for ${s} handle id: "${s==="source"?e:i}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:s=>`Edge type "${s}" not found. Using fallback type "default".`,error012:s=>`Node with id "${s}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(s="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${s}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},sl=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],bb=["Enter"," ","Escape"],Sb={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:s,x:t,y:e})=>`Moved selected node ${s}. New position, x: ${t}, y: ${e}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var To;(function(s){s.Strict="strict",s.Loose="loose"})(To||(To={}));var ur;(function(s){s.Free="free",s.Vertical="vertical",s.Horizontal="horizontal"})(ur||(ur={}));var rl;(function(s){s.Partial="partial",s.Full="full"})(rl||(rl={}));const _b={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var ws;(function(s){s.Bezier="default",s.Straight="straight",s.Step="step",s.SmoothStep="smoothstep",s.SimpleBezier="simplebezier"})(ws||(ws={}));var Zu;(function(s){s.Arrow="arrow",s.ArrowClosed="arrowclosed"})(Zu||(Zu={}));var bt;(function(s){s.Left="left",s.Top="top",s.Right="right",s.Bottom="bottom"})(bt||(bt={}));const dx={[bt.Left]:bt.Right,[bt.Right]:bt.Left,[bt.Top]:bt.Bottom,[bt.Bottom]:bt.Top};function wb(s){return s===null?null:s?"valid":"invalid"}const Cb=s=>"id"in s&&"source"in s&&"target"in s,JD=s=>"id"in s&&"position"in s&&!("source"in s)&&!("target"in s),vp=s=>"id"in s&&"internals"in s&&!("source"in s)&&!("target"in s),vl=(s,t=[0,0])=>{const{width:e,height:i}=Yi(s),o=s.origin??t,a=e*o[0],c=i*o[1];return{x:s.position.x-a,y:s.position.y-c}},tO=(s,t={nodeOrigin:[0,0]})=>{if(s.length===0)return{x:0,y:0,width:0,height:0};const e=s.reduce((i,o)=>{const a=typeof o=="string";let c=!t.nodeLookup&&!a?o:void 0;t.nodeLookup&&(c=a?t.nodeLookup.get(o):vp(o)?o:t.nodeLookup.get(o.id));const h=c?Ku(c,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return xh(i,h)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return bh(e)},xl=(s,t={})=>{let e={x:1/0,y:1/0,x2:-1/0,y2:-1/0},i=!1;return s.forEach(o=>{(t.filter===void 0||t.filter(o))&&(e=xh(e,Ku(o)),i=!0)}),i?bh(e):{x:0,y:0,width:0,height:0}},xp=(s,t,[e,i,o]=[0,0,1],a=!1,c=!1)=>{const h={...Sl(t,[e,i,o]),width:t.width/o,height:t.height/o},f=[];for(const d of s.values()){const{measured:p,selectable:y=!0,hidden:v=!1}=d;if(c&&!y||v)continue;const x=p.width??d.width??d.initialWidth??null,b=p.height??d.height??d.initialHeight??null,w=ol(h,Mo(d)),T=(x??0)*(b??0),E=a&&w>0;(!d.internals.handleBounds||E||w>=T||d.dragging)&&f.push(d)}return f},eO=(s,t)=>{const e=new Set;return s.forEach(i=>{e.add(i.id)}),t.filter(i=>e.has(i.source)||e.has(i.target))};function nO(s,t){const e=new Map,i=t?.nodes?new Set(t.nodes.map(o=>o.id)):null;return s.forEach(o=>{o.measured.width&&o.measured.height&&(t?.includeHiddenNodes||!o.hidden)&&(!i||i.has(o.id))&&e.set(o.id,o)}),e}async function iO({nodes:s,width:t,height:e,panZoom:i,minZoom:o,maxZoom:a},c){if(s.size===0)return Promise.resolve(!0);const h=nO(s,c),f=xl(h),d=bp(f,t,e,c?.minZoom??o,c?.maxZoom??a,c?.padding??.1);return await i.setViewport(d,{duration:c?.duration,ease:c?.ease,interpolate:c?.interpolate}),Promise.resolve(!0)}function Tb({nodeId:s,nextPosition:t,nodeLookup:e,nodeOrigin:i=[0,0],nodeExtent:o,onError:a}){const c=e.get(s),h=c.parentId?e.get(c.parentId):void 0,{x:f,y:d}=h?h.internals.positionAbsolute:{x:0,y:0},p=c.origin??i;let y=c.extent||o;if(c.extent==="parent"&&!c.expandParent)if(!h)a?.("005",ei.error005());else{const x=h.measured.width,b=h.measured.height;x&&b&&(y=[[f,d],[f+x,d+b]])}else h&&Do(c.extent)&&(y=[[c.extent[0][0]+f,c.extent[0][1]+d],[c.extent[1][0]+f,c.extent[1][1]+d]]);const v=Do(y)?mr(t,y,c.measured):t;return(c.measured.width===void 0||c.measured.height===void 0)&&a?.("015",ei.error015()),{position:{x:v.x-f+(c.measured.width??0)*p[0],y:v.y-d+(c.measured.height??0)*p[1]},positionAbsolute:v}}async function sO({nodesToRemove:s=[],edgesToRemove:t=[],nodes:e,edges:i,onBeforeDelete:o}){const a=new Set(s.map(v=>v.id)),c=[];for(const v of e){if(v.deletable===!1)continue;const x=a.has(v.id),b=!x&&v.parentId&&c.find(w=>w.id===v.parentId);(x||b)&&c.push(v)}const h=new Set(t.map(v=>v.id)),f=i.filter(v=>v.deletable!==!1),p=eO(c,f);for(const v of f)h.has(v.id)&&!p.find(b=>b.id===v.id)&&p.push(v);if(!o)return{edges:p,nodes:c};const y=await o({nodes:c,edges:p});return typeof y=="boolean"?y?{edges:p,nodes:c}:{edges:[],nodes:[]}:y}const Eo=(s,t=0,e=1)=>Math.min(Math.max(s,t),e),mr=(s={x:0,y:0},t,e)=>({x:Eo(s.x,t[0][0],t[1][0]-(e?.width??0)),y:Eo(s.y,t[0][1],t[1][1]-(e?.height??0))});function Eb(s,t,e){const{width:i,height:o}=Yi(e),{x:a,y:c}=e.internals.positionAbsolute;return mr(s,[[a,c],[a+i,c+o]],t)}const gx=(s,t,e)=>s<t?Eo(Math.abs(s-t),1,t)/t:s>e?-Eo(Math.abs(s-e),1,t)/t:0,Mb=(s,t,e=15,i=40)=>{const o=gx(s.x,i,t.width-i)*e,a=gx(s.y,i,t.height-i)*e;return[o,a]},xh=(s,t)=>({x:Math.min(s.x,t.x),y:Math.min(s.y,t.y),x2:Math.max(s.x2,t.x2),y2:Math.max(s.y2,t.y2)}),Ig=({x:s,y:t,width:e,height:i})=>({x:s,y:t,x2:s+e,y2:t+i}),bh=({x:s,y:t,x2:e,y2:i})=>({x:s,y:t,width:e-s,height:i-t}),Mo=(s,t=[0,0])=>{const{x:e,y:i}=vp(s)?s.internals.positionAbsolute:vl(s,t);return{x:e,y:i,width:s.measured?.width??s.width??s.initialWidth??0,height:s.measured?.height??s.height??s.initialHeight??0}},Ku=(s,t=[0,0])=>{const{x:e,y:i}=vp(s)?s.internals.positionAbsolute:vl(s,t);return{x:e,y:i,x2:e+(s.measured?.width??s.width??s.initialWidth??0),y2:i+(s.measured?.height??s.height??s.initialHeight??0)}},Db=(s,t)=>bh(xh(Ig(s),Ig(t))),ol=(s,t)=>{const e=Math.max(0,Math.min(s.x+s.width,t.x+t.width)-Math.max(s.x,t.x)),i=Math.max(0,Math.min(s.y+s.height,t.y+t.height)-Math.max(s.y,t.y));return Math.ceil(e*i)},px=s=>Bn(s.width)&&Bn(s.height)&&Bn(s.x)&&Bn(s.y),Bn=s=>!isNaN(s)&&isFinite(s),rO=(s,t)=>{},bl=(s,t=[1,1])=>({x:t[0]*Math.round(s.x/t[0]),y:t[1]*Math.round(s.y/t[1])}),Sl=({x:s,y:t},[e,i,o],a=!1,c=[1,1])=>{const h={x:(s-e)/o,y:(t-i)/o};return a?bl(h,c):h},Qu=({x:s,y:t},[e,i,o])=>({x:s*o+e,y:t*o+i});function co(s,t){if(typeof s=="number")return Math.floor((t-t/(1+s))*.5);if(typeof s=="string"&&s.endsWith("px")){const e=parseFloat(s);if(!Number.isNaN(e))return Math.floor(e)}if(typeof s=="string"&&s.endsWith("%")){const e=parseFloat(s);if(!Number.isNaN(e))return Math.floor(t*e*.01)}return console.error(`[React Flow] The padding value "${s}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function oO(s,t,e){if(typeof s=="string"||typeof s=="number"){const i=co(s,e),o=co(s,t);return{top:i,right:o,bottom:i,left:o,x:o*2,y:i*2}}if(typeof s=="object"){const i=co(s.top??s.y??0,e),o=co(s.bottom??s.y??0,e),a=co(s.left??s.x??0,t),c=co(s.right??s.x??0,t);return{top:i,right:c,bottom:o,left:a,x:a+c,y:i+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function aO(s,t,e,i,o,a){const{x:c,y:h}=Qu(s,[t,e,i]),{x:f,y:d}=Qu({x:s.x+s.width,y:s.y+s.height},[t,e,i]),p=o-f,y=a-d;return{left:Math.floor(c),top:Math.floor(h),right:Math.floor(p),bottom:Math.floor(y)}}const bp=(s,t,e,i,o,a)=>{const c=oO(a,t,e),h=(t-c.x)/s.width,f=(e-c.y)/s.height,d=Math.min(h,f),p=Eo(d,i,o),y=s.x+s.width/2,v=s.y+s.height/2,x=t/2-y*p,b=e/2-v*p,w=aO(s,x,b,p,t,e),T={left:Math.min(w.left-c.left,0),top:Math.min(w.top-c.top,0),right:Math.min(w.right-c.right,0),bottom:Math.min(w.bottom-c.bottom,0)};return{x:x-T.left+T.right,y:b-T.top+T.bottom,zoom:p}},al=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Do(s){return s!=null&&s!=="parent"}function Yi(s){return{width:s.measured?.width??s.width??s.initialWidth??0,height:s.measured?.height??s.height??s.initialHeight??0}}function Ob(s){return(s.measured?.width??s.width??s.initialWidth)!==void 0&&(s.measured?.height??s.height??s.initialHeight)!==void 0}function Ab(s,t={width:0,height:0},e,i,o){const a={...s},c=i.get(e);if(c){const h=c.origin||o;a.x+=c.internals.positionAbsolute.x-(t.width??0)*h[0],a.y+=c.internals.positionAbsolute.y-(t.height??0)*h[1]}return a}function mx(s,t){if(s.size!==t.size)return!1;for(const e of s)if(!t.has(e))return!1;return!0}function lO(){let s,t;return{promise:new Promise((i,o)=>{s=i,t=o}),resolve:s,reject:t}}function cO(s){return{...Sb,...s||{}}}function qa(s,{snapGrid:t=[0,0],snapToGrid:e=!1,transform:i,containerBounds:o}){const{x:a,y:c}=Hn(s),h=Sl({x:a-(o?.left??0),y:c-(o?.top??0)},i),{x:f,y:d}=e?bl(h,t):h;return{xSnapped:f,ySnapped:d,...h}}const Sp=s=>({width:s.offsetWidth,height:s.offsetHeight}),kb=s=>s?.getRootNode?.()||window?.document,uO=["INPUT","SELECT","TEXTAREA"];function jb(s){const t=s.composedPath?.()?.[0]||s.target;return t?.nodeType!==1?!1:uO.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Nb=s=>"clientX"in s,Hn=(s,t)=>{const e=Nb(s),i=e?s.clientX:s.touches?.[0].clientX,o=e?s.clientY:s.touches?.[0].clientY;return{x:i-(t?.left??0),y:o-(t?.top??0)}},yx=(s,t,e,i,o)=>{const a=t.querySelectorAll(`.${s}`);return!a||!a.length?null:Array.from(a).map(c=>{const h=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),type:s,nodeId:o,position:c.getAttribute("data-handlepos"),x:(h.left-e.left)/i,y:(h.top-e.top)/i,...Sp(c)}})};function Rb({sourceX:s,sourceY:t,targetX:e,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:c,targetControlY:h}){const f=s*.125+o*.375+c*.375+e*.125,d=t*.125+a*.375+h*.375+i*.125,p=Math.abs(f-s),y=Math.abs(d-t);return[f,d,p,y]}function Jc(s,t){return s>=0?.5*s:t*25*Math.sqrt(-s)}function vx({pos:s,x1:t,y1:e,x2:i,y2:o,c:a}){switch(s){case bt.Left:return[t-Jc(t-i,a),e];case bt.Right:return[t+Jc(i-t,a),e];case bt.Top:return[t,e-Jc(e-o,a)];case bt.Bottom:return[t,e+Jc(o-e,a)]}}function zb({sourceX:s,sourceY:t,sourcePosition:e=bt.Bottom,targetX:i,targetY:o,targetPosition:a=bt.Top,curvature:c=.25}){const[h,f]=vx({pos:e,x1:s,y1:t,x2:i,y2:o,c}),[d,p]=vx({pos:a,x1:i,y1:o,x2:s,y2:t,c}),[y,v,x,b]=Rb({sourceX:s,sourceY:t,targetX:i,targetY:o,sourceControlX:h,sourceControlY:f,targetControlX:d,targetControlY:p});return[`M${s},${t} C${h},${f} ${d},${p} ${i},${o}`,y,v,x,b]}function Lb({sourceX:s,sourceY:t,targetX:e,targetY:i}){const o=Math.abs(e-s)/2,a=e<s?e+o:e-o,c=Math.abs(i-t)/2,h=i<t?i+c:i-c;return[a,h,o,c]}function hO({sourceNode:s,targetNode:t,selected:e=!1,zIndex:i=0,elevateOnSelect:o=!1,zIndexMode:a="basic"}){if(a==="manual")return i;const c=o&&e?i+1e3:i,h=Math.max(s.parentId||o&&s.selected?s.internals.z:0,t.parentId||o&&t.selected?t.internals.z:0);return c+h}function fO({sourceNode:s,targetNode:t,width:e,height:i,transform:o}){const a=xh(Ku(s),Ku(t));a.x===a.x2&&(a.x2+=1),a.y===a.y2&&(a.y2+=1);const c={x:-o[0]/o[2],y:-o[1]/o[2],width:e/o[2],height:i/o[2]};return ol(c,bh(a))>0}const dO=({source:s,sourceHandle:t,target:e,targetHandle:i})=>`xy-edge__${s}${t||""}-${e}${i||""}`,gO=(s,t)=>t.some(e=>e.source===s.source&&e.target===s.target&&(e.sourceHandle===s.sourceHandle||!e.sourceHandle&&!s.sourceHandle)&&(e.targetHandle===s.targetHandle||!e.targetHandle&&!s.targetHandle)),pO=(s,t,e={})=>{if(!s.source||!s.target)return t;const i=e.getEdgeId||dO;let o;return Cb(s)?o={...s}:o={...s,id:i(s)},gO(o,t)?t:(o.sourceHandle===null&&delete o.sourceHandle,o.targetHandle===null&&delete o.targetHandle,t.concat(o))};function Bb({sourceX:s,sourceY:t,targetX:e,targetY:i}){const[o,a,c,h]=Lb({sourceX:s,sourceY:t,targetX:e,targetY:i});return[`M ${s},${t}L ${e},${i}`,o,a,c,h]}const xx={[bt.Left]:{x:-1,y:0},[bt.Right]:{x:1,y:0},[bt.Top]:{x:0,y:-1},[bt.Bottom]:{x:0,y:1}},mO=({source:s,sourcePosition:t=bt.Bottom,target:e})=>t===bt.Left||t===bt.Right?s.x<e.x?{x:1,y:0}:{x:-1,y:0}:s.y<e.y?{x:0,y:1}:{x:0,y:-1},bx=(s,t)=>Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2));function yO({source:s,sourcePosition:t=bt.Bottom,target:e,targetPosition:i=bt.Top,center:o,offset:a,stepPosition:c}){const h=xx[t],f=xx[i],d={x:s.x+h.x*a,y:s.y+h.y*a},p={x:e.x+f.x*a,y:e.y+f.y*a},y=mO({source:d,sourcePosition:t,target:p}),v=y.x!==0?"x":"y",x=y[v];let b=[],w,T;const E={x:0,y:0},M={x:0,y:0},[,,C,D]=Lb({sourceX:s.x,sourceY:s.y,targetX:e.x,targetY:e.y});if(h[v]*f[v]===-1){v==="x"?(w=o.x??d.x+(p.x-d.x)*c,T=o.y??(d.y+p.y)/2):(w=o.x??(d.x+p.x)/2,T=o.y??d.y+(p.y-d.y)*c);const R=[{x:w,y:d.y},{x:w,y:p.y}],z=[{x:d.x,y:T},{x:p.x,y:T}];h[v]===x?b=v==="x"?R:z:b=v==="x"?z:R}else{const R=[{x:d.x,y:p.y}],z=[{x:p.x,y:d.y}];if(v==="x"?b=h.x===x?z:R:b=h.y===x?R:z,t===i){const Z=Math.abs(s[v]-e[v]);if(Z<=a){const rt=Math.min(a-1,a-Z);h[v]===x?E[v]=(d[v]>s[v]?-1:1)*rt:M[v]=(p[v]>e[v]?-1:1)*rt}}if(t!==i){const Z=v==="x"?"y":"x",rt=h[v]===f[Z],N=d[Z]>p[Z],I=d[Z]<p[Z];(h[v]===1&&(!rt&&N||rt&&I)||h[v]!==1&&(!rt&&I||rt&&N))&&(b=v==="x"?R:z)}const U={x:d.x+E.x,y:d.y+E.y},G={x:p.x+M.x,y:p.y+M.y},ut=Math.max(Math.abs(U.x-b[0].x),Math.abs(G.x-b[0].x)),W=Math.max(Math.abs(U.y-b[0].y),Math.abs(G.y-b[0].y));ut>=W?(w=(U.x+G.x)/2,T=b[0].y):(w=b[0].x,T=(U.y+G.y)/2)}return[[s,{x:d.x+E.x,y:d.y+E.y},...b,{x:p.x+M.x,y:p.y+M.y},e],w,T,C,D]}function vO(s,t,e,i){const o=Math.min(bx(s,t)/2,bx(t,e)/2,i),{x:a,y:c}=t;if(s.x===a&&a===e.x||s.y===c&&c===e.y)return`L${a} ${c}`;if(s.y===c){const d=s.x<e.x?-1:1,p=s.y<e.y?1:-1;return`L ${a+o*d},${c}Q ${a},${c} ${a},${c+o*p}`}const h=s.x<e.x?1:-1,f=s.y<e.y?-1:1;return`L ${a},${c+o*f}Q ${a},${c} ${a+o*h},${c}`}function Gg({sourceX:s,sourceY:t,sourcePosition:e=bt.Bottom,targetX:i,targetY:o,targetPosition:a=bt.Top,borderRadius:c=5,centerX:h,centerY:f,offset:d=20,stepPosition:p=.5}){const[y,v,x,b,w]=yO({source:{x:s,y:t},sourcePosition:e,target:{x:i,y:o},targetPosition:a,center:{x:h,y:f},offset:d,stepPosition:p});return[y.reduce((E,M,C)=>{let D="";return C>0&&C<y.length-1?D=vO(y[C-1],M,y[C+1],c):D=`${C===0?"M":"L"}${M.x} ${M.y}`,E+=D,E},""),v,x,b,w]}function Sx(s){return s&&!!(s.internals.handleBounds||s.handles?.length)&&!!(s.measured.width||s.width||s.initialWidth)}function xO(s){const{sourceNode:t,targetNode:e}=s;if(!Sx(t)||!Sx(e))return null;const i=t.internals.handleBounds||_x(t.handles),o=e.internals.handleBounds||_x(e.handles),a=wx(i?.source??[],s.sourceHandle),c=wx(s.connectionMode===To.Strict?o?.target??[]:(o?.target??[]).concat(o?.source??[]),s.targetHandle);if(!a||!c)return s.onError?.("008",ei.error008(a?"target":"source",{id:s.id,sourceHandle:s.sourceHandle,targetHandle:s.targetHandle})),null;const h=a?.position||bt.Bottom,f=c?.position||bt.Top,d=yr(t,a,h),p=yr(e,c,f);return{sourceX:d.x,sourceY:d.y,targetX:p.x,targetY:p.y,sourcePosition:h,targetPosition:f}}function _x(s){if(!s)return null;const t=[],e=[];for(const i of s)i.width=i.width??1,i.height=i.height??1,i.type==="source"?t.push(i):i.type==="target"&&e.push(i);return{source:t,target:e}}function yr(s,t,e=bt.Left,i=!1){const o=(t?.x??0)+s.internals.positionAbsolute.x,a=(t?.y??0)+s.internals.positionAbsolute.y,{width:c,height:h}=t??Yi(s);if(i)return{x:o+c/2,y:a+h/2};switch(t?.position??e){case bt.Top:return{x:o+c/2,y:a};case bt.Right:return{x:o+c,y:a+h/2};case bt.Bottom:return{x:o+c/2,y:a+h};case bt.Left:return{x:o,y:a+h/2}}}function wx(s,t){return s&&(t?s.find(e=>e.id===t):s[0])||null}function $g(s,t){return s?typeof s=="string"?s:`${t?`${t}__`:""}${Object.keys(s).sort().map(i=>`${i}=${s[i]}`).join("&")}`:""}function bO(s,{id:t,defaultColor:e,defaultMarkerStart:i,defaultMarkerEnd:o}){const a=new Set;return s.reduce((c,h)=>([h.markerStart||i,h.markerEnd||o].forEach(f=>{if(f&&typeof f=="object"){const d=$g(f,t);a.has(d)||(c.push({id:d,color:f.color||e,...f}),a.add(d))}}),c),[]).sort((c,h)=>c.id.localeCompare(h.id))}const Hb=1e3,SO=10,_p={nodeOrigin:[0,0],nodeExtent:sl,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},_O={..._p,checkEquality:!0};function wp(s,t){const e={...s};for(const i in t)t[i]!==void 0&&(e[i]=t[i]);return e}function wO(s,t,e){const i=wp(_p,e);for(const o of s.values())if(o.parentId)Tp(o,s,t,i);else{const a=vl(o,i.nodeOrigin),c=Do(o.extent)?o.extent:i.nodeExtent,h=mr(a,c,Yi(o));o.internals.positionAbsolute=h}}function CO(s,t){if(!s.handles)return s.measured?t?.internals.handleBounds:void 0;const e=[],i=[];for(const o of s.handles){const a={id:o.id,width:o.width??1,height:o.height??1,nodeId:s.id,x:o.x,y:o.y,position:o.position,type:o.type};o.type==="source"?e.push(a):o.type==="target"&&i.push(a)}return{source:e,target:i}}function Cp(s){return s==="manual"}function qg(s,t,e,i={}){const o=wp(_O,i),a={i:0},c=new Map(t),h=o?.elevateNodesOnSelect&&!Cp(o.zIndexMode)?Hb:0;let f=s.length>0;t.clear(),e.clear();for(const d of s){let p=c.get(d.id);if(o.checkEquality&&d===p?.internals.userNode)t.set(d.id,p);else{const y=vl(d,o.nodeOrigin),v=Do(d.extent)?d.extent:o.nodeExtent,x=mr(y,v,Yi(d));p={...o.defaults,...d,measured:{width:d.measured?.width,height:d.measured?.height},internals:{positionAbsolute:x,handleBounds:CO(d,p),z:Ub(d,h,o.zIndexMode),userNode:d}},t.set(d.id,p)}(p.measured===void 0||p.measured.width===void 0||p.measured.height===void 0)&&!p.hidden&&(f=!1),d.parentId&&Tp(p,t,e,i,a)}return f}function TO(s,t){if(!s.parentId)return;const e=t.get(s.parentId);e?e.set(s.id,s):t.set(s.parentId,new Map([[s.id,s]]))}function Tp(s,t,e,i,o){const{elevateNodesOnSelect:a,nodeOrigin:c,nodeExtent:h,zIndexMode:f}=wp(_p,i),d=s.parentId,p=t.get(d);if(!p){console.warn(`Parent node ${d} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}TO(s,e),o&&!p.parentId&&p.internals.rootParentIndex===void 0&&f==="auto"&&(p.internals.rootParentIndex=++o.i,p.internals.z=p.internals.z+o.i*SO),o&&p.internals.rootParentIndex!==void 0&&(o.i=p.internals.rootParentIndex);const y=a&&!Cp(f)?Hb:0,{x:v,y:x,z:b}=EO(s,p,c,h,y,f),{positionAbsolute:w}=s.internals,T=v!==w.x||x!==w.y;(T||b!==s.internals.z)&&t.set(s.id,{...s,internals:{...s.internals,positionAbsolute:T?{x:v,y:x}:w,z:b}})}function Ub(s,t,e){const i=Bn(s.zIndex)?s.zIndex:0;return Cp(e)?i:i+(s.selected?t:0)}function EO(s,t,e,i,o,a){const{x:c,y:h}=t.internals.positionAbsolute,f=Yi(s),d=vl(s,e),p=Do(s.extent)?mr(d,s.extent,f):d;let y=mr({x:c+p.x,y:h+p.y},i,f);s.extent==="parent"&&(y=Eb(y,f,t));const v=Ub(s,o,a),x=t.internals.z??0;return{x:y.x,y:y.y,z:x>=v?x+1:v}}function Ep(s,t,e,i=[0,0]){const o=[],a=new Map;for(const c of s){const h=t.get(c.parentId);if(!h)continue;const f=a.get(c.parentId)?.expandedRect??Mo(h),d=Db(f,c.rect);a.set(c.parentId,{expandedRect:d,parent:h})}return a.size>0&&a.forEach(({expandedRect:c,parent:h},f)=>{const d=h.internals.positionAbsolute,p=Yi(h),y=h.origin??i,v=c.x<d.x?Math.round(Math.abs(d.x-c.x)):0,x=c.y<d.y?Math.round(Math.abs(d.y-c.y)):0,b=Math.max(p.width,Math.round(c.width)),w=Math.max(p.height,Math.round(c.height)),T=(b-p.width)*y[0],E=(w-p.height)*y[1];(v>0||x>0||T||E)&&(o.push({id:f,type:"position",position:{x:h.position.x-v+T,y:h.position.y-x+E}}),e.get(f)?.forEach(M=>{s.some(C=>C.id===M.id)||o.push({id:M.id,type:"position",position:{x:M.position.x+v,y:M.position.y+x}})})),(p.width<c.width||p.height<c.height||v||x)&&o.push({id:f,type:"dimensions",setAttributes:!0,dimensions:{width:b+(v?y[0]*v-T:0),height:w+(x?y[1]*x-E:0)}})}),o}function MO(s,t,e,i,o,a,c){const h=i?.querySelector(".xyflow__viewport");let f=!1;if(!h)return{changes:[],updatedInternals:f};const d=[],p=window.getComputedStyle(h),{m22:y}=new window.DOMMatrixReadOnly(p.transform),v=[];for(const x of s.values()){const b=t.get(x.id);if(!b)continue;if(b.hidden){t.set(b.id,{...b,internals:{...b.internals,handleBounds:void 0}}),f=!0;continue}const w=Sp(x.nodeElement),T=b.measured.width!==w.width||b.measured.height!==w.height;if(!!(w.width&&w.height&&(T||!b.internals.handleBounds||x.force))){const M=x.nodeElement.getBoundingClientRect(),C=Do(b.extent)?b.extent:a;let{positionAbsolute:D}=b.internals;b.parentId&&b.extent==="parent"?D=Eb(D,w,t.get(b.parentId)):C&&(D=mr(D,C,w));const j={...b,measured:w,internals:{...b.internals,positionAbsolute:D,handleBounds:{source:yx("source",x.nodeElement,M,y,b.id),target:yx("target",x.nodeElement,M,y,b.id)}}};t.set(b.id,j),b.parentId&&Tp(j,t,e,{nodeOrigin:o,zIndexMode:c}),f=!0,T&&(d.push({id:b.id,type:"dimensions",dimensions:w}),b.expandParent&&b.parentId&&v.push({id:b.id,parentId:b.parentId,rect:Mo(j,o)}))}}if(v.length>0){const x=Ep(v,t,e,o);d.push(...x)}return{changes:d,updatedInternals:f}}async function DO({delta:s,panZoom:t,transform:e,translateExtent:i,width:o,height:a}){if(!t||!s.x&&!s.y)return Promise.resolve(!1);const c=await t.setViewportConstrained({x:e[0]+s.x,y:e[1]+s.y,zoom:e[2]},[[0,0],[o,a]],i),h=!!c&&(c.x!==e[0]||c.y!==e[1]||c.k!==e[2]);return Promise.resolve(h)}function Cx(s,t,e,i,o,a){let c=o;const h=i.get(c)||new Map;i.set(c,h.set(e,t)),c=`${o}-${s}`;const f=i.get(c)||new Map;if(i.set(c,f.set(e,t)),a){c=`${o}-${s}-${a}`;const d=i.get(c)||new Map;i.set(c,d.set(e,t))}}function Pb(s,t,e){s.clear(),t.clear();for(const i of e){const{source:o,target:a,sourceHandle:c=null,targetHandle:h=null}=i,f={edgeId:i.id,source:o,target:a,sourceHandle:c,targetHandle:h},d=`${o}-${c}--${a}-${h}`,p=`${a}-${h}--${o}-${c}`;Cx("source",f,p,s,o,c),Cx("target",f,d,s,a,h),t.set(i.id,i)}}function Yb(s,t){if(!s.parentId)return!1;const e=t.get(s.parentId);return e?e.selected?!0:Yb(e,t):!1}function Tx(s,t,e){let i=s;do{if(i?.matches?.(t))return!0;if(i===e)return!1;i=i?.parentElement}while(i);return!1}function OO(s,t,e,i){const o=new Map;for(const[a,c]of s)if((c.selected||c.id===i)&&(!c.parentId||!Yb(c,s))&&(c.draggable||t&&typeof c.draggable>"u")){const h=s.get(a);h&&o.set(a,{id:a,position:h.position||{x:0,y:0},distance:{x:e.x-h.internals.positionAbsolute.x,y:e.y-h.internals.positionAbsolute.y},extent:h.extent,parentId:h.parentId,origin:h.origin,expandParent:h.expandParent,internals:{positionAbsolute:h.internals.positionAbsolute||{x:0,y:0}},measured:{width:h.measured.width??0,height:h.measured.height??0}})}return o}function fg({nodeId:s,dragItems:t,nodeLookup:e,dragging:i=!0}){const o=[];for(const[c,h]of t){const f=e.get(c)?.internals.userNode;f&&o.push({...f,position:h.position,dragging:i})}if(!s)return[o[0],o];const a=e.get(s)?.internals.userNode;return[a?{...a,position:t.get(s)?.position||a.position,dragging:i}:o[0],o]}function AO({dragItems:s,snapGrid:t,x:e,y:i}){const o=s.values().next().value;if(!o)return null;const a={x:e-o.distance.x,y:i-o.distance.y},c=bl(a,t);return{x:c.x-a.x,y:c.y-a.y}}function kO({onNodeMouseDown:s,getStoreItems:t,onDragStart:e,onDrag:i,onDragStop:o}){let a={x:null,y:null},c=0,h=new Map,f=!1,d={x:0,y:0},p=null,y=!1,v=null,x=!1,b=!1,w=null;function T({noDragClassName:M,handleSelector:C,domNode:D,isSelectable:j,nodeId:R,nodeClickDistance:z=0}){v=cn(D);function U({x:Z,y:rt}){const{nodeLookup:N,nodeExtent:I,snapGrid:A,snapToGrid:L,nodeOrigin:H,onNodeDrag:q,onSelectionDrag:st,onError:k,updateNodePositions:P}=t();a={x:Z,y:rt};let et=!1;const nt=h.size>1,ht=nt&&I?Ig(xl(h)):null,dt=nt&&L?AO({dragItems:h,snapGrid:A,x:Z,y:rt}):null;for(const[ft,X]of h){if(!N.has(ft))continue;let ot={x:Z-X.distance.x,y:rt-X.distance.y};L&&(ot=dt?{x:Math.round(ot.x+dt.x),y:Math.round(ot.y+dt.y)}:bl(ot,A));let gt=null;if(nt&&I&&!X.extent&&ht){const{positionAbsolute:_t}=X.internals,Ot=_t.x-ht.x+I[0][0],It=_t.x+X.measured.width-ht.x2+I[1][0],Vt=_t.y-ht.y+I[0][1],xe=_t.y+X.measured.height-ht.y2+I[1][1];gt=[[Ot,Vt],[It,xe]]}const{position:xt,positionAbsolute:pt}=Tb({nodeId:ft,nextPosition:ot,nodeLookup:N,nodeExtent:gt||I,nodeOrigin:H,onError:k});et=et||X.position.x!==xt.x||X.position.y!==xt.y,X.position=xt,X.internals.positionAbsolute=pt}if(b=b||et,!!et&&(P(h,!0),w&&(i||q||!R&&st))){const[ft,X]=fg({nodeId:R,dragItems:h,nodeLookup:N});i?.(w,h,ft,X),q?.(w,ft,X),R||st?.(w,X)}}async function G(){if(!p)return;const{transform:Z,panBy:rt,autoPanSpeed:N,autoPanOnNodeDrag:I}=t();if(!I){f=!1,cancelAnimationFrame(c);return}const[A,L]=Mb(d,p,N);(A!==0||L!==0)&&(a.x=(a.x??0)-A/Z[2],a.y=(a.y??0)-L/Z[2],await rt({x:A,y:L})&&U(a)),c=requestAnimationFrame(G)}function ut(Z){const{nodeLookup:rt,multiSelectionActive:N,nodesDraggable:I,transform:A,snapGrid:L,snapToGrid:H,selectNodesOnDrag:q,onNodeDragStart:st,onSelectionDragStart:k,unselectNodesAndEdges:P}=t();y=!0,(!q||!j)&&!N&&R&&(rt.get(R)?.selected||P()),j&&q&&R&&s?.(R);const et=qa(Z.sourceEvent,{transform:A,snapGrid:L,snapToGrid:H,containerBounds:p});if(a=et,h=OO(rt,I,et,R),h.size>0&&(e||st||!R&&k)){const[nt,ht]=fg({nodeId:R,dragItems:h,nodeLookup:rt});e?.(Z.sourceEvent,h,nt,ht),st?.(Z.sourceEvent,nt,ht),R||k?.(Z.sourceEvent,ht)}}const W=sb().clickDistance(z).on("start",Z=>{const{domNode:rt,nodeDragThreshold:N,transform:I,snapGrid:A,snapToGrid:L}=t();p=rt?.getBoundingClientRect()||null,x=!1,b=!1,w=Z.sourceEvent,N===0&&ut(Z),a=qa(Z.sourceEvent,{transform:I,snapGrid:A,snapToGrid:L,containerBounds:p}),d=Hn(Z.sourceEvent,p)}).on("drag",Z=>{const{autoPanOnNodeDrag:rt,transform:N,snapGrid:I,snapToGrid:A,nodeDragThreshold:L,nodeLookup:H}=t(),q=qa(Z.sourceEvent,{transform:N,snapGrid:I,snapToGrid:A,containerBounds:p});if(w=Z.sourceEvent,(Z.sourceEvent.type==="touchmove"&&Z.sourceEvent.touches.length>1||R&&!H.has(R))&&(x=!0),!x){if(!f&&rt&&y&&(f=!0,G()),!y){const st=Hn(Z.sourceEvent,p),k=st.x-d.x,P=st.y-d.y;Math.sqrt(k*k+P*P)>L&&ut(Z)}(a.x!==q.xSnapped||a.y!==q.ySnapped)&&h&&y&&(d=Hn(Z.sourceEvent,p),U(q))}}).on("end",Z=>{if(!(!y||x)&&(f=!1,y=!1,cancelAnimationFrame(c),h.size>0)){const{nodeLookup:rt,updateNodePositions:N,onNodeDragStop:I,onSelectionDragStop:A}=t();if(b&&(N(h,!1),b=!1),o||I||!R&&A){const[L,H]=fg({nodeId:R,dragItems:h,nodeLookup:rt,dragging:!1});o?.(Z.sourceEvent,h,L,H),I?.(Z.sourceEvent,L,H),R||A?.(Z.sourceEvent,H)}}}).filter(Z=>{const rt=Z.target;return!Z.button&&(!M||!Tx(rt,`.${M}`,D))&&(!C||Tx(rt,C,D))});v.call(W)}function E(){v?.on(".drag",null)}return{update:T,destroy:E}}function jO(s,t,e){const i=[],o={x:s.x-e,y:s.y-e,width:e*2,height:e*2};for(const a of t.values())ol(o,Mo(a))>0&&i.push(a);return i}const NO=250;function RO(s,t,e,i){let o=[],a=1/0;const c=jO(s,e,t+NO);for(const h of c){const f=[...h.internals.handleBounds?.source??[],...h.internals.handleBounds?.target??[]];for(const d of f){if(i.nodeId===d.nodeId&&i.type===d.type&&i.id===d.id)continue;const{x:p,y}=yr(h,d,d.position,!0),v=Math.sqrt(Math.pow(p-s.x,2)+Math.pow(y-s.y,2));v>t||(v<a?(o=[{...d,x:p,y}],a=v):v===a&&o.push({...d,x:p,y}))}}if(!o.length)return null;if(o.length>1){const h=i.type==="source"?"target":"source";return o.find(f=>f.type===h)??o[0]}return o[0]}function Vb(s,t,e,i,o,a=!1){const c=i.get(s);if(!c)return null;const h=o==="strict"?c.internals.handleBounds?.[t]:[...c.internals.handleBounds?.source??[],...c.internals.handleBounds?.target??[]],f=(e?h?.find(d=>d.id===e):h?.[0])??null;return f&&a?{...f,...yr(c,f,f.position,!0)}:f}function Xb(s,t){return s||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function zO(s,t){let e=null;return t?e=!0:s&&!t&&(e=!1),e}const Fb=()=>!0;function LO(s,{connectionMode:t,connectionRadius:e,handleId:i,nodeId:o,edgeUpdaterType:a,isTarget:c,domNode:h,nodeLookup:f,lib:d,autoPanOnConnect:p,flowId:y,panBy:v,cancelConnection:x,onConnectStart:b,onConnect:w,onConnectEnd:T,isValidConnection:E=Fb,onReconnectEnd:M,updateConnection:C,getTransform:D,getFromHandle:j,autoPanSpeed:R,dragThreshold:z=1,handleDomNode:U}){const G=kb(s.target);let ut=0,W;const{x:Z,y:rt}=Hn(s),N=Xb(a,U),I=h?.getBoundingClientRect();let A=!1;if(!I||!N)return;const L=Vb(o,N,i,f,t);if(!L)return;let H=Hn(s,I),q=!1,st=null,k=!1,P=null;function et(){if(!p||!I)return;const[xt,pt]=Mb(H,I,R);v({x:xt,y:pt}),ut=requestAnimationFrame(et)}const nt={...L,nodeId:o,type:N,position:L.position},ht=f.get(o);let ft={inProgress:!0,isValid:null,from:yr(ht,nt,bt.Left,!0),fromHandle:nt,fromPosition:nt.position,fromNode:ht,to:H,toHandle:null,toPosition:dx[nt.position],toNode:null,pointer:H};function X(){A=!0,C(ft),b?.(s,{nodeId:o,handleId:i,handleType:N})}z===0&&X();function ot(xt){if(!A){const{x:xe,y:Tn}=Hn(xt),Je=xe-Z,En=Tn-rt;if(!(Je*Je+En*En>z*z))return;X()}if(!j()||!nt){gt(xt);return}const pt=D();H=Hn(xt,I),W=RO(Sl(H,pt,!1,[1,1]),e,f,nt),q||(et(),q=!0);const _t=Ib(xt,{handle:W,connectionMode:t,fromNodeId:o,fromHandleId:i,fromType:c?"target":"source",isValidConnection:E,doc:G,lib:d,flowId:y,nodeLookup:f});P=_t.handleDomNode,st=_t.connection,k=zO(!!W,_t.isValid);const Ot=f.get(o),It=Ot?yr(Ot,nt,bt.Left,!0):ft.from,Vt={...ft,from:It,isValid:k,to:_t.toHandle&&k?Qu({x:_t.toHandle.x,y:_t.toHandle.y},pt):H,toHandle:_t.toHandle,toPosition:k&&_t.toHandle?_t.toHandle.position:dx[nt.position],toNode:_t.toHandle?f.get(_t.toHandle.nodeId):null,pointer:H};C(Vt),ft=Vt}function gt(xt){if(!("touches"in xt&&xt.touches.length>0)){if(A){(W||P)&&st&&k&&w?.(st);const{inProgress:pt,..._t}=ft,Ot={..._t,toPosition:ft.toHandle?ft.toPosition:null};T?.(xt,Ot),a&&M?.(xt,Ot)}x(),cancelAnimationFrame(ut),q=!1,k=!1,st=null,P=null,G.removeEventListener("mousemove",ot),G.removeEventListener("mouseup",gt),G.removeEventListener("touchmove",ot),G.removeEventListener("touchend",gt)}}G.addEventListener("mousemove",ot),G.addEventListener("mouseup",gt),G.addEventListener("touchmove",ot),G.addEventListener("touchend",gt)}function Ib(s,{handle:t,connectionMode:e,fromNodeId:i,fromHandleId:o,fromType:a,doc:c,lib:h,flowId:f,isValidConnection:d=Fb,nodeLookup:p}){const y=a==="target",v=t?c.querySelector(`.${h}-flow__handle[data-id="${f}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x,y:b}=Hn(s),w=c.elementFromPoint(x,b),T=w?.classList.contains(`${h}-flow__handle`)?w:v,E={handleDomNode:T,isValid:!1,connection:null,toHandle:null};if(T){const M=Xb(void 0,T),C=T.getAttribute("data-nodeid"),D=T.getAttribute("data-handleid"),j=T.classList.contains("connectable"),R=T.classList.contains("connectableend");if(!C||!M)return E;const z={source:y?C:i,sourceHandle:y?D:o,target:y?i:C,targetHandle:y?o:D};E.connection=z;const G=j&&R&&(e===To.Strict?y&&M==="source"||!y&&M==="target":C!==i||D!==o);E.isValid=G&&d(z),E.toHandle=Vb(C,M,D,p,e,!0)}return E}const Wg={onPointerDown:LO,isValid:Ib};function BO({domNode:s,panZoom:t,getTransform:e,getViewScale:i}){const o=cn(s);function a({translateExtent:h,width:f,height:d,zoomStep:p=1,pannable:y=!0,zoomable:v=!0,inversePan:x=!1}){const b=C=>{if(C.sourceEvent.type!=="wheel"||!t)return;const D=e(),j=C.sourceEvent.ctrlKey&&al()?10:1,R=-C.sourceEvent.deltaY*(C.sourceEvent.deltaMode===1?.05:C.sourceEvent.deltaMode?1:.002)*p,z=D[2]*Math.pow(2,R*j);t.scaleTo(z)};let w=[0,0];const T=C=>{(C.sourceEvent.type==="mousedown"||C.sourceEvent.type==="touchstart")&&(w=[C.sourceEvent.clientX??C.sourceEvent.touches[0].clientX,C.sourceEvent.clientY??C.sourceEvent.touches[0].clientY])},E=C=>{const D=e();if(C.sourceEvent.type!=="mousemove"&&C.sourceEvent.type!=="touchmove"||!t)return;const j=[C.sourceEvent.clientX??C.sourceEvent.touches[0].clientX,C.sourceEvent.clientY??C.sourceEvent.touches[0].clientY],R=[j[0]-w[0],j[1]-w[1]];w=j;const z=i()*Math.max(D[2],Math.log(D[2]))*(x?-1:1),U={x:D[0]-R[0]*z,y:D[1]-R[1]*z},G=[[0,0],[f,d]];t.setViewportConstrained({x:U.x,y:U.y,zoom:D[2]},G,h)},M=xb().on("start",T).on("zoom",y?E:null).on("zoom.wheel",v?b:null);o.call(M,{})}function c(){o.on("zoom",null)}return{update:a,destroy:c,pointer:Nn}}const Sh=s=>({x:s.x,y:s.y,zoom:s.k}),dg=({x:s,y:t,zoom:e})=>vh.translate(s,t).scale(e),fo=(s,t)=>s.target.closest(`.${t}`),Gb=(s,t)=>t===2&&Array.isArray(s)&&s.includes(2),HO=s=>((s*=2)<=1?s*s*s:(s-=2)*s*s+2)/2,gg=(s,t=0,e=HO,i=()=>{})=>{const o=typeof t=="number"&&t>0;return o||i(),o?s.transition().duration(t).ease(e).on("end",i):s},$b=s=>{const t=s.ctrlKey&&al()?10:1;return-s.deltaY*(s.deltaMode===1?.05:s.deltaMode?1:.002)*t};function UO({zoomPanValues:s,noWheelClassName:t,d3Selection:e,d3Zoom:i,panOnScrollMode:o,panOnScrollSpeed:a,zoomOnPinch:c,onPanZoomStart:h,onPanZoom:f,onPanZoomEnd:d}){return p=>{if(fo(p,t))return p.ctrlKey&&p.preventDefault(),!1;p.preventDefault(),p.stopImmediatePropagation();const y=e.property("__zoom").k||1;if(p.ctrlKey&&c){const T=Nn(p),E=$b(p),M=y*Math.pow(2,E);i.scaleTo(e,M,T,p);return}const v=p.deltaMode===1?20:1;let x=o===ur.Vertical?0:p.deltaX*v,b=o===ur.Horizontal?0:p.deltaY*v;!al()&&p.shiftKey&&o!==ur.Vertical&&(x=p.deltaY*v,b=0),i.translateBy(e,-(x/y)*a,-(b/y)*a,{internal:!0});const w=Sh(e.property("__zoom"));clearTimeout(s.panScrollTimeout),s.isPanScrolling?(f?.(p,w),s.panScrollTimeout=setTimeout(()=>{d?.(p,w),s.isPanScrolling=!1},150)):(s.isPanScrolling=!0,h?.(p,w))}}function PO({noWheelClassName:s,preventScrolling:t,d3ZoomHandler:e}){return function(i,o){const a=i.type==="wheel",c=!t&&a&&!i.ctrlKey,h=fo(i,s);if(i.ctrlKey&&a&&h&&i.preventDefault(),c||h)return null;i.preventDefault(),e.call(this,i,o)}}function YO({zoomPanValues:s,onDraggingChange:t,onPanZoomStart:e}){return i=>{if(i.sourceEvent?.internal)return;const o=Sh(i.transform);s.mouseButton=i.sourceEvent?.button||0,s.isZoomingOrPanning=!0,s.prevViewport=o,i.sourceEvent?.type==="mousedown"&&t(!0),e&&e?.(i.sourceEvent,o)}}function VO({zoomPanValues:s,panOnDrag:t,onPaneContextMenu:e,onTransformChange:i,onPanZoom:o}){return a=>{s.usedRightMouseButton=!!(e&&Gb(t,s.mouseButton??0)),a.sourceEvent?.sync||i([a.transform.x,a.transform.y,a.transform.k]),o&&!a.sourceEvent?.internal&&o?.(a.sourceEvent,Sh(a.transform))}}function XO({zoomPanValues:s,panOnDrag:t,panOnScroll:e,onDraggingChange:i,onPanZoomEnd:o,onPaneContextMenu:a}){return c=>{if(!c.sourceEvent?.internal&&(s.isZoomingOrPanning=!1,a&&Gb(t,s.mouseButton??0)&&!s.usedRightMouseButton&&c.sourceEvent&&a(c.sourceEvent),s.usedRightMouseButton=!1,i(!1),o)){const h=Sh(c.transform);s.prevViewport=h,clearTimeout(s.timerId),s.timerId=setTimeout(()=>{o?.(c.sourceEvent,h)},e?150:0)}}}function FO({zoomActivationKeyPressed:s,zoomOnScroll:t,zoomOnPinch:e,panOnDrag:i,panOnScroll:o,zoomOnDoubleClick:a,userSelectionActive:c,noWheelClassName:h,noPanClassName:f,lib:d,connectionInProgress:p}){return y=>{const v=s||t,x=e&&y.ctrlKey,b=y.type==="wheel";if(y.button===1&&y.type==="mousedown"&&(fo(y,`${d}-flow__node`)||fo(y,`${d}-flow__edge`)))return!0;if(!i&&!v&&!o&&!a&&!e||c||p&&!b||fo(y,h)&&b||fo(y,f)&&(!b||o&&b&&!s)||!e&&y.ctrlKey&&b)return!1;if(!e&&y.type==="touchstart"&&y.touches?.length>1)return y.preventDefault(),!1;if(!v&&!o&&!x&&b||!i&&(y.type==="mousedown"||y.type==="touchstart")||Array.isArray(i)&&!i.includes(y.button)&&y.type==="mousedown")return!1;const w=Array.isArray(i)&&i.includes(y.button)||!y.button||y.button<=1;return(!y.ctrlKey||b)&&w}}function IO({domNode:s,minZoom:t,maxZoom:e,translateExtent:i,viewport:o,onPanZoom:a,onPanZoomStart:c,onPanZoomEnd:h,onDraggingChange:f}){const d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},p=s.getBoundingClientRect(),y=xb().scaleExtent([t,e]).translateExtent(i),v=cn(s).call(y);M({x:o.x,y:o.y,zoom:Eo(o.zoom,t,e)},[[0,0],[p.width,p.height]],i);const x=v.on("wheel.zoom"),b=v.on("dblclick.zoom");y.wheelDelta($b);function w(W,Z){return v?new Promise(rt=>{y?.interpolate(Z?.interpolate==="linear"?$a:ju).transform(gg(v,Z?.duration,Z?.ease,()=>rt(!0)),W)}):Promise.resolve(!1)}function T({noWheelClassName:W,noPanClassName:Z,onPaneContextMenu:rt,userSelectionActive:N,panOnScroll:I,panOnDrag:A,panOnScrollMode:L,panOnScrollSpeed:H,preventScrolling:q,zoomOnPinch:st,zoomOnScroll:k,zoomOnDoubleClick:P,zoomActivationKeyPressed:et,lib:nt,onTransformChange:ht,connectionInProgress:dt,paneClickDistance:ft,selectionOnDrag:X}){N&&!d.isZoomingOrPanning&&E();const ot=I&&!et&&!N;y.clickDistance(X?1/0:!Bn(ft)||ft<0?0:ft);const gt=ot?UO({zoomPanValues:d,noWheelClassName:W,d3Selection:v,d3Zoom:y,panOnScrollMode:L,panOnScrollSpeed:H,zoomOnPinch:st,onPanZoomStart:c,onPanZoom:a,onPanZoomEnd:h}):PO({noWheelClassName:W,preventScrolling:q,d3ZoomHandler:x});if(v.on("wheel.zoom",gt,{passive:!1}),!N){const pt=YO({zoomPanValues:d,onDraggingChange:f,onPanZoomStart:c});y.on("start",pt);const _t=VO({zoomPanValues:d,panOnDrag:A,onPaneContextMenu:!!rt,onPanZoom:a,onTransformChange:ht});y.on("zoom",_t);const Ot=XO({zoomPanValues:d,panOnDrag:A,panOnScroll:I,onPaneContextMenu:rt,onPanZoomEnd:h,onDraggingChange:f});y.on("end",Ot)}const xt=FO({zoomActivationKeyPressed:et,panOnDrag:A,zoomOnScroll:k,panOnScroll:I,zoomOnDoubleClick:P,zoomOnPinch:st,userSelectionActive:N,noPanClassName:Z,noWheelClassName:W,lib:nt,connectionInProgress:dt});y.filter(xt),P?v.on("dblclick.zoom",b):v.on("dblclick.zoom",null)}function E(){y.on("zoom",null)}async function M(W,Z,rt){const N=dg(W),I=y?.constrain()(N,Z,rt);return I&&await w(I),new Promise(A=>A(I))}async function C(W,Z){const rt=dg(W);return await w(rt,Z),new Promise(N=>N(rt))}function D(W){if(v){const Z=dg(W),rt=v.property("__zoom");(rt.k!==W.zoom||rt.x!==W.x||rt.y!==W.y)&&y?.transform(v,Z,null,{sync:!0})}}function j(){const W=v?vb(v.node()):{x:0,y:0,k:1};return{x:W.x,y:W.y,zoom:W.k}}function R(W,Z){return v?new Promise(rt=>{y?.interpolate(Z?.interpolate==="linear"?$a:ju).scaleTo(gg(v,Z?.duration,Z?.ease,()=>rt(!0)),W)}):Promise.resolve(!1)}function z(W,Z){return v?new Promise(rt=>{y?.interpolate(Z?.interpolate==="linear"?$a:ju).scaleBy(gg(v,Z?.duration,Z?.ease,()=>rt(!0)),W)}):Promise.resolve(!1)}function U(W){y?.scaleExtent(W)}function G(W){y?.translateExtent(W)}function ut(W){const Z=!Bn(W)||W<0?0:W;y?.clickDistance(Z)}return{update:T,destroy:E,setViewport:C,setViewportConstrained:M,getViewport:j,scaleTo:R,scaleBy:z,setScaleExtent:U,setTranslateExtent:G,syncViewport:D,setClickDistance:ut}}var Oo;(function(s){s.Line="line",s.Handle="handle"})(Oo||(Oo={}));function GO({width:s,prevWidth:t,height:e,prevHeight:i,affectsX:o,affectsY:a}){const c=s-t,h=e-i,f=[c>0?1:c<0?-1:0,h>0?1:h<0?-1:0];return c&&o&&(f[0]=f[0]*-1),h&&a&&(f[1]=f[1]*-1),f}function Ex(s){const t=s.includes("right")||s.includes("left"),e=s.includes("bottom")||s.includes("top"),i=s.includes("left"),o=s.includes("top");return{isHorizontal:t,isVertical:e,affectsX:i,affectsY:o}}function xs(s,t){return Math.max(0,t-s)}function bs(s,t){return Math.max(0,s-t)}function tu(s,t,e){return Math.max(0,t-s,s-e)}function Mx(s,t){return s?!t:t}function $O(s,t,e,i,o,a,c,h){let{affectsX:f,affectsY:d}=t;const{isHorizontal:p,isVertical:y}=t,v=p&&y,{xSnapped:x,ySnapped:b}=e,{minWidth:w,maxWidth:T,minHeight:E,maxHeight:M}=i,{x:C,y:D,width:j,height:R,aspectRatio:z}=s;let U=Math.floor(p?x-s.pointerX:0),G=Math.floor(y?b-s.pointerY:0);const ut=j+(f?-U:U),W=R+(d?-G:G),Z=-a[0]*j,rt=-a[1]*R;let N=tu(ut,w,T),I=tu(W,E,M);if(c){let H=0,q=0;f&&U<0?H=xs(C+U+Z,c[0][0]):!f&&U>0&&(H=bs(C+ut+Z,c[1][0])),d&&G<0?q=xs(D+G+rt,c[0][1]):!d&&G>0&&(q=bs(D+W+rt,c[1][1])),N=Math.max(N,H),I=Math.max(I,q)}if(h){let H=0,q=0;f&&U>0?H=bs(C+U,h[0][0]):!f&&U<0&&(H=xs(C+ut,h[1][0])),d&&G>0?q=bs(D+G,h[0][1]):!d&&G<0&&(q=xs(D+W,h[1][1])),N=Math.max(N,H),I=Math.max(I,q)}if(o){if(p){const H=tu(ut/z,E,M)*z;if(N=Math.max(N,H),c){let q=0;!f&&!d||f&&!d&&v?q=bs(D+rt+ut/z,c[1][1])*z:q=xs(D+rt+(f?U:-U)/z,c[0][1])*z,N=Math.max(N,q)}if(h){let q=0;!f&&!d||f&&!d&&v?q=xs(D+ut/z,h[1][1])*z:q=bs(D+(f?U:-U)/z,h[0][1])*z,N=Math.max(N,q)}}if(y){const H=tu(W*z,w,T)/z;if(I=Math.max(I,H),c){let q=0;!f&&!d||d&&!f&&v?q=bs(C+W*z+Z,c[1][0])/z:q=xs(C+(d?G:-G)*z+Z,c[0][0])/z,I=Math.max(I,q)}if(h){let q=0;!f&&!d||d&&!f&&v?q=xs(C+W*z,h[1][0])/z:q=bs(C+(d?G:-G)*z,h[0][0])/z,I=Math.max(I,q)}}}G=G+(G<0?I:-I),U=U+(U<0?N:-N),o&&(v?ut>W*z?G=(Mx(f,d)?-U:U)/z:U=(Mx(f,d)?-G:G)*z:p?(G=U/z,d=f):(U=G*z,f=d));const A=f?C+U:C,L=d?D+G:D;return{width:j+(f?-U:U),height:R+(d?-G:G),x:a[0]*U*(f?-1:1)+A,y:a[1]*G*(d?-1:1)+L}}const qb={width:0,height:0,x:0,y:0},qO={...qb,pointerX:0,pointerY:0,aspectRatio:1};function WO(s){return[[0,0],[s.measured.width,s.measured.height]]}function ZO(s,t,e){const i=t.position.x+s.position.x,o=t.position.y+s.position.y,a=s.measured.width??0,c=s.measured.height??0,h=e[0]*a,f=e[1]*c;return[[i-h,o-f],[i+a-h,o+c-f]]}function KO({domNode:s,nodeId:t,getStoreItems:e,onChange:i,onEnd:o}){const a=cn(s);let c={controlDirection:Ex("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function h({controlPosition:d,boundaries:p,keepAspectRatio:y,resizeDirection:v,onResizeStart:x,onResize:b,onResizeEnd:w,shouldResize:T}){let E={...qb},M={...qO};c={boundaries:p,resizeDirection:v,keepAspectRatio:y,controlDirection:Ex(d)};let C,D=null,j=[],R,z,U,G=!1;const ut=sb().on("start",W=>{const{nodeLookup:Z,transform:rt,snapGrid:N,snapToGrid:I,nodeOrigin:A,paneDomNode:L}=e();if(C=Z.get(t),!C)return;D=L?.getBoundingClientRect()??null;const{xSnapped:H,ySnapped:q}=qa(W.sourceEvent,{transform:rt,snapGrid:N,snapToGrid:I,containerBounds:D});E={width:C.measured.width??0,height:C.measured.height??0,x:C.position.x??0,y:C.position.y??0},M={...E,pointerX:H,pointerY:q,aspectRatio:E.width/E.height},R=void 0,C.parentId&&(C.extent==="parent"||C.expandParent)&&(R=Z.get(C.parentId),z=R&&C.extent==="parent"?WO(R):void 0),j=[],U=void 0;for(const[st,k]of Z)if(k.parentId===t&&(j.push({id:st,position:{...k.position},extent:k.extent}),k.extent==="parent"||k.expandParent)){const P=ZO(k,C,k.origin??A);U?U=[[Math.min(P[0][0],U[0][0]),Math.min(P[0][1],U[0][1])],[Math.max(P[1][0],U[1][0]),Math.max(P[1][1],U[1][1])]]:U=P}x?.(W,{...E})}).on("drag",W=>{const{transform:Z,snapGrid:rt,snapToGrid:N,nodeOrigin:I}=e(),A=qa(W.sourceEvent,{transform:Z,snapGrid:rt,snapToGrid:N,containerBounds:D}),L=[];if(!C)return;const{x:H,y:q,width:st,height:k}=E,P={},et=C.origin??I,{width:nt,height:ht,x:dt,y:ft}=$O(M,c.controlDirection,A,c.boundaries,c.keepAspectRatio,et,z,U),X=nt!==st,ot=ht!==k,gt=dt!==H&&X,xt=ft!==q&&ot;if(!gt&&!xt&&!X&&!ot)return;if((gt||xt||et[0]===1||et[1]===1)&&(P.x=gt?dt:E.x,P.y=xt?ft:E.y,E.x=P.x,E.y=P.y,j.length>0)){const It=dt-H,Vt=ft-q;for(const xe of j)xe.position={x:xe.position.x-It+et[0]*(nt-st),y:xe.position.y-Vt+et[1]*(ht-k)},L.push(xe)}if((X||ot)&&(P.width=X&&(!c.resizeDirection||c.resizeDirection==="horizontal")?nt:E.width,P.height=ot&&(!c.resizeDirection||c.resizeDirection==="vertical")?ht:E.height,E.width=P.width,E.height=P.height),R&&C.expandParent){const It=et[0]*(P.width??0);P.x&&P.x<It&&(E.x=It,M.x=M.x-(P.x-It));const Vt=et[1]*(P.height??0);P.y&&P.y<Vt&&(E.y=Vt,M.y=M.y-(P.y-Vt))}const pt=GO({width:E.width,prevWidth:st,height:E.height,prevHeight:k,affectsX:c.controlDirection.affectsX,affectsY:c.controlDirection.affectsY}),_t={...E,direction:pt};T?.(W,_t)!==!1&&(G=!0,b?.(W,_t),i(P,L))}).on("end",W=>{G&&(w?.(W,{...E}),o?.({...E}),G=!1)});a.call(ut)}function f(){a.on(".drag",null)}return{update:h,destroy:f}}var pg={exports:{}},mg={},yg={exports:{}},vg={};var Dx;function QO(){if(Dx)return vg;Dx=1;var s=pl();function t(y,v){return y===v&&(y!==0||1/y===1/v)||y!==y&&v!==v}var e=typeof Object.is=="function"?Object.is:t,i=s.useState,o=s.useEffect,a=s.useLayoutEffect,c=s.useDebugValue;function h(y,v){var x=v(),b=i({inst:{value:x,getSnapshot:v}}),w=b[0].inst,T=b[1];return a(function(){w.value=x,w.getSnapshot=v,f(w)&&T({inst:w})},[y,x,v]),o(function(){return f(w)&&T({inst:w}),y(function(){f(w)&&T({inst:w})})},[y]),c(x),x}function f(y){var v=y.getSnapshot;y=y.value;try{var x=v();return!e(y,x)}catch{return!0}}function d(y,v){return v()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:h;return vg.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:p,vg}var Ox;function JO(){return Ox||(Ox=1,yg.exports=QO()),yg.exports}var Ax;function t3(){if(Ax)return mg;Ax=1;var s=pl(),t=JO();function e(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var i=typeof Object.is=="function"?Object.is:e,o=t.useSyncExternalStore,a=s.useRef,c=s.useEffect,h=s.useMemo,f=s.useDebugValue;return mg.useSyncExternalStoreWithSelector=function(d,p,y,v,x){var b=a(null);if(b.current===null){var w={hasValue:!1,value:null};b.current=w}else w=b.current;b=h(function(){function E(R){if(!M){if(M=!0,C=R,R=v(R),x!==void 0&&w.hasValue){var z=w.value;if(x(z,R))return D=z}return D=R}if(z=D,i(C,R))return z;var U=v(R);return x!==void 0&&x(z,U)?(C=R,z):(C=R,D=U)}var M=!1,C,D,j=y===void 0?null:y;return[function(){return E(p())},j===null?void 0:function(){return E(j())}]},[p,y,v,x]);var T=o(d,b[0],b[1]);return c(function(){w.hasValue=!0,w.value=T},[T]),f(T),T},mg}var kx;function e3(){return kx||(kx=1,pg.exports=t3()),pg.exports}var n3=e3();const i3=H1(n3),s3={},jx=s=>{let t;const e=new Set,i=(p,y)=>{const v=typeof p=="function"?p(t):p;if(!Object.is(v,t)){const x=t;t=y??(typeof v!="object"||v===null)?v:Object.assign({},t,v),e.forEach(b=>b(t,x))}},o=()=>t,f={setState:i,getState:o,getInitialState:()=>d,subscribe:p=>(e.add(p),()=>e.delete(p)),destroy:()=>{(s3?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),e.clear()}},d=t=s(i,o,f);return f},r3=s=>s?jx(s):jx,{useDebugValue:o3}=Xa,{useSyncExternalStoreWithSelector:a3}=i3,l3=s=>s;function Wb(s,t=l3,e){const i=a3(s.subscribe,s.getState,s.getServerState||s.getInitialState,t,e);return o3(i),i}const Nx=(s,t)=>{const e=r3(s),i=(o,a=t)=>Wb(e,o,a);return Object.assign(i,e),i},c3=(s,t)=>s?Nx(s,t):Nx;function ee(s,t){if(Object.is(s,t))return!0;if(typeof s!="object"||s===null||typeof t!="object"||t===null)return!1;if(s instanceof Map&&t instanceof Map){if(s.size!==t.size)return!1;for(const[i,o]of s)if(!Object.is(o,t.get(i)))return!1;return!0}if(s instanceof Set&&t instanceof Set){if(s.size!==t.size)return!1;for(const i of s)if(!t.has(i))return!1;return!0}const e=Object.keys(s);if(e.length!==Object.keys(t).length)return!1;for(const i of e)if(!Object.prototype.hasOwnProperty.call(t,i)||!Object.is(s[i],t[i]))return!1;return!0}U1();const _h=Y.createContext(null),u3=_h.Provider,Zb=ei.error001();function Lt(s,t){const e=Y.useContext(_h);if(e===null)throw new Error(Zb);return Wb(e,s,t)}function ne(){const s=Y.useContext(_h);if(s===null)throw new Error(Zb);return Y.useMemo(()=>({getState:s.getState,setState:s.setState,subscribe:s.subscribe}),[s])}const Rx={display:"none"},h3={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Kb="react-flow__node-desc",Qb="react-flow__edge-desc",f3="react-flow__aria-live",d3=s=>s.ariaLiveMessage,g3=s=>s.ariaLabelConfig;function p3({rfId:s}){const t=Lt(d3);return _.jsx("div",{id:`${f3}-${s}`,"aria-live":"assertive","aria-atomic":"true",style:h3,children:t})}function m3({rfId:s,disableKeyboardA11y:t}){const e=Lt(g3);return _.jsxs(_.Fragment,{children:[_.jsx("div",{id:`${Kb}-${s}`,style:Rx,children:t?e["node.a11yDescription.default"]:e["node.a11yDescription.keyboardDisabled"]}),_.jsx("div",{id:`${Qb}-${s}`,style:Rx,children:e["edge.a11yDescription.default"]}),!t&&_.jsx(p3,{rfId:s})]})}const wh=Y.forwardRef(({position:s="top-left",children:t,className:e,style:i,...o},a)=>{const c=`${s}`.split("-");return _.jsx("div",{className:pe(["react-flow__panel",e,...c]),style:i,ref:a,...o,children:t})});wh.displayName="Panel";function y3({proOptions:s,position:t="bottom-right"}){return s?.hideAttribution?null:_.jsx(wh,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:_.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const v3=s=>{const t=[],e=[];for(const[,i]of s.nodeLookup)i.selected&&t.push(i.internals.userNode);for(const[,i]of s.edgeLookup)i.selected&&e.push(i);return{selectedNodes:t,selectedEdges:e}},eu=s=>s.id;function x3(s,t){return ee(s.selectedNodes.map(eu),t.selectedNodes.map(eu))&&ee(s.selectedEdges.map(eu),t.selectedEdges.map(eu))}function b3({onSelectionChange:s}){const t=ne(),{selectedNodes:e,selectedEdges:i}=Lt(v3,x3);return Y.useEffect(()=>{const o={nodes:e,edges:i};s?.(o),t.getState().onSelectionChangeHandlers.forEach(a=>a(o))},[e,i,s]),null}const S3=s=>!!s.onSelectionChangeHandlers;function _3({onSelectionChange:s}){const t=Lt(S3);return s||t?_.jsx(b3,{onSelectionChange:s}):null}const Jb=[0,0],w3={x:0,y:0,zoom:1},C3=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],zx=[...C3,"rfId"],T3=s=>({setNodes:s.setNodes,setEdges:s.setEdges,setMinZoom:s.setMinZoom,setMaxZoom:s.setMaxZoom,setTranslateExtent:s.setTranslateExtent,setNodeExtent:s.setNodeExtent,reset:s.reset,setDefaultNodesAndEdges:s.setDefaultNodesAndEdges}),Lx={translateExtent:sl,nodeOrigin:Jb,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function E3(s){const{setNodes:t,setEdges:e,setMinZoom:i,setMaxZoom:o,setTranslateExtent:a,setNodeExtent:c,reset:h,setDefaultNodesAndEdges:f}=Lt(T3,ee),d=ne();Y.useEffect(()=>(f(s.defaultNodes,s.defaultEdges),()=>{p.current=Lx,h()}),[]);const p=Y.useRef(Lx);return Y.useEffect(()=>{for(const y of zx){const v=s[y],x=p.current[y];v!==x&&(typeof s[y]>"u"||(y==="nodes"?t(v):y==="edges"?e(v):y==="minZoom"?i(v):y==="maxZoom"?o(v):y==="translateExtent"?a(v):y==="nodeExtent"?c(v):y==="ariaLabelConfig"?d.setState({ariaLabelConfig:cO(v)}):y==="fitView"?d.setState({fitViewQueued:v}):y==="fitViewOptions"?d.setState({fitViewOptions:v}):d.setState({[y]:v})))}p.current=s},zx.map(y=>s[y])),null}function Bx(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function M3(s){const[t,e]=Y.useState(s==="system"?null:s);return Y.useEffect(()=>{if(s!=="system"){e(s);return}const i=Bx(),o=()=>e(i?.matches?"dark":"light");return o(),i?.addEventListener("change",o),()=>{i?.removeEventListener("change",o)}},[s]),t!==null?t:Bx()?.matches?"dark":"light"}const Hx=typeof document<"u"?document:null;function ll(s=null,t={target:Hx,actInsideInputWithModifier:!0}){const[e,i]=Y.useState(!1),o=Y.useRef(!1),a=Y.useRef(new Set([])),[c,h]=Y.useMemo(()=>{if(s!==null){const d=(Array.isArray(s)?s:[s]).filter(y=>typeof y=="string").map(y=>y.replace("+",`
`).replace(`

`,`
+`).split(`
`)),p=d.reduce((y,v)=>y.concat(...v),[]);return[d,p]}return[[],[]]},[s]);return Y.useEffect(()=>{const f=t?.target??Hx,d=t?.actInsideInputWithModifier??!0;if(s!==null){const p=x=>{if(o.current=x.ctrlKey||x.metaKey||x.shiftKey||x.altKey,(!o.current||o.current&&!d)&&jb(x))return!1;const w=Px(x.code,h);if(a.current.add(x[w]),Ux(c,a.current,!1)){const T=x.composedPath?.()?.[0]||x.target,E=T?.nodeName==="BUTTON"||T?.nodeName==="A";t.preventDefault!==!1&&(o.current||!E)&&x.preventDefault(),i(!0)}},y=x=>{const b=Px(x.code,h);Ux(c,a.current,!0)?(i(!1),a.current.clear()):a.current.delete(x[b]),x.key==="Meta"&&a.current.clear(),o.current=!1},v=()=>{a.current.clear(),i(!1)};return f?.addEventListener("keydown",p),f?.addEventListener("keyup",y),window.addEventListener("blur",v),window.addEventListener("contextmenu",v),()=>{f?.removeEventListener("keydown",p),f?.removeEventListener("keyup",y),window.removeEventListener("blur",v),window.removeEventListener("contextmenu",v)}}},[s,i]),e}function Ux(s,t,e){return s.filter(i=>e||i.length===t.size).some(i=>i.every(o=>t.has(o)))}function Px(s,t){return t.includes(s)?"code":"key"}const D3=()=>{const s=ne();return Y.useMemo(()=>({zoomIn:t=>{const{panZoom:e}=s.getState();return e?e.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:e}=s.getState();return e?e.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,e)=>{const{panZoom:i}=s.getState();return i?i.scaleTo(t,{duration:e?.duration}):Promise.resolve(!1)},getZoom:()=>s.getState().transform[2],setViewport:async(t,e)=>{const{transform:[i,o,a],panZoom:c}=s.getState();return c?(await c.setViewport({x:t.x??i,y:t.y??o,zoom:t.zoom??a},e),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,e,i]=s.getState().transform;return{x:t,y:e,zoom:i}},setCenter:async(t,e,i)=>s.getState().setCenter(t,e,i),fitBounds:async(t,e)=>{const{width:i,height:o,minZoom:a,maxZoom:c,panZoom:h}=s.getState(),f=bp(t,i,o,a,c,e?.padding??.1);return h?(await h.setViewport(f,{duration:e?.duration,ease:e?.ease,interpolate:e?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,e={})=>{const{transform:i,snapGrid:o,snapToGrid:a,domNode:c}=s.getState();if(!c)return t;const{x:h,y:f}=c.getBoundingClientRect(),d={x:t.x-h,y:t.y-f},p=e.snapGrid??o,y=e.snapToGrid??a;return Sl(d,i,y,p)},flowToScreenPosition:t=>{const{transform:e,domNode:i}=s.getState();if(!i)return t;const{x:o,y:a}=i.getBoundingClientRect(),c=Qu(t,e);return{x:c.x+o,y:c.y+a}}}),[])};function tS(s,t){const e=[],i=new Map,o=[];for(const a of s)if(a.type==="add"){o.push(a);continue}else if(a.type==="remove"||a.type==="replace")i.set(a.id,[a]);else{const c=i.get(a.id);c?c.push(a):i.set(a.id,[a])}for(const a of t){const c=i.get(a.id);if(!c){e.push(a);continue}if(c[0].type==="remove")continue;if(c[0].type==="replace"){e.push({...c[0].item});continue}const h={...a};for(const f of c)O3(f,h);e.push(h)}return o.length&&o.forEach(a=>{a.index!==void 0?e.splice(a.index,0,{...a.item}):e.push({...a.item})}),e}function O3(s,t){switch(s.type){case"select":{t.selected=s.selected;break}case"position":{typeof s.position<"u"&&(t.position=s.position),typeof s.dragging<"u"&&(t.dragging=s.dragging);break}case"dimensions":{typeof s.dimensions<"u"&&(t.measured={...s.dimensions},s.setAttributes&&((s.setAttributes===!0||s.setAttributes==="width")&&(t.width=s.dimensions.width),(s.setAttributes===!0||s.setAttributes==="height")&&(t.height=s.dimensions.height))),typeof s.resizing=="boolean"&&(t.resizing=s.resizing);break}}}function eS(s,t){return tS(s,t)}function nS(s,t){return tS(s,t)}function er(s,t){return{id:s,type:"select",selected:t}}function go(s,t=new Set,e=!1){const i=[];for(const[o,a]of s){const c=t.has(o);!(a.selected===void 0&&!c)&&a.selected!==c&&(e&&(a.selected=c),i.push(er(a.id,c)))}return i}function Yx({items:s=[],lookup:t}){const e=[],i=new Map(s.map(o=>[o.id,o]));for(const[o,a]of s.entries()){const c=t.get(a.id),h=c?.internals?.userNode??c;h!==void 0&&h!==a&&e.push({id:a.id,item:a,type:"replace"}),h===void 0&&e.push({item:a,type:"add",index:o})}for(const[o]of t)i.get(o)===void 0&&e.push({id:o,type:"remove"});return e}function Vx(s){return{id:s.id,type:"remove"}}const Xx=s=>JD(s),A3=s=>Cb(s);function iS(s){return Y.forwardRef(s)}const k3=typeof window<"u"?Y.useLayoutEffect:Y.useEffect;function Fx(s){const[t,e]=Y.useState(BigInt(0)),[i]=Y.useState(()=>j3(()=>e(o=>o+BigInt(1))));return k3(()=>{const o=i.get();o.length&&(s(o),i.reset())},[t]),i}function j3(s){let t=[];return{get:()=>t,reset:()=>{t=[]},push:e=>{t.push(e),s()}}}const sS=Y.createContext(null);function N3({children:s}){const t=ne(),e=Y.useCallback(h=>{const{nodes:f=[],setNodes:d,hasDefaultNodes:p,onNodesChange:y,nodeLookup:v,fitViewQueued:x,onNodesChangeMiddlewareMap:b}=t.getState();let w=f;for(const E of h)w=typeof E=="function"?E(w):E;let T=Yx({items:w,lookup:v});for(const E of b.values())T=E(T);p&&d(w),T.length>0?y?.(T):x&&window.requestAnimationFrame(()=>{const{fitViewQueued:E,nodes:M,setNodes:C}=t.getState();E&&C(M)})},[]),i=Fx(e),o=Y.useCallback(h=>{const{edges:f=[],setEdges:d,hasDefaultEdges:p,onEdgesChange:y,edgeLookup:v}=t.getState();let x=f;for(const b of h)x=typeof b=="function"?b(x):b;p?d(x):y&&y(Yx({items:x,lookup:v}))},[]),a=Fx(o),c=Y.useMemo(()=>({nodeQueue:i,edgeQueue:a}),[]);return _.jsx(sS.Provider,{value:c,children:s})}function R3(){const s=Y.useContext(sS);if(!s)throw new Error("useBatchContext must be used within a BatchProvider");return s}const z3=s=>!!s.panZoom;function Ch(){const s=D3(),t=ne(),e=R3(),i=Lt(z3),o=Y.useMemo(()=>{const a=y=>t.getState().nodeLookup.get(y),c=y=>{e.nodeQueue.push(y)},h=y=>{e.edgeQueue.push(y)},f=y=>{const{nodeLookup:v,nodeOrigin:x}=t.getState(),b=Xx(y)?y:v.get(y.id),w=b.parentId?Ab(b.position,b.measured,b.parentId,v,x):b.position,T={...b,position:w,width:b.measured?.width??b.width,height:b.measured?.height??b.height};return Mo(T)},d=(y,v,x={replace:!1})=>{c(b=>b.map(w=>{if(w.id===y){const T=typeof v=="function"?v(w):v;return x.replace&&Xx(T)?T:{...w,...T}}return w}))},p=(y,v,x={replace:!1})=>{h(b=>b.map(w=>{if(w.id===y){const T=typeof v=="function"?v(w):v;return x.replace&&A3(T)?T:{...w,...T}}return w}))};return{getNodes:()=>t.getState().nodes.map(y=>({...y})),getNode:y=>a(y)?.internals.userNode,getInternalNode:a,getEdges:()=>{const{edges:y=[]}=t.getState();return y.map(v=>({...v}))},getEdge:y=>t.getState().edgeLookup.get(y),setNodes:c,setEdges:h,addNodes:y=>{const v=Array.isArray(y)?y:[y];e.nodeQueue.push(x=>[...x,...v])},addEdges:y=>{const v=Array.isArray(y)?y:[y];e.edgeQueue.push(x=>[...x,...v])},toObject:()=>{const{nodes:y=[],edges:v=[],transform:x}=t.getState(),[b,w,T]=x;return{nodes:y.map(E=>({...E})),edges:v.map(E=>({...E})),viewport:{x:b,y:w,zoom:T}}},deleteElements:async({nodes:y=[],edges:v=[]})=>{const{nodes:x,edges:b,onNodesDelete:w,onEdgesDelete:T,triggerNodeChanges:E,triggerEdgeChanges:M,onDelete:C,onBeforeDelete:D}=t.getState(),{nodes:j,edges:R}=await sO({nodesToRemove:y,edgesToRemove:v,nodes:x,edges:b,onBeforeDelete:D}),z=R.length>0,U=j.length>0;if(z){const G=R.map(Vx);T?.(R),M(G)}if(U){const G=j.map(Vx);w?.(j),E(G)}return(U||z)&&C?.({nodes:j,edges:R}),{deletedNodes:j,deletedEdges:R}},getIntersectingNodes:(y,v=!0,x)=>{const b=px(y),w=b?y:f(y),T=x!==void 0;return w?(x||t.getState().nodes).filter(E=>{const M=t.getState().nodeLookup.get(E.id);if(M&&!b&&(E.id===y.id||!M.internals.positionAbsolute))return!1;const C=Mo(T?E:M),D=ol(C,w);return v&&D>0||D>=C.width*C.height||D>=w.width*w.height}):[]},isNodeIntersecting:(y,v,x=!0)=>{const w=px(y)?y:f(y);if(!w)return!1;const T=ol(w,v);return x&&T>0||T>=v.width*v.height||T>=w.width*w.height},updateNode:d,updateNodeData:(y,v,x={replace:!1})=>{d(y,b=>{const w=typeof v=="function"?v(b):v;return x.replace?{...b,data:w}:{...b,data:{...b.data,...w}}},x)},updateEdge:p,updateEdgeData:(y,v,x={replace:!1})=>{p(y,b=>{const w=typeof v=="function"?v(b):v;return x.replace?{...b,data:w}:{...b,data:{...b.data,...w}}},x)},getNodesBounds:y=>{const{nodeLookup:v,nodeOrigin:x}=t.getState();return tO(y,{nodeLookup:v,nodeOrigin:x})},getHandleConnections:({type:y,id:v,nodeId:x})=>Array.from(t.getState().connectionLookup.get(`${x}-${y}${v?`-${v}`:""}`)?.values()??[]),getNodeConnections:({type:y,handleId:v,nodeId:x})=>Array.from(t.getState().connectionLookup.get(`${x}${y?v?`-${y}-${v}`:`-${y}`:""}`)?.values()??[]),fitView:async y=>{const v=t.getState().fitViewResolver??lO();return t.setState({fitViewQueued:!0,fitViewOptions:y,fitViewResolver:v}),e.nodeQueue.push(x=>[...x]),v.promise}}},[]);return Y.useMemo(()=>({...o,...s,viewportInitialized:i}),[i])}const Ix=s=>s.selected,L3=typeof window<"u"?window:void 0;function B3({deleteKeyCode:s,multiSelectionKeyCode:t}){const e=ne(),{deleteElements:i}=Ch(),o=ll(s,{actInsideInputWithModifier:!1}),a=ll(t,{target:L3});Y.useEffect(()=>{if(o){const{edges:c,nodes:h}=e.getState();i({nodes:h.filter(Ix),edges:c.filter(Ix)}),e.setState({nodesSelectionActive:!1})}},[o]),Y.useEffect(()=>{e.setState({multiSelectionActive:a})},[a])}function H3(s){const t=ne();Y.useEffect(()=>{const e=()=>{if(!s.current||!(s.current.checkVisibility?.()??!0))return!1;const i=Sp(s.current);(i.height===0||i.width===0)&&t.getState().onError?.("004",ei.error004()),t.setState({width:i.width||500,height:i.height||500})};if(s.current){e(),window.addEventListener("resize",e);const i=new ResizeObserver(()=>e());return i.observe(s.current),()=>{window.removeEventListener("resize",e),i&&s.current&&i.unobserve(s.current)}}},[])}const Th={position:"absolute",width:"100%",height:"100%",top:0,left:0},U3=s=>({userSelectionActive:s.userSelectionActive,lib:s.lib,connectionInProgress:s.connection.inProgress});function P3({onPaneContextMenu:s,zoomOnScroll:t=!0,zoomOnPinch:e=!0,panOnScroll:i=!1,panOnScrollSpeed:o=.5,panOnScrollMode:a=ur.Free,zoomOnDoubleClick:c=!0,panOnDrag:h=!0,defaultViewport:f,translateExtent:d,minZoom:p,maxZoom:y,zoomActivationKeyCode:v,preventScrolling:x=!0,children:b,noWheelClassName:w,noPanClassName:T,onViewportChange:E,isControlledViewport:M,paneClickDistance:C,selectionOnDrag:D}){const j=ne(),R=Y.useRef(null),{userSelectionActive:z,lib:U,connectionInProgress:G}=Lt(U3,ee),ut=ll(v),W=Y.useRef();H3(R);const Z=Y.useCallback(rt=>{E?.({x:rt[0],y:rt[1],zoom:rt[2]}),M||j.setState({transform:rt})},[E,M]);return Y.useEffect(()=>{if(R.current){W.current=IO({domNode:R.current,minZoom:p,maxZoom:y,translateExtent:d,viewport:f,onDraggingChange:A=>j.setState({paneDragging:A}),onPanZoomStart:(A,L)=>{const{onViewportChangeStart:H,onMoveStart:q}=j.getState();q?.(A,L),H?.(L)},onPanZoom:(A,L)=>{const{onViewportChange:H,onMove:q}=j.getState();q?.(A,L),H?.(L)},onPanZoomEnd:(A,L)=>{const{onViewportChangeEnd:H,onMoveEnd:q}=j.getState();q?.(A,L),H?.(L)}});const{x:rt,y:N,zoom:I}=W.current.getViewport();return j.setState({panZoom:W.current,transform:[rt,N,I],domNode:R.current.closest(".react-flow")}),()=>{W.current?.destroy()}}},[]),Y.useEffect(()=>{W.current?.update({onPaneContextMenu:s,zoomOnScroll:t,zoomOnPinch:e,panOnScroll:i,panOnScrollSpeed:o,panOnScrollMode:a,zoomOnDoubleClick:c,panOnDrag:h,zoomActivationKeyPressed:ut,preventScrolling:x,noPanClassName:T,userSelectionActive:z,noWheelClassName:w,lib:U,onTransformChange:Z,connectionInProgress:G,selectionOnDrag:D,paneClickDistance:C})},[s,t,e,i,o,a,c,h,ut,x,T,z,w,U,Z,G,D,C]),_.jsx("div",{className:"react-flow__renderer",ref:R,style:Th,children:b})}const Y3=s=>({userSelectionActive:s.userSelectionActive,userSelectionRect:s.userSelectionRect});function V3(){const{userSelectionActive:s,userSelectionRect:t}=Lt(Y3,ee);return s&&t?_.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const xg=(s,t)=>e=>{e.target===t.current&&s?.(e)},X3=s=>({userSelectionActive:s.userSelectionActive,elementsSelectable:s.elementsSelectable,connectionInProgress:s.connection.inProgress,dragging:s.paneDragging});function F3({isSelecting:s,selectionKeyPressed:t,selectionMode:e=rl.Full,panOnDrag:i,paneClickDistance:o,selectionOnDrag:a,onSelectionStart:c,onSelectionEnd:h,onPaneClick:f,onPaneContextMenu:d,onPaneScroll:p,onPaneMouseEnter:y,onPaneMouseMove:v,onPaneMouseLeave:x,children:b}){const w=ne(),{userSelectionActive:T,elementsSelectable:E,dragging:M,connectionInProgress:C}=Lt(X3,ee),D=E&&(s||T),j=Y.useRef(null),R=Y.useRef(),z=Y.useRef(new Set),U=Y.useRef(new Set),G=Y.useRef(!1),ut=H=>{if(G.current||C){G.current=!1;return}f?.(H),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},W=H=>{if(Array.isArray(i)&&i?.includes(2)){H.preventDefault();return}d?.(H)},Z=p?H=>p(H):void 0,rt=H=>{G.current&&(H.stopPropagation(),G.current=!1)},N=H=>{const{domNode:q}=w.getState();if(R.current=q?.getBoundingClientRect(),!R.current)return;const st=H.target===j.current;if(!st&&!!H.target.closest(".nokey")||!s||!(a&&st||t)||H.button!==0||!H.isPrimary)return;H.target?.setPointerCapture?.(H.pointerId),G.current=!1;const{x:et,y:nt}=Hn(H.nativeEvent,R.current);w.setState({userSelectionRect:{width:0,height:0,startX:et,startY:nt,x:et,y:nt}}),st||(H.stopPropagation(),H.preventDefault())},I=H=>{const{userSelectionRect:q,transform:st,nodeLookup:k,edgeLookup:P,connectionLookup:et,triggerNodeChanges:nt,triggerEdgeChanges:ht,defaultEdgeOptions:dt,resetSelectedElements:ft}=w.getState();if(!R.current||!q)return;const{x:X,y:ot}=Hn(H.nativeEvent,R.current),{startX:gt,startY:xt}=q;if(!G.current){const Vt=t?0:o;if(Math.hypot(X-gt,ot-xt)<=Vt)return;ft(),c?.(H)}G.current=!0;const pt={startX:gt,startY:xt,x:X<gt?X:gt,y:ot<xt?ot:xt,width:Math.abs(X-gt),height:Math.abs(ot-xt)},_t=z.current,Ot=U.current;z.current=new Set(xp(k,pt,st,e===rl.Partial,!0).map(Vt=>Vt.id)),U.current=new Set;const It=dt?.selectable??!0;for(const Vt of z.current){const xe=et.get(Vt);if(xe)for(const{edgeId:Tn}of xe.values()){const Je=P.get(Tn);Je&&(Je.selectable??It)&&U.current.add(Tn)}}if(!mx(_t,z.current)){const Vt=go(k,z.current,!0);nt(Vt)}if(!mx(Ot,U.current)){const Vt=go(P,U.current);ht(Vt)}w.setState({userSelectionRect:pt,userSelectionActive:!0,nodesSelectionActive:!1})},A=H=>{H.button===0&&(H.target?.releasePointerCapture?.(H.pointerId),!T&&H.target===j.current&&w.getState().userSelectionRect&&ut?.(H),w.setState({userSelectionActive:!1,userSelectionRect:null}),G.current&&(h?.(H),w.setState({nodesSelectionActive:z.current.size>0})))},L=i===!0||Array.isArray(i)&&i.includes(0);return _.jsxs("div",{className:pe(["react-flow__pane",{draggable:L,dragging:M,selection:s}]),onClick:D?void 0:xg(ut,j),onContextMenu:xg(W,j),onWheel:xg(Z,j),onPointerEnter:D?void 0:y,onPointerMove:D?I:v,onPointerUp:D?A:void 0,onPointerDownCapture:D?N:void 0,onClickCapture:D?rt:void 0,onPointerLeave:x,ref:j,style:Th,children:[b,_.jsx(V3,{})]})}function Zg({id:s,store:t,unselect:e=!1,nodeRef:i}){const{addSelectedNodes:o,unselectNodesAndEdges:a,multiSelectionActive:c,nodeLookup:h,onError:f}=t.getState(),d=h.get(s);if(!d){f?.("012",ei.error012(s));return}t.setState({nodesSelectionActive:!1}),d.selected?(e||d.selected&&c)&&(a({nodes:[d],edges:[]}),requestAnimationFrame(()=>i?.current?.blur())):o([s])}function rS({nodeRef:s,disabled:t=!1,noDragClassName:e,handleSelector:i,nodeId:o,isSelectable:a,nodeClickDistance:c}){const h=ne(),[f,d]=Y.useState(!1),p=Y.useRef();return Y.useEffect(()=>{p.current=kO({getStoreItems:()=>h.getState(),onNodeMouseDown:y=>{Zg({id:y,store:h,nodeRef:s})},onDragStart:()=>{d(!0)},onDragStop:()=>{d(!1)}})},[]),Y.useEffect(()=>{if(t)p.current?.destroy();else if(s.current)return p.current?.update({noDragClassName:e,handleSelector:i,domNode:s.current,isSelectable:a,nodeId:o,nodeClickDistance:c}),()=>{p.current?.destroy()}},[e,i,t,a,s,o]),f}const I3=s=>t=>t.selected&&(t.draggable||s&&typeof t.draggable>"u");function oS(){const s=ne();return Y.useCallback(e=>{const{nodeExtent:i,snapToGrid:o,snapGrid:a,nodesDraggable:c,onError:h,updateNodePositions:f,nodeLookup:d,nodeOrigin:p}=s.getState(),y=new Map,v=I3(c),x=o?a[0]:5,b=o?a[1]:5,w=e.direction.x*x*e.factor,T=e.direction.y*b*e.factor;for(const[,E]of d){if(!v(E))continue;let M={x:E.internals.positionAbsolute.x+w,y:E.internals.positionAbsolute.y+T};o&&(M=bl(M,a));const{position:C,positionAbsolute:D}=Tb({nodeId:E.id,nextPosition:M,nodeLookup:d,nodeExtent:i,nodeOrigin:p,onError:h});E.position=C,E.internals.positionAbsolute=D,y.set(E.id,E)}f(y)},[])}const Mp=Y.createContext(null),G3=Mp.Provider;Mp.Consumer;const aS=()=>Y.useContext(Mp),$3=s=>({connectOnClick:s.connectOnClick,noPanClassName:s.noPanClassName,rfId:s.rfId}),q3=(s,t,e)=>i=>{const{connectionClickStartHandle:o,connectionMode:a,connection:c}=i,{fromHandle:h,toHandle:f,isValid:d}=c,p=f?.nodeId===s&&f?.id===t&&f?.type===e;return{connectingFrom:h?.nodeId===s&&h?.id===t&&h?.type===e,connectingTo:p,clickConnecting:o?.nodeId===s&&o?.id===t&&o?.type===e,isPossibleEndHandle:a===To.Strict?h?.type!==e:s!==h?.nodeId||t!==h?.id,connectionInProcess:!!h,clickConnectionInProcess:!!o,valid:p&&d}};function W3({type:s="source",position:t=bt.Top,isValidConnection:e,isConnectable:i=!0,isConnectableStart:o=!0,isConnectableEnd:a=!0,id:c,onConnect:h,children:f,className:d,onMouseDown:p,onTouchStart:y,...v},x){const b=c||null,w=s==="target",T=ne(),E=aS(),{connectOnClick:M,noPanClassName:C,rfId:D}=Lt($3,ee),{connectingFrom:j,connectingTo:R,clickConnecting:z,isPossibleEndHandle:U,connectionInProcess:G,clickConnectionInProcess:ut,valid:W}=Lt(q3(E,b,s),ee);E||T.getState().onError?.("010",ei.error010());const Z=I=>{const{defaultEdgeOptions:A,onConnect:L,hasDefaultEdges:H}=T.getState(),q={...A,...I};if(H){const{edges:st,setEdges:k}=T.getState();k(pO(q,st))}L?.(q),h?.(q)},rt=I=>{if(!E)return;const A=Nb(I.nativeEvent);if(o&&(A&&I.button===0||!A)){const L=T.getState();Wg.onPointerDown(I.nativeEvent,{handleDomNode:I.currentTarget,autoPanOnConnect:L.autoPanOnConnect,connectionMode:L.connectionMode,connectionRadius:L.connectionRadius,domNode:L.domNode,nodeLookup:L.nodeLookup,lib:L.lib,isTarget:w,handleId:b,nodeId:E,flowId:L.rfId,panBy:L.panBy,cancelConnection:L.cancelConnection,onConnectStart:L.onConnectStart,onConnectEnd:L.onConnectEnd,updateConnection:L.updateConnection,onConnect:Z,isValidConnection:e||L.isValidConnection,getTransform:()=>T.getState().transform,getFromHandle:()=>T.getState().connection.fromHandle,autoPanSpeed:L.autoPanSpeed,dragThreshold:L.connectionDragThreshold})}A?p?.(I):y?.(I)},N=I=>{const{onClickConnectStart:A,onClickConnectEnd:L,connectionClickStartHandle:H,connectionMode:q,isValidConnection:st,lib:k,rfId:P,nodeLookup:et,connection:nt}=T.getState();if(!E||!H&&!o)return;if(!H){A?.(I.nativeEvent,{nodeId:E,handleId:b,handleType:s}),T.setState({connectionClickStartHandle:{nodeId:E,type:s,id:b}});return}const ht=kb(I.target),dt=e||st,{connection:ft,isValid:X}=Wg.isValid(I.nativeEvent,{handle:{nodeId:E,id:b,type:s},connectionMode:q,fromNodeId:H.nodeId,fromHandleId:H.id||null,fromType:H.type,isValidConnection:dt,flowId:P,doc:ht,lib:k,nodeLookup:et});X&&ft&&Z(ft);const ot=structuredClone(nt);delete ot.inProgress,ot.toPosition=ot.toHandle?ot.toHandle.position:null,L?.(I,ot),T.setState({connectionClickStartHandle:null})};return _.jsx("div",{"data-handleid":b,"data-nodeid":E,"data-handlepos":t,"data-id":`${D}-${E}-${b}-${s}`,className:pe(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",C,d,{source:!w,target:w,connectable:i,connectablestart:o,connectableend:a,clickconnecting:z,connectingfrom:j,connectingto:R,valid:W,connectionindicator:i&&(!G||U)&&(G||ut?a:o)}]),onMouseDown:rt,onTouchStart:rt,onClick:M?N:void 0,ref:x,...v,children:f})}const hr=Y.memo(iS(W3));function Z3({data:s,isConnectable:t,sourcePosition:e=bt.Bottom}){return _.jsxs(_.Fragment,{children:[s?.label,_.jsx(hr,{type:"source",position:e,isConnectable:t})]})}function K3({data:s,isConnectable:t,targetPosition:e=bt.Top,sourcePosition:i=bt.Bottom}){return _.jsxs(_.Fragment,{children:[_.jsx(hr,{type:"target",position:e,isConnectable:t}),s?.label,_.jsx(hr,{type:"source",position:i,isConnectable:t})]})}function Q3(){return null}function J3({data:s,isConnectable:t,targetPosition:e=bt.Top}){return _.jsxs(_.Fragment,{children:[_.jsx(hr,{type:"target",position:e,isConnectable:t}),s?.label]})}const Ju={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Gx={input:Z3,default:K3,output:J3,group:Q3};function tA(s){return s.internals.handleBounds===void 0?{width:s.width??s.initialWidth??s.style?.width,height:s.height??s.initialHeight??s.style?.height}:{width:s.width??s.style?.width,height:s.height??s.style?.height}}const eA=s=>{const{width:t,height:e,x:i,y:o}=xl(s.nodeLookup,{filter:a=>!!a.selected});return{width:Bn(t)?t:null,height:Bn(e)?e:null,userSelectionActive:s.userSelectionActive,transformString:`translate(${s.transform[0]}px,${s.transform[1]}px) scale(${s.transform[2]}) translate(${i}px,${o}px)`}};function nA({onSelectionContextMenu:s,noPanClassName:t,disableKeyboardA11y:e}){const i=ne(),{width:o,height:a,transformString:c,userSelectionActive:h}=Lt(eA,ee),f=oS(),d=Y.useRef(null);if(Y.useEffect(()=>{e||d.current?.focus({preventScroll:!0})},[e]),rS({nodeRef:d}),h||!o||!a)return null;const p=s?v=>{const x=i.getState().nodes.filter(b=>b.selected);s(v,x)}:void 0,y=v=>{Object.prototype.hasOwnProperty.call(Ju,v.key)&&(v.preventDefault(),f({direction:Ju[v.key],factor:v.shiftKey?4:1}))};return _.jsx("div",{className:pe(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c},children:_.jsx("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:e?void 0:-1,onKeyDown:e?void 0:y,style:{width:o,height:a}})})}const $x=typeof window<"u"?window:void 0,iA=s=>({nodesSelectionActive:s.nodesSelectionActive,userSelectionActive:s.userSelectionActive});function lS({children:s,onPaneClick:t,onPaneMouseEnter:e,onPaneMouseMove:i,onPaneMouseLeave:o,onPaneContextMenu:a,onPaneScroll:c,paneClickDistance:h,deleteKeyCode:f,selectionKeyCode:d,selectionOnDrag:p,selectionMode:y,onSelectionStart:v,onSelectionEnd:x,multiSelectionKeyCode:b,panActivationKeyCode:w,zoomActivationKeyCode:T,elementsSelectable:E,zoomOnScroll:M,zoomOnPinch:C,panOnScroll:D,panOnScrollSpeed:j,panOnScrollMode:R,zoomOnDoubleClick:z,panOnDrag:U,defaultViewport:G,translateExtent:ut,minZoom:W,maxZoom:Z,preventScrolling:rt,onSelectionContextMenu:N,noWheelClassName:I,noPanClassName:A,disableKeyboardA11y:L,onViewportChange:H,isControlledViewport:q}){const{nodesSelectionActive:st,userSelectionActive:k}=Lt(iA,ee),P=ll(d,{target:$x}),et=ll(w,{target:$x}),nt=et||U,ht=et||D,dt=p&&nt!==!0,ft=P||k||dt;return B3({deleteKeyCode:f,multiSelectionKeyCode:b}),_.jsx(P3,{onPaneContextMenu:a,elementsSelectable:E,zoomOnScroll:M,zoomOnPinch:C,panOnScroll:ht,panOnScrollSpeed:j,panOnScrollMode:R,zoomOnDoubleClick:z,panOnDrag:!P&&nt,defaultViewport:G,translateExtent:ut,minZoom:W,maxZoom:Z,zoomActivationKeyCode:T,preventScrolling:rt,noWheelClassName:I,noPanClassName:A,onViewportChange:H,isControlledViewport:q,paneClickDistance:h,selectionOnDrag:dt,children:_.jsxs(F3,{onSelectionStart:v,onSelectionEnd:x,onPaneClick:t,onPaneMouseEnter:e,onPaneMouseMove:i,onPaneMouseLeave:o,onPaneContextMenu:a,onPaneScroll:c,panOnDrag:nt,isSelecting:!!ft,selectionMode:y,selectionKeyPressed:P,paneClickDistance:h,selectionOnDrag:dt,children:[s,st&&_.jsx(nA,{onSelectionContextMenu:N,noPanClassName:A,disableKeyboardA11y:L})]})})}lS.displayName="FlowRenderer";const sA=Y.memo(lS),rA=s=>t=>s?xp(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(e=>e.id):Array.from(t.nodeLookup.keys());function oA(s){return Lt(Y.useCallback(rA(s),[s]),ee)}const aA=s=>s.updateNodeInternals;function lA(){const s=Lt(aA),[t]=Y.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(e=>{const i=new Map;e.forEach(o=>{const a=o.target.getAttribute("data-id");i.set(a,{id:a,nodeElement:o.target,force:!0})}),s(i)}));return Y.useEffect(()=>()=>{t?.disconnect()},[t]),t}function cA({node:s,nodeType:t,hasDimensions:e,resizeObserver:i}){const o=ne(),a=Y.useRef(null),c=Y.useRef(null),h=Y.useRef(s.sourcePosition),f=Y.useRef(s.targetPosition),d=Y.useRef(t),p=e&&!!s.internals.handleBounds;return Y.useEffect(()=>{a.current&&!s.hidden&&(!p||c.current!==a.current)&&(c.current&&i?.unobserve(c.current),i?.observe(a.current),c.current=a.current)},[p,s.hidden]),Y.useEffect(()=>()=>{c.current&&(i?.unobserve(c.current),c.current=null)},[]),Y.useEffect(()=>{if(a.current){const y=d.current!==t,v=h.current!==s.sourcePosition,x=f.current!==s.targetPosition;(y||v||x)&&(d.current=t,h.current=s.sourcePosition,f.current=s.targetPosition,o.getState().updateNodeInternals(new Map([[s.id,{id:s.id,nodeElement:a.current,force:!0}]])))}},[s.id,t,s.sourcePosition,s.targetPosition]),a}function uA({id:s,onClick:t,onMouseEnter:e,onMouseMove:i,onMouseLeave:o,onContextMenu:a,onDoubleClick:c,nodesDraggable:h,elementsSelectable:f,nodesConnectable:d,nodesFocusable:p,resizeObserver:y,noDragClassName:v,noPanClassName:x,disableKeyboardA11y:b,rfId:w,nodeTypes:T,nodeClickDistance:E,onError:M}){const{node:C,internals:D,isParent:j}=Lt(X=>{const ot=X.nodeLookup.get(s),gt=X.parentLookup.has(s);return{node:ot,internals:ot.internals,isParent:gt}},ee);let R=C.type||"default",z=T?.[R]||Gx[R];z===void 0&&(M?.("003",ei.error003(R)),R="default",z=T?.default||Gx.default);const U=!!(C.draggable||h&&typeof C.draggable>"u"),G=!!(C.selectable||f&&typeof C.selectable>"u"),ut=!!(C.connectable||d&&typeof C.connectable>"u"),W=!!(C.focusable||p&&typeof C.focusable>"u"),Z=ne(),rt=Ob(C),N=cA({node:C,nodeType:R,hasDimensions:rt,resizeObserver:y}),I=rS({nodeRef:N,disabled:C.hidden||!U,noDragClassName:v,handleSelector:C.dragHandle,nodeId:s,isSelectable:G,nodeClickDistance:E}),A=oS();if(C.hidden)return null;const L=Yi(C),H=tA(C),q=G||U||t||e||i||o,st=e?X=>e(X,{...D.userNode}):void 0,k=i?X=>i(X,{...D.userNode}):void 0,P=o?X=>o(X,{...D.userNode}):void 0,et=a?X=>a(X,{...D.userNode}):void 0,nt=c?X=>c(X,{...D.userNode}):void 0,ht=X=>{const{selectNodesOnDrag:ot,nodeDragThreshold:gt}=Z.getState();G&&(!ot||!U||gt>0)&&Zg({id:s,store:Z,nodeRef:N}),t&&t(X,{...D.userNode})},dt=X=>{if(!(jb(X.nativeEvent)||b)){if(bb.includes(X.key)&&G){const ot=X.key==="Escape";Zg({id:s,store:Z,unselect:ot,nodeRef:N})}else if(U&&C.selected&&Object.prototype.hasOwnProperty.call(Ju,X.key)){X.preventDefault();const{ariaLabelConfig:ot}=Z.getState();Z.setState({ariaLiveMessage:ot["node.a11yDescription.ariaLiveMessage"]({direction:X.key.replace("Arrow","").toLowerCase(),x:~~D.positionAbsolute.x,y:~~D.positionAbsolute.y})}),A({direction:Ju[X.key],factor:X.shiftKey?4:1})}}},ft=()=>{if(b||!N.current?.matches(":focus-visible"))return;const{transform:X,width:ot,height:gt,autoPanOnNodeFocus:xt,setCenter:pt}=Z.getState();if(!xt)return;xp(new Map([[s,C]]),{x:0,y:0,width:ot,height:gt},X,!0).length>0||pt(C.position.x+L.width/2,C.position.y+L.height/2,{zoom:X[2]})};return _.jsx("div",{className:pe(["react-flow__node",`react-flow__node-${R}`,{[x]:U},C.className,{selected:C.selected,selectable:G,parent:j,draggable:U,dragging:I}]),ref:N,style:{zIndex:D.z,transform:`translate(${D.positionAbsolute.x}px,${D.positionAbsolute.y}px)`,pointerEvents:q?"all":"none",visibility:rt?"visible":"hidden",...C.style,...H},"data-id":s,"data-testid":`rf__node-${s}`,onMouseEnter:st,onMouseMove:k,onMouseLeave:P,onContextMenu:et,onClick:ht,onDoubleClick:nt,onKeyDown:W?dt:void 0,tabIndex:W?0:void 0,onFocus:W?ft:void 0,role:C.ariaRole??(W?"group":void 0),"aria-roledescription":"node","aria-describedby":b?void 0:`${Kb}-${w}`,"aria-label":C.ariaLabel,...C.domAttributes,children:_.jsx(G3,{value:s,children:_.jsx(z,{id:s,data:C.data,type:R,positionAbsoluteX:D.positionAbsolute.x,positionAbsoluteY:D.positionAbsolute.y,selected:C.selected??!1,selectable:G,draggable:U,deletable:C.deletable??!0,isConnectable:ut,sourcePosition:C.sourcePosition,targetPosition:C.targetPosition,dragging:I,dragHandle:C.dragHandle,zIndex:D.z,parentId:C.parentId,...L})})})}var hA=Y.memo(uA);const fA=s=>({nodesDraggable:s.nodesDraggable,nodesConnectable:s.nodesConnectable,nodesFocusable:s.nodesFocusable,elementsSelectable:s.elementsSelectable,onError:s.onError});function cS(s){const{nodesDraggable:t,nodesConnectable:e,nodesFocusable:i,elementsSelectable:o,onError:a}=Lt(fA,ee),c=oA(s.onlyRenderVisibleElements),h=lA();return _.jsx("div",{className:"react-flow__nodes",style:Th,children:c.map(f=>_.jsx(hA,{id:f,nodeTypes:s.nodeTypes,nodeExtent:s.nodeExtent,onClick:s.onNodeClick,onMouseEnter:s.onNodeMouseEnter,onMouseMove:s.onNodeMouseMove,onMouseLeave:s.onNodeMouseLeave,onContextMenu:s.onNodeContextMenu,onDoubleClick:s.onNodeDoubleClick,noDragClassName:s.noDragClassName,noPanClassName:s.noPanClassName,rfId:s.rfId,disableKeyboardA11y:s.disableKeyboardA11y,resizeObserver:h,nodesDraggable:t,nodesConnectable:e,nodesFocusable:i,elementsSelectable:o,nodeClickDistance:s.nodeClickDistance,onError:a},f))})}cS.displayName="NodeRenderer";const dA=Y.memo(cS);function gA(s){return Lt(Y.useCallback(e=>{if(!s)return e.edges.map(o=>o.id);const i=[];if(e.width&&e.height)for(const o of e.edges){const a=e.nodeLookup.get(o.source),c=e.nodeLookup.get(o.target);a&&c&&fO({sourceNode:a,targetNode:c,width:e.width,height:e.height,transform:e.transform})&&i.push(o.id)}return i},[s]),ee)}const pA=({color:s="none",strokeWidth:t=1})=>{const e={strokeWidth:t,...s&&{stroke:s}};return _.jsx("polyline",{className:"arrow",style:e,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},mA=({color:s="none",strokeWidth:t=1})=>{const e={strokeWidth:t,...s&&{stroke:s,fill:s}};return _.jsx("polyline",{className:"arrowclosed",style:e,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},qx={[Zu.Arrow]:pA,[Zu.ArrowClosed]:mA};function yA(s){const t=ne();return Y.useMemo(()=>Object.prototype.hasOwnProperty.call(qx,s)?qx[s]:(t.getState().onError?.("009",ei.error009(s)),null),[s])}const vA=({id:s,type:t,color:e,width:i=12.5,height:o=12.5,markerUnits:a="strokeWidth",strokeWidth:c,orient:h="auto-start-reverse"})=>{const f=yA(t);return f?_.jsx("marker",{className:"react-flow__arrowhead",id:s,markerWidth:`${i}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:a,orient:h,refX:"0",refY:"0",children:_.jsx(f,{color:e,strokeWidth:c})}):null},uS=({defaultColor:s,rfId:t})=>{const e=Lt(a=>a.edges),i=Lt(a=>a.defaultEdgeOptions),o=Y.useMemo(()=>bO(e,{id:t,defaultColor:s,defaultMarkerStart:i?.markerStart,defaultMarkerEnd:i?.markerEnd}),[e,i,t,s]);return o.length?_.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:_.jsx("defs",{children:o.map(a=>_.jsx(vA,{id:a.id,type:a.type,color:a.color,width:a.width,height:a.height,markerUnits:a.markerUnits,strokeWidth:a.strokeWidth,orient:a.orient},a.id))})}):null};uS.displayName="MarkerDefinitions";var xA=Y.memo(uS);function hS({x:s,y:t,label:e,labelStyle:i,labelShowBg:o=!0,labelBgStyle:a,labelBgPadding:c=[2,4],labelBgBorderRadius:h=2,children:f,className:d,...p}){const[y,v]=Y.useState({x:1,y:0,width:0,height:0}),x=pe(["react-flow__edge-textwrapper",d]),b=Y.useRef(null);return Y.useEffect(()=>{if(b.current){const w=b.current.getBBox();v({x:w.x,y:w.y,width:w.width,height:w.height})}},[e]),e?_.jsxs("g",{transform:`translate(${s-y.width/2} ${t-y.height/2})`,className:x,visibility:y.width?"visible":"hidden",...p,children:[o&&_.jsx("rect",{width:y.width+2*c[0],x:-c[0],y:-c[1],height:y.height+2*c[1],className:"react-flow__edge-textbg",style:a,rx:h,ry:h}),_.jsx("text",{className:"react-flow__edge-text",y:y.height/2,dy:"0.3em",ref:b,style:i,children:e}),f]}):null}hS.displayName="EdgeText";const bA=Y.memo(hS);function Eh({path:s,labelX:t,labelY:e,label:i,labelStyle:o,labelShowBg:a,labelBgStyle:c,labelBgPadding:h,labelBgBorderRadius:f,interactionWidth:d=20,...p}){return _.jsxs(_.Fragment,{children:[_.jsx("path",{...p,d:s,fill:"none",className:pe(["react-flow__edge-path",p.className])}),d?_.jsx("path",{d:s,fill:"none",strokeOpacity:0,strokeWidth:d,className:"react-flow__edge-interaction"}):null,i&&Bn(t)&&Bn(e)?_.jsx(bA,{x:t,y:e,label:i,labelStyle:o,labelShowBg:a,labelBgStyle:c,labelBgPadding:h,labelBgBorderRadius:f}):null]})}function Wx({pos:s,x1:t,y1:e,x2:i,y2:o}){return s===bt.Left||s===bt.Right?[.5*(t+i),e]:[t,.5*(e+o)]}function fS({sourceX:s,sourceY:t,sourcePosition:e=bt.Bottom,targetX:i,targetY:o,targetPosition:a=bt.Top}){const[c,h]=Wx({pos:e,x1:s,y1:t,x2:i,y2:o}),[f,d]=Wx({pos:a,x1:i,y1:o,x2:s,y2:t}),[p,y,v,x]=Rb({sourceX:s,sourceY:t,targetX:i,targetY:o,sourceControlX:c,sourceControlY:h,targetControlX:f,targetControlY:d});return[`M${s},${t} C${c},${h} ${f},${d} ${i},${o}`,p,y,v,x]}function dS(s){return Y.memo(({id:t,sourceX:e,sourceY:i,targetX:o,targetY:a,sourcePosition:c,targetPosition:h,label:f,labelStyle:d,labelShowBg:p,labelBgStyle:y,labelBgPadding:v,labelBgBorderRadius:x,style:b,markerEnd:w,markerStart:T,interactionWidth:E})=>{const[M,C,D]=fS({sourceX:e,sourceY:i,sourcePosition:c,targetX:o,targetY:a,targetPosition:h}),j=s.isInternal?void 0:t;return _.jsx(Eh,{id:j,path:M,labelX:C,labelY:D,label:f,labelStyle:d,labelShowBg:p,labelBgStyle:y,labelBgPadding:v,labelBgBorderRadius:x,style:b,markerEnd:w,markerStart:T,interactionWidth:E})})}const SA=dS({isInternal:!1}),gS=dS({isInternal:!0});SA.displayName="SimpleBezierEdge";gS.displayName="SimpleBezierEdgeInternal";function pS(s){return Y.memo(({id:t,sourceX:e,sourceY:i,targetX:o,targetY:a,label:c,labelStyle:h,labelShowBg:f,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:y,style:v,sourcePosition:x=bt.Bottom,targetPosition:b=bt.Top,markerEnd:w,markerStart:T,pathOptions:E,interactionWidth:M})=>{const[C,D,j]=Gg({sourceX:e,sourceY:i,sourcePosition:x,targetX:o,targetY:a,targetPosition:b,borderRadius:E?.borderRadius,offset:E?.offset,stepPosition:E?.stepPosition}),R=s.isInternal?void 0:t;return _.jsx(Eh,{id:R,path:C,labelX:D,labelY:j,label:c,labelStyle:h,labelShowBg:f,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:y,style:v,markerEnd:w,markerStart:T,interactionWidth:M})})}const mS=pS({isInternal:!1}),yS=pS({isInternal:!0});mS.displayName="SmoothStepEdge";yS.displayName="SmoothStepEdgeInternal";function vS(s){return Y.memo(({id:t,...e})=>{const i=s.isInternal?void 0:t;return _.jsx(mS,{...e,id:i,pathOptions:Y.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])})})}const _A=vS({isInternal:!1}),xS=vS({isInternal:!0});_A.displayName="StepEdge";xS.displayName="StepEdgeInternal";function bS(s){return Y.memo(({id:t,sourceX:e,sourceY:i,targetX:o,targetY:a,label:c,labelStyle:h,labelShowBg:f,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:y,style:v,markerEnd:x,markerStart:b,interactionWidth:w})=>{const[T,E,M]=Bb({sourceX:e,sourceY:i,targetX:o,targetY:a}),C=s.isInternal?void 0:t;return _.jsx(Eh,{id:C,path:T,labelX:E,labelY:M,label:c,labelStyle:h,labelShowBg:f,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:y,style:v,markerEnd:x,markerStart:b,interactionWidth:w})})}const wA=bS({isInternal:!1}),SS=bS({isInternal:!0});wA.displayName="StraightEdge";SS.displayName="StraightEdgeInternal";function _S(s){return Y.memo(({id:t,sourceX:e,sourceY:i,targetX:o,targetY:a,sourcePosition:c=bt.Bottom,targetPosition:h=bt.Top,label:f,labelStyle:d,labelShowBg:p,labelBgStyle:y,labelBgPadding:v,labelBgBorderRadius:x,style:b,markerEnd:w,markerStart:T,pathOptions:E,interactionWidth:M})=>{const[C,D,j]=zb({sourceX:e,sourceY:i,sourcePosition:c,targetX:o,targetY:a,targetPosition:h,curvature:E?.curvature}),R=s.isInternal?void 0:t;return _.jsx(Eh,{id:R,path:C,labelX:D,labelY:j,label:f,labelStyle:d,labelShowBg:p,labelBgStyle:y,labelBgPadding:v,labelBgBorderRadius:x,style:b,markerEnd:w,markerStart:T,interactionWidth:M})})}const CA=_S({isInternal:!1}),wS=_S({isInternal:!0});CA.displayName="BezierEdge";wS.displayName="BezierEdgeInternal";const Zx={default:wS,straight:SS,step:xS,smoothstep:yS,simplebezier:gS},Kx={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},TA=(s,t,e)=>e===bt.Left?s-t:e===bt.Right?s+t:s,EA=(s,t,e)=>e===bt.Top?s-t:e===bt.Bottom?s+t:s,Qx="react-flow__edgeupdater";function Jx({position:s,centerX:t,centerY:e,radius:i=10,onMouseDown:o,onMouseEnter:a,onMouseOut:c,type:h}){return _.jsx("circle",{onMouseDown:o,onMouseEnter:a,onMouseOut:c,className:pe([Qx,`${Qx}-${h}`]),cx:TA(t,i,s),cy:EA(e,i,s),r:i,stroke:"transparent",fill:"transparent"})}function MA({isReconnectable:s,reconnectRadius:t,edge:e,sourceX:i,sourceY:o,targetX:a,targetY:c,sourcePosition:h,targetPosition:f,onReconnect:d,onReconnectStart:p,onReconnectEnd:y,setReconnecting:v,setUpdateHover:x}){const b=ne(),w=(D,j)=>{if(D.button!==0)return;const{autoPanOnConnect:R,domNode:z,isValidConnection:U,connectionMode:G,connectionRadius:ut,lib:W,onConnectStart:Z,onConnectEnd:rt,cancelConnection:N,nodeLookup:I,rfId:A,panBy:L,updateConnection:H}=b.getState(),q=j.type==="target",st=(et,nt)=>{v(!1),y?.(et,e,j.type,nt)},k=et=>d?.(e,et),P=(et,nt)=>{v(!0),p?.(D,e,j.type),Z?.(et,nt)};Wg.onPointerDown(D.nativeEvent,{autoPanOnConnect:R,connectionMode:G,connectionRadius:ut,domNode:z,handleId:j.id,nodeId:j.nodeId,nodeLookup:I,isTarget:q,edgeUpdaterType:j.type,lib:W,flowId:A,cancelConnection:N,panBy:L,isValidConnection:U,onConnect:k,onConnectStart:P,onConnectEnd:rt,onReconnectEnd:st,updateConnection:H,getTransform:()=>b.getState().transform,getFromHandle:()=>b.getState().connection.fromHandle,dragThreshold:b.getState().connectionDragThreshold,handleDomNode:D.currentTarget})},T=D=>w(D,{nodeId:e.target,id:e.targetHandle??null,type:"target"}),E=D=>w(D,{nodeId:e.source,id:e.sourceHandle??null,type:"source"}),M=()=>x(!0),C=()=>x(!1);return _.jsxs(_.Fragment,{children:[(s===!0||s==="source")&&_.jsx(Jx,{position:h,centerX:i,centerY:o,radius:t,onMouseDown:T,onMouseEnter:M,onMouseOut:C,type:"source"}),(s===!0||s==="target")&&_.jsx(Jx,{position:f,centerX:a,centerY:c,radius:t,onMouseDown:E,onMouseEnter:M,onMouseOut:C,type:"target"})]})}function DA({id:s,edgesFocusable:t,edgesReconnectable:e,elementsSelectable:i,onClick:o,onDoubleClick:a,onContextMenu:c,onMouseEnter:h,onMouseMove:f,onMouseLeave:d,reconnectRadius:p,onReconnect:y,onReconnectStart:v,onReconnectEnd:x,rfId:b,edgeTypes:w,noPanClassName:T,onError:E,disableKeyboardA11y:M}){let C=Lt(pt=>pt.edgeLookup.get(s));const D=Lt(pt=>pt.defaultEdgeOptions);C=D?{...D,...C}:C;let j=C.type||"default",R=w?.[j]||Zx[j];R===void 0&&(E?.("011",ei.error011(j)),j="default",R=w?.default||Zx.default);const z=!!(C.focusable||t&&typeof C.focusable>"u"),U=typeof y<"u"&&(C.reconnectable||e&&typeof C.reconnectable>"u"),G=!!(C.selectable||i&&typeof C.selectable>"u"),ut=Y.useRef(null),[W,Z]=Y.useState(!1),[rt,N]=Y.useState(!1),I=ne(),{zIndex:A,sourceX:L,sourceY:H,targetX:q,targetY:st,sourcePosition:k,targetPosition:P}=Lt(Y.useCallback(pt=>{const _t=pt.nodeLookup.get(C.source),Ot=pt.nodeLookup.get(C.target);if(!_t||!Ot)return{zIndex:C.zIndex,...Kx};const It=xO({id:s,sourceNode:_t,targetNode:Ot,sourceHandle:C.sourceHandle||null,targetHandle:C.targetHandle||null,connectionMode:pt.connectionMode,onError:E});return{zIndex:hO({selected:C.selected,zIndex:C.zIndex,sourceNode:_t,targetNode:Ot,elevateOnSelect:pt.elevateEdgesOnSelect,zIndexMode:pt.zIndexMode}),...It||Kx}},[C.source,C.target,C.sourceHandle,C.targetHandle,C.selected,C.zIndex]),ee),et=Y.useMemo(()=>C.markerStart?`url('#${$g(C.markerStart,b)}')`:void 0,[C.markerStart,b]),nt=Y.useMemo(()=>C.markerEnd?`url('#${$g(C.markerEnd,b)}')`:void 0,[C.markerEnd,b]);if(C.hidden||L===null||H===null||q===null||st===null)return null;const ht=pt=>{const{addSelectedEdges:_t,unselectNodesAndEdges:Ot,multiSelectionActive:It}=I.getState();G&&(I.setState({nodesSelectionActive:!1}),C.selected&&It?(Ot({nodes:[],edges:[C]}),ut.current?.blur()):_t([s])),o&&o(pt,C)},dt=a?pt=>{a(pt,{...C})}:void 0,ft=c?pt=>{c(pt,{...C})}:void 0,X=h?pt=>{h(pt,{...C})}:void 0,ot=f?pt=>{f(pt,{...C})}:void 0,gt=d?pt=>{d(pt,{...C})}:void 0,xt=pt=>{if(!M&&bb.includes(pt.key)&&G){const{unselectNodesAndEdges:_t,addSelectedEdges:Ot}=I.getState();pt.key==="Escape"?(ut.current?.blur(),_t({edges:[C]})):Ot([s])}};return _.jsx("svg",{style:{zIndex:A},children:_.jsxs("g",{className:pe(["react-flow__edge",`react-flow__edge-${j}`,C.className,T,{selected:C.selected,animated:C.animated,inactive:!G&&!o,updating:W,selectable:G}]),onClick:ht,onDoubleClick:dt,onContextMenu:ft,onMouseEnter:X,onMouseMove:ot,onMouseLeave:gt,onKeyDown:z?xt:void 0,tabIndex:z?0:void 0,role:C.ariaRole??(z?"group":"img"),"aria-roledescription":"edge","data-id":s,"data-testid":`rf__edge-${s}`,"aria-label":C.ariaLabel===null?void 0:C.ariaLabel||`Edge from ${C.source} to ${C.target}`,"aria-describedby":z?`${Qb}-${b}`:void 0,ref:ut,...C.domAttributes,children:[!rt&&_.jsx(R,{id:s,source:C.source,target:C.target,type:C.type,selected:C.selected,animated:C.animated,selectable:G,deletable:C.deletable??!0,label:C.label,labelStyle:C.labelStyle,labelShowBg:C.labelShowBg,labelBgStyle:C.labelBgStyle,labelBgPadding:C.labelBgPadding,labelBgBorderRadius:C.labelBgBorderRadius,sourceX:L,sourceY:H,targetX:q,targetY:st,sourcePosition:k,targetPosition:P,data:C.data,style:C.style,sourceHandleId:C.sourceHandle,targetHandleId:C.targetHandle,markerStart:et,markerEnd:nt,pathOptions:"pathOptions"in C?C.pathOptions:void 0,interactionWidth:C.interactionWidth}),U&&_.jsx(MA,{edge:C,isReconnectable:U,reconnectRadius:p,onReconnect:y,onReconnectStart:v,onReconnectEnd:x,sourceX:L,sourceY:H,targetX:q,targetY:st,sourcePosition:k,targetPosition:P,setUpdateHover:Z,setReconnecting:N})]})})}var OA=Y.memo(DA);const AA=s=>({edgesFocusable:s.edgesFocusable,edgesReconnectable:s.edgesReconnectable,elementsSelectable:s.elementsSelectable,connectionMode:s.connectionMode,onError:s.onError});function CS({defaultMarkerColor:s,onlyRenderVisibleElements:t,rfId:e,edgeTypes:i,noPanClassName:o,onReconnect:a,onEdgeContextMenu:c,onEdgeMouseEnter:h,onEdgeMouseMove:f,onEdgeMouseLeave:d,onEdgeClick:p,reconnectRadius:y,onEdgeDoubleClick:v,onReconnectStart:x,onReconnectEnd:b,disableKeyboardA11y:w}){const{edgesFocusable:T,edgesReconnectable:E,elementsSelectable:M,onError:C}=Lt(AA,ee),D=gA(t);return _.jsxs("div",{className:"react-flow__edges",children:[_.jsx(xA,{defaultColor:s,rfId:e}),D.map(j=>_.jsx(OA,{id:j,edgesFocusable:T,edgesReconnectable:E,elementsSelectable:M,noPanClassName:o,onReconnect:a,onContextMenu:c,onMouseEnter:h,onMouseMove:f,onMouseLeave:d,onClick:p,reconnectRadius:y,onDoubleClick:v,onReconnectStart:x,onReconnectEnd:b,rfId:e,onError:C,edgeTypes:i,disableKeyboardA11y:w},j))]})}CS.displayName="EdgeRenderer";const kA=Y.memo(CS),jA=s=>`translate(${s.transform[0]}px,${s.transform[1]}px) scale(${s.transform[2]})`;function NA({children:s}){const t=Lt(jA);return _.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:s})}function RA(s){const t=Ch(),e=Y.useRef(!1);Y.useEffect(()=>{!e.current&&t.viewportInitialized&&s&&(setTimeout(()=>s(t),1),e.current=!0)},[s,t.viewportInitialized])}const zA=s=>s.panZoom?.syncViewport;function LA(s){const t=Lt(zA),e=ne();return Y.useEffect(()=>{s&&(t?.(s),e.setState({transform:[s.x,s.y,s.zoom]}))},[s,t]),null}function BA(s){return s.connection.inProgress?{...s.connection,to:Sl(s.connection.to,s.transform)}:{...s.connection}}function HA(s){return BA}function UA(s){const t=HA();return Lt(t,ee)}const PA=s=>({nodesConnectable:s.nodesConnectable,isValid:s.connection.isValid,inProgress:s.connection.inProgress,width:s.width,height:s.height});function YA({containerStyle:s,style:t,type:e,component:i}){const{nodesConnectable:o,width:a,height:c,isValid:h,inProgress:f}=Lt(PA,ee);return!(a&&o&&f)?null:_.jsx("svg",{style:s,width:a,height:c,className:"react-flow__connectionline react-flow__container",children:_.jsx("g",{className:pe(["react-flow__connection",wb(h)]),children:_.jsx(TS,{style:t,type:e,CustomComponent:i,isValid:h})})})}const TS=({style:s,type:t=ws.Bezier,CustomComponent:e,isValid:i})=>{const{inProgress:o,from:a,fromNode:c,fromHandle:h,fromPosition:f,to:d,toNode:p,toHandle:y,toPosition:v,pointer:x}=UA();if(!o)return;if(e)return _.jsx(e,{connectionLineType:t,connectionLineStyle:s,fromNode:c,fromHandle:h,fromX:a.x,fromY:a.y,toX:d.x,toY:d.y,fromPosition:f,toPosition:v,connectionStatus:wb(i),toNode:p,toHandle:y,pointer:x});let b="";const w={sourceX:a.x,sourceY:a.y,sourcePosition:f,targetX:d.x,targetY:d.y,targetPosition:v};switch(t){case ws.Bezier:[b]=zb(w);break;case ws.SimpleBezier:[b]=fS(w);break;case ws.Step:[b]=Gg({...w,borderRadius:0});break;case ws.SmoothStep:[b]=Gg(w);break;default:[b]=Bb(w)}return _.jsx("path",{d:b,fill:"none",className:"react-flow__connection-path",style:s})};TS.displayName="ConnectionLine";const VA={};function t1(s=VA){Y.useRef(s),ne(),Y.useEffect(()=>{},[s])}function XA(){ne(),Y.useRef(!1),Y.useEffect(()=>{},[])}function ES({nodeTypes:s,edgeTypes:t,onInit:e,onNodeClick:i,onEdgeClick:o,onNodeDoubleClick:a,onEdgeDoubleClick:c,onNodeMouseEnter:h,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:p,onSelectionContextMenu:y,onSelectionStart:v,onSelectionEnd:x,connectionLineType:b,connectionLineStyle:w,connectionLineComponent:T,connectionLineContainerStyle:E,selectionKeyCode:M,selectionOnDrag:C,selectionMode:D,multiSelectionKeyCode:j,panActivationKeyCode:R,zoomActivationKeyCode:z,deleteKeyCode:U,onlyRenderVisibleElements:G,elementsSelectable:ut,defaultViewport:W,translateExtent:Z,minZoom:rt,maxZoom:N,preventScrolling:I,defaultMarkerColor:A,zoomOnScroll:L,zoomOnPinch:H,panOnScroll:q,panOnScrollSpeed:st,panOnScrollMode:k,zoomOnDoubleClick:P,panOnDrag:et,onPaneClick:nt,onPaneMouseEnter:ht,onPaneMouseMove:dt,onPaneMouseLeave:ft,onPaneScroll:X,onPaneContextMenu:ot,paneClickDistance:gt,nodeClickDistance:xt,onEdgeContextMenu:pt,onEdgeMouseEnter:_t,onEdgeMouseMove:Ot,onEdgeMouseLeave:It,reconnectRadius:Vt,onReconnect:xe,onReconnectStart:Tn,onReconnectEnd:Je,noDragClassName:En,noWheelClassName:si,noPanClassName:Os,disableKeyboardA11y:As,nodeExtent:_e,rfId:Sr,viewport:ri,onViewportChange:Fi}){return t1(s),t1(t),XA(),RA(e),LA(ri),_.jsx(sA,{onPaneClick:nt,onPaneMouseEnter:ht,onPaneMouseMove:dt,onPaneMouseLeave:ft,onPaneContextMenu:ot,onPaneScroll:X,paneClickDistance:gt,deleteKeyCode:U,selectionKeyCode:M,selectionOnDrag:C,selectionMode:D,onSelectionStart:v,onSelectionEnd:x,multiSelectionKeyCode:j,panActivationKeyCode:R,zoomActivationKeyCode:z,elementsSelectable:ut,zoomOnScroll:L,zoomOnPinch:H,zoomOnDoubleClick:P,panOnScroll:q,panOnScrollSpeed:st,panOnScrollMode:k,panOnDrag:et,defaultViewport:W,translateExtent:Z,minZoom:rt,maxZoom:N,onSelectionContextMenu:y,preventScrolling:I,noDragClassName:En,noWheelClassName:si,noPanClassName:Os,disableKeyboardA11y:As,onViewportChange:Fi,isControlledViewport:!!ri,children:_.jsxs(NA,{children:[_.jsx(kA,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:c,onReconnect:xe,onReconnectStart:Tn,onReconnectEnd:Je,onlyRenderVisibleElements:G,onEdgeContextMenu:pt,onEdgeMouseEnter:_t,onEdgeMouseMove:Ot,onEdgeMouseLeave:It,reconnectRadius:Vt,defaultMarkerColor:A,noPanClassName:Os,disableKeyboardA11y:As,rfId:Sr}),_.jsx(YA,{style:w,type:b,component:T,containerStyle:E}),_.jsx("div",{className:"react-flow__edgelabel-renderer"}),_.jsx(dA,{nodeTypes:s,onNodeClick:i,onNodeDoubleClick:a,onNodeMouseEnter:h,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:p,nodeClickDistance:xt,onlyRenderVisibleElements:G,noPanClassName:Os,noDragClassName:En,disableKeyboardA11y:As,nodeExtent:_e,rfId:Sr}),_.jsx("div",{className:"react-flow__viewport-portal"})]})})}ES.displayName="GraphView";const FA=Y.memo(ES),e1=({nodes:s,edges:t,defaultNodes:e,defaultEdges:i,width:o,height:a,fitView:c,fitViewOptions:h,minZoom:f=.5,maxZoom:d=2,nodeOrigin:p,nodeExtent:y,zIndexMode:v="basic"}={})=>{const x=new Map,b=new Map,w=new Map,T=new Map,E=i??t??[],M=e??s??[],C=p??[0,0],D=y??sl;Pb(w,T,E);const j=qg(M,x,b,{nodeOrigin:C,nodeExtent:D,zIndexMode:v});let R=[0,0,1];if(c&&o&&a){const z=xl(x,{filter:W=>!!((W.width||W.initialWidth)&&(W.height||W.initialHeight))}),{x:U,y:G,zoom:ut}=bp(z,o,a,f,d,h?.padding??.1);R=[U,G,ut]}return{rfId:"1",width:o??0,height:a??0,transform:R,nodes:M,nodesInitialized:j,nodeLookup:x,parentLookup:b,edges:E,edgeLookup:T,connectionLookup:w,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:e!==void 0,hasDefaultEdges:i!==void 0,panZoom:null,minZoom:f,maxZoom:d,translateExtent:sl,nodeExtent:D,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:To.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:C,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:c??!1,fitViewOptions:h,fitViewResolver:null,connection:{..._b},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:rO,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Sb,zIndexMode:v,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},IA=({nodes:s,edges:t,defaultNodes:e,defaultEdges:i,width:o,height:a,fitView:c,fitViewOptions:h,minZoom:f,maxZoom:d,nodeOrigin:p,nodeExtent:y,zIndexMode:v})=>c3((x,b)=>{async function w(){const{nodeLookup:T,panZoom:E,fitViewOptions:M,fitViewResolver:C,width:D,height:j,minZoom:R,maxZoom:z}=b();E&&(await iO({nodes:T,width:D,height:j,panZoom:E,minZoom:R,maxZoom:z},M),C?.resolve(!0),x({fitViewResolver:null}))}return{...e1({nodes:s,edges:t,width:o,height:a,fitView:c,fitViewOptions:h,minZoom:f,maxZoom:d,nodeOrigin:p,nodeExtent:y,defaultNodes:e,defaultEdges:i,zIndexMode:v}),setNodes:T=>{const{nodeLookup:E,parentLookup:M,nodeOrigin:C,elevateNodesOnSelect:D,fitViewQueued:j,zIndexMode:R}=b(),z=qg(T,E,M,{nodeOrigin:C,nodeExtent:y,elevateNodesOnSelect:D,checkEquality:!0,zIndexMode:R});j&&z?(w(),x({nodes:T,nodesInitialized:z,fitViewQueued:!1,fitViewOptions:void 0})):x({nodes:T,nodesInitialized:z})},setEdges:T=>{const{connectionLookup:E,edgeLookup:M}=b();Pb(E,M,T),x({edges:T})},setDefaultNodesAndEdges:(T,E)=>{if(T){const{setNodes:M}=b();M(T),x({hasDefaultNodes:!0})}if(E){const{setEdges:M}=b();M(E),x({hasDefaultEdges:!0})}},updateNodeInternals:T=>{const{triggerNodeChanges:E,nodeLookup:M,parentLookup:C,domNode:D,nodeOrigin:j,nodeExtent:R,debug:z,fitViewQueued:U,zIndexMode:G}=b(),{changes:ut,updatedInternals:W}=MO(T,M,C,D,j,R,G);W&&(wO(M,C,{nodeOrigin:j,nodeExtent:R,zIndexMode:G}),U?(w(),x({fitViewQueued:!1,fitViewOptions:void 0})):x({}),ut?.length>0&&(z&&console.log("React Flow: trigger node changes",ut),E?.(ut)))},updateNodePositions:(T,E=!1)=>{const M=[];let C=[];const{nodeLookup:D,triggerNodeChanges:j,connection:R,updateConnection:z,onNodesChangeMiddlewareMap:U}=b();for(const[G,ut]of T){const W=D.get(G),Z=!!(W?.expandParent&&W?.parentId&&ut?.position),rt={id:G,type:"position",position:Z?{x:Math.max(0,ut.position.x),y:Math.max(0,ut.position.y)}:ut.position,dragging:E};if(W&&R.inProgress&&R.fromNode.id===W.id){const N=yr(W,R.fromHandle,bt.Left,!0);z({...R,from:N})}Z&&W.parentId&&M.push({id:G,parentId:W.parentId,rect:{...ut.internals.positionAbsolute,width:ut.measured.width??0,height:ut.measured.height??0}}),C.push(rt)}if(M.length>0){const{parentLookup:G,nodeOrigin:ut}=b(),W=Ep(M,D,G,ut);C.push(...W)}for(const G of U.values())C=G(C);j(C)},triggerNodeChanges:T=>{const{onNodesChange:E,setNodes:M,nodes:C,hasDefaultNodes:D,debug:j}=b();if(T?.length){if(D){const R=eS(T,C);M(R)}j&&console.log("React Flow: trigger node changes",T),E?.(T)}},triggerEdgeChanges:T=>{const{onEdgesChange:E,setEdges:M,edges:C,hasDefaultEdges:D,debug:j}=b();if(T?.length){if(D){const R=nS(T,C);M(R)}j&&console.log("React Flow: trigger edge changes",T),E?.(T)}},addSelectedNodes:T=>{const{multiSelectionActive:E,edgeLookup:M,nodeLookup:C,triggerNodeChanges:D,triggerEdgeChanges:j}=b();if(E){const R=T.map(z=>er(z,!0));D(R);return}D(go(C,new Set([...T]),!0)),j(go(M))},addSelectedEdges:T=>{const{multiSelectionActive:E,edgeLookup:M,nodeLookup:C,triggerNodeChanges:D,triggerEdgeChanges:j}=b();if(E){const R=T.map(z=>er(z,!0));j(R);return}j(go(M,new Set([...T]))),D(go(C,new Set,!0))},unselectNodesAndEdges:({nodes:T,edges:E}={})=>{const{edges:M,nodes:C,nodeLookup:D,triggerNodeChanges:j,triggerEdgeChanges:R}=b(),z=T||C,U=E||M,G=z.map(W=>{const Z=D.get(W.id);return Z&&(Z.selected=!1),er(W.id,!1)}),ut=U.map(W=>er(W.id,!1));j(G),R(ut)},setMinZoom:T=>{const{panZoom:E,maxZoom:M}=b();E?.setScaleExtent([T,M]),x({minZoom:T})},setMaxZoom:T=>{const{panZoom:E,minZoom:M}=b();E?.setScaleExtent([M,T]),x({maxZoom:T})},setTranslateExtent:T=>{b().panZoom?.setTranslateExtent(T),x({translateExtent:T})},resetSelectedElements:()=>{const{edges:T,nodes:E,triggerNodeChanges:M,triggerEdgeChanges:C,elementsSelectable:D}=b();if(!D)return;const j=E.reduce((z,U)=>U.selected?[...z,er(U.id,!1)]:z,[]),R=T.reduce((z,U)=>U.selected?[...z,er(U.id,!1)]:z,[]);M(j),C(R)},setNodeExtent:T=>{const{nodes:E,nodeLookup:M,parentLookup:C,nodeOrigin:D,elevateNodesOnSelect:j,nodeExtent:R,zIndexMode:z}=b();T[0][0]===R[0][0]&&T[0][1]===R[0][1]&&T[1][0]===R[1][0]&&T[1][1]===R[1][1]||(qg(E,M,C,{nodeOrigin:D,nodeExtent:T,elevateNodesOnSelect:j,checkEquality:!1,zIndexMode:z}),x({nodeExtent:T}))},panBy:T=>{const{transform:E,width:M,height:C,panZoom:D,translateExtent:j}=b();return DO({delta:T,panZoom:D,transform:E,translateExtent:j,width:M,height:C})},setCenter:async(T,E,M)=>{const{width:C,height:D,maxZoom:j,panZoom:R}=b();if(!R)return Promise.resolve(!1);const z=typeof M?.zoom<"u"?M.zoom:j;return await R.setViewport({x:C/2-T*z,y:D/2-E*z,zoom:z},{duration:M?.duration,ease:M?.ease,interpolate:M?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{x({connection:{..._b}})},updateConnection:T=>{x({connection:T})},reset:()=>x({...e1()})}},Object.is);function MS({initialNodes:s,initialEdges:t,defaultNodes:e,defaultEdges:i,initialWidth:o,initialHeight:a,initialMinZoom:c,initialMaxZoom:h,initialFitViewOptions:f,fitView:d,nodeOrigin:p,nodeExtent:y,zIndexMode:v,children:x}){const[b]=Y.useState(()=>IA({nodes:s,edges:t,defaultNodes:e,defaultEdges:i,width:o,height:a,fitView:d,minZoom:c,maxZoom:h,fitViewOptions:f,nodeOrigin:p,nodeExtent:y,zIndexMode:v}));return _.jsx(u3,{value:b,children:_.jsx(N3,{children:x})})}function GA({children:s,nodes:t,edges:e,defaultNodes:i,defaultEdges:o,width:a,height:c,fitView:h,fitViewOptions:f,minZoom:d,maxZoom:p,nodeOrigin:y,nodeExtent:v,zIndexMode:x}){return Y.useContext(_h)?_.jsx(_.Fragment,{children:s}):_.jsx(MS,{initialNodes:t,initialEdges:e,defaultNodes:i,defaultEdges:o,initialWidth:a,initialHeight:c,fitView:h,initialFitViewOptions:f,initialMinZoom:d,initialMaxZoom:p,nodeOrigin:y,nodeExtent:v,zIndexMode:x,children:s})}const $A={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function qA({nodes:s,edges:t,defaultNodes:e,defaultEdges:i,className:o,nodeTypes:a,edgeTypes:c,onNodeClick:h,onEdgeClick:f,onInit:d,onMove:p,onMoveStart:y,onMoveEnd:v,onConnect:x,onConnectStart:b,onConnectEnd:w,onClickConnectStart:T,onClickConnectEnd:E,onNodeMouseEnter:M,onNodeMouseMove:C,onNodeMouseLeave:D,onNodeContextMenu:j,onNodeDoubleClick:R,onNodeDragStart:z,onNodeDrag:U,onNodeDragStop:G,onNodesDelete:ut,onEdgesDelete:W,onDelete:Z,onSelectionChange:rt,onSelectionDragStart:N,onSelectionDrag:I,onSelectionDragStop:A,onSelectionContextMenu:L,onSelectionStart:H,onSelectionEnd:q,onBeforeDelete:st,connectionMode:k,connectionLineType:P=ws.Bezier,connectionLineStyle:et,connectionLineComponent:nt,connectionLineContainerStyle:ht,deleteKeyCode:dt="Backspace",selectionKeyCode:ft="Shift",selectionOnDrag:X=!1,selectionMode:ot=rl.Full,panActivationKeyCode:gt="Space",multiSelectionKeyCode:xt=al()?"Meta":"Control",zoomActivationKeyCode:pt=al()?"Meta":"Control",snapToGrid:_t,snapGrid:Ot,onlyRenderVisibleElements:It=!1,selectNodesOnDrag:Vt,nodesDraggable:xe,autoPanOnNodeFocus:Tn,nodesConnectable:Je,nodesFocusable:En,nodeOrigin:si=Jb,edgesFocusable:Os,edgesReconnectable:As,elementsSelectable:_e=!0,defaultViewport:Sr=w3,minZoom:ri=.5,maxZoom:Fi=2,translateExtent:ks=sl,preventScrolling:Hh=!0,nodeExtent:_r,defaultMarkerColor:Uh="#b1b1b7",zoomOnScroll:Ph=!0,zoomOnPinch:js=!0,panOnScroll:Ne=!1,panOnScrollSpeed:Vn=.5,panOnScrollMode:Re=ur.Free,zoomOnDoubleClick:Yh=!0,panOnDrag:Vh=!0,onPaneClick:Xh,onPaneMouseEnter:wr,onPaneMouseMove:Cr,onPaneMouseLeave:Tr,onPaneScroll:oi,onPaneContextMenu:Er,paneClickDistance:Ns=1,nodeClickDistance:Fh=0,children:Tl,onReconnect:Xo,onReconnectStart:Rs,onReconnectEnd:Ih,onEdgeContextMenu:El,onEdgeDoubleClick:Ml,onEdgeMouseEnter:Dl,onEdgeMouseMove:Fo,onEdgeMouseLeave:Io,reconnectRadius:Ol=10,onNodesChange:Al,onEdgesChange:Xn,noDragClassName:me="nodrag",noWheelClassName:Oe="nowheel",noPanClassName:ai="nopan",fitView:Mr,fitViewOptions:kl,connectOnClick:Gh,attributionPosition:jl,proOptions:zs,defaultEdgeOptions:Go,elevateNodesOnSelect:Ii=!0,elevateEdgesOnSelect:Gi=!1,disableKeyboardA11y:$i=!1,autoPanOnConnect:qi,autoPanOnNodeDrag:ue,autoPanSpeed:Nl,connectionRadius:Rl,isValidConnection:li,onError:Wi,style:$h,id:$o,nodeDragThreshold:zl,connectionDragThreshold:qh,viewport:Dr,onViewportChange:Or,width:Mn,height:Pe,colorMode:Ll="light",debug:Wh,onScroll:Ar,ariaLabelConfig:Bl,zIndexMode:Ls="basic",...Zh},Ye){const Bs=$o||"1",Hl=M3(Ll),qo=Y.useCallback(ci=>{ci.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ar?.(ci)},[Ar]);return _.jsx("div",{"data-testid":"rf__wrapper",...Zh,onScroll:qo,style:{...$h,...$A},ref:Ye,className:pe(["react-flow",o,Hl]),id:$o,role:"application",children:_.jsxs(GA,{nodes:s,edges:t,width:Mn,height:Pe,fitView:Mr,fitViewOptions:kl,minZoom:ri,maxZoom:Fi,nodeOrigin:si,nodeExtent:_r,zIndexMode:Ls,children:[_.jsx(FA,{onInit:d,onNodeClick:h,onEdgeClick:f,onNodeMouseEnter:M,onNodeMouseMove:C,onNodeMouseLeave:D,onNodeContextMenu:j,onNodeDoubleClick:R,nodeTypes:a,edgeTypes:c,connectionLineType:P,connectionLineStyle:et,connectionLineComponent:nt,connectionLineContainerStyle:ht,selectionKeyCode:ft,selectionOnDrag:X,selectionMode:ot,deleteKeyCode:dt,multiSelectionKeyCode:xt,panActivationKeyCode:gt,zoomActivationKeyCode:pt,onlyRenderVisibleElements:It,defaultViewport:Sr,translateExtent:ks,minZoom:ri,maxZoom:Fi,preventScrolling:Hh,zoomOnScroll:Ph,zoomOnPinch:js,zoomOnDoubleClick:Yh,panOnScroll:Ne,panOnScrollSpeed:Vn,panOnScrollMode:Re,panOnDrag:Vh,onPaneClick:Xh,onPaneMouseEnter:wr,onPaneMouseMove:Cr,onPaneMouseLeave:Tr,onPaneScroll:oi,onPaneContextMenu:Er,paneClickDistance:Ns,nodeClickDistance:Fh,onSelectionContextMenu:L,onSelectionStart:H,onSelectionEnd:q,onReconnect:Xo,onReconnectStart:Rs,onReconnectEnd:Ih,onEdgeContextMenu:El,onEdgeDoubleClick:Ml,onEdgeMouseEnter:Dl,onEdgeMouseMove:Fo,onEdgeMouseLeave:Io,reconnectRadius:Ol,defaultMarkerColor:Uh,noDragClassName:me,noWheelClassName:Oe,noPanClassName:ai,rfId:Bs,disableKeyboardA11y:$i,nodeExtent:_r,viewport:Dr,onViewportChange:Or}),_.jsx(E3,{nodes:s,edges:t,defaultNodes:e,defaultEdges:i,onConnect:x,onConnectStart:b,onConnectEnd:w,onClickConnectStart:T,onClickConnectEnd:E,nodesDraggable:xe,autoPanOnNodeFocus:Tn,nodesConnectable:Je,nodesFocusable:En,edgesFocusable:Os,edgesReconnectable:As,elementsSelectable:_e,elevateNodesOnSelect:Ii,elevateEdgesOnSelect:Gi,minZoom:ri,maxZoom:Fi,nodeExtent:_r,onNodesChange:Al,onEdgesChange:Xn,snapToGrid:_t,snapGrid:Ot,connectionMode:k,translateExtent:ks,connectOnClick:Gh,defaultEdgeOptions:Go,fitView:Mr,fitViewOptions:kl,onNodesDelete:ut,onEdgesDelete:W,onDelete:Z,onNodeDragStart:z,onNodeDrag:U,onNodeDragStop:G,onSelectionDrag:I,onSelectionDragStart:N,onSelectionDragStop:A,onMove:p,onMoveStart:y,onMoveEnd:v,noPanClassName:ai,nodeOrigin:si,rfId:Bs,autoPanOnConnect:qi,autoPanOnNodeDrag:ue,autoPanSpeed:Nl,onError:Wi,connectionRadius:Rl,isValidConnection:li,selectNodesOnDrag:Vt,nodeDragThreshold:zl,connectionDragThreshold:qh,onBeforeDelete:st,debug:Wh,ariaLabelConfig:Bl,zIndexMode:Ls}),_.jsx(_3,{onSelectionChange:rt}),Tl,_.jsx(y3,{proOptions:zs,position:jl}),_.jsx(m3,{rfId:Bs,disableKeyboardA11y:$i})]})})}var WA=iS(qA);function ZA({dimensions:s,lineWidth:t,variant:e,className:i}){return _.jsx("path",{strokeWidth:t,d:`M${s[0]/2} 0 V${s[1]} M0 ${s[1]/2} H${s[0]}`,className:pe(["react-flow__background-pattern",e,i])})}function KA({radius:s,className:t}){return _.jsx("circle",{cx:s,cy:s,r:s,className:pe(["react-flow__background-pattern","dots",t])})}var zi;(function(s){s.Lines="lines",s.Dots="dots",s.Cross="cross"})(zi||(zi={}));const QA={[zi.Dots]:1,[zi.Lines]:1,[zi.Cross]:6},JA=s=>({transform:s.transform,patternId:`pattern-${s.rfId}`});function DS({id:s,variant:t=zi.Dots,gap:e=20,size:i,lineWidth:o=1,offset:a=0,color:c,bgColor:h,style:f,className:d,patternClassName:p}){const y=Y.useRef(null),{transform:v,patternId:x}=Lt(JA,ee),b=i||QA[t],w=t===zi.Dots,T=t===zi.Cross,E=Array.isArray(e)?e:[e,e],M=[E[0]*v[2]||1,E[1]*v[2]||1],C=b*v[2],D=Array.isArray(a)?a:[a,a],j=T?[C,C]:M,R=[D[0]*v[2]||1+j[0]/2,D[1]*v[2]||1+j[1]/2],z=`${x}${s||""}`;return _.jsxs("svg",{className:pe(["react-flow__background",d]),style:{...f,...Th,"--xy-background-color-props":h,"--xy-background-pattern-color-props":c},ref:y,"data-testid":"rf__background",children:[_.jsx("pattern",{id:z,x:v[0]%M[0],y:v[1]%M[1],width:M[0],height:M[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${R[0]},-${R[1]})`,children:w?_.jsx(KA,{radius:C/2,className:p}):_.jsx(ZA,{dimensions:j,lineWidth:o,variant:t,className:p})}),_.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${z})`})]})}DS.displayName="Background";const t4=Y.memo(DS);function e4(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:_.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function n4(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:_.jsx("path",{d:"M0 0h32v4.2H0z"})})}function i4(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:_.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function s4(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:_.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function r4(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:_.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function nu({children:s,className:t,...e}){return _.jsx("button",{type:"button",className:pe(["react-flow__controls-button",t]),...e,children:s})}const o4=s=>({isInteractive:s.nodesDraggable||s.nodesConnectable||s.elementsSelectable,minZoomReached:s.transform[2]<=s.minZoom,maxZoomReached:s.transform[2]>=s.maxZoom,ariaLabelConfig:s.ariaLabelConfig});function OS({style:s,showZoom:t=!0,showFitView:e=!0,showInteractive:i=!0,fitViewOptions:o,onZoomIn:a,onZoomOut:c,onFitView:h,onInteractiveChange:f,className:d,children:p,position:y="bottom-left",orientation:v="vertical","aria-label":x}){const b=ne(),{isInteractive:w,minZoomReached:T,maxZoomReached:E,ariaLabelConfig:M}=Lt(o4,ee),{zoomIn:C,zoomOut:D,fitView:j}=Ch(),R=()=>{C(),a?.()},z=()=>{D(),c?.()},U=()=>{j(o),h?.()},G=()=>{b.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),f?.(!w)},ut=v==="horizontal"?"horizontal":"vertical";return _.jsxs(wh,{className:pe(["react-flow__controls",ut,d]),position:y,style:s,"data-testid":"rf__controls","aria-label":x??M["controls.ariaLabel"],children:[t&&_.jsxs(_.Fragment,{children:[_.jsx(nu,{onClick:R,className:"react-flow__controls-zoomin",title:M["controls.zoomIn.ariaLabel"],"aria-label":M["controls.zoomIn.ariaLabel"],disabled:E,children:_.jsx(e4,{})}),_.jsx(nu,{onClick:z,className:"react-flow__controls-zoomout",title:M["controls.zoomOut.ariaLabel"],"aria-label":M["controls.zoomOut.ariaLabel"],disabled:T,children:_.jsx(n4,{})})]}),e&&_.jsx(nu,{className:"react-flow__controls-fitview",onClick:U,title:M["controls.fitView.ariaLabel"],"aria-label":M["controls.fitView.ariaLabel"],children:_.jsx(i4,{})}),i&&_.jsx(nu,{className:"react-flow__controls-interactive",onClick:G,title:M["controls.interactive.ariaLabel"],"aria-label":M["controls.interactive.ariaLabel"],children:w?_.jsx(r4,{}):_.jsx(s4,{})}),p]})}OS.displayName="Controls";Y.memo(OS);function a4({id:s,x:t,y:e,width:i,height:o,style:a,color:c,strokeColor:h,strokeWidth:f,className:d,borderRadius:p,shapeRendering:y,selected:v,onClick:x}){const{background:b,backgroundColor:w}=a||{},T=c||b||w;return _.jsx("rect",{className:pe(["react-flow__minimap-node",{selected:v},d]),x:t,y:e,rx:p,ry:p,width:i,height:o,style:{fill:T,stroke:h,strokeWidth:f},shapeRendering:y,onClick:x?E=>x(E,s):void 0})}const l4=Y.memo(a4),c4=s=>s.nodes.map(t=>t.id),bg=s=>s instanceof Function?s:()=>s;function u4({nodeStrokeColor:s,nodeColor:t,nodeClassName:e="",nodeBorderRadius:i=5,nodeStrokeWidth:o,nodeComponent:a=l4,onClick:c}){const h=Lt(c4,ee),f=bg(t),d=bg(s),p=bg(e),y=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return _.jsx(_.Fragment,{children:h.map(v=>_.jsx(f4,{id:v,nodeColorFunc:f,nodeStrokeColorFunc:d,nodeClassNameFunc:p,nodeBorderRadius:i,nodeStrokeWidth:o,NodeComponent:a,onClick:c,shapeRendering:y},v))})}function h4({id:s,nodeColorFunc:t,nodeStrokeColorFunc:e,nodeClassNameFunc:i,nodeBorderRadius:o,nodeStrokeWidth:a,shapeRendering:c,NodeComponent:h,onClick:f}){const{node:d,x:p,y,width:v,height:x}=Lt(b=>{const{internals:w}=b.nodeLookup.get(s),T=w.userNode,{x:E,y:M}=w.positionAbsolute,{width:C,height:D}=Yi(T);return{node:T,x:E,y:M,width:C,height:D}},ee);return!d||d.hidden||!Ob(d)?null:_.jsx(h,{x:p,y,width:v,height:x,style:d.style,selected:!!d.selected,className:i(d),color:t(d),borderRadius:o,strokeColor:e(d),strokeWidth:a,shapeRendering:c,onClick:f,id:d.id})}const f4=Y.memo(h4);var d4=Y.memo(u4);const g4=200,p4=150,m4=s=>!s.hidden,y4=s=>{const t={x:-s.transform[0]/s.transform[2],y:-s.transform[1]/s.transform[2],width:s.width/s.transform[2],height:s.height/s.transform[2]};return{viewBB:t,boundingRect:s.nodeLookup.size>0?Db(xl(s.nodeLookup,{filter:m4}),t):t,rfId:s.rfId,panZoom:s.panZoom,translateExtent:s.translateExtent,flowWidth:s.width,flowHeight:s.height,ariaLabelConfig:s.ariaLabelConfig}},v4="react-flow__minimap-desc";function AS({style:s,className:t,nodeStrokeColor:e,nodeColor:i,nodeClassName:o="",nodeBorderRadius:a=5,nodeStrokeWidth:c,nodeComponent:h,bgColor:f,maskColor:d,maskStrokeColor:p,maskStrokeWidth:y,position:v="bottom-right",onClick:x,onNodeClick:b,pannable:w=!1,zoomable:T=!1,ariaLabel:E,inversePan:M,zoomStep:C=1,offsetScale:D=5}){const j=ne(),R=Y.useRef(null),{boundingRect:z,viewBB:U,rfId:G,panZoom:ut,translateExtent:W,flowWidth:Z,flowHeight:rt,ariaLabelConfig:N}=Lt(y4,ee),I=s?.width??g4,A=s?.height??p4,L=z.width/I,H=z.height/A,q=Math.max(L,H),st=q*I,k=q*A,P=D*q,et=z.x-(st-z.width)/2-P,nt=z.y-(k-z.height)/2-P,ht=st+P*2,dt=k+P*2,ft=`${v4}-${G}`,X=Y.useRef(0),ot=Y.useRef();X.current=q,Y.useEffect(()=>{if(R.current&&ut)return ot.current=BO({domNode:R.current,panZoom:ut,getTransform:()=>j.getState().transform,getViewScale:()=>X.current}),()=>{ot.current?.destroy()}},[ut]),Y.useEffect(()=>{ot.current?.update({translateExtent:W,width:Z,height:rt,inversePan:M,pannable:w,zoomStep:C,zoomable:T})},[w,T,M,C,W,Z,rt]);const gt=x?_t=>{const[Ot,It]=ot.current?.pointer(_t)||[0,0];x(_t,{x:Ot,y:It})}:void 0,xt=b?Y.useCallback((_t,Ot)=>{const It=j.getState().nodeLookup.get(Ot).internals.userNode;b(_t,It)},[]):void 0,pt=E??N["minimap.ariaLabel"];return _.jsx(wh,{position:v,style:{...s,"--xy-minimap-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-background-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-color-props":typeof p=="string"?p:void 0,"--xy-minimap-mask-stroke-width-props":typeof y=="number"?y*q:void 0,"--xy-minimap-node-background-color-props":typeof i=="string"?i:void 0,"--xy-minimap-node-stroke-color-props":typeof e=="string"?e:void 0,"--xy-minimap-node-stroke-width-props":typeof c=="number"?c:void 0},className:pe(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:_.jsxs("svg",{width:I,height:A,viewBox:`${et} ${nt} ${ht} ${dt}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":ft,ref:R,onClick:gt,children:[pt&&_.jsx("title",{id:ft,children:pt}),_.jsx(d4,{onClick:xt,nodeColor:i,nodeStrokeColor:e,nodeBorderRadius:a,nodeClassName:o,nodeStrokeWidth:c,nodeComponent:h}),_.jsx("path",{className:"react-flow__minimap-mask",d:`M${et-P},${nt-P}h${ht+P*2}v${dt+P*2}h${-ht-P*2}z
        M${U.x},${U.y}h${U.width}v${U.height}h${-U.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}AS.displayName="MiniMap";Y.memo(AS);const x4=s=>t=>s?`${Math.max(1/t.transform[2],1)}`:void 0,b4={[Oo.Line]:"right",[Oo.Handle]:"bottom-right"};function S4({nodeId:s,position:t,variant:e=Oo.Handle,className:i,style:o=void 0,children:a,color:c,minWidth:h=10,minHeight:f=10,maxWidth:d=Number.MAX_VALUE,maxHeight:p=Number.MAX_VALUE,keepAspectRatio:y=!1,resizeDirection:v,autoScale:x=!0,shouldResize:b,onResizeStart:w,onResize:T,onResizeEnd:E}){const M=aS(),C=typeof s=="string"?s:M,D=ne(),j=Y.useRef(null),R=e===Oo.Handle,z=Lt(Y.useCallback(x4(R&&x),[R,x]),ee),U=Y.useRef(null),G=t??b4[e];Y.useEffect(()=>{if(!(!j.current||!C))return U.current||(U.current=KO({domNode:j.current,nodeId:C,getStoreItems:()=>{const{nodeLookup:W,transform:Z,snapGrid:rt,snapToGrid:N,nodeOrigin:I,domNode:A}=D.getState();return{nodeLookup:W,transform:Z,snapGrid:rt,snapToGrid:N,nodeOrigin:I,paneDomNode:A}},onChange:(W,Z)=>{const{triggerNodeChanges:rt,nodeLookup:N,parentLookup:I,nodeOrigin:A}=D.getState(),L=[],H={x:W.x,y:W.y},q=N.get(C);if(q&&q.expandParent&&q.parentId){const st=q.origin??A,k=W.width??q.measured.width??0,P=W.height??q.measured.height??0,et={id:q.id,parentId:q.parentId,rect:{width:k,height:P,...Ab({x:W.x??q.position.x,y:W.y??q.position.y},{width:k,height:P},q.parentId,N,st)}},nt=Ep([et],N,I,A);L.push(...nt),H.x=W.x?Math.max(st[0]*k,W.x):void 0,H.y=W.y?Math.max(st[1]*P,W.y):void 0}if(H.x!==void 0&&H.y!==void 0){const st={id:C,type:"position",position:{...H}};L.push(st)}if(W.width!==void 0&&W.height!==void 0){const k={id:C,type:"dimensions",resizing:!0,setAttributes:v?v==="horizontal"?"width":"height":!0,dimensions:{width:W.width,height:W.height}};L.push(k)}for(const st of Z){const k={...st,type:"position"};L.push(k)}rt(L)},onEnd:({width:W,height:Z})=>{const rt={id:C,type:"dimensions",resizing:!1,dimensions:{width:W,height:Z}};D.getState().triggerNodeChanges([rt])}})),U.current.update({controlPosition:G,boundaries:{minWidth:h,minHeight:f,maxWidth:d,maxHeight:p},keepAspectRatio:y,resizeDirection:v,onResizeStart:w,onResize:T,onResizeEnd:E,shouldResize:b}),()=>{U.current?.destroy()}},[G,h,f,d,p,y,w,T,E,b]);const ut=G.split("-");return _.jsx("div",{className:pe(["react-flow__resize-control","nodrag",...ut,e,i]),ref:j,style:{...o,scale:z,...c&&{[R?"backgroundColor":"borderColor"]:c}},children:a})}Y.memo(S4);const Me=[];for(let s=0;s<256;++s)Me.push((s+256).toString(16).slice(1));function _4(s,t=0){return(Me[s[t+0]]+Me[s[t+1]]+Me[s[t+2]]+Me[s[t+3]]+"-"+Me[s[t+4]]+Me[s[t+5]]+"-"+Me[s[t+6]]+Me[s[t+7]]+"-"+Me[s[t+8]]+Me[s[t+9]]+"-"+Me[s[t+10]]+Me[s[t+11]]+Me[s[t+12]]+Me[s[t+13]]+Me[s[t+14]]+Me[s[t+15]]).toLowerCase()}let Sg;const w4=new Uint8Array(16);function C4(){if(!Sg){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Sg=crypto.getRandomValues.bind(crypto)}return Sg(w4)}const T4=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),n1={randomUUID:T4};function E4(s,t,e){s=s||{};const i=s.random??s.rng?.()??C4();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,_4(i)}function fr(s,t,e){return n1.randomUUID&&!s?n1.randomUUID():E4(s)}const M4={idle:"#444444",queued:"#f0ad4e",running:"#00d4aa",done:"#ffffff",error:"#ff4444",cancelled:"#444444",blocked:"#44444466"},zo=Y.memo(function({selected:t,status:e,thumbnail:i,label1:o,label2:a,hasInput:c,hasOutput:h,outputPortName:f="image",inputPortName:d="image",secondInputPortName:p,overlay:y}){const v=M4[e],x=e==="blocked";return _.jsxs("div",{className:"relative",style:{width:160,borderRadius:4,overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.5)",border:t?"2px dashed #ffffff":`1px solid ${v}`,opacity:x?.5:1,transition:"border-color 300ms, opacity 300ms"},children:[c&&_.jsx(hr,{type:"target",position:bt.Left,id:d,style:{width:8,height:8,background:"#333333",border:"2px solid #888888",top:60}}),p&&_.jsx(hr,{type:"target",position:bt.Left,id:p,style:{width:8,height:8,background:"#333333",border:"2px solid #888888",top:100}}),_.jsxs("div",{className:"relative flex items-center justify-center",style:{width:"100%",height:120,backgroundColor:i?"#ffffff":"#1a1a24"},children:[i?_.jsx("img",{src:i,alt:"",className:"h-full w-full object-cover",draggable:!1}):_.jsx("div",{style:{color:"#333340",fontSize:11},children:"No image"}),e==="running"&&_.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40",children:_.jsx(Y1,{size:24,color:"#00d4aa",className:"animate-spin"})}),e==="error"&&_.jsx("div",{className:"absolute right-2 top-2",children:_.jsx(hT,{size:16,color:"#ff4444"})}),y]}),_.jsxs("div",{className:"px-2 py-1.5",style:{backgroundColor:"#1a1a24"},children:[_.jsx("div",{className:"truncate",style:{color:"#cccccc",fontSize:11,lineHeight:"14px"},children:o}),a&&_.jsx("div",{className:"truncate",style:{color:"#888888",fontSize:10,lineHeight:"13px"},children:a})]}),h&&_.jsx(hr,{type:"source",position:bt.Right,id:f,style:{width:8,height:8,background:"#333333",border:"2px solid #888888",top:60}})]})}),D4=Y.memo(function({data:t,selected:e}){const i=t.resultImage??t.params.image??null;return _.jsx(zo,{selected:e,status:t.status,thumbnail:i,label1:"Source",hasInput:!1,hasOutput:!0,outputPortName:"image"})});function O4(s){switch(s){case"main":return"1. Main renderer";case"experimental-exterior":return"(exp) Exterior render";case"experimental-interior":return"(exp) Interior render"}}const A4=Y.memo(function({data:t,selected:e}){const i=O4(t.params.engine),o=t.params.prompt||"",a=o.length>40?o.slice(0,40)+"...":o;return _.jsx(zo,{selected:e,status:t.status,thumbnail:t.resultImage,label1:i,label2:a,hasInput:!0,hasOutput:!0})}),k4=Y.memo(function({data:t,selected:e}){const i=t.params.prompt||"",o=i.length>40?i.slice(0,40)+"...":i;return _.jsx(zo,{selected:e,status:t.status,thumbnail:t.resultImage,label1:"2. Details editor",label2:o||void 0,hasInput:!0,hasOutput:!0})}),j4=Y.memo(function({data:t,selected:e}){const i=t.params.prompt||"Upscale",o=i.length>40?i.slice(0,40)+"...":i;return _.jsx(zo,{selected:e,status:t.status,thumbnail:t.resultImage,label1:"3. Creative upscaler",label2:o,hasInput:!0,hasOutput:!0})}),N4=Y.memo(function({data:t,selected:e}){const i=t.params.prompt||"",o=i.length>40?i.slice(0,40)+"...":i,a=t.resultImage?_.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:_.jsx("div",{className:"flex items-center justify-center rounded-full",style:{width:36,height:36,backgroundColor:"rgba(0,0,0,0.5)"},children:_.jsx(GC,{size:18,color:"#ffffff",fill:"#ffffff"})})}):null;return _.jsx(zo,{selected:e,status:t.status,thumbnail:t.resultImage,label1:"4. Image to video",label2:o||void 0,hasInput:!0,hasOutput:!0,inputPortName:"image",secondInputPortName:"endFrame",overlay:a})}),R4=Y.memo(function({data:t,selected:e}){const i=t.params.mode==="slider"?"Slider":"Side by side";return _.jsx(zo,{selected:e,status:t.status,thumbnail:t.resultImage,label1:"Compare",label2:i,hasInput:!0,hasOutput:!1,inputPortName:"imageA",secondInputPortName:"imageB"})});function z4({x:s,y:t,items:e,onClose:i}){const o=Y.useCallback(a=>{a(),i()},[i]);return _.jsxs(_.Fragment,{children:[_.jsx("div",{className:"fixed inset-0 z-40",onClick:i,onContextMenu:a=>{a.preventDefault(),i()}}),_.jsx("div",{className:"fixed z-50 rounded-lg py-1",style:{left:s,top:t,backgroundColor:"#1e1e2a",boxShadow:"0 4px 16px rgba(0,0,0,0.6)",minWidth:180,borderRadius:8},children:e.map(a=>_.jsx("button",{className:"block w-full px-4 py-2 text-left text-sm transition-colors duration-100",style:{color:a.danger?"#ff4444":"#cccccc"},onMouseEnter:c=>c.currentTarget.style.backgroundColor="#2a2a36",onMouseLeave:c=>c.currentTarget.style.backgroundColor="transparent",onClick:()=>o(a.action),children:a.label},a.label))})]})}const Kg=Ro((s,t)=>({undoStack:[],redoStack:[],pushUndo:e=>{s(i=>({undoStack:[...i.undoStack.slice(-49),e],redoStack:[]}))},undo:e=>{const{undoStack:i}=t();if(i.length===0)return null;const o=i[i.length-1];return s(a=>({undoStack:a.undoStack.slice(0,-1),redoStack:[...a.redoStack,e]})),o},redo:e=>{const{redoStack:i}=t();if(i.length===0)return null;const o=i[i.length-1];return s(a=>({redoStack:a.redoStack.slice(0,-1),undoStack:[...a.undoStack,e]})),o},clearStacks:()=>s({undoStack:[],redoStack:[]})}));function L4(s){switch(s){case"SOURCE":return{origin:"upload",image:"",cameraLocked:!1,sceneMeta:null};case"RENDER":return{engine:"main",prompt:"Create photorealistic image",presetId:null,seed:null,resolution:"1200x1200"};case"MODIFIER":return{prompt:"",presetId:null,mask:null,maskLayers:[]};case"UPSCALE":return{scale:2,optimizedFor:"standard",creativity:0,detailStrength:0,similarity:0,promptStrength:0,prompt:"Upscale"};case"VIDEO":return{engine:"kling",duration:5,prompt:"Move forward",endFrameImage:null};case"COMPARE":return{mode:"slider"}}}function B4(s){switch(s){case"SOURCE":return 0;case"RENDER":return 1;case"MODIFIER":return 1;case"UPSCALE":return 2;case"VIDEO":return 5;case"COMPARE":return 0}}function qn(){const{nodes:s,edges:t,selectedNodeId:e}=Mt.getState();Kg.getState().pushUndo({nodes:structuredClone(s),edges:structuredClone(t),selectedNodeId:e})}const Mt=Ro((s,t)=>({nodes:[],edges:[],selectedNodeId:null,addNode:e=>{qn(),s(i=>({nodes:[...i.nodes,e]}))},removeNode:e=>{qn(),s(i=>({nodes:i.nodes.filter(o=>o.id!==e),edges:i.edges.filter(o=>o.from!==e&&o.to!==e),selectedNodeId:i.selectedNodeId===e?null:i.selectedNodeId}))},updateNode:(e,i)=>{qn(),s(o=>({nodes:o.nodes.map(a=>a.id===e?{...a,...i}:a)}))},updateNodeParams:(e,i)=>{qn(),s(o=>({nodes:o.nodes.map(a=>a.id===e?{...a,params:{...a.params,...i}}:a)}))},updateNodePosition:(e,i)=>s(o=>({nodes:o.nodes.map(a=>a.id===e?{...a,position:i}:a)})),updateNodeStatus:(e,i)=>s(o=>({nodes:o.nodes.map(a=>a.id===e?{...a,status:i}:a)})),updateNodeResult:(e,i)=>s(o=>({nodes:o.nodes.map(a=>a.id===e?{...a,result:i}:a)})),addEdge:e=>{t().edges.some(a=>a.from===e.from&&a.fromPort===e.fromPort&&a.to===e.to&&a.toPort===e.toPort)||(qn(),s(a=>({edges:[...a.edges,e]})))},removeEdge:e=>{qn(),s(i=>({edges:i.edges.filter(o=>o.id!==e)}))},selectNode:e=>s({selectedNodeId:e}),clearAll:()=>{qn(),s({nodes:[],edges:[],selectedNodeId:null})},createSourceNode:(e,i,o,a)=>{qn();const c=fr(),h={id:c,type:"SOURCE",position:o,status:"done",params:{origin:i,image:e,cameraLocked:a?.cameraLocked??!1,sceneMeta:a?.sceneMeta??null},result:{image:e,timestamp:new Date().toISOString(),cacheKey:""},cost:0,version:"1.0.0"};return s(f=>({nodes:[...f.nodes,h],selectedNodeId:c})),c},createNode:(e,i)=>{qn();const o=fr(),a={id:o,type:e,position:i,status:"idle",params:L4(e),result:null,cost:B4(e),version:"1.0.0"};return s(c=>({nodes:[...c.nodes,a],selectedNodeId:o})),o},duplicateNode:e=>{const i=t().nodes.find(c=>c.id===e);if(!i)return null;qn();const o=fr(),a={...i,id:o,position:{x:i.position.x+30,y:i.position.y+30},status:"idle",result:null};return s(c=>({nodes:[...c.nodes,a],selectedNodeId:o})),o},getNode:e=>t().nodes.find(i=>i.id===e),getSelectedNode:()=>{const{nodes:e,selectedNodeId:i}=t();return i?e.find(o=>o.id===i):void 0},getUpstreamNodes:e=>{const{nodes:i,edges:o}=t(),a=new Set,c=[e];for(;c.length>0;){const h=c.shift();if(!a.has(h)){a.add(h);for(const f of o)f.to===h&&!a.has(f.from)&&c.push(f.from)}}return i.filter(h=>a.has(h.id))}})),th=Ro(s=>({isRunning:!1,currentNodeId:null,queue:[],error:null,setRunning:t=>s({isRunning:t}),setCurrentNodeId:t=>s({currentNodeId:t}),setQueue:t=>s({queue:t}),setError:t=>s({error:t}),reset:()=>s({isRunning:!1,currentNodeId:null,queue:[],error:null})})),Dp=Ro((s,t)=>({snapshots:[],saveSnapshot:(e,i,o)=>{const a=e.filter(h=>h.result?.image).map(h=>h.result.image),c={id:fr(),graph:{graphId:fr(),nodes:structuredClone(e),edges:structuredClone(i),meta:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),source:"web",appVersion:"1.0.0"},ui:{zoom:1,pan:{x:0,y:0}}},timestamp:new Date().toISOString(),creditUsed:o,thumbnails:a};s(h=>({snapshots:[c,...h.snapshots]}))},restoreSnapshot:e=>t().snapshots.find(i=>i.id===e),loadMore:()=>{}}));function H4(s){switch(s.type){case"SOURCE":case"COMPARE":return 0;case"RENDER":case"MODIFIER":return 1;case"UPSCALE":return s.params.scale===4?4:2;case"VIDEO":return s.params.duration===10?10:5}}const Op=Ro(s=>({balance:100,deduct:t=>s(e=>({balance:Math.max(0,e.balance-t)})),estimateCost:t=>t.filter(e=>e.status!=="done").reduce((e,i)=>e+H4(i),0)}));function U4(s){let t=5381;for(let e=0;e<s.length;e++)t=(t<<5)+t+s.charCodeAt(e)|0;return(t>>>0).toString(36)}function P4(s){const t={};for(const e of Object.keys(s).sort())t[e]=s[e];return t}function Y4(s,t,e){const i=e.find(a=>a.to===s.id);if(!i)return"root";const o=t.find(a=>a.id===i.from);return o?.result?.cacheKey?o.result.cacheKey:"pending"}function Ap(s,t,e){const i=Y4(s,t,e),o=JSON.stringify({type:s.type,params:P4(s.params),inputHash:i});return U4(o)}class Ao extends Error{status;constructor(t,e=null){super(t),this.name="GeminiError",this.status=e}}class kS extends Ao{constructor(t="Invalid or missing API key"){super(t,401),this.name="AuthError"}}class V4 extends Ao{constructor(t="Rate limit exceeded  try again later"){super(t,429),this.name="RateLimitError"}}class X4 extends Ao{reason;constructor(t){super(`Content blocked: ${t}`),this.name="ContentFilterError",this.reason=t,this.status=200}}class F4 extends Ao{constructor(t){super(`Gemini server error (${t})`),this.name="ServerError",this.status=t}}const I4="https://generativelanguage.googleapis.com/v1beta/models",G4="gemini-2.0-flash-exp-image-generation",iu=2,$4=12e4,i1={main:"gemini-2.0-flash-exp-image-generation","experimental-exterior":"gemini-2.0-flash-exp-image-generation","experimental-interior":"gemini-2.0-flash-exp-image-generation"},q4=`You are a photorealistic image renderer. Transform the input 3D scene into a photorealistic photograph. RULES  strictly follow every one:
1. Keep the EXACT same composition: every object stays at the same position and size.
2. Do NOT add, remove, move, or resize any object.
3. Only change surface materials to realistic textures, add natural lighting and shadows.
4. Camera angle, perspective, and framing must be identical to the input.
5. The result must look like a real photograph of the same scene.
Failure to follow these rules means the task has failed.`;function kp(){return!0}function W4(){throw new kS("VITE_GEMINI_API_KEY is not set")}function Z4(s){return s&&s in i1?i1[s]:G4}function K4(s){return s.startsWith("iVBOR")?"image/png":s.startsWith("/9j/")?"image/jpeg":s.startsWith("R0lGOD")?"image/gif":s.startsWith("UklGR")?"image/webp":"image/png"}function Q4(s){const t=s.match(/^data:([^;]+);base64,(.+)$/);return t?{mimeType:t[1],base64:t[2]}:{mimeType:K4(s),base64:s}}function _g(s){return Math.min(1e3*2**s,16e3)}function wg(s){return new Promise(t=>setTimeout(t,s))}async function jp(s){const t=W4(),e=Z4(s.engine),i=s.systemInstruction??q4,o=s.responseModalities??["TEXT","IMAGE"],{base64:a,mimeType:c}=Q4(s.image),h={system_instruction:{parts:[{text:i}]},contents:[{parts:[{inlineData:{mimeType:c,data:a}},{text:s.prompt}]}],generationConfig:{responseModalities:o}};return Lu(e,t,h,0)}async function Lu(s,t,e,i){const o=`${I4}/${s}:generateContent?key=${encodeURIComponent(t)}`,a=new AbortController,c=setTimeout(()=>a.abort(),$4);let h;try{h=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:a.signal})}catch(f){if(clearTimeout(c),i<iu)return await wg(_g(i)),Lu(s,t,e,i+1);throw new Ao(`Request failed after ${iu+1} attempts: ${String(f)}`)}finally{clearTimeout(c)}switch(h.status){case 200:return J4(await h.json());case 401:case 403:throw new kS;case 429:{if(i<iu)return await wg(_g(i)),Lu(s,t,e,i+1);throw new V4}default:if(h.status>=500){if(i<iu)return await wg(_g(i)),Lu(s,t,e,i+1);throw new F4(h.status)}throw new Ao(`Unexpected response ${h.status}: ${await h.text()}`,h.status)}}function J4(s){const t=s.candidates;if(!t||t.length===0){const o=s.promptFeedback;if(o?.blockReason)throw new X4(o.blockReason);return{image:null,text:null}}const e=t[0]?.content?.parts;if(!e)return{image:null,text:null};const i={image:null,text:null};for(const o of e){typeof o.text=="string"&&(i.text=o.text);const a=o.inlineData;a?.data&&(i.image=a.data)}return i}function t5(s){return new Promise(t=>setTimeout(t,s))}async function e5(s){return await t5(2e3),{image:s.image,resolution:s.resolution,timestamp:new Date().toISOString(),cacheKey:""}}async function n5(s){const t=await jp({image:s.image,prompt:s.prompt,engine:s.engine});return{image:t.image?`data:image/png;base64,${t.image}`:s.image,resolution:s.resolution,timestamp:new Date().toISOString(),cacheKey:""}}async function i5(s){return kp()?e5(s):n5(s)}function s5(s){return new Promise(t=>setTimeout(t,s))}async function r5(s){return await s5(2e3),{image:s.image,timestamp:new Date().toISOString(),cacheKey:""}}async function o5(s){const e=await jp({image:s.image,prompt:s.prompt,systemInstruction:"You are an image detail editor. Apply the requested modification to the input image. Preserve overall composition and only change the areas described in the prompt."});return{image:e.image?`data:image/png;base64,${e.image}`:s.image,timestamp:new Date().toISOString(),cacheKey:""}}async function a5(s){return kp()?r5(s):o5(s)}function l5(s){return new Promise(t=>setTimeout(t,s))}async function c5(s){return await l5(3e3),{image:s.image,resolution:`${s.scale}x upscaled`,timestamp:new Date().toISOString(),cacheKey:""}}async function u5(s){const t="You are a creative image upscaler. Enhance the input image to a higher resolution while adding fine detail. Maintain the exact composition, colors, and layout of the original.",e=`Upscale this image by ${s.scale}x. Optimization: ${s.optimizedFor}. `+(s.prompt?s.prompt:"Enhance all details."),i=await jp({image:s.image,prompt:e,systemInstruction:t});return{image:i.image?`data:image/png;base64,${i.image}`:s.image,resolution:`${s.scale}x upscaled`,timestamp:new Date().toISOString(),cacheKey:""}}async function h5(s){return kp()?c5(s):u5(s)}function f5(s){return new Promise(t=>setTimeout(t,s))}async function d5(s){return await f5(5e3),{image:s.image,video:"mock-video-url",timestamp:new Date().toISOString(),cacheKey:""}}function jS(s,t){const e=new Set,i=[s];for(;i.length>0;){const o=i.shift();if(e.has(o))continue;e.add(o);const a=t.filter(c=>c.to===o);for(const c of a)i.push(c.from)}return e}function g5(s,t){const e=new Set,i=new Set;function o(a){e.add(a),i.add(a);const c=t.filter(h=>h.from===a&&s.has(h.to));for(const h of c)if(i.has(h.to)||!e.has(h.to)&&o(h.to))return!0;return i.delete(a),!1}for(const a of s)if(!e.has(a)&&o(a))return!0;return!1}function p5(s,t){const e=new Set(s.map(f=>f.id)),i=t.filter(f=>e.has(f.from)&&e.has(f.to)),o=new Map,a=new Map;for(const f of s)o.set(f.id,0),a.set(f.id,[]);for(const f of i)o.set(f.to,(o.get(f.to)??0)+1),a.get(f.from).push(f.to);const c=[];let h=s.filter(f=>o.get(f.id)===0);for(;h.length>0;){c.push([...h]);const f=[];for(const d of h)for(const p of a.get(d.id)){const y=o.get(p)-1;if(o.set(p,y),y===0){const v=s.find(x=>x.id===p);v&&f.push(v)}}h=f}return c}function m5(s){const{edges:t}=Mt.getState(),e=Mt.getState().updateNodeStatus,i=new Set,o=[s];for(;o.length>0;){const a=o.shift(),c=t.filter(h=>h.from===a);for(const h of c)i.has(h.to)||(i.add(h.to),o.push(h.to),e(h.to,"blocked"))}}function su(s){const{nodes:t,edges:e}=Mt.getState(),i=e.find(a=>a.to===s&&a.toPort==="image");return i?t.find(a=>a.id===i.from)?.result?.image??null:null}async function y5(s){const{updateNodeStatus:t,updateNodeResult:e}=Mt.getState(),{nodes:i,edges:o}=Mt.getState(),{setCurrentNodeId:a}=th.getState(),{deduct:c}=Op.getState();t(s.id,"running"),a(s.id);try{let h;switch(s.type){case"SOURCE":{h={image:s.params.image,resolution:"original",timestamp:new Date().toISOString(),cacheKey:""};break}case"RENDER":{const f=s.params,d=su(s.id);h=await i5({engine:f.engine,image:d??"",prompt:f.prompt,systemPrompt:"",negativePrompt:"",seed:f.seed,resolution:f.resolution});break}case"MODIFIER":{const f=s.params,d=su(s.id);h=await a5({image:d??"",prompt:f.prompt,systemPrompt:"",negativePrompt:"",mask:f.mask,maskLayers:f.maskLayers});break}case"UPSCALE":{const f=s.params,d=su(s.id);h=await h5({image:d??"",scale:f.scale,optimizedFor:f.optimizedFor,creativity:f.creativity,detailStrength:f.detailStrength,similarity:f.similarity,promptStrength:f.promptStrength,prompt:f.prompt});break}case"VIDEO":{const f=s.params,d=su(s.id);h=await d5({engine:f.engine,image:d??"",endFrame:f.endFrameImage,duration:f.duration,prompt:f.prompt});break}case"COMPARE":{h={timestamp:new Date().toISOString(),cacheKey:""};break}}h.cacheKey=Ap(s,i,o),e(s.id,h),t(s.id,"done"),c(s.cost)}catch{t(s.id,"error"),m5(s.id)}}async function NS(s){const{nodes:t,edges:e,updateNodeStatus:i}=Mt.getState(),o=th.getState(),a=Op.getState(),c=Dp.getState(),h=jS(s,e),f=t.filter(b=>h.has(b.id));if(g5(h,e)){o.setError("Cyclic connection detected");return}for(const b of f){const w=Ap(b,t,e);b.result&&b.result.cacheKey===w||(b.type!=="SOURCE"||!b.result)&&i(b.id,"idle")}const p=Mt.getState().nodes.filter(b=>h.has(b.id)).filter(b=>b.status!=="done"),y=p.reduce((b,w)=>b+w.cost,0);if(a.balance<y){o.setError("Not enough credits");return}o.setRunning(!0),o.setError(null),o.setQueue(p.map(b=>b.id));for(const b of p)i(b.id,"queued");const v=p5(p,e);try{for(const b of v)await Promise.all(b.map(w=>y5(w)))}finally{o.setRunning(!1),o.setCurrentNodeId(null),o.setQueue([])}const x=Mt.getState();c.saveSnapshot(x.nodes,x.edges,y)}function v5(s){const{nodes:t,edges:e}=Mt.getState(),i=jS(s,e);return t.filter(a=>i.has(a.id)).filter(a=>{if(a.status==="done"&&a.result){const c=Ap(a,t,e);return a.result.cacheKey!==c}return!0}).reduce((a,c)=>a+c.cost,0)}const x5={SOURCE:D4,RENDER:A4,MODIFIER:k4,UPSCALE:j4,VIDEO:N4,COMPARE:R4},b5=[{type:"RENDER",label:"1. Main renderer"},{type:"MODIFIER",label:"2. Details editor"},{type:"UPSCALE",label:"3. Creative upscaler"},{type:"VIDEO",label:"4. Image to video"},{type:"COMPARE",label:"Compare"}];function S5(s,t,e){if(s.length===0)return;const i=new Set(s),o=t.filter(y=>i.has(y.from)&&i.has(y.to)),a=new Map,c=new Map;for(const y of s)a.set(y,0),c.set(y,[]);for(const y of o)a.set(y.to,(a.get(y.to)??0)+1),c.get(y.from).push(y.to);const h=[];let f=s.filter(y=>a.get(y)===0);for(;f.length>0;){h.push([...f]);const y=[];for(const v of f)for(const x of c.get(v)){const b=a.get(x)-1;a.set(x,b),b===0&&y.push(x)}f=y}const d=250,p=150;for(let y=0;y<h.length;y++){const v=h[y];v.sort((w,T)=>(c.get(T)?.length??0)-(c.get(w)?.length??0));const b=-((v.length-1)*p)/2;for(let w=0;w<v.length;w++)e(v[w],{x:y*d,y:b+w*p})}}function _5(){const s=Ch(),t=Y.useRef(null),e=Y.useRef(null),i=Y.useRef(null),o=Y.useRef(null),a=Mt(X=>X.nodes),c=Mt(X=>X.edges),h=Mt(X=>X.selectedNodeId),f=Mt(X=>X.selectNode),d=Mt(X=>X.updateNodePosition),p=Mt(X=>X.addEdge),y=Mt(X=>X.createSourceNode),v=Mt(X=>X.createNode),x=Mt(X=>X.removeNode),b=Mt(X=>X.removeEdge),w=Mt(X=>X.duplicateNode),T=Mt(X=>X.clearAll),E=je(X=>X.setCompareA),M=je(X=>X.setCompareB),[C,D]=Y.useState({visible:!1,position:{x:0,y:0},screenPosition:{x:0,y:0},sourceNodeId:"",sourcePortName:""}),[j,R]=Y.useState({visible:!1,x:0,y:0,items:[]}),z=Y.useMemo(()=>a.map(X=>({id:X.id,type:X.type,position:X.position,selected:X.id===h,data:{status:X.status,params:X.params,resultImage:X.result?.image??null}})),[a,h]),U=Y.useMemo(()=>c.map(X=>({id:X.id,source:X.from,sourceHandle:X.fromPort,target:X.to,targetHandle:X.toPort,style:{stroke:"#555555",strokeWidth:2},animated:!1})),[c]),G=Y.useCallback(X=>{for(const ot of X)ot.type==="position"&&ot.position&&ot.id&&d(ot.id,ot.position),ot.type==="remove"&&ot.id&&x(ot.id);eS(X,z)},[d,x,z]),ut=Y.useCallback(X=>{for(const ot of X)ot.type==="remove"&&ot.id&&b(ot.id);nS(X,U)},[b,U]),W=Y.useCallback(X=>{!X.source||!X.target||p({id:fr(),from:X.source,fromPort:X.sourceHandle??"image",to:X.target,toPort:X.targetHandle??"image"})},[p]),Z=Y.useCallback((X,ot)=>{ot.nodeId&&ot.handleType==="source"&&(o.current={nodeId:ot.nodeId,handleId:ot.handleId??"image"})},[]),rt=Y.useCallback(X=>{const ot=o.current;if(o.current=null,!ot||!X.target?.classList?.contains("react-flow__pane"))return;const xt="changedTouches"in X?X.changedTouches[0].clientX:X.clientX,pt="changedTouches"in X?X.changedTouches[0].clientY:X.clientY,_t=s.screenToFlowPosition({x:xt,y:pt});D({visible:!0,position:_t,screenPosition:{x:xt,y:pt},sourceNodeId:ot.nodeId,sourcePortName:ot.handleId})},[s]),N=Y.useCallback(X=>{const ot=v(X,C.position),gt=X==="COMPARE"?"imageA":"image";p({id:fr(),from:C.sourceNodeId,fromPort:C.sourcePortName,to:ot,toPort:gt}),D(xt=>({...xt,visible:!1}))},[v,p,C]),I=Y.useCallback(()=>{D(X=>({...X,visible:!1}))},[]),A=Y.useCallback(()=>{R(X=>({...X,visible:!1}))},[]),L=Y.useCallback((X,ot)=>{X.preventDefault(),f(ot.id);const gt=[{label:"Make",action:()=>{NS(ot.id)}},{label:"Duplicate",action:()=>{w(ot.id)}},{label:"Delete",action:()=>{x(ot.id)},danger:!0},{label:"Compare A",action:()=>{E(ot.id)}},{label:"Compare B",action:()=>{M(ot.id)}}];R({visible:!0,x:X.clientX,y:X.clientY,items:gt})},[f,w,x,E,M]),H=Y.useCallback(X=>{X.preventDefault();const ot=[{label:"Load image...",action:()=>{i.current?.click()}},{label:"Clear all",action:()=>{T()},danger:!0},{label:"Rearrange nodes",action:()=>{const gt=Mt.getState().nodes,xt=Mt.getState().edges;S5(gt.map(pt=>pt.id),xt,d),setTimeout(()=>s.fitView({padding:.2}),50)}}];R({visible:!0,x:X.clientX,y:X.clientY,items:ot})},[T,d,s]),q=Y.useCallback((X,ot)=>{f(ot.id)},[f]),st=Y.useCallback(()=>{f(null),D(X=>({...X,visible:!1})),R(X=>({...X,visible:!1}))},[f]),k=Y.useCallback(X=>{X.preventDefault(),X.dataTransfer.dropEffect="copy"},[]),P=Y.useCallback(X=>{X.preventDefault();const ot=X.dataTransfer.files;if(ot.length===0)return;const gt=ot[0];if(!gt.type.startsWith("image/"))return;const xt=s.screenToFlowPosition({x:X.clientX,y:X.clientY}),pt=new FileReader;pt.onload=()=>{const _t=pt.result;y(_t,"upload",xt)},pt.readAsDataURL(gt)},[s,y]),et=Y.useCallback(()=>{e.current?.click()},[]),nt=Y.useCallback(X=>{const ot=X.target.files?.[0];if(!ot||!ot.type.startsWith("image/"))return;const gt=new FileReader;gt.onload=()=>{const xt=gt.result,pt=s.screenToFlowPosition({x:window.innerWidth/2,y:window.innerHeight/2});y(xt,"upload",pt)},gt.readAsDataURL(ot),X.target.value=""},[s,y]),ht=Y.useCallback(X=>{const ot=X.target.files?.[0];if(!ot||!ot.type.startsWith("image/"))return;const gt=new FileReader;gt.onload=()=>{const xt=gt.result,pt=s.screenToFlowPosition({x:window.innerWidth/2,y:window.innerHeight/2});y(xt,"upload",pt)},gt.readAsDataURL(ot),X.target.value=""},[s,y]),dt=Y.useCallback(X=>{const ot=X.clipboardData.items;for(const gt of ot)if(gt.type.startsWith("image/")){const xt=gt.getAsFile();if(!xt)continue;const pt=new FileReader;pt.onload=()=>{const _t=pt.result,Ot=s.screenToFlowPosition({x:window.innerWidth/2,y:window.innerHeight/2});y(_t,"paste",Ot)},pt.readAsDataURL(xt),X.preventDefault();break}},[s,y]),ft=a.length===0;return _.jsxs("div",{ref:t,className:"relative flex-1",style:{backgroundColor:"#111118"},onPaste:dt,tabIndex:0,children:[_.jsx(WA,{nodes:z,edges:U,onNodesChange:G,onEdgesChange:ut,onConnect:W,onConnectStart:Z,onConnectEnd:rt,onNodeClick:q,onNodeContextMenu:L,onPaneClick:st,onPaneContextMenu:H,onDragOver:k,onDrop:P,nodeTypes:x5,fitView:!0,proOptions:{hideAttribution:!0},style:{backgroundColor:"#111118"},defaultEdgeOptions:{style:{stroke:"#555555",strokeWidth:2}},deleteKeyCode:"Delete",children:_.jsx(t4,{variant:zi.Dots,gap:20,size:1,color:"#1a1a24"})}),ft&&_.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:_.jsxs("div",{className:"pointer-events-auto flex flex-col items-center gap-3",children:[_.jsx("div",{className:"flex items-center justify-center rounded-lg",style:{width:80,height:80,border:"2px dashed #555555"},children:_.jsx(DC,{size:32,style:{color:"#555555"}})}),_.jsx("p",{style:{color:"#888888",fontSize:14},children:"Drag and drop an image to get started, or"}),_.jsxs("button",{className:"flex items-center gap-2 rounded-md px-5 py-2 text-sm font-medium transition-colors duration-150",style:{backgroundColor:"#00c9a7",color:"#ffffff"},onMouseEnter:X=>X.currentTarget.style.backgroundColor="#00ddb8",onMouseLeave:X=>X.currentTarget.style.backgroundColor="#00c9a7",onClick:et,children:[_.jsx(EC,{size:14}),"Browse"]})]})}),_.jsx("input",{ref:e,type:"file",accept:"image/*",className:"hidden",onChange:nt}),_.jsx("input",{ref:i,type:"file",accept:"image/*",className:"hidden",onChange:ht}),C.visible&&_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"fixed inset-0 z-40",onClick:I}),_.jsxs("div",{className:"absolute z-50 rounded-md py-1",style:{left:C.screenPosition.x-(t.current?.getBoundingClientRect().left??0),top:C.screenPosition.y-(t.current?.getBoundingClientRect().top??0),backgroundColor:"#1a1a2e",border:"1px solid #333344",boxShadow:"0 4px 16px rgba(0,0,0,0.5)",minWidth:180},children:[_.jsx("div",{className:"px-3 py-1.5",style:{color:"#888888",fontSize:11,borderBottom:"1px solid #333344"},children:"Add node"}),b5.map(X=>_.jsx("button",{className:"block w-full px-3 py-2 text-left text-sm transition-colors duration-100",style:{color:"#cccccc"},onMouseEnter:ot=>ot.currentTarget.style.backgroundColor="#2a2a3e",onMouseLeave:ot=>ot.currentTarget.style.backgroundColor="transparent",onClick:()=>N(X.type),children:X.label},X.type))]})]}),j.visible&&_.jsx(z4,{x:j.x,y:j.y,items:j.items,onClose:A})]})}function w5(){return _.jsx(MS,{children:_.jsx(_5,{})})}function C5({selectedNode:s}){const t=Y.useRef(null),[e,i]=Y.useState(1),[o,a]=Y.useState({x:0,y:0}),[c,h]=Y.useState(!1),f=Y.useRef({x:0,y:0,panX:0,panY:0}),d=s?.result?.image??null,p=s?.result?.resolution??null,y=Y.useCallback(T=>{T.preventDefault(),i(E=>{const M=E-T.deltaY*.001;return Math.max(.1,Math.min(5,M))})},[]),v=Y.useCallback(T=>{T.button===0&&(h(!0),f.current={x:T.clientX,y:T.clientY,panX:o.x,panY:o.y})},[o]),x=Y.useCallback(T=>{c&&a({x:f.current.panX+(T.clientX-f.current.x),y:f.current.panY+(T.clientY-f.current.y)})},[c]),b=Y.useCallback(()=>{h(!1)},[]);if(!s)return _.jsx("div",{className:"flex items-center justify-center",style:{minHeight:200,color:"#555555",fontSize:13},children:"No image selected"});if(!d)return _.jsx("div",{className:"flex items-center justify-center",style:{minHeight:200,color:"#555555",fontSize:13},children:"No result yet"});const w=Math.round(e*100);return _.jsxs("div",{ref:t,className:"relative select-none overflow-hidden",style:{minHeight:200,cursor:c?"grabbing":"grab"},onWheel:y,onMouseDown:v,onMouseMove:x,onMouseUp:b,onMouseLeave:b,children:[_.jsx("div",{style:{transform:`translate(${o.x}px, ${o.y}px) scale(${e})`,transformOrigin:"center center",transition:c?"none":"transform 100ms ease-out"},children:_.jsx("img",{src:d,alt:"",className:"w-full",draggable:!1})}),_.jsxs("div",{className:"absolute right-2 top-2 flex flex-col items-end gap-0.5",children:[_.jsxs("span",{style:{fontSize:12,color:"#00c9a7",backgroundColor:"rgba(0,0,0,0.5)",borderRadius:10,padding:"1px 8px"},children:[w,"%"]}),p&&_.jsx("span",{style:{fontSize:10,color:"#666666"},children:p})]})]})}function T5(){const s=je(b=>b.compareANodeId),t=je(b=>b.compareBNodeId),e=Mt(b=>b.nodes),i=s?e.find(b=>b.id===s):null,o=t?e.find(b=>b.id===t):null,a=i?.result?.image??null,c=o?.result?.image??null,h=Y.useRef(null),[f,d]=Y.useState(.5),p=Y.useRef(!1),y=Y.useCallback(()=>{p.current=!0},[]),v=Y.useCallback(b=>{if(!p.current||!h.current)return;const w=h.current.getBoundingClientRect(),T=(b.clientX-w.left)/w.width;d(Math.max(0,Math.min(1,T)))},[]),x=Y.useCallback(()=>{p.current=!1},[]);return!a&&!c?_.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",style:{minHeight:200,color:"#555555",fontSize:13},children:[_.jsx("span",{children:"Assign images with node right-click"}),_.jsx("span",{style:{fontSize:11,color:"#444444"},children:"Compare A / Compare B"})]}):_.jsxs("div",{ref:h,className:"relative select-none",style:{minHeight:200,backgroundColor:"#111118",cursor:"col-resize"},onMouseMove:v,onMouseUp:x,onMouseLeave:x,children:[c?_.jsx("img",{src:c,alt:"Compare B",className:"block w-full",style:{objectFit:"contain"},draggable:!1}):_.jsx("div",{className:"flex w-full items-center justify-center",style:{height:200,color:"#444444",fontSize:12},children:"B: Not assigned"}),a&&_.jsx("div",{className:"absolute inset-0 overflow-hidden",style:{width:`${f*100}%`},children:_.jsx("img",{src:a,alt:"Compare A",className:"block",style:{width:h.current?.clientWidth??"100%",objectFit:"contain"},draggable:!1})}),_.jsx("div",{className:"absolute top-0 bottom-0",style:{left:`${f*100}%`,width:2,backgroundColor:"#ffffff",transform:"translateX(-1px)",pointerEvents:"none"}}),_.jsx("div",{className:"absolute top-1/2 z-10 flex items-center justify-center rounded-full",style:{left:`${f*100}%`,transform:"translate(-50%, -50%)",width:24,height:24,backgroundColor:"#ffffff",cursor:"col-resize",boxShadow:"0 2px 6px rgba(0,0,0,0.5)"},onMouseDown:y,children:_.jsxs("div",{className:"flex gap-0.5",children:[_.jsx("div",{style:{width:2,height:10,backgroundColor:"#333333",borderRadius:1}}),_.jsx("div",{style:{width:2,height:10,backgroundColor:"#333333",borderRadius:1}})]})}),_.jsx("div",{className:"absolute left-2 top-2 rounded px-1.5 py-0.5",style:{backgroundColor:"rgba(0,0,0,0.6)",color:"#ffffff",fontSize:10},children:"A"}),_.jsx("div",{className:"absolute right-2 top-2 rounded px-1.5 py-0.5",style:{backgroundColor:"rgba(0,0,0,0.6)",color:"#ffffff",fontSize:10},children:"B"})]})}function V(s,t,e){return(t=(function(i){var o=(function(a,c){if(typeof a!="object"||!a)return a;var h=a[Symbol.toPrimitive];if(h!==void 0){var f=h.call(a,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(c==="string"?String:Number)(a)})(i,"string");return typeof o=="symbol"?o:o+""})(t))in s?Object.defineProperty(s,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):s[t]=e,s}class s1{constructor(){V(this,"browserShadowBlurConstant",1),V(this,"DPI",96),V(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),V(this,"perfLimitSizeTotal",2097152),V(this,"maxCacheSideLimit",4096),V(this,"minCacheSideLimit",256),V(this,"disableStyleCopyPaste",!1),V(this,"enableGLFiltering",!0),V(this,"textureSize",4096),V(this,"forceGLPutImageData",!1),V(this,"cachesBoundsOfCurve",!1),V(this,"fontPaths",{}),V(this,"NUM_FRACTION_DIGITS",4)}}const Bt=new class extends s1{constructor(s){super(),this.configure(s)}configure(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,s)}addFonts(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths={...this.fontPaths,...s}}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(s=>{delete this.fontPaths[s]})}clearFonts(){this.fontPaths={}}restoreDefaults(s){const t=new s1,e=s?.reduce((i,o)=>(i[o]=t[o],i),{})||t;this.configure(e)}},Ts=function(s){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return console[s]("fabric",...e)};class Kn extends Error{constructor(t,e){super(`fabric: ${t}`,e)}}class E5 extends Kn{constructor(t){super(`${t} 'options.signal' is in 'aborted' state`)}}class M5{}class D5 extends M5{testPrecision(t,e){const i=`precision ${e} float;
void main(){}`,o=t.createShader(t.FRAGMENT_SHADER);return!!o&&(t.shaderSource(o,i),t.compileShader(o),!!t.getShaderParameter(o,t.COMPILE_STATUS))}queryWebGL(t){const e=t.getContext("webgl");e&&(this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(i=>this.testPrecision(e,i)),e.getExtension("WEBGL_lose_context").loseContext(),Ts("log",`WebGL: max texture size ${this.maxTextureSize}`))}isSupported(t){return!!this.maxTextureSize&&this.maxTextureSize>=t}}const O5={};let r1;const ni=()=>r1||(r1={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new D5,dispose(){},copyPasteData:O5}),Lo=()=>ni().document,Mh=()=>ni().window,RS=()=>{var s;return Math.max((s=Bt.devicePixelRatio)!==null&&s!==void 0?s:Mh().devicePixelRatio,1)},Wa=new class{constructor(){V(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(s){let{fontFamily:t,fontStyle:e,fontWeight:i}=s;t=t.toLowerCase();const o=this.charWidthsCache;o.has(t)||o.set(t,new Map);const a=o.get(t),c=`${e.toLowerCase()}_${(i+"").toLowerCase()}`;return a.has(c)||a.set(c,new Map),a.get(c)}clearFontCache(s){s?this.charWidthsCache.delete((s||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(s){const{perfLimitSizeTotal:t}=Bt,e=Math.sqrt(t*s);return[Math.floor(e),Math.floor(t/e)]}},Qg="7.1.0";function Bu(){}const _l=Math.PI/2,A5=Math.PI/4,ko=2*Math.PI,Np=Math.PI/180,Ue=Object.freeze([1,0,0,1,0,0]),Rp=16,Ss=.4477152502,Dt="center",Yt="left",Ze="top",Jg="bottom",le="right",Ke="none",zp=/\r?\n/,zS="moving",Dh="scaling",LS="rotating",Lp="rotate",BS="skewing",cl="resizing",k5="modifyPoly",j5="modifyPath",eh="changed",Oh="scale",Qe="scaleX",wn="scaleY",Bo="skewX",Ho="skewY",Se="fill",un="stroke",nh="modified",nr="ltr",Oi="rtl",tp="normal",uo="json",Cg="svg",mt=new class{constructor(){this[uo]=new Map,this[Cg]=new Map}has(s){return this[uo].has(s)}getClass(s){const t=this[uo].get(s);if(!t)throw new Kn(`No class registered for ${s}`);return t}setClass(s,t){t?this[uo].set(t,s):(this[uo].set(s.type,s),this[uo].set(s.type.toLowerCase(),s))}getSVGClass(s){return this[Cg].get(s)}setSVGClass(s,t){this[Cg].set(t??s.type.toLowerCase(),s)}},ih=new class extends Array{remove(s){const t=this.indexOf(s);t>-1&&this.splice(t,1)}cancelAll(){const s=this.splice(0);return s.forEach(t=>t.abort()),s}cancelByCanvas(s){if(!s)return[];const t=this.filter(e=>{var i;return e.target===s||typeof e.target=="object"&&((i=e.target)===null||i===void 0?void 0:i.canvas)===s});return t.forEach(e=>e.abort()),t}cancelByTarget(s){if(!s)return[];const t=this.filter(e=>e.target===s);return t.forEach(e=>e.abort()),t}};class N5{constructor(){V(this,"__eventListeners",{})}on(t,e){if(this.__eventListeners||(this.__eventListeners={}),typeof t=="object")return Object.entries(t).forEach(i=>{let[o,a]=i;this.on(o,a)}),()=>this.off(t);if(e){const i=t;return this.__eventListeners[i]||(this.__eventListeners[i]=[]),this.__eventListeners[i].push(e),()=>this.off(i,e)}return()=>!1}once(t,e){if(typeof t=="object"){const i=[];return Object.entries(t).forEach(o=>{let[a,c]=o;i.push(this.once(a,c))}),()=>i.forEach(o=>o())}if(e){const i=this.on(t,function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];e.call(this,...a),i()});return i}return()=>!1}_removeEventListener(t,e){if(this.__eventListeners[t])if(e){const i=this.__eventListeners[t],o=i.indexOf(e);o>-1&&i.splice(o,1)}else this.__eventListeners[t]=[]}off(t,e){if(this.__eventListeners)if(t===void 0)for(const i in this.__eventListeners)this._removeEventListener(i);else typeof t=="object"?Object.entries(t).forEach(i=>{let[o,a]=i;this._removeEventListener(o,a)}):this._removeEventListener(t,e)}fire(t,e){var i;if(!this.__eventListeners)return;const o=(i=this.__eventListeners[t])===null||i===void 0?void 0:i.concat();if(o)for(let a=0;a<o.length;a++)o[a].call(this,e||{})}}const ho=(s,t)=>{const e=s.indexOf(t);return e!==-1&&s.splice(e,1),s},Hi=s=>{if(s===0)return 1;switch(Math.abs(s)/_l){case 1:case 3:return 0;case 2:return-1}return Math.cos(s)},Ui=s=>{if(s===0)return 0;const t=s/_l,e=Math.sign(s);switch(t){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(s)};class tt{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}add(t){return new tt(this.x+t.x,this.y+t.y)}addEquals(t){return this.x+=t.x,this.y+=t.y,this}scalarAdd(t){return new tt(this.x+t,this.y+t)}scalarAddEquals(t){return this.x+=t,this.y+=t,this}subtract(t){return new tt(this.x-t.x,this.y-t.y)}subtractEquals(t){return this.x-=t.x,this.y-=t.y,this}scalarSubtract(t){return new tt(this.x-t,this.y-t)}scalarSubtractEquals(t){return this.x-=t,this.y-=t,this}multiply(t){return new tt(this.x*t.x,this.y*t.y)}scalarMultiply(t){return new tt(this.x*t,this.y*t)}scalarMultiplyEquals(t){return this.x*=t,this.y*=t,this}divide(t){return new tt(this.x/t.x,this.y/t.y)}scalarDivide(t){return new tt(this.x/t,this.y/t)}scalarDivideEquals(t){return this.x/=t,this.y/=t,this}eq(t){return this.x===t.x&&this.y===t.y}lt(t){return this.x<t.x&&this.y<t.y}lte(t){return this.x<=t.x&&this.y<=t.y}gt(t){return this.x>t.x&&this.y>t.y}gte(t){return this.x>=t.x&&this.y>=t.y}lerp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return e=Math.max(Math.min(1,e),0),new tt(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}distanceFrom(t){const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}midPointFrom(t){return this.lerp(t)}min(t){return new tt(Math.min(this.x,t.x),Math.min(this.y,t.y))}max(t){return new tt(Math.max(this.x,t.x),Math.max(this.y,t.y))}toString(){return`${this.x},${this.y}`}setXY(t,e){return this.x=t,this.y=e,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setFromPoint(t){return this.x=t.x,this.y=t.y,this}swap(t){const e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i}clone(){return new tt(this.x,this.y)}rotate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bp;const i=Ui(t),o=Hi(t),a=this.subtract(e);return new tt(a.x*o-a.y*i,a.x*i+a.y*o).add(e)}transform(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new tt(t[0]*this.x+t[2]*this.y+(e?0:t[4]),t[1]*this.x+t[3]*this.y+(e?0:t[5]))}}const Bp=new tt(0,0),Hu=s=>!!s&&Array.isArray(s._objects);function HS(s){class t extends s{constructor(){super(...arguments),V(this,"_objects",[])}_onObjectAdded(i){}_onObjectRemoved(i){}_onStackOrderChanged(i){}add(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];const c=this._objects.push(...o);return o.forEach(h=>this._onObjectAdded(h)),c}insertAt(i){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return this._objects.splice(i,0,...a),a.forEach(h=>this._onObjectAdded(h)),this._objects.length}remove(){const i=this._objects,o=[];for(var a=arguments.length,c=new Array(a),h=0;h<a;h++)c[h]=arguments[h];return c.forEach(f=>{const d=i.indexOf(f);d!==-1&&(i.splice(d,1),o.push(f),this._onObjectRemoved(f))}),o}forEachObject(i){this.getObjects().forEach((o,a,c)=>i(o,a,c))}getObjects(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return o.length===0?[...this._objects]:this._objects.filter(c=>c.isType(...o))}item(i){return this._objects[i]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(i,o){return!!this._objects.includes(i)||!!o&&this._objects.some(a=>a instanceof t&&a.contains(i,!0))}complexity(){return this._objects.reduce((i,o)=>i+=o.complexity?o.complexity():0,0)}sendObjectToBack(i){return!(!i||i===this._objects[0])&&(ho(this._objects,i),this._objects.unshift(i),this._onStackOrderChanged(i),!0)}bringObjectToFront(i){return!(!i||i===this._objects[this._objects.length-1])&&(ho(this._objects,i),this._objects.push(i),this._onStackOrderChanged(i),!0)}sendObjectBackwards(i,o){if(!i)return!1;const a=this._objects.indexOf(i);if(a!==0){const c=this.findNewLowerIndex(i,a,o);return ho(this._objects,i),this._objects.splice(c,0,i),this._onStackOrderChanged(i),!0}return!1}bringObjectForward(i,o){if(!i)return!1;const a=this._objects.indexOf(i);if(a!==this._objects.length-1){const c=this.findNewUpperIndex(i,a,o);return ho(this._objects,i),this._objects.splice(c,0,i),this._onStackOrderChanged(i),!0}return!1}moveObjectTo(i,o){return i!==this._objects[o]&&(ho(this._objects,i),this._objects.splice(o,0,i),this._onStackOrderChanged(i),!0)}findNewLowerIndex(i,o,a){let c;if(a){c=o;for(let h=o-1;h>=0;--h)if(i.isOverlapping(this._objects[h])){c=h;break}}else c=o-1;return c}findNewUpperIndex(i,o,a){let c;if(a){c=o;for(let h=o+1;h<this._objects.length;++h)if(i.isOverlapping(this._objects[h])){c=h;break}}else c=o+1;return c}collectObjects(i){let{left:o,top:a,width:c,height:h}=i,{includeIntersecting:f=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const d=[],p=new tt(o,a),y=p.add(new tt(c,h));for(let v=this._objects.length-1;v>=0;v--){const x=this._objects[v];x.selectable&&x.visible&&(f&&x.intersectsWithRect(p,y)||x.isContainedWithinRect(p,y)||f&&x.containsPoint(p)||f&&x.containsPoint(y))&&d.push(x)}return d}}return t}class US extends N5{_setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const e in t)this.set(e,t[e])}_setObject(t){for(const e in t)this._set(e,t[e])}set(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this}_set(t,e){this[t]=e}toggle(t){const e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this}get(t){return this[t]}}function Uu(s){return Mh().requestAnimationFrame(s)}function R5(s){return Mh().cancelAnimationFrame(s)}let z5=0;const Es=()=>z5++,Pi=()=>{const s=Lo().createElement("canvas");if(!s||s.getContext===void 0)throw new Kn("Failed to create `canvas` element");return s},L5=()=>Lo().createElement("img"),Cn=s=>{const t=Pi();return t.width=s.width,t.height=s.height,t},PS=(s,t,e)=>s.toDataURL(`image/${t}`,e),YS=(s,t,e)=>new Promise((i,o)=>{s.toBlob(i,`image/${t}`,e)}),ce=s=>s*Np,Ms=s=>s/Np,B5=s=>s.every((t,e)=>t===Ue[e]),qe=(s,t,e)=>new tt(s).transform(t,e),Un=s=>{const t=1/(s[0]*s[3]-s[1]*s[2]),e=[t*s[3],-t*s[1],-t*s[2],t*s[0],0,0],{x:i,y:o}=new tt(s[4],s[5]).transform(e,!0);return e[4]=-i,e[5]=-o,e},De=(s,t,e)=>[s[0]*t[0]+s[2]*t[1],s[1]*t[0]+s[3]*t[1],s[0]*t[2]+s[2]*t[3],s[1]*t[2]+s[3]*t[3],e?0:s[0]*t[4]+s[2]*t[5]+s[4],e?0:s[1]*t[4]+s[3]*t[5]+s[5]],Hp=(s,t)=>s.reduceRight((e,i)=>i&&e?De(i,e,t):i||e,void 0)||Ue.concat(),VS=s=>{let[t,e]=s;return Math.atan2(e,t)},sh=s=>{const t=VS(s),e=Math.pow(s[0],2)+Math.pow(s[1],2),i=Math.sqrt(e),o=(s[0]*s[3]-s[2]*s[1])/i,a=Math.atan2(s[0]*s[2]+s[1]*s[3],e);return{angle:Ms(t),scaleX:i,scaleY:o,skewX:Ms(a),skewY:0,translateX:s[4]||0,translateY:s[5]||0}},wl=function(s){return[1,0,0,1,s,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Uo(){let{angle:s=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:t=0,y:e=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=ce(s),o=Hi(i),a=Ui(i);return[o,a,-a,o,t?t-(o*t-a*e):0,e?e-(a*t+o*e):0]}const Up=function(s){return[s,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,0,0]},XS=s=>Math.tan(ce(s)),FS=s=>[1,0,XS(s),1,0,0],IS=s=>[1,XS(s),0,1,0,0],Ah=s=>{let{scaleX:t=1,scaleY:e=1,flipX:i=!1,flipY:o=!1,skewX:a=0,skewY:c=0}=s,h=Up(i?-t:t,o?-e:e);return a&&(h=De(h,FS(a),!0)),c&&(h=De(h,IS(c),!0)),h},H5=s=>{const{translateX:t=0,translateY:e=0,angle:i=0}=s;let o=wl(t,e);i&&(o=De(o,Uo({angle:i})));const a=Ah(s);return B5(a)||(o=De(o,a)),o},Pu=function(s){let{signal:t,crossOrigin:e=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(i,o){if(t&&t.aborted)return o(new E5("loadImage"));const a=L5();let c;t&&(c=function(f){a.src="",o(f)},t.addEventListener("abort",c,{once:!0}));const h=function(){a.onload=a.onerror=null,c&&t?.removeEventListener("abort",c),i(a)};s?(a.onload=h,a.onerror=function(){c&&t?.removeEventListener("abort",c),o(new Kn(`Error loading ${a.src}`))},e&&(a.crossOrigin=e),a.src=s):h()})},ul=function(s){let{signal:t,reviver:e=Bu}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((i,o)=>{const a=[];t&&t.addEventListener("abort",o,{once:!0}),Promise.all(s.map(c=>mt.getClass(c.type).fromObject(c,{signal:t}).then(h=>(e(c,h),a.push(h),h)))).then(i).catch(c=>{a.forEach(h=>{h.dispose&&h.dispose()}),o(c)}).finally(()=>{t&&t.removeEventListener("abort",o)})})},kh=function(s){let{signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((e,i)=>{const o=[];t&&t.addEventListener("abort",i,{once:!0});const a=Object.values(s).map(h=>h&&h.type&&mt.has(h.type)?ul([h],{signal:t}).then(f=>{let[d]=f;return o.push(d),d}):h),c=Object.keys(s);Promise.all(a).then(h=>h.reduce((f,d,p)=>(f[c[p]]=d,f),{})).then(e).catch(h=>{o.forEach(f=>{f.dispose&&f.dispose()}),i(h)}).finally(()=>{t&&t.removeEventListener("abort",i)})})},Po=function(s){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((t,e)=>(e in s&&(t[e]=s[e]),t),{})},Pp=(s,t)=>Object.keys(s).reduce((e,i)=>(t(s[i],i,s)&&(e[i]=s[i]),e),{}),Kt=(s,t)=>parseFloat(Number(s).toFixed(t)),hl=s=>"matrix("+s.map(t=>Kt(t,Bt.NUM_FRACTION_DIGITS)).join(" ")+")",_n=s=>!!s&&s.toLive!==void 0,o1=s=>!!s&&typeof s.toObject=="function",a1=s=>!!s&&s.offsetX!==void 0&&"source"in s,ir=s=>!!s&&"multiSelectionStacking"in s;function GS(s){const t=s&&Ln(s);let e=0,i=0;if(!s||!t)return{left:e,top:i};let o=s;const a=t.documentElement,c=t.body||{scrollLeft:0,scrollTop:0};for(;o&&(o.parentNode||o.host)&&(o=o.parentNode||o.host,o===t?(e=c.scrollLeft||a.scrollLeft||0,i=c.scrollTop||a.scrollTop||0):(e+=o.scrollLeft||0,i+=o.scrollTop||0),o.nodeType!==1||o.style.position!=="fixed"););return{left:e,top:i}}const Ln=s=>s.ownerDocument||null,$S=s=>{var t;return((t=s.ownerDocument)===null||t===void 0?void 0:t.defaultView)||null},qS=function(s,t,e){let{width:i,height:o}=e,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;s.width=i,s.height=o,a>1&&(s.setAttribute("width",(i*a).toString()),s.setAttribute("height",(o*a).toString()),t.scale(a,a))},ep=(s,t)=>{let{width:e,height:i}=t;e&&(s.style.width=typeof e=="number"?`${e}px`:e),i&&(s.style.height=typeof i=="number"?`${i}px`:i)};function l1(s){return s.onselectstart!==void 0&&(s.onselectstart=()=>!1),s.style.userSelect=Ke,s}class WS{constructor(t){V(this,"_originalCanvasStyle",void 0),V(this,"lower",void 0);const e=this.createLowerCanvas(t);this.lower={el:e,ctx:e.getContext("2d")}}createLowerCanvas(t){const e=(i=t)&&i.getContext!==void 0?t:t&&Lo().getElementById(t)||Pi();var i;if(e.hasAttribute("data-fabric"))throw new Kn("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=e.style.cssText,e.setAttribute("data-fabric","main"),e.classList.add("lower-canvas"),e}cleanupDOM(t){let{width:e,height:i}=t;const{el:o}=this.lower;o.classList.remove("lower-canvas"),o.removeAttribute("data-fabric"),o.setAttribute("width",`${e}`),o.setAttribute("height",`${i}`),o.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(t,e){const{el:i,ctx:o}=this.lower;qS(i,o,t,e)}setCSSDimensions(t){ep(this.lower.el,t)}calcOffset(){return(function(t){var e;const i=t&&Ln(t),o={left:0,top:0};if(!i)return o;const a=((e=$S(t))===null||e===void 0?void 0:e.getComputedStyle(t,null))||{};o.left+=parseInt(a.borderLeftWidth,10)||0,o.top+=parseInt(a.borderTopWidth,10)||0,o.left+=parseInt(a.paddingLeft,10)||0,o.top+=parseInt(a.paddingTop,10)||0;let c={left:0,top:0};const h=i.documentElement;t.getBoundingClientRect!==void 0&&(c=t.getBoundingClientRect());const f=GS(t);return{left:c.left+f.left-(h.clientLeft||0)+o.left,top:c.top+f.top-(h.clientTop||0)+o.top}})(this.lower.el)}dispose(){ni().dispose(this.lower.el),delete this.lower}}const U5={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Ue],patternQuality:"best"};class Cl extends HS(US){get lowerCanvasEl(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.el}get contextContainer(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.ctx}static getDefaults(){return Cl.ownDefaults}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(e),this.initElements(t),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(t){this.elements=new WS(t)}add(){const t=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}insertAt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];const a=super.insertAt(t,...i);return i.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),a}remove(){const t=super.remove(...arguments);return t.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}_onObjectAdded(t){t.canvas&&t.canvas!==this&&(Ts("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),t.canvas.remove(t)),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t){t._set("canvas",void 0),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?RS():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}_setDimensionsImpl(t){let{cssOnly:e=!1,backstoreOnly:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e){const o={width:this.width,height:this.height,...t};this.elements.setDimensions(o,this.getRetinaScaling()),this.hasLostContext=!0,this.width=o.width,this.height=o.height}i||this.elements.setCSSDimensions(t),this.calcOffset()}setDimensions(t,e){this._setDimensionsImpl(t,e),e&&e.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(t){this.viewportTransform=t,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(t,e){const i=t,o=[...this.viewportTransform],a=qe(t,Un(o));o[0]=e,o[3]=e;const c=qe(a,o);o[4]+=i.x-c.x,o[5]+=i.y-c.y,this.setViewportTransform(o)}setZoom(t){this.zoomToPoint(new tt(0,0),t)}absolutePan(t){const e=[...this.viewportTransform];return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)}relativePan(t){return this.absolutePan(new tt(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(t){t.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Uu(()=>this.renderAndReset()))}calcViewportBoundaries(){const t=this.width,e=this.height,i=Un(this.viewportTransform),o=qe({x:0,y:0},i),a=qe({x:t,y:e},i),c=o.min(a),h=o.max(a);return this.vptCoords={tl:c,tr:new tt(h.x,c.y),bl:new tt(c.x,h.y),br:h}}cancelRequestedRender(){this.nextRenderHandle&&(R5(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(t){}renderCanvas(t,e){if(this.destroyed)return;const i=this.viewportTransform,o=this.clipPath;this.calcViewportBoundaries(),this.clearContext(t),t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.patternQuality=this.patternQuality,this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(t,e),t.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(t),o&&(o._set("canvas",this),o.shouldCache(),o._transformDone=!0,o.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t,o)),this._renderOverlay(t),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(t),this.fire("after:render",{ctx:t}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(t,e){const i=this.viewportTransform;t.save(),t.transform(...i),t.globalCompositeOperation="destination-in",e.transform(t),t.scale(1/e.zoomX,1/e.zoomY),t.drawImage(e._cacheCanvas,-e.cacheTranslationX,-e.cacheTranslationY),t.restore()}_renderObjects(t,e){for(let i=0,o=e.length;i<o;++i)e[i]&&e[i].render(t)}_renderBackgroundOrOverlay(t,e){const i=this[`${e}Color`],o=this[`${e}Image`],a=this.viewportTransform,c=this[`${e}Vpt`];if(!i&&!o)return;const h=_n(i);if(i){if(t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=h?i.toLive(t):i,c&&t.transform(...a),h){t.transform(1,0,0,1,i.offsetX||0,i.offsetY||0);const f=i.gradientTransform||i.patternTransform;f&&t.transform(...f)}t.fill(),t.restore()}if(o){t.save();const{skipOffscreen:f}=this;this.skipOffscreen=c,c&&t.transform(...a),o.render(t),this.skipOffscreen=f,t.restore()}}_renderBackground(t){this._renderBackgroundOrOverlay(t,"background")}_renderOverlay(t){this._renderBackgroundOrOverlay(t,"overlay")}getCenterPoint(){return new tt(this.width/2,this.height/2)}centerObjectH(t){return this._centerObject(t,new tt(this.getCenterPoint().x,t.getCenterPoint().y))}centerObjectV(t){return this._centerObject(t,new tt(t.getCenterPoint().x,this.getCenterPoint().y))}centerObject(t){return this._centerObject(t,this.getCenterPoint())}viewportCenterObject(t){return this._centerObject(t,this.getVpCenter())}viewportCenterObjectH(t){return this._centerObject(t,new tt(this.getVpCenter().x,t.getCenterPoint().y))}viewportCenterObjectV(t){return this._centerObject(t,new tt(t.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return qe(this.getCenterPoint(),Un(this.viewportTransform))}_centerObject(t,e){t.setXY(e,Dt,Dt),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(t){return this.toDatalessObject(t)}toObject(t){return this._toObjectMethod("toObject",t)}toJSON(){return this.toObject()}toDatalessObject(t){return this._toObjectMethod("toDatalessObject",t)}_toObjectMethod(t,e){const i=this.clipPath,o=i&&!i.excludeFromExport?this._toObject(i,t,e):null;return{version:Qg,...Po(this,e),objects:this._objects.filter(a=>!a.excludeFromExport).map(a=>this._toObject(a,t,e)),...this.__serializeBgOverlay(t,e),...o?{clipPath:o}:null}}_toObject(t,e,i){let o;this.includeDefaultValues||(o=t.includeDefaultValues,t.includeDefaultValues=!1);const a=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=!!o),a}__serializeBgOverlay(t,e){const i={},o=this.backgroundImage,a=this.overlayImage,c=this.backgroundColor,h=this.overlayColor;return _n(c)?c.excludeFromExport||(i.background=c.toObject(e)):c&&(i.background=c),_n(h)?h.excludeFromExport||(i.overlay=h.toObject(e)):h&&(i.overlay=h),o&&!o.excludeFromExport&&(i.backgroundImage=this._toObject(o,t,e)),a&&!a.excludeFromExport&&(i.overlayImage=this._toObject(a,t,e)),i}toSVG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t.reviver=e;const i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this.clipPath&&i.push(`<g clip-path="url(#${this.clipPath.clipPathId})" >
`),this._setSVGBgOverlayColor(i,"background"),this._setSVGBgOverlayImage(i,"backgroundImage",e),this._setSVGObjects(i,e),this.clipPath&&i.push(`</g>
`),this._setSVGBgOverlayColor(i,"overlay"),this._setSVGBgOverlayImage(i,"overlayImage",e),i.push("</svg>"),i.join("")}_setSVGPreamble(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(t,e){const i=e.width||`${this.width}`,o=e.height||`${this.height}`,a=Bt.NUM_FRACTION_DIGITS,c=e.viewBox;let h;if(c)h=`viewBox="${c.x} ${c.y} ${c.width} ${c.height}" `;else if(this.svgViewportTransformation){const f=this.viewportTransform;h=`viewBox="${Kt(-f[4]/f[0],a)} ${Kt(-f[5]/f[3],a)} ${Kt(this.width/f[0],a)} ${Kt(this.height/f[3],a)}" `}else h=`viewBox="0 0 ${this.width} ${this.height}" `;t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',o,'" ',h,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Qg,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),`</defs>
`)}createSVGClipPathMarkup(t){const e=this.clipPath;return e?(e.clipPathId=`CLIPPATH_${Es()}`,`<clipPath id="${e.clipPathId}" >
${e.toClipPathSVG(t.reviver)}</clipPath>
`):""}createSVGRefElementsMarkup(){return["background","overlay"].map(t=>{const e=this[`${t}Color`];if(_n(e)){const i=this[`${t}Vpt`],o=this.viewportTransform,a={isType:()=>!1,width:this.width/(i?o[0]:1),height:this.height/(i?o[3]:1)};return e.toSVG(a,{additionalTransform:i?hl(o):""})}}).join("")}createSVGFontFacesMarkup(){const t=[],e={},i=Bt.fontPaths;this._objects.forEach(function a(c){t.push(c),Hu(c)&&c._objects.forEach(a)}),t.forEach(a=>{if(!(c=a)||typeof c._renderText!="function")return;var c;const{styles:h,fontFamily:f}=a;!e[f]&&i[f]&&(e[f]=!0,h&&Object.values(h).forEach(d=>{Object.values(d).forEach(p=>{let{fontFamily:y=""}=p;!e[y]&&i[y]&&(e[y]=!0)})}))});const o=Object.keys(e).map(a=>`		@font-face {
			font-family: '${a}';
			src: url('${i[a]}');
		}
`).join("");return o?`	<style type="text/css"><![CDATA[
${o}]]></style>
`:""}_setSVGObjects(t,e){this.forEachObject(i=>{i.excludeFromExport||this._setSVGObject(t,i,e)})}_setSVGObject(t,e,i){t.push(e.toSVG(i))}_setSVGBgOverlayImage(t,e,i){const o=this[e];o&&!o.excludeFromExport&&o.toSVG&&t.push(o.toSVG(i))}_setSVGBgOverlayColor(t,e){const i=this[`${e}Color`];if(i)if(_n(i)){const o=i.repeat||"",a=this.width,c=this.height,h=this[`${e}Vpt`]?hl(Un(this.viewportTransform)):"";t.push(`<rect transform="${h} translate(${a/2},${c/2})" x="${i.offsetX-a/2}" y="${i.offsetY-c/2}" width="${o!=="repeat-y"&&o!=="no-repeat"||!a1(i)?a:i.source.width}" height="${o!=="repeat-x"&&o!=="no-repeat"||!a1(i)?c:i.source.height}" fill="url(#SVGID_${i.id})"></rect>
`)}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',i,'"',`></rect>
`)}loadFromJSON(t,e){let{signal:i}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t)return Promise.reject(new Kn("`json` is undefined"));const{objects:o=[],...a}=typeof t=="string"?JSON.parse(t):t,{backgroundImage:c,background:h,overlayImage:f,overlay:d,clipPath:p}=a,y=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([ul(o,{reviver:e,signal:i}),kh({backgroundImage:c,backgroundColor:h,overlayImage:f,overlayColor:d,clipPath:p},{signal:i})]).then(v=>{let[x,b]=v;return this.clear(),this.add(...x),this.set(a),this.set(b),this.renderOnAddRemove=y,this})}clone(t){const e=this.toObject(t);return this.cloneWithoutData().loadFromJSON(e)}cloneWithoutData(){const t=Cn(this);return new this.constructor(t)}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:i=1,multiplier:o=1,enableRetinaScaling:a=!1}=t,c=o*(a?this.getRetinaScaling():1);return PS(this.toCanvasElement(c,t),e,i)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:i=1,multiplier:o=1,enableRetinaScaling:a=!1}=t,c=o*(a?this.getRetinaScaling():1);return YS(this.toCanvasElement(c,t),e,i)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:e,height:i,left:o,top:a,filter:c}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=(e||this.width)*t,f=(i||this.height)*t,d=this.getZoom(),p=this.width,y=this.height,v=this.skipControlsDrawing,x=d*t,b=this.viewportTransform,w=[x,0,0,x,(b[4]-(o||0))*t,(b[5]-(a||0))*t],T=this.enableRetinaScaling,E=Cn({width:h,height:f}),M=c?this._objects.filter(C=>c(C)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=w,this.width=h,this.height=f,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(E.getContext("2d"),M),this.viewportTransform=b,this.width=p,this.height=y,this.calcViewportBoundaries(),this.enableRetinaScaling=T,this.skipControlsDrawing=v,E}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),ih.cancelByCanvas(this),this.disposed=!0,new Promise((t,e)=>{const i=()=>{this.destroy(),t(!0)};i.kill=e,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?t(!1):this.nextRenderHandle?this.__cleanupTask=i:i()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(t=>t.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return`#<Canvas (${this.complexity()}): { objects: ${this._objects.length} }>`}}V(Cl,"ownDefaults",U5);const P5=["touchstart","touchmove","touchend"],Y5=s=>{const t=GS(s.target),e=(function(i){const o=i.changedTouches;return o&&o[0]?o[0]:i})(s);return new tt(e.clientX+t.left,e.clientY+t.top)},np=s=>P5.includes(s.type)||s.pointerType==="touch",c1=s=>{s.preventDefault(),s.stopPropagation()},Li=s=>{let t=0,e=0,i=0,o=0;for(let a=0,c=s.length;a<c;a++){const{x:h,y:f}=s[a];(h>i||!a)&&(i=h),(h<t||!a)&&(t=h),(f>o||!a)&&(o=f),(f<e||!a)&&(e=f)}return{left:t,top:e,width:i-t,height:o-e}},V5=(s,t)=>rh(s,De(t,s.calcOwnMatrix())),rh=(s,t)=>{const{translateX:e,translateY:i,scaleX:o,scaleY:a,...c}=sh(t),h=new tt(e,i);s.flipX=!1,s.flipY=!1,Object.assign(s,c),s.set({scaleX:o,scaleY:a}),s.setPositionByOrigin(h,Dt,Dt)},X5=s=>{s.scaleX=1,s.scaleY=1,s.skewX=0,s.skewY=0,s.flipX=!1,s.flipY=!1,s.rotate(0)},ZS=s=>({scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,angle:s.angle,left:s.left,flipX:s.flipX,flipY:s.flipY,top:s.top}),Yp=(s,t,e)=>{const i=s/2,o=t/2,a=[new tt(-i,-o),new tt(i,-o),new tt(-i,o),new tt(i,o)].map(h=>h.transform(e)),c=Li(a);return new tt(c.width,c.height)},jh=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ue;return De(Un(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ue),s)},jo=function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ue,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ue;return s.transform(jh(t,e))},F5=function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ue,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ue;return s.transform(jh(t,e),!0)},I5=(s,t,e)=>{const i=jh(t,e);return rh(s,De(i,s.calcOwnMatrix())),i},G5={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Be=s=>typeof s=="string"?G5[s]:s-.5,$5=new tt(1,0),KS=new tt,QS=(s,t)=>s.rotate(t),oh=(s,t)=>new tt(t).subtract(s),ip=s=>s.distanceFrom(KS),sp=(s,t)=>Math.atan2(Za(s,t),q5(s,t)),JS=s=>sp($5,s),Vp=s=>s.eq(KS)?s:s.scalarDivide(ip(s)),t_=function(s){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Vp(new tt(-s.y,s.x).scalarMultiply(t?1:-1))},Za=(s,t)=>s.x*t.y-s.y*t.x,q5=(s,t)=>s.x*t.x+s.y*t.y,u1=(s,t,e)=>{if(s.eq(t)||s.eq(e))return!0;const i=Za(t,e),o=Za(t,s),a=Za(e,s);return i>=0?o>=0&&a<=0:!(o<=0&&a>=0)},ah="not-allowed";function e_(s){return Be(s.originX)===Be(Dt)&&Be(s.originY)===Be(Dt)}function h1(s){return .5-Be(s)}const Pn=(s,t)=>s[t],n_=(s,t,e,i)=>({e:s,transform:t,pointer:new tt(e,i)});function i_(s,t,e){const i=e,o=jo(s.getCenterPoint(),s.canvas.viewportTransform,void 0),a=JS(oh(o,i))+ko;return Math.round(a%ko/A5)}function Xp(s,t,e,i,o){var a;let{target:c,corner:h}=s;const f=c.controls[h],d=((a=c.canvas)===null||a===void 0?void 0:a.getZoom())||1,p=c.padding/d,y=(function(v,x,b,w){const T=v.getRelativeCenterPoint(),E=b!==void 0&&w!==void 0?v.translateToGivenOrigin(T,Dt,Dt,b,w):new tt(v.left,v.top);return(v.angle?x.rotate(-ce(v.angle),T):x).subtract(E)})(c,new tt(i,o),t,e);return y.x>=p&&(y.x-=p),y.x<=-p&&(y.x+=p),y.y>=p&&(y.y-=p),y.y<=p&&(y.y+=p),y.x-=f.offsetX,y.y-=f.offsetY,y}const lh=s=>s.replace(/\s+/g," "),f1={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Tg=(s,t,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?s+6*(t-s)*e:e<.5?t:e<2/3?s+(t-s)*(2/3-e)*6:s),d1=(s,t,e,i)=>{s/=255,t/=255,e/=255;const o=Math.max(s,t,e),a=Math.min(s,t,e);let c,h;const f=(o+a)/2;if(o===a)c=h=0;else{const d=o-a;switch(h=f>.5?d/(2-o-a):d/(o+a),o){case s:c=(t-e)/d+(t<e?6:0);break;case t:c=(e-s)/d+2;break;case e:c=(s-t)/d+4}c/=6}return[Math.round(360*c),Math.round(100*h),Math.round(100*f),i]},g1=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(s)/(s.endsWith("%")?100:1)},ru=s=>Math.min(Math.round(s),255).toString(16).toUpperCase().padStart(2,"0"),p1=s=>{let[t,e,i,o=1]=s;const a=Math.round(.3*t+.59*e+.11*i);return[a,a,a,o]};class Wt{constructor(t){if(V(this,"isUnrecognised",!1),t)if(t instanceof Wt)this.setSource([...t._source]);else if(Array.isArray(t)){const[e,i,o,a=1]=t;this.setSource([e,i,o,a])}else this.setSource(this._tryParsingColor(t));else this.setSource([0,0,0,1])}_tryParsingColor(t){return(t=t.toLowerCase())in f1&&(t=f1[t]),t==="transparent"?[255,255,255,0]:Wt.sourceFromHex(t)||Wt.sourceFromRgb(t)||Wt.sourceFromHsl(t)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(t){this._source=t}toRgb(){const[t,e,i]=this.getSource();return`rgb(${t},${e},${i})`}toRgba(){return`rgba(${this.getSource().join(",")})`}toHsl(){const[t,e,i]=d1(...this.getSource());return`hsl(${t},${e}%,${i}%)`}toHsla(){const[t,e,i,o]=d1(...this.getSource());return`hsla(${t},${e}%,${i}%,${o})`}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[t,e,i,o]=this.getSource();return`${ru(t)}${ru(e)}${ru(i)}${ru(Math.round(255*o))}`}getAlpha(){return this.getSource()[3]}setAlpha(t){return this._source[3]=t,this}toGrayscale(){return this.setSource(p1(this.getSource())),this}toBlackWhite(t){const[e,,,i]=p1(this.getSource()),o=e<(t||127)?0:255;return this.setSource([o,o,o,i]),this}overlayWith(t){t instanceof Wt||(t=new Wt(t));const e=this.getSource(),i=t.getSource(),[o,a,c]=e.map((h,f)=>Math.round(.5*h+.5*i[f]));return this.setSource([o,a,c,e[3]]),this}static fromRgb(t){return Wt.fromRgba(t)}static fromRgba(t){return new Wt(Wt.sourceFromRgb(t))}static sourceFromRgb(t){const e=lh(t).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(e){const[i,o,a]=e.slice(1,4).map(c=>{const h=parseFloat(c);return c.endsWith("%")?Math.round(2.55*h):h});return[i,o,a,g1(e[4])]}}static fromHsl(t){return Wt.fromHsla(t)}static fromHsla(t){return new Wt(Wt.sourceFromHsl(t))}static sourceFromHsl(t){const e=lh(t).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!e)return;const i=(Wt.parseAngletoDegrees(e[1])%360+360)%360/360,o=parseFloat(e[2])/100,a=parseFloat(e[3])/100;let c,h,f;if(o===0)c=h=f=a;else{const d=a<=.5?a*(o+1):a+o-a*o,p=2*a-d;c=Tg(p,d,i+1/3),h=Tg(p,d,i),f=Tg(p,d,i-1/3)}return[Math.round(255*c),Math.round(255*h),Math.round(255*f),g1(e[4])]}static fromHex(t){return new Wt(Wt.sourceFromHex(t))}static sourceFromHex(t){if(t.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const e=t.slice(t.indexOf("#")+1);let i;i=e.length<=4?e.split("").map(f=>f+f):e.match(/.{2}/g);const[o,a,c,h=255]=i.map(f=>parseInt(f,16));return[o,a,c,h/255]}}static parseAngletoDegrees(t){const e=t.toLowerCase(),i=parseFloat(e);return e.includes("rad")?Ms(i):e.includes("turn")?360*i:i}}const bo=function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rp;const e=/\D{0,2}$/.exec(s),i=parseFloat(s),o=Bt.DPI;switch(e?.[0]){case"mm":return i*o/25.4;case"cm":return i*o/2.54;case"in":return i*o;case"pt":return i*o/72;case"pc":return i*o/72*12;case"em":return i*t;default:return i}},W5=s=>{const[t,e]=s.trim().split(" "),[i,o]=(a=t)&&a!==Ke?[a.slice(1,4),a.slice(5,8)]:a===Ke?[a,a]:["Mid","Mid"];var a;return{meetOrSlice:e||"meet",alignX:i,alignY:o}},fl=function(s,t){let e,i,o=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(t)if(t.toLive)e=`url(#SVGID_${t.id})`;else{const a=new Wt(t),c=a.getAlpha();e=a.toRgb(),c!==1&&(i=c.toString())}else e="none";return o?`${s}: ${e}; ${i?`${s}-opacity: ${i}; `:""}`:`${s}="${e}" ${i?`${s}-opacity="${i}" `:""}`};class s_{getSvgStyles(t){const e=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",o=this.strokeDashArray?this.strokeDashArray.join(" "):Ke,a=this.strokeDashOffset?this.strokeDashOffset:"0",c=this.strokeLineCap?this.strokeLineCap:"butt",h=this.strokeLineJoin?this.strokeLineJoin:"miter",f=this.strokeMiterLimit?this.strokeMiterLimit:"4",d=this.opacity!==void 0?this.opacity:"1",p=this.visible?"":" visibility: hidden;",y=t?"":this.getSvgFilter(),v=fl(Se,this.fill);return[fl(un,this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",o,"; ","stroke-linecap: ",c,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",h,"; ","stroke-miterlimit: ",f,"; ",v,"fill-rule: ",e,"; ","opacity: ",d,";",y,p].join("")}getSvgFilter(){return this.shadow?`filter: url(#SVGID_${this.shadow.id});`:""}getSvgCommons(){return[this.id?`id="${this.id}" `:"",this.clipPath?`clip-path="url(#${this.clipPath.clipPathId})" `:""].join("")}getSvgTransform(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=t?this.calcTransformMatrix():this.calcOwnMatrix();return`${`transform="${hl(i)}`}${e}" `}_toSVG(t){return[""]}toSVG(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})}toClipPathSVG(t){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})}_createBaseClipPathSVGMarkup(t){let{reviver:e,additionalTransform:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),a=t.indexOf("COMMON_PARTS");return t[a]=o,e?e(t.join("")):t.join("")}_createBaseSVGMarkup(t){let{noStyle:e,reviver:i,withShadow:o,additionalTransform:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=e?"":`style="${this.getSvgStyles()}" `,h=o?`style="${this.getSvgFilter()}" `:"",f=this.clipPath,d=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",p=f&&f.absolutePositioned,y=this.stroke,v=this.fill,x=this.shadow,b=[],w=t.indexOf("COMMON_PARTS");let T;f&&(f.clipPathId=`CLIPPATH_${Es()}`,T=`<clipPath id="${f.clipPathId}" >
${f.toClipPathSVG(i)}</clipPath>
`),p&&b.push("<g ",h,this.getSvgCommons(),` >
`),b.push("<g ",this.getSvgTransform(!1),p?"":h+this.getSvgCommons(),` >
`);const E=[c,d,e?"":this.addPaintOrder()," ",a?`transform="${a}" `:""].join("");return t[w]=E,_n(v)&&b.push(v.toSVG(this)),_n(y)&&b.push(y.toSVG(this)),x&&b.push(x.toSVG(this)),f&&b.push(T),b.push(t.join("")),b.push(`</g>
`),p&&b.push(`</g>
`),i?i(b.join("")):b.join("")}addPaintOrder(){return this.paintFirst!==Se?` paint-order="${this.paintFirst}" `:""}}function Nh(s){return new RegExp("^("+s.join("|")+")\\b","i")}const vr="textDecorationThickness",r_=["fontSize","fontWeight","fontFamily","fontStyle"],o_=["underline","overline","linethrough"],a_=[...r_,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],l_=[...a_,...o_,"textBackgroundColor","direction",vr],Z5=[...r_,...o_,un,"strokeWidth",Se,"deltaY","textBackgroundColor",vr],K5={_reNewline:zp,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:tp,fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Yt,fontStyle:tp,lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Yt,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:nr,CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[vr]:66.667},Qn="justify",ch="justify-left",Ka="justify-right",Qa="justify-center",xr=String.raw`[-+]?(?:\d*\.\d+|\d+\.?)(?:[eE][-+]?\d+)?`,Q5=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+xr+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+xr+"))?\\s+(.*)"),J5={cx:Yt,x:Yt,r:"radius",cy:Ze,y:Ze,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":vr},Eg="font-size",Mg="clip-path";Nh(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);Nh(["symbol","image","marker","pattern","view","svg"]);const m1=Nh(["symbol","g","a","svg","clipPath","defs"]),y1="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",v1=new RegExp("(?:\\s|^)"+y1+y1+"("+xr+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class ti{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof t=="string"?ti.parseShadow(t):t;Object.assign(this,ti.ownDefaults,e),this.id=Es()}static parseShadow(t){const e=t.trim(),[,i=0,o=0,a=0]=(v1.exec(e)||[]).map(c=>parseFloat(c)||0);return{color:(e.replace(v1,"")||"rgb(0,0,0)").trim(),offsetX:i,offsetY:o,blur:a}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(t){const e=QS(new tt(this.offsetX,this.offsetY),ce(-t.angle)),i=new Wt(this.color);let o=40,a=40;return t.width&&t.height&&(o=100*Kt((Math.abs(e.x)+this.blur)/t.width,Bt.NUM_FRACTION_DIGITS)+20,a=100*Kt((Math.abs(e.y)+this.blur)/t.height,Bt.NUM_FRACTION_DIGITS)+20),t.flipX&&(e.x*=-1),t.flipY&&(e.y*=-1),`<filter id="SVGID_${this.id}" y="-${a}%" height="${100+2*a}%" x="-${o}%" width="${100+2*o}%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="${Kt(this.blur?this.blur/2:0,Bt.NUM_FRACTION_DIGITS)}"></feGaussianBlur>
	<feOffset dx="${Kt(e.x,Bt.NUM_FRACTION_DIGITS)}" dy="${Kt(e.y,Bt.NUM_FRACTION_DIGITS)}" result="oBlur" ></feOffset>
	<feFlood flood-color="${i.toRgb()}" flood-opacity="${i.getAlpha()}"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`}toObject(){const t={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},e=ti.ownDefaults;return this.includeDefaultValues?t:Pp(t,(i,o)=>i!==e[o])}static async fromObject(t){return new this(t)}}V(ti,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),V(ti,"type","shadow"),mt.setClass(ti,"shadow");const No=(s,t,e)=>Math.max(s,Math.min(t,e)),tk=[Ze,Yt,Qe,wn,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Bo,Ho],Vi=[Se,un,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],ek={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Dt,originY:Dt,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Se,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},nk=(s,t,e,i)=>-e*Math.cos(s/i*_l)+e+t,ik=()=>!1;class Fp{constructor(t){let{startValue:e,byValue:i,duration:o=500,delay:a=0,easing:c=nk,onStart:h=Bu,onChange:f=Bu,onComplete:d=Bu,abort:p=ik,target:y}=t;V(this,"_state","pending"),V(this,"durationProgress",0),V(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=o,this.delay=a,this.easing=c,this._onStart=h,this._onChange=f,this._onComplete=d,this._abort=p,this.target=y,this.startValue=e,this.byValue=i,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const t=e=>{this._state==="pending"&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>Uu(t),this.delay):Uu(t)}tick(t){const e=(t||+new Date)-this.startTime,i=Math.min(e,this.duration);this.durationProgress=i/this.duration;const{value:o,valueProgress:a}=this.calculate(i);this.value=Object.freeze(o),this.valueProgress=a,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):e>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Uu(this.tick)))}register(){ih.push(this)}unregister(){ih.remove(this)}abort(){this._state="aborted",this.unregister()}}class sk extends Fp{constructor(t){let{startValue:e=0,endValue:i=100,...o}=t;super({...o,startValue:e,byValue:i-e})}calculate(t){const e=this.easing(t,this.startValue,this.byValue,this.duration);return{value:e,valueProgress:Math.abs((e-this.startValue)/this.byValue)}}}class rk extends Fp{constructor(t){let{startValue:e=[0],endValue:i=[100],...o}=t;super({...o,startValue:e,byValue:i.map((a,c)=>a-e[c])})}calculate(t){const e=this.startValue.map((i,o)=>this.easing(t,i,this.byValue[o],this.duration,o));return{value:e,valueProgress:Math.abs((e[0]-this.startValue[0])/this.byValue[0])}}}const ok=(s,t,e,i)=>t+e*(1-Math.cos(s/i*_l)),Dg=s=>s&&((t,e,i)=>s(new Wt(t).toRgba(),e,i));class ak extends Fp{constructor(t){let{startValue:e,endValue:i,easing:o=ok,onChange:a,onComplete:c,abort:h,...f}=t;const d=new Wt(e).getSource(),p=new Wt(i).getSource();super({...f,startValue:d,byValue:p.map((y,v)=>y-d[v]),easing:o,onChange:Dg(a),onComplete:Dg(c),abort:Dg(h)})}calculate(t){const[e,i,o,a]=this.startValue.map((h,f)=>this.easing(t,h,this.byValue[f],this.duration,f)),c=[...[e,i,o].map(Math.round),No(0,a,1)];return{value:c,valueProgress:c.map((h,f)=>this.byValue[f]!==0?Math.abs((h-this.startValue[f])/this.byValue[f]):0).find(h=>h!==0)||0}}}function c_(s){const t=(e=>Array.isArray(e.startValue)||Array.isArray(e.endValue))(s)?new rk(s):new sk(s);return t.start(),t}function lk(s){const t=new ak(s);return t.start(),t}class ie{constructor(t){this.status=t,this.points=[]}includes(t){return this.points.some(e=>e.eq(t))}append(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.points=this.points.concat(e.filter(o=>!this.includes(o))),this}static isPointContained(t,e,i){let o=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e.eq(i))return t.eq(e);if(e.x===i.x)return t.x===e.x&&(o||t.y>=Math.min(e.y,i.y)&&t.y<=Math.max(e.y,i.y));if(e.y===i.y)return t.y===e.y&&(o||t.x>=Math.min(e.x,i.x)&&t.x<=Math.max(e.x,i.x));{const a=oh(e,i),c=oh(e,t).divide(a);return o?Math.abs(c.x)===Math.abs(c.y):c.x===c.y&&c.x>=0&&c.x<=1}}static isPointInPolygon(t,e){const i=new tt(t).setX(Math.min(t.x-1,...e.map(a=>a.x)));let o=0;for(let a=0;a<e.length;a++){const c=this.intersectSegmentSegment(e[a],e[(a+1)%e.length],t,i);if(c.includes(t))return!0;o+=+(c.status==="Intersection")}return o%2==1}static intersectLineLine(t,e,i,o){let a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],c=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const h=e.x-t.x,f=e.y-t.y,d=o.x-i.x,p=o.y-i.y,y=t.x-i.x,v=t.y-i.y,x=d*v-p*y,b=h*v-f*y,w=p*h-d*f;if(w!==0){const T=x/w,E=b/w;return(a||0<=T&&T<=1)&&(c||0<=E&&E<=1)?new ie("Intersection").append(new tt(t.x+T*h,t.y+T*f)):new ie}if(x===0||b===0){const T=a||c||ie.isPointContained(t,i,o)||ie.isPointContained(e,i,o)||ie.isPointContained(i,t,e)||ie.isPointContained(o,t,e);return new ie(T?"Coincident":void 0)}return new ie("Parallel")}static intersectSegmentLine(t,e,i,o){return ie.intersectLineLine(t,e,i,o,!1,!0)}static intersectSegmentSegment(t,e,i,o){return ie.intersectLineLine(t,e,i,o,!1,!1)}static intersectLinePolygon(t,e,i){let o=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const a=new ie,c=i.length;for(let h,f,d,p=0;p<c;p++){if(h=i[p],f=i[(p+1)%c],d=ie.intersectLineLine(t,e,h,f,o,!1),d.status==="Coincident")return d;a.append(...d.points)}return a.points.length>0&&(a.status="Intersection"),a}static intersectSegmentPolygon(t,e,i){return ie.intersectLinePolygon(t,e,i,!1)}static intersectPolygonPolygon(t,e){const i=new ie,o=t.length,a=[];for(let c=0;c<o;c++){const h=t[c],f=t[(c+1)%o],d=ie.intersectSegmentPolygon(h,f,e);d.status==="Coincident"?(a.push(d),i.append(h,f)):i.append(...d.points)}return a.length>0&&a.length===t.length?new ie("Coincident"):(i.points.length>0&&(i.status="Intersection"),i)}static intersectPolygonRectangle(t,e,i){const o=e.min(i),a=e.max(i),c=new tt(a.x,o.y),h=new tt(o.x,a.y);return ie.intersectPolygonPolygon(t,[o,c,a,h])}}class ck extends US{getX(){return this.getXY().x}setX(t){this.setXY(this.getXY().setX(t))}getY(){return this.getXY().y}setY(t){this.setXY(this.getXY().setY(t))}getRelativeX(){return this.left}setRelativeX(t){this.left=t}getRelativeY(){return this.top}setRelativeY(t){this.top=t}getXY(){const t=this.getRelativeXY();return this.group?qe(t,this.group.calcTransformMatrix()):t}setXY(t,e,i){this.group&&(t=qe(t,Un(this.group.calcTransformMatrix()))),this.setRelativeXY(t,e,i)}getRelativeXY(){return new tt(this.left,this.top)}setRelativeXY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(t,e,i)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:t,tr:e,br:i,bl:o}=this.aCoords||(this.aCoords=this.calcACoords()),a=[t,e,i,o];if(this.group){const c=this.group.calcTransformMatrix();return a.map(h=>qe(h,c))}return a}intersectsWithRect(t,e){return ie.intersectPolygonRectangle(this.getCoords(),t,e).status==="Intersection"}intersectsWithObject(t){const e=ie.intersectPolygonPolygon(this.getCoords(),t.getCoords());return e.status==="Intersection"||e.status==="Coincident"||t.isContainedWithinObject(this)||this.isContainedWithinObject(t)}isContainedWithinObject(t){return this.getCoords().every(e=>t.containsPoint(e))}isContainedWithinRect(t,e){const{left:i,top:o,width:a,height:c}=this.getBoundingRect();return i>=t.x&&i+a<=e.x&&o>=t.y&&o+c<=e.y}isOverlapping(t){return this.intersectsWithObject(t)||this.isContainedWithinObject(t)||t.isContainedWithinObject(this)}containsPoint(t){return ie.isPointInPolygon(t,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return!!this.getCoords().some(i=>i.x<=e.x&&i.x>=t.x&&i.y<=e.y&&i.y>=t.y)||!!this.intersectsWithRect(t,e)||this.containsPoint(t.midPointFrom(e))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return this.intersectsWithRect(t,e)?!0:this.getCoords().every(i=>(i.x>=e.x||i.x<=t.x)&&(i.y>=e.y||i.y<=t.y))&&this.containsPoint(t.midPointFrom(e))}getBoundingRect(){return Li(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(t){this._set(Qe,t),this._set(wn,t),this.setCoords()}scaleToWidth(t){const e=this.getBoundingRect().width/this.getScaledWidth();return this.scale(t/this.width/e)}scaleToHeight(t){const e=this.getBoundingRect().height/this.getScaledHeight();return this.scale(t/this.height/e)}getCanvasRetinaScaling(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.getRetinaScaling())||1}getTotalAngle(){return this.group?Ms(VS(this.calcTransformMatrix())):this.angle}getViewportTransform(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.viewportTransform)||Ue.concat()}calcACoords(){const t=Uo({angle:this.angle}),{x:e,y:i}=this.getRelativeCenterPoint(),o=wl(e,i),a=De(o,t),c=this._getTransformedDimensions(),h=c.x/2,f=c.y/2;return{tl:qe({x:-h,y:-f},a),tr:qe({x:h,y:-f},a),bl:qe({x:-h,y:f},a),br:qe({x:h,y:f},a)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=[];return!t&&this.group&&(e=this.group.transformMatrixKey(t)),e.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Be(this.originX),Be(this.originY)),e}calcTransformMatrix(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=this.calcOwnMatrix();if(t||!this.group)return e;const i=this.transformMatrixKey(t),o=this.matrixCache;return o&&o.key.every((a,c)=>a===i[c])?o.value:(this.group&&(e=De(this.group.calcTransformMatrix(!1),e)),this.matrixCache={key:i,value:e},e)}calcOwnMatrix(){const t=this.transformMatrixKey(!0),e=this.ownMatrixCache;if(e&&e.key.every((c,h)=>c===t[h]))return e.value;const i=this.getRelativeCenterPoint(),o={angle:this.angle,translateX:i.x,translateY:i.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},a=H5(o);return this.ownMatrixCache={key:t,value:a},a}_getNonTransformedDimensions(){return new tt(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(t){return this._getTransformedDimensions(t).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth,...t},i=e.strokeWidth;let o=i,a=0;this.strokeUniform&&(o=0,a=i);const c=e.width+o,h=e.height+o;let f;return f=e.skewX===0&&e.skewY===0?new tt(c*e.scaleX,h*e.scaleY):Yp(c,h,Ah(e)),f.scalarAdd(a)}translateToGivenOrigin(t,e,i,o,a){let c=t.x,h=t.y;const f=Be(o)-Be(e),d=Be(a)-Be(i);if(f||d){const p=this._getTransformedDimensions();c+=f*p.x,h+=d*p.y}return new tt(c,h)}translateToCenterPoint(t,e,i){if(e===Dt&&i===Dt)return t;const o=this.translateToGivenOrigin(t,e,i,Dt,Dt);return this.angle?o.rotate(ce(this.angle),t):o}translateToOriginPoint(t,e,i){const o=this.translateToGivenOrigin(t,Dt,Dt,e,i);return this.angle?o.rotate(ce(this.angle),t):o}getCenterPoint(){const t=this.getRelativeCenterPoint();return this.group?qe(t,this.group.calcTransformMatrix()):t}getRelativeCenterPoint(){return this.translateToCenterPoint(new tt(this.left,this.top),this.originX,this.originY)}getPointByOrigin(t,e){return this.getPositionByOrigin(t,e)}getPositionByOrigin(t,e){return this.translateToOriginPoint(this.getRelativeCenterPoint(),t,e)}setPositionByOrigin(t,e,i){const o=this.translateToCenterPoint(t,e,i),a=this.translateToOriginPoint(o,this.originX,this.originY);this.set({left:a.x,top:a.y})}_getLeftTopCoords(){return this.getPositionByOrigin(Yt,Ze)}positionByLeftTop(t){return this.setPositionByOrigin(t,Yt,Ze)}}let Di=class Yu extends ck{static getDefaults(){return Yu.ownDefaults}get type(){const t=this.constructor.type;return t==="FabricObject"?"object":t.toLowerCase()}set type(t){Ts("warn","Setting type has no effect",t)}constructor(t){super(),V(this,"_cacheContext",null),Object.assign(this,Yu.ownDefaults),this.setOptions(t)}_createCacheCanvas(){this._cacheCanvas=Pi(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(t){const e=t.width,i=t.height,o=Bt.maxCacheSideLimit,a=Bt.minCacheSideLimit;if(e<=o&&i<=o&&e*i<=Bt.perfLimitSizeTotal)return e<a&&(t.width=a),i<a&&(t.height=a),t;const c=e/i,[h,f]=Wa.limitDimsByArea(c),d=No(a,h,o),p=No(a,f,o);return e>d&&(t.zoomX/=e/d,t.width=d,t.capped=!0),i>p&&(t.zoomY/=i/p,t.height=p,t.capped=!0),t}_getCacheCanvasDimensions(){const t=this.getTotalObjectScaling(),e=this._getTransformedDimensions({skewX:0,skewY:0}),i=e.x*t.x/this.scaleX,o=e.y*t.y/this.scaleY;return{width:Math.ceil(i+2),height:Math.ceil(o+2),zoomX:t.x,zoomY:t.y,x:i,y:o}}_updateCacheCanvas(){const t=this._cacheCanvas,e=this._cacheContext,{width:i,height:o,zoomX:a,zoomY:c,x:h,y:f}=this._limitCacheSize(this._getCacheCanvasDimensions()),d=i!==t.width||o!==t.height,p=this.zoomX!==a||this.zoomY!==c;if(!t||!e)return!1;if(d||p){i!==t.width||o!==t.height?(t.width=i,t.height=o):(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height));const y=h/2,v=f/2;return this.cacheTranslationX=Math.round(t.width/2-y)+y,this.cacheTranslationY=Math.round(t.height/2-v)+v,e.translate(this.cacheTranslationX,this.cacheTranslationY),e.scale(a,c),this.zoomX=a,this.zoomY=c,!0}return!1}setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(t)}transform(t){const e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,i=this.calcTransformMatrix(!e);t.transform(i[0],i[1],i[2],i[3],i[4],i[5])}getObjectScaling(){if(!this.group)return new tt(Math.abs(this.scaleX),Math.abs(this.scaleY));const t=sh(this.calcTransformMatrix());return new tt(Math.abs(t.scaleX),Math.abs(t.scaleY))}getTotalObjectScaling(){const t=this.getObjectScaling();if(this.canvas){const e=this.canvas.getZoom(),i=this.getCanvasRetinaScaling();return t.scalarMultiply(e*i)}return t}getObjectOpacity(){let t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t}_constrainScale(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t===0?1e-4:t}_set(t,e){t!==Qe&&t!==wn||(e=this._constrainScale(e)),t===Qe&&e<0?(this.flipX=!this.flipX,e*=-1):t==="scaleY"&&e<0?(this.flipY=!this.flipY,e*=-1):t!=="shadow"||!e||e instanceof ti||(e=new ti(e));const i=this[t]!==e;return this[t]=e,i&&this.constructor.cacheProperties.includes(t)&&(this.dirty=!0),this.parent&&(this.dirty||i&&this.constructor.stateProperties.includes(t))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.drawObject(t,!1,{}),this.dirty=!1),t.restore())}drawSelectionBackground(t){}renderCache(t){if(t=t||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:e,zoomY:i,cacheTranslationX:o,cacheTranslationY:a}=this,{width:c,height:h}=this._cacheCanvas;this.drawObject(this._cacheContext,t.forClipping,{zoomX:e,zoomY:i,cacheTranslationX:o,cacheTranslationY:a,width:c,height:h,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return!!this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return!!this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===un&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(t,e,i){t.save(),e.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",t.setTransform(1,0,0,1,0,0),t.drawImage(i,0,0),t.restore()}drawObject(t,e,i){const o=this.fill,a=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t,this.clipPath,i),this.fill=o,this.stroke=a}createClipPathLayer(t,e){const i=Cn(e),o=i.getContext("2d");if(o.translate(e.cacheTranslationX,e.cacheTranslationY),o.scale(e.zoomX,e.zoomY),t._cacheCanvas=i,e.parentClipPaths.forEach(a=>{a.transform(o)}),e.parentClipPaths.push(t),t.absolutePositioned){const a=Un(this.calcTransformMatrix());o.transform(a[0],a[1],a[2],a[3],a[4],a[5])}return t.transform(o),t.drawObject(o,!0,e),i}_drawClipPath(t,e,i){if(!e)return;e._transformDone=!0;const o=this.createClipPathLayer(e,i);this.drawClipPathOnCache(t,e,o)}drawCacheOnCanvas(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const e=this._cacheCanvas,i=this._cacheContext;return!(!e||!i||t||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(e&&i&&!t&&(i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),i.restore()),!0)}_renderBackground(t){if(!this.backgroundColor)return;const e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}_setOpacity(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity}_setStrokeStyles(t,e){const i=e.stroke;i&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,_n(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?this._applyPatternForTransformedGradient(t,i):(t.strokeStyle=i.toLive(t),this._applyPatternGradientTransform(t,i)):t.strokeStyle=e.stroke)}_setFillStyles(t,e){let{fill:i}=e;i&&(_n(i)?(t.fillStyle=i.toLive(t),this._applyPatternGradientTransform(t,i)):t.fillStyle=i)}_setClippingProperties(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"}_setLineDash(t,e){e&&e.length!==0&&t.setLineDash(e)}_setShadow(t){if(!this.shadow)return;const e=this.shadow,i=this.canvas,o=this.getCanvasRetinaScaling(),[a,,,c]=i?.viewportTransform||Ue,h=a*o,f=c*o,d=e.nonScaling?new tt(1,1):this.getObjectScaling();t.shadowColor=e.color,t.shadowBlur=e.blur*Bt.browserShadowBlurConstant*(h+f)*(d.x+d.y)/4,t.shadowOffsetX=e.offsetX*h*d.x,t.shadowOffsetY=e.offsetY*f*d.y}_removeShadow(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)}_applyPatternGradientTransform(t,e){if(!_n(e))return{offsetX:0,offsetY:0};const i=e.gradientTransform||e.patternTransform,o=-this.width/2+e.offsetX||0,a=-this.height/2+e.offsetY||0;return e.gradientUnits==="percentage"?t.transform(this.width,0,0,this.height,o,a):t.transform(1,0,0,1,o,a),i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:o,offsetY:a}}_renderPaintInOrder(t){this.paintFirst===un?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))}_render(t){}_renderFill(t){this.fill&&(t.save(),this._setFillStyles(t,this),this.fillRule==="evenodd"?t.fill("evenodd"):t.fill(),t.restore())}_renderStroke(t){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform){const e=this.getObjectScaling();t.scale(1/e.x,1/e.y)}this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}}_applyPatternForTransformedGradient(t,e){var i;const o=this._limitCacheSize(this._getCacheCanvasDimensions()),a=this.getCanvasRetinaScaling(),c=o.x/this.scaleX/a,h=o.y/this.scaleY/a,f=Cn({width:Math.ceil(c),height:Math.ceil(h)}),d=f.getContext("2d");d&&(d.beginPath(),d.moveTo(0,0),d.lineTo(c,0),d.lineTo(c,h),d.lineTo(0,h),d.closePath(),d.translate(c/2,h/2),d.scale(o.zoomX/this.scaleX/a,o.zoomY/this.scaleY/a),this._applyPatternGradientTransform(d,e),d.fillStyle=e.toLive(t),d.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(a*this.scaleX/o.zoomX,a*this.scaleY/o.zoomY),t.strokeStyle=(i=d.createPattern(f,"no-repeat"))!==null&&i!==void 0?i:"")}_findCenterFromElement(){return new tt(this.left+this.width/2,this.top+this.height/2)}clone(t){const e=this.toObject(t);return this.constructor.fromObject(e)}cloneAsImage(t){const e=this.toCanvasElement(t);return new(mt.getClass("image"))(e)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=ZS(this),i=this.group,o=this.shadow,a=Math.abs,c=t.enableRetinaScaling?RS():1,h=(t.multiplier||1)*c,f=t.canvasProvider||(M=>new Cl(M,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,t.withoutTransform&&X5(this),t.withoutShadow&&(this.shadow=null),t.viewportTransform&&I5(this,this.getViewportTransform()),this.setCoords();const d=Pi(),p=this.getBoundingRect(),y=this.shadow,v=new tt;if(y){const M=y.blur,C=y.nonScaling?new tt(1,1):this.getObjectScaling();v.x=2*Math.round(a(y.offsetX)+M)*a(C.x),v.y=2*Math.round(a(y.offsetY)+M)*a(C.y)}const x=p.width+v.x,b=p.height+v.y;d.width=Math.ceil(x),d.height=Math.ceil(b);const w=f(d);t.format==="jpeg"&&(w.backgroundColor="#fff"),this.setPositionByOrigin(new tt(w.width/2,w.height/2),Dt,Dt);const T=this.canvas;w._objects=[this],this.set("canvas",w),this.setCoords();const E=w.toCanvasElement(h||1,t);return this.set("canvas",T),this.shadow=o,i&&(this.group=i),this.set(e),this.setCoords(),w._objects=[],w.destroy(),E}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return PS(this.toCanvasElement(t),t.format||"png",t.quality||1)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return YS(this.toCanvasElement(t),t.format||"png",t.quality||1)}isType(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return e.includes(this.constructor.type)||e.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(t){const{centeredRotation:e,originX:i,originY:o}=this;if(e){const{x:a,y:c}=this.getRelativeCenterPoint();this.originX=Dt,this.originY=Dt,this.left=a,this.top=c}if(this.set("angle",t),e){const{x:a,y:c}=this.getPositionByOrigin(i,o);this.left=a,this.top=c,this.originX=i,this.originY=o}}setOnGroup(){}_setupCompositeOperation(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}dispose(){ih.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&ni().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(t,e){return Object.entries(t).reduce((i,o)=>{let[a,c]=o;return i[a]=this._animate(a,c,e),i},{})}_animate(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=t.split("."),a=this.constructor.colorProperties.includes(o[o.length-1]),{abort:c,startValue:h,onChange:f,onComplete:d}=i,p={...i,target:this,startValue:h??o.reduce((y,v)=>y[v],this),endValue:e,abort:c?.bind(this),onChange:(y,v,x)=>{o.reduce((b,w,T)=>(T===o.length-1&&(b[w]=y),b[w]),this),f&&f(y,v,x)},onComplete:(y,v,x)=>{this.setCoords(),d&&d(y,v,x)}};return a?lk(p):c_(p)}isDescendantOf(t){const{parent:e,group:i}=this;return e===t||i===t||!!e&&e.isDescendantOf(t)||!!i&&i!==e&&i.isDescendantOf(t)}getAncestors(){const t=[];let e=this;do e=e.parent,e&&t.push(e);while(e);return t}findCommonAncestors(t){if(this===t)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const e=this.getAncestors(),i=t.getAncestors();if(e.length===0&&i.length>0&&this===i[i.length-1])return{fork:[],otherFork:[t,...i.slice(0,i.length-1)],common:[this]};for(let o,a=0;a<e.length;a++){if(o=e[a],o===t)return{fork:[this,...e.slice(0,a)],otherFork:[],common:e.slice(a)};for(let c=0;c<i.length;c++){if(this===i[c])return{fork:[],otherFork:[t,...i.slice(0,c)],common:[this,...e]};if(o===i[c])return{fork:[this,...e.slice(0,a)],otherFork:[t,...i.slice(0,c)],common:e.slice(a)}}}return{fork:[this,...e],otherFork:[t,...i],common:[]}}hasCommonAncestors(t){const e=this.findCommonAncestors(t);return e&&!!e.common.length}isInFrontOf(t){if(this===t)return;const e=this.findCommonAncestors(t);if(e.fork.includes(t))return!0;if(e.otherFork.includes(this))return!1;const i=e.common[0]||this.canvas;if(!i)return;const o=e.fork.pop(),a=e.otherFork.pop(),c=i._objects.indexOf(o),h=i._objects.indexOf(a);return c>-1&&c>h}toObject(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Yu.customProperties,this.constructor.customProperties||[]);let e;const i=Bt.NUM_FRACTION_DIGITS,{clipPath:o,fill:a,stroke:c,shadow:h,strokeDashArray:f,left:d,top:p,originX:y,originY:v,width:x,height:b,strokeWidth:w,strokeLineCap:T,strokeDashOffset:E,strokeLineJoin:M,strokeUniform:C,strokeMiterLimit:D,scaleX:j,scaleY:R,angle:z,flipX:U,flipY:G,opacity:ut,visible:W,backgroundColor:Z,fillRule:rt,paintFirst:N,globalCompositeOperation:I,skewX:A,skewY:L}=this;o&&!o.excludeFromExport&&(e=o.toObject(t.concat("inverted","absolutePositioned")));const H=st=>Kt(st,i),q={...Po(this,t),type:this.constructor.type,version:Qg,originX:y,originY:v,left:H(d),top:H(p),width:H(x),height:H(b),fill:o1(a)?a.toObject():a,stroke:o1(c)?c.toObject():c,strokeWidth:H(w),strokeDashArray:f&&f.concat(),strokeLineCap:T,strokeDashOffset:E,strokeLineJoin:M,strokeUniform:C,strokeMiterLimit:H(D),scaleX:H(j),scaleY:H(R),angle:H(z),flipX:U,flipY:G,opacity:H(ut),shadow:h&&h.toObject(),visible:W,backgroundColor:Z,fillRule:rt,paintFirst:N,globalCompositeOperation:I,skewX:H(A),skewY:H(L),...e?{clipPath:e}:null};return this.includeDefaultValues?q:this._removeDefaultValues(q)}toDatalessObject(t){return this.toObject(t)}_removeDefaultValues(t){const e=this.constructor.getDefaults(),i=Object.keys(e).length>0?e:Object.getPrototypeOf(this);return Pp(t,(o,a)=>{if(a===Yt||a===Ze||a==="type")return!0;const c=i[a];return o!==c&&!(Array.isArray(o)&&Array.isArray(c)&&o.length===0&&c.length===0)})}toString(){return`#<${this.constructor.type}>`}static _fromObject(t){let{type:e,...i}=t,{extraParam:o,...a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return kh(i,a).then(c=>o?(delete c[o],new this(i[o],c)):new this(c))}static fromObject(t,e){return this._fromObject(t,e)}};V(Di,"stateProperties",tk),V(Di,"cacheProperties",Vi),V(Di,"ownDefaults",ek),V(Di,"type","FabricObject"),V(Di,"colorProperties",[Se,un,"backgroundColor"]),V(Di,"customProperties",[]),mt.setClass(Di),mt.setClass(Di,"object");const u_=(s,t)=>{var e;const{transform:{target:i}}=t;(e=i.canvas)===null||e===void 0||e.fire(`object:${s}`,{...t,target:i}),i.fire(s,t)},Yo=(s,t,e)=>(i,o,a,c)=>{const h=t(i,o,a,c);return h&&u_(s,{...n_(i,o,a,c),...e}),h};function Vo(s){return(t,e,i,o)=>{const{target:a,originX:c,originY:h}=e,f=a.getPositionByOrigin(c,h),d=s(t,e,i,o);return a.setPositionByOrigin(f,e.originX,e.originY),d}}const uk=(s,t,e,i)=>(o,a,c,h)=>{const f=Xp(a,a.originX,a.originY,c,h)[e],d=Be(a[t]);if(d===0||d>0&&f<0||d<0&&f>0){const{target:p}=a,y=p.strokeWidth/(p.strokeUniform?p[i]:1),v=e_(a)?2:1,x=p[s],b=Math.abs(f*v/p[i])-y;return p.set(s,Math.max(b,1)),x!==p[s]}return!1},hk=uk("width","originX","x","scaleX"),x1=Yo(cl,Vo(hk));function fk(s,t,e,i,o){s.save();const{stroke:a,xSize:c,ySize:h,opName:f}=this.commonRenderProps(s,t,e,o,i);let d=c;c>h?s.scale(1,h/c):h>c&&(d=h,s.scale(c/h,1)),s.beginPath(),s.arc(0,0,d/2,0,ko,!1),s[f](),a&&s.stroke(),s.restore()}function dk(s,t,e,i,o){s.save();const{stroke:a,xSize:c,ySize:h,opName:f}=this.commonRenderProps(s,t,e,o,i),d=c/2,p=h/2;s[`${f}Rect`](-d,-p,c,h),a&&s.strokeRect(-d,-p,c,h),s.restore()}class jn{constructor(t){V(this,"visible",!0),V(this,"actionName",Oh),V(this,"angle",0),V(this,"x",0),V(this,"y",0),V(this,"offsetX",0),V(this,"offsetY",0),V(this,"sizeX",0),V(this,"sizeY",0),V(this,"touchSizeX",0),V(this,"touchSizeY",0),V(this,"cursorStyle","crosshair"),V(this,"withConnection",!1),Object.assign(this,t)}shouldActivate(t,e,i,o){var a;let{tl:c,tr:h,br:f,bl:d}=o;return((a=e.canvas)===null||a===void 0?void 0:a.getActiveObject())===e&&e.isControlVisible(t)&&ie.isPointInPolygon(i,[c,h,f,d])}getActionHandler(t,e,i){return this.actionHandler}getMouseDownHandler(t,e,i){return this.mouseDownHandler}getMouseUpHandler(t,e,i){return this.mouseUpHandler}cursorStyleHandler(t,e,i,o){return e.cursorStyle}getActionName(t,e,i){return e.actionName}getVisibility(t,e){var i,o;return(i=(o=t._controlsVisibility)===null||o===void 0?void 0:o[e])!==null&&i!==void 0?i:this.visible}setVisibility(t,e,i){this.visible=t}positionHandler(t,e,i,o){return new tt(this.x*t.x+this.offsetX,this.y*t.y+this.offsetY).transform(e)}calcCornerCoords(t,e,i,o,a,c){const h=Hp([wl(i,o),Uo({angle:t}),Up((a?this.touchSizeX:this.sizeX)||e,(a?this.touchSizeY:this.sizeY)||e)]);return{tl:new tt(-.5,-.5).transform(h),tr:new tt(.5,-.5).transform(h),br:new tt(.5,.5).transform(h),bl:new tt(-.5,.5).transform(h)}}commonRenderProps(t,e,i,o){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const{cornerSize:c,cornerColor:h,transparentCorners:f,cornerStrokeColor:d}=a,p=c||o.cornerSize,y=this.sizeX||p,v=this.sizeY||p,x=f!==void 0?f:o.transparentCorners,b=x?un:Se,w=d||o.cornerStrokeColor,T=!x&&!!w;return t.fillStyle=h||o.cornerColor||"",t.strokeStyle=w||"",t.translate(e,i),t.rotate(ce(o.getTotalAngle())),{stroke:T,xSize:y,ySize:v,transparentCorners:x,opName:b}}render(t,e,i,o,a){((o=o||{}).cornerStyle||a.cornerStyle)==="circle"?fk.call(this,t,e,i,o,a):dk.call(this,t,e,i,o,a)}}const gk=(s,t,e)=>e.lockRotation?ah:t.cursorStyle,pk=Yo(LS,Vo((s,t,e,i)=>{let{target:o,ex:a,ey:c,theta:h,originX:f,originY:d}=t;const p=o.getPositionByOrigin(f,d);if(Pn(o,"lockRotation"))return!1;const y=Math.atan2(c-p.y,a-p.x),v=Math.atan2(i-p.y,e-p.x);let x=Ms(v-y+h);if(o.snapAngle&&o.snapAngle>0){const w=o.snapAngle,T=o.snapThreshold||w,E=Math.ceil(x/w)*w,M=Math.floor(x/w)*w;Math.abs(x-M)<T?x=M:Math.abs(x-E)<T&&(x=E)}x<0&&(x=360+x),x%=360;const b=o.angle!==x;return o.angle=x,b}));function h_(s,t){const e=t.canvas,i=s[e.uniScaleKey];return e.uniformScaling&&!i||!e.uniformScaling&&i}function f_(s,t,e){const i=Pn(s,"lockScalingX"),o=Pn(s,"lockScalingY");if(i&&o||!t&&(i||o)&&e||i&&t==="x"||o&&t==="y")return!0;const{width:a,height:c,strokeWidth:h}=s;return a===0&&h===0&&t!=="y"||c===0&&h===0&&t!=="x"}const mk=["e","se","s","sw","w","nw","n","ne","e"],Ga=(s,t,e,i)=>{const o=h_(s,e);if(f_(e,t.x!==0&&t.y===0?"x":t.x===0&&t.y!==0?"y":"",o))return ah;const a=i_(e,0,i);return`${mk[a]}-resize`};function Ip(s,t,e,i){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const a=t.target,c=o.by,h=h_(s,a);let f,d,p,y,v,x;if(f_(a,c,h))return!1;if(t.gestureScale)d=t.scaleX*t.gestureScale,p=t.scaleY*t.gestureScale;else{if(f=Xp(t,t.originX,t.originY,e,i),v=c!=="y"?Math.sign(f.x||t.signX||1):1,x=c!=="x"?Math.sign(f.y||t.signY||1):1,t.signX||(t.signX=v),t.signY||(t.signY=x),Pn(a,"lockScalingFlip")&&(t.signX!==v||t.signY!==x))return!1;if(y=a._getTransformedDimensions(),h&&!c){const T=Math.abs(f.x)+Math.abs(f.y),{original:E}=t,M=T/(Math.abs(y.x*E.scaleX/a.scaleX)+Math.abs(y.y*E.scaleY/a.scaleY));d=E.scaleX*M,p=E.scaleY*M}else d=Math.abs(f.x*a.scaleX/y.x),p=Math.abs(f.y*a.scaleY/y.y);e_(t)&&(d*=2,p*=2),t.signX!==v&&c!=="y"&&(t.originX=h1(t.originX),d*=-1,t.signX=v),t.signY!==x&&c!=="x"&&(t.originY=h1(t.originY),p*=-1,t.signY=x)}const b=a.scaleX,w=a.scaleY;return c?(c==="x"&&a.set(Qe,d),c==="y"&&a.set(wn,p)):(!Pn(a,"lockScalingX")&&a.set(Qe,d),!Pn(a,"lockScalingY")&&a.set(wn,p)),b!==a.scaleX||w!==a.scaleY}const ou=Yo(Dh,Vo((s,t,e,i)=>Ip(s,t,e,i))),yk=Yo(Dh,Vo((s,t,e,i)=>Ip(s,t,e,i,{by:"x"}))),vk=Yo(Dh,Vo((s,t,e,i)=>Ip(s,t,e,i,{by:"y"}))),Og={x:{counterAxis:"y",scale:Qe,skew:Bo,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:wn,skew:Ho,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},xk=["ns","nesw","ew","nwse"],bk=(s,t,e,i)=>{if(t.x!==0&&Pn(e,"lockSkewingY")||t.y!==0&&Pn(e,"lockSkewingX"))return ah;const o=i_(e,0,i)%4;return`${xk[o]}-resize`};function d_(s,t,e,i,o){const{target:a}=e,{counterAxis:c,origin:h,lockSkewing:f,skew:d,flip:p}=Og[s];if(Pn(a,f))return!1;const{origin:y,flip:v}=Og[c],x=Be(e[y])*(a[v]?-1:1),b=-Math.sign(x)*(a[p]?-1:1),w=.5*-((a[d]===0&&Xp(e,Dt,Dt,i,o)[s]>0||a[d]>0?1:-1)*b)+.5;return Yo(BS,Vo((E,M,C,D)=>(function(j,R,z){let{target:U,ex:G,ey:ut,skewingSide:W,...Z}=R;const{skew:rt}=Og[j],N=z.subtract(new tt(G,ut)).divide(new tt(U.scaleX,U.scaleY))[j],I=U[rt],A=Z[rt],L=Math.tan(ce(A)),H=j==="y"?U._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:U._getTransformedDimensions({scaleX:1,scaleY:1}).y,q=2*N*W/Math.max(H,1)+L,st=Ms(Math.atan(q));U.set(rt,st);const k=I!==U[rt];if(k&&j==="y"){const{skewX:P,scaleX:et}=U,nt=U._getTransformedDimensions({skewY:I}),ht=U._getTransformedDimensions(),dt=P!==0?nt.x/ht.x:1;dt!==1&&U.set(Qe,dt*et)}return k})(s,M,new tt(C,D))))(t,{...e,[h]:w,skewingSide:b},i,o)}const Sk=(s,t,e,i)=>d_("x",s,t,e,i),_k=(s,t,e,i)=>d_("y",s,t,e,i);function Rh(s,t){return s[t.canvas.altActionKey]}const au=(s,t,e)=>{const i=Rh(s,e);return t.x===0?i?Bo:wn:t.y===0?i?Ho:Qe:""},po=(s,t,e,i)=>Rh(s,e)?bk(0,t,e,i):Ga(s,t,e,i),b1=(s,t,e,i)=>Rh(s,t.target)?_k(s,t,e,i):yk(s,t,e,i),S1=(s,t,e,i)=>Rh(s,t.target)?Sk(s,t,e,i):vk(s,t,e,i),g_=()=>({ml:new jn({x:-.5,y:0,cursorStyleHandler:po,actionHandler:b1,getActionName:au}),mr:new jn({x:.5,y:0,cursorStyleHandler:po,actionHandler:b1,getActionName:au}),mb:new jn({x:0,y:.5,cursorStyleHandler:po,actionHandler:S1,getActionName:au}),mt:new jn({x:0,y:-.5,cursorStyleHandler:po,actionHandler:S1,getActionName:au}),tl:new jn({x:-.5,y:-.5,cursorStyleHandler:Ga,actionHandler:ou}),tr:new jn({x:.5,y:-.5,cursorStyleHandler:Ga,actionHandler:ou}),bl:new jn({x:-.5,y:.5,cursorStyleHandler:Ga,actionHandler:ou}),br:new jn({x:.5,y:.5,cursorStyleHandler:Ga,actionHandler:ou}),mtr:new jn({x:0,y:-.5,actionHandler:pk,cursorStyleHandler:gk,offsetY:-40,withConnection:!0,actionName:Lp})}),wk=()=>({mr:new jn({x:.5,y:0,actionHandler:x1,cursorStyleHandler:po,actionName:cl}),ml:new jn({x:-.5,y:0,actionHandler:x1,cursorStyleHandler:po,actionName:cl})}),Ck=()=>({...g_(),...wk()});class dl extends Di{static getDefaults(){return{...super.getDefaults(),...dl.ownDefaults}}constructor(t){super(),Object.assign(this,this.constructor.createControls(),dl.ownDefaults),this.setOptions(t)}static createControls(){return{controls:g_()}}_updateCacheCanvas(){const t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){const e=t._currentTransform,i=e.target,o=e.action;if(this===i&&o&&o.startsWith(Oh))return!1}return super._updateCacheCanvas()}getActiveControl(){const t=this.__corner;return t?{key:t,control:this.controls[t],coord:this.oCoords[t]}:void 0}findControl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const i=Object.entries(this.oCoords);for(let o=i.length-1;o>=0;o--){const[a,c]=i[o],h=this.controls[a];if(h.shouldActivate(a,this,t,e?c.touchCorner:c.corner))return this.__corner=a,{key:a,control:h,coord:this.oCoords[a]}}}calcOCoords(){const t=this.getViewportTransform(),e=this.getCenterPoint(),i=wl(e.x,e.y),o=Uo({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),a=De(i,o),c=De(t,a),h=De(c,[1/t[0],0,0,1/t[3],0,0]),f=this.group?sh(this.calcTransformMatrix()):void 0;f&&(f.scaleX=Math.abs(f.scaleX),f.scaleY=Math.abs(f.scaleY));const d=this._calculateCurrentDimensions(f),p={};return this.forEachControl((y,v)=>{const x=y.positionHandler(d,h,this,y);p[v]=Object.assign(x,this._calcCornerCoords(y,x))}),p}_calcCornerCoords(t,e){const i=this.getTotalAngle();return{corner:t.calcCornerCoords(i,this.cornerSize,e.x,e.y,!1,this),touchCorner:t.calcCornerCoords(i,this.touchCornerSize,e.x,e.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(t){for(const e in this.controls)t(this.controls[e],e,this)}drawSelectionBackground(t){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;t.save();const e=this.getRelativeCenterPoint(),i=this._calculateCurrentDimensions(),o=this.getViewportTransform();t.translate(e.x,e.y),t.scale(1/o[0],1/o[3]),t.rotate(ce(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-i.x/2,-i.y/2,i.x,i.y),t.restore()}strokeBorders(t,e){t.strokeRect(-e.x/2,-e.y/2,e.x,e.y)}_drawBorders(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o={hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray,...i};t.save(),t.strokeStyle=o.borderColor,this._setLineDash(t,o.borderDashArray),this.strokeBorders(t,e),o.hasControls&&this.drawControlsConnectingLines(t,e),t.restore()}_renderControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:i,hasControls:o}=this,a={hasBorders:i,hasControls:o,...e},c=this.getViewportTransform(),h=a.hasBorders,f=a.hasControls,d=De(c,this.calcTransformMatrix()),p=sh(d);t.save(),t.translate(p.translateX,p.translateY),t.lineWidth=this.borderScaleFactor,this.group===this.parent&&(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(p.angle-=180),t.rotate(ce(this.group?p.angle:this.angle)),h&&this.drawBorders(t,p,e),f&&this.drawControls(t,e),t.restore()}drawBorders(t,e,i){let o;if(i&&i.forActiveSelection||this.group){const a=Yp(this.width,this.height,Ah(e)),c=this.isStrokeAccountedForInDimensions()?Bp:(this.strokeUniform?new tt().scalarAdd(this.canvas?this.canvas.getZoom():1):new tt(e.scaleX,e.scaleY)).scalarMultiply(this.strokeWidth);o=a.add(c).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else o=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(t,o,i)}drawControlsConnectingLines(t,e){let i=!1;t.beginPath(),this.forEachControl((o,a)=>{o.withConnection&&o.getVisibility(this,a)&&(i=!0,t.moveTo(o.x*e.x,o.y*e.y),t.lineTo(o.x*e.x+o.offsetX,o.y*e.y+o.offsetY))}),i&&t.stroke()}drawControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.save();const i=this.getCanvasRetinaScaling(),{cornerStrokeColor:o,cornerDashArray:a,cornerColor:c}=this,h={cornerStrokeColor:o,cornerDashArray:a,cornerColor:c,...e};t.setTransform(i,0,0,i,0,0),t.strokeStyle=t.fillStyle=h.cornerColor,this.transparentCorners||(t.strokeStyle=h.cornerStrokeColor),this._setLineDash(t,h.cornerDashArray),this.forEachControl((f,d)=>{if(f.getVisibility(this,d)){const p=this.oCoords[d];f.render(t,p.x,p.y,h,this)}}),t.restore()}isControlVisible(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)}setControlVisible(t,e){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e}setControlsVisibility(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(t).forEach(e=>{let[i,o]=e;return this.setControlVisible(i,o)})}clearContextTop(t){if(!this.canvas)return;const e=this.canvas.contextTop;if(!e)return;const i=this.canvas.viewportTransform;e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(e);const o=this.width+4,a=this.height+4;return e.clearRect(-o/2,-a/2,o,a),t||e.restore(),e}onDeselect(t){return!1}onSelect(t){return!1}shouldStartDragging(t){return!1}onDragStart(t){return!1}canDrop(t){return!1}renderDragSourceEffect(t){}renderDropTargetEffect(t){}}function p_(s,t){return t.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(i=>{i!=="constructor"&&Object.defineProperty(s.prototype,i,Object.getOwnPropertyDescriptor(e.prototype,i)||Object.create(null))})}),s}V(dl,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class ke extends dl{}p_(ke,[s_]),mt.setClass(ke),mt.setClass(ke,"object");const Tk=(s,t,e,i)=>{const o=2*(i=Math.round(i))+1,{data:a}=s.getImageData(t-i,e-i,o,o);for(let c=3;c<a.length;c+=4)if(a[c]>0)return!1;return!0};class m_{constructor(t){this.options=t,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new tt(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new tt(1/this.options.scaleX,1/this.options.scaleY):new tt(1,1)}createSideVector(t,e){const i=oh(t,e);return this.options.strokeUniform?i.multiply(this.scale):i}projectOrthogonally(t,e,i){return this.applySkew(t.add(this.calcOrthogonalProjection(t,e,i)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(t){const e=new tt(t);return e.y+=e.x*Math.tan(ce(this.options.skewY)),e.x+=e.y*Math.tan(ce(this.options.skewX)),e}scaleUnitVector(t,e){return t.multiply(this.strokeUniformScalar).scalarMultiply(e)}}const Ek=new tt;class So extends m_{static getOrthogonalRotationFactor(t,e){const i=e?sp(t,e):JS(t);return Math.abs(i)<_l?-1:1}constructor(t,e,i,o){super(o),V(this,"AB",void 0),V(this,"AC",void 0),V(this,"alpha",void 0),V(this,"bisector",void 0),this.A=new tt(t),this.B=new tt(e),this.C=new tt(i),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=sp(this.AB,this.AC),this.bisector=Vp(QS(this.AB.eq(Ek)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const o=this.createSideVector(t,e),a=t_(o),c=So.getOrthogonalRotationFactor(a,this.bisector);return this.scaleUnitVector(a,i*c)}projectBevel(){const t=[];return(this.alpha%ko===0?[this.B]:[this.B,this.C]).forEach(e=>{t.push(this.projectOrthogonally(this.A,e)),t.push(this.projectOrthogonally(this.A,e,-this.strokeProjectionMagnitude))}),t}projectMiter(){const t=[],e=Math.abs(this.alpha),i=1/Math.sin(e/2),o=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*i),a=this.options.strokeUniform?ip(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return ip(o)/this.strokeProjectionMagnitude<=a&&t.push(this.applySkew(this.A.add(o))),t.push(...this.projectBevel()),t}projectRoundNoSkew(t,e){const i=[],o=new tt(So.getOrthogonalRotationFactor(this.bisector),So.getOrthogonalRotationFactor(new tt(this.bisector.y,this.bisector.x)));return[new tt(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(o),new tt(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(o)].forEach(a=>{u1(a,t,e)&&i.push(this.A.add(a))}),i}projectRoundWithSkew(t,e){const i=[],{skewX:o,skewY:a,scaleX:c,scaleY:h,strokeUniform:f}=this.options,d=new tt(Math.tan(ce(o)),Math.tan(ce(a))),p=this.strokeProjectionMagnitude,y=f?p/h/Math.sqrt(1/h**2+1/c**2*d.y**2):p/Math.sqrt(1+d.y**2),v=new tt(Math.sqrt(Math.max(p**2-y**2,0)),y),x=f?p/Math.sqrt(1+d.x**2*(1/h)**2/(1/c+1/c*d.x*d.y)**2):p/Math.sqrt(1+d.x**2/(1+d.x*d.y)**2),b=new tt(x,Math.sqrt(Math.max(p**2-x**2,0)));return[b,b.scalarMultiply(-1),v,v.scalarMultiply(-1)].map(w=>this.applySkew(f?w.multiply(this.strokeUniformScalar):w)).forEach(w=>{u1(w,t,e)&&i.push(this.applySkew(this.A).add(w))}),i}projectRound(){const t=[];t.push(...this.projectBevel());const e=this.alpha%ko===0,i=this.applySkew(this.A),o=t[e?0:2].subtract(i),a=t[e?1:0].subtract(i),c=e?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),h=Za(o,c)>0,f=h?o:a,d=h?a:o;return this.isSkewed()?t.push(...this.projectRoundWithSkew(f,d)):t.push(...this.projectRoundNoSkew(f,d)),t}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t,angle:this.alpha,bisector:this.bisector}))}}class _1 extends m_{constructor(t,e,i){super(i),this.A=new tt(t),this.T=new tt(e)}calcOrthogonalProjection(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const o=this.createSideVector(t,e);return this.scaleUnitVector(t_(o),i)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const t=[];if(!this.isSkewed()&&this.A.eq(this.T)){const e=new tt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.applySkew(this.A.add(e)),this.applySkew(this.A.subtract(e)))}else t.push(...new So(this.A,this.T,this.T,this.options).projectRound());return t}projectSquare(){const t=[];if(this.A.eq(this.T)){const e=new tt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.A.add(e),this.A.subtract(e))}else{const e=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),i=this.scaleUnitVector(Vp(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),o=this.A.add(i);t.push(o.add(e),o.subtract(e))}return t.map(e=>this.applySkew(e))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t}))}}const Mk=function(s,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const i=[];if(s.length===0)return i;const o=s.reduce((a,c)=>(a[a.length-1].eq(c)||a.push(new tt(c)),a),[new tt(s[0])]);if(o.length===1)e=!0;else if(!e){const a=o[0],c=((h,f)=>{for(let d=h.length-1;d>=0;d--)if(f(h[d],d,h))return d;return-1})(o,h=>!h.eq(a));o.splice(c+1)}return o.forEach((a,c,h)=>{let f,d;c===0?(d=h[1],f=e?a:h[h.length-1]):c===h.length-1?(f=h[c-1],d=e?a:h[0]):(f=h[c-1],d=h[c+1]),e&&h.length===1?i.push(...new _1(a,a,t).project()):!e||c!==0&&c!==h.length-1?i.push(...new So(a,f,d,t).project()):i.push(...new _1(a,c===0?d:f,t).project())}),i},Gp=s=>{const t={};return Object.keys(s).forEach(e=>{t[e]={},Object.keys(s[e]).forEach(i=>{t[e][i]={...s[e][i]}})}),t},Dk=s=>s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let Pa;const $p=s=>{if(Pa||Pa||(Pa="Intl"in Mh()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Pa){const t=Pa.segment(s);return Array.from(t).map(e=>{let{segment:i}=e;return i})}return Ok(s)},Ok=s=>{const t=[];for(let e,i=0;i<s.length;i++)(e=Ak(s,i))!==!1&&t.push(e);return t},Ak=(s,t)=>{const e=s.charCodeAt(t);if(isNaN(e))return"";if(e<55296||e>57343)return s.charAt(t);if(55296<=e&&e<=56319){if(s.length<=t+1)throw"High surrogate without following low surrogate";const o=s.charCodeAt(t+1);if(56320>o||o>57343)throw"High surrogate without following low surrogate";return s.charAt(t)+s.charAt(t+1)}if(t===0)throw"Low surrogate without preceding high surrogate";const i=s.charCodeAt(t-1);if(55296>i||i>56319)throw"Low surrogate without preceding high surrogate";return!1},qp=function(s,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return s.fill!==t.fill||s.stroke!==t.stroke||s.strokeWidth!==t.strokeWidth||s.fontSize!==t.fontSize||s.fontFamily!==t.fontFamily||s.fontWeight!==t.fontWeight||s.fontStyle!==t.fontStyle||s.textDecorationThickness!==t.textDecorationThickness||s.textBackgroundColor!==t.textBackgroundColor||s.deltaY!==t.deltaY||e&&(s.overline!==t.overline||s.underline!==t.underline||s.linethrough!==t.linethrough)},kk=(s,t)=>{const e=t.split(`
`),i=[];let o=-1,a={};s=Gp(s);for(let c=0;c<e.length;c++){const h=$p(e[c]);if(s[c])for(let f=0;f<h.length;f++){o++;const d=s[c][f];d&&Object.keys(d).length>0&&(qp(a,d,!0)?i.push({start:o,end:o+1,style:d}):i[i.length-1].end++),a=d||{}}else o+=h.length,a={}}return i},jk=(s,t)=>{if(!Array.isArray(s))return Gp(s);const e=t.split(zp),i={};let o=-1,a=0;for(let c=0;c<e.length;c++){const h=$p(e[c]);for(let f=0;f<h.length;f++)o++,s[a]&&s[a].start<=o&&o<s[a].end&&(i[c]=i[c]||{},i[c][f]={...s[a].style},o===s[a].end-1&&a++)}return i},Ds=["display","transform",Se,"fill-opacity","fill-rule","opacity",un,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function w1(s,t){const e=s.nodeName,i=s.getAttribute("class"),o=s.getAttribute("id"),a="(?![a-zA-Z\\-]+)";let c;if(c=new RegExp("^"+e,"i"),t=t.replace(c,""),o&&t.length&&(c=new RegExp("#"+o+a,"i"),t=t.replace(c,"")),i&&t.length){const h=i.split(" ");for(let f=h.length;f--;)c=new RegExp("\\."+h[f]+a,"i"),t=t.replace(c,"")}return t.length===0}function Nk(s,t){let e=!0;const i=w1(s,t.pop());return i&&t.length&&(e=(function(o,a){let c,h=!0;for(;o.parentElement&&o.parentElement.nodeType===1&&a.length;)h&&(c=a.pop()),h=w1(o=o.parentElement,c);return a.length===0})(s,t)),i&&e&&t.length===0}function Rk(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={};for(const i in t)Nk(s,i.split(" "))&&(e={...e,...t[i]});return e}const zk=s=>{var t;return(t=J5[s])!==null&&t!==void 0?t:s},Lk=new RegExp(`(${xr})`,"gi"),He=`(${xr})`,Bk=String.raw`(skewX)\(${He}\)`,Hk=String.raw`(skewY)\(${He}\)`,Uk=String.raw`(rotate)\(${He}(?: ${He} ${He})?\)`,Pk=String.raw`(scale)\(${He}(?: ${He})?\)`,Yk=String.raw`(translate)\(${He}(?: ${He})?\)`,Wp=`(?:${String.raw`(matrix)\(${He} ${He} ${He} ${He} ${He} ${He}\)`}|${Yk}|${Uk}|${Pk}|${Bk}|${Hk})`,Vk=`(?:${Wp}*)`,Xk=String.raw`^\s*(?:${Vk}?)\s*$`,Fk=new RegExp(Xk),Ik=new RegExp(Wp),Gk=new RegExp(Wp,"g");function rp(s){const t=[];if(!(s=(e=>lh(e.replace(Lk," $1 ").replace(/,/gi," ")))(s).replace(/\s*([()])\s*/gi,"$1"))||s&&!Fk.test(s))return[...Ue];for(const e of s.matchAll(Gk)){const i=Ik.exec(e[0]);if(!i)continue;let o=Ue;const a=i.filter(b=>!!b),[,c,...h]=a,[f,d,p,y,v,x]=h.map(b=>parseFloat(b));switch(c){case"translate":o=wl(f,d);break;case Lp:o=Uo({angle:f},{x:d,y:p});break;case Oh:o=Up(f,d);break;case Bo:o=FS(f);break;case Ho:o=IS(f);break;case"matrix":o=[f,d,p,y,v,x]}t.push(o)}return Hp(t)}function $k(s,t,e,i){const o=Array.isArray(t);let a,c=t;if(s!==Se&&s!==un||t!==Ke){if(s==="strokeUniform")return t==="non-scaling-stroke";if(s==="strokeDashArray")c=t===Ke?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(s==="transformMatrix")c=e&&e.transformMatrix?De(e.transformMatrix,rp(t)):rp(t);else if(s==="visible")c=t!==Ke&&t!=="hidden",e&&e.visible===!1&&(c=!1);else if(s==="opacity")c=parseFloat(t),e&&e.opacity!==void 0&&(c*=e.opacity);else if(s==="textAnchor")c=t==="start"?Yt:t==="end"?le:Dt;else if(s==="charSpacing"||s===vr)a=bo(t,i)/i*1e3;else if(s==="paintFirst"){const h=t.indexOf(Se),f=t.indexOf(un);c=Se,(h>-1&&f>-1&&f<h||h===-1&&f>-1)&&(c=un)}else{if(s==="href"||s==="xlink:href"||s==="font"||s==="id")return t;if(s==="imageSmoothing")return t==="optimizeQuality";a=o?t.map(bo):bo(t,i)}}else c="";return!o&&isNaN(a)?c:a}function qk(s,t){s.replace(/;\s*$/,"").split(";").forEach(e=>{if(!e)return;const[i,o]=e.split(":");t[i.trim().toLowerCase()]=o.trim()})}function Wk(s){const t={},e=s.getAttribute("style");return e&&(typeof e=="string"?qk(e,t):(function(i,o){Object.entries(i).forEach(a=>{let[c,h]=a;h!==void 0&&(o[c.toLowerCase()]=h)})})(e,t)),t}const Zk={stroke:"strokeOpacity",fill:"fillOpacity"};function Xi(s,t,e){if(!s)return{};let i,o={},a=Rp;s.parentNode&&m1.test(s.parentNode.nodeName)&&(o=Xi(s.parentElement,t,e),o.fontSize&&(i=a=bo(o.fontSize)));const c={...t.reduce((d,p)=>{const y=s.getAttribute(p);return y&&(d[p]=y),d},{}),...Rk(s,e),...Wk(s)};c[Mg]&&s.setAttribute(Mg,c[Mg]),c[Eg]&&(i=bo(c[Eg],a),c[Eg]=`${i}`);const h={};for(const d in c){const p=zk(d),y=$k(p,c[d],o,i);h[p]=y}h&&h.font&&(function(d,p){const y=d.match(Q5);if(!y)return;const v=y[1],x=y[3],b=y[4],w=y[5],T=y[6];v&&(p.fontStyle=v),x&&(p.fontWeight=isNaN(parseFloat(x))?x:parseFloat(x)),b&&(p.fontSize=bo(b)),T&&(p.fontFamily=T),w&&(p.lineHeight=w===tp?1:w)})(h.font,h);const f={...o,...h};return m1.test(s.nodeName)?f:(function(d){const p=ke.getDefaults();return Object.entries(Zk).forEach(y=>{let[v,x]=y;if(d[x]===void 0||d[v]==="")return;if(d[v]===void 0){if(!p[v])return;d[v]=p[v]}if(d[v].indexOf("url(")===0)return;const b=new Wt(d[v]);d[v]=b.setAlpha(Kt(b.getAlpha()*d[x],2)).toRgba()}),d})(f)}const y_=["rx","ry"];class Zn extends ke{static getDefaults(){return{...super.getDefaults(),...Zn.ownDefaults}}constructor(t){super(),Object.assign(this,Zn.ownDefaults),this.setOptions(t),this._initRxRy()}_initRxRy(){const{rx:t,ry:e}=this;t&&!e?this.ry=t:e&&!t&&(this.rx=e)}_render(t){const{width:e,height:i}=this,o=-e/2,a=-i/2,c=this.rx?Math.min(this.rx,e/2):0,h=this.ry?Math.min(this.ry,i/2):0,f=c!==0||h!==0;t.beginPath(),t.moveTo(o+c,a),t.lineTo(o+e-c,a),f&&t.bezierCurveTo(o+e-Ss*c,a,o+e,a+Ss*h,o+e,a+h),t.lineTo(o+e,a+i-h),f&&t.bezierCurveTo(o+e,a+i-Ss*h,o+e-Ss*c,a+i,o+e-c,a+i),t.lineTo(o+c,a+i),f&&t.bezierCurveTo(o+Ss*c,a+i,o,a+i-Ss*h,o,a+i-h),t.lineTo(o,a+h),f&&t.bezierCurveTo(o,a+Ss*h,o+Ss*c,a,o+c,a),t.closePath(),this._renderPaintInOrder(t)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...y_,...t])}_toSVG(){const{width:t,height:e,rx:i,ry:o}=this;return["<rect ","COMMON_PARTS",`x="${-t/2}" y="${-e/2}" rx="${i}" ry="${o}" width="${t}" height="${e}" />
`]}static async fromElement(t,e,i){const{left:o=0,top:a=0,width:c=0,height:h=0,visible:f=!0,...d}=Xi(t,this.ATTRIBUTE_NAMES,i);return new this({...e,...d,left:o,top:a,width:c,height:h,visible:!!(f&&c&&h)})}}V(Zn,"type","Rect"),V(Zn,"cacheProperties",[...Vi,...y_]),V(Zn,"ownDefaults",{rx:0,ry:0}),V(Zn,"ATTRIBUTE_NAMES",[...Ds,"x","y","rx","ry","width","height"]),mt.setClass(Zn),mt.setSVGClass(Zn);const Ni="initialization",uh="added",Zp="removed",hh="imperative",v_=(s,t)=>{const{strokeUniform:e,strokeWidth:i,width:o,height:a,group:c}=t,h=c&&c!==s?jh(c.calcTransformMatrix(),s.calcTransformMatrix()):null,f=h?t.getRelativeCenterPoint().transform(h):t.getRelativeCenterPoint(),d=!t.isStrokeAccountedForInDimensions(),p=e&&d?F5(new tt(i,i),void 0,s.calcTransformMatrix()):Bp,y=!e&&d?i:0,v=Yp(o+y,a+y,Hp([h,t.calcOwnMatrix()],!0)).add(p).scalarDivide(2);return[f.subtract(v),f.add(v)]};class zh{calcLayoutResult(t,e){if(this.shouldPerformLayout(t))return this.calcBoundingBox(e,t)}shouldPerformLayout(t){let{type:e,prevStrategy:i,strategy:o}=t;return e===Ni||e===hh||!!i&&o!==i}shouldLayoutClipPath(t){let{type:e,target:{clipPath:i}}=t;return e!==Ni&&i&&!i.absolutePositioned}getInitialSize(t,e){return e.size}calcBoundingBox(t,e){const{type:i,target:o}=e;if(i===hh&&e.overrides)return e.overrides;if(t.length===0)return;const{left:a,top:c,width:h,height:f}=Li(t.map(y=>v_(o,y)).reduce((y,v)=>y.concat(v),[])),d=new tt(h,f),p=new tt(a,c).add(d.scalarDivide(2));if(i===Ni){const y=this.getInitialSize(e,{size:d,center:p});return{center:p,relativeCorrection:new tt(0,0),size:y}}return{center:p.transform(o.calcOwnMatrix()),size:d}}}V(zh,"type","strategy");class op extends zh{shouldPerformLayout(t){return!0}}V(op,"type","fit-content"),mt.setClass(op);const x_="layoutManager";class gl{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new op;V(this,"strategy",void 0),this.strategy=t,this._subscriptions=new Map}performLayout(t){const e={bubbles:!0,strategy:this.strategy,...t,prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}};this.onBeforeLayout(e);const i=this.getLayoutResult(e);i&&this.commitLayout(e,i),this.onAfterLayout(e,i),this._prevLayoutStrategy=e.strategy}attachHandlers(t,e){const{target:i}=e;return[nh,zS,cl,LS,Dh,BS,eh,k5,j5].map(o=>t.on(o,a=>this.performLayout(o===nh?{type:"object_modified",trigger:o,e:a,target:i}:{type:"object_modifying",trigger:o,e:a,target:i})))}subscribe(t,e){this.unsubscribe(t,e);const i=this.attachHandlers(t,e);this._subscriptions.set(t,i)}unsubscribe(t,e){(this._subscriptions.get(t)||[]).forEach(i=>i()),this._subscriptions.delete(t)}unsubscribeTargets(t){t.targets.forEach(e=>this.unsubscribe(e,t))}subscribeTargets(t){t.targets.forEach(e=>this.subscribe(e,t))}onBeforeLayout(t){const{target:e,type:i}=t,{canvas:o}=e;if(i===Ni||i===uh?this.subscribeTargets(t):i===Zp&&this.unsubscribeTargets(t),e.fire("layout:before",{context:t}),o&&o.fire("object:layout:before",{target:e,context:t}),i===hh&&t.deep){const{strategy:a,...c}=t;e.forEachObject(h=>h.layoutManager&&h.layoutManager.performLayout({...c,bubbles:!1,target:h}))}}getLayoutResult(t){const{target:e,strategy:i,type:o}=t,a=i.calcLayoutResult(t,e.getObjects());if(!a)return;const c=o===Ni?new tt:e.getRelativeCenterPoint(),{center:h,correction:f=new tt,relativeCorrection:d=new tt}=a,p=c.subtract(h).add(f).transform(o===Ni?Ue:Un(e.calcOwnMatrix()),!0).add(d);return{result:a,prevCenter:c,nextCenter:h,offset:p}}commitLayout(t,e){const{target:i}=t,{result:{size:o},nextCenter:a}=e;var c,h;i.set({width:o.x,height:o.y}),this.layoutObjects(t,e),t.type===Ni?i.set({left:(c=t.x)!==null&&c!==void 0?c:a.x+o.x*Be(i.originX),top:(h=t.y)!==null&&h!==void 0?h:a.y+o.y*Be(i.originY)}):(i.setPositionByOrigin(a,Dt,Dt),i.setCoords(),i.set("dirty",!0))}layoutObjects(t,e){const{target:i}=t;i.forEachObject(o=>{o.group===i&&this.layoutObject(t,e,o)}),t.strategy.shouldLayoutClipPath(t)&&this.layoutObject(t,e,i.clipPath)}layoutObject(t,e,i){let{offset:o}=e;i.set({left:i.left+o.x,top:i.top+o.y})}onAfterLayout(t,e){const{target:i,strategy:o,bubbles:a,prevStrategy:c,...h}=t,{canvas:f}=i;i.fire("layout:after",{context:t,result:e}),f&&f.fire("object:layout:after",{context:t,result:e,target:i});const d=i.parent;a&&d!=null&&d.layoutManager&&((h.path||(h.path=[])).push(i),d.layoutManager.performLayout({...h,target:d})),i.set("dirty",!0)}dispose(){const{_subscriptions:t}=this;t.forEach(e=>e.forEach(i=>i())),t.clear()}toObject(){return{type:x_,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}mt.setClass(gl,x_);class Kk extends gl{performLayout(){}}class dr extends HS(ke){static getDefaults(){return{...super.getDefaults(),...dr.ownDefaults}}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),V(this,"_activeObjects",[]),V(this,"__objectSelectionTracker",void 0),V(this,"__objectSelectionDisposer",void 0),Object.assign(this,dr.ownDefaults),this.setOptions(e),this.groupInit(t,e)}groupInit(t,e){var i;this._objects=[...t],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(o=>{this.enterGroup(o,!1)}),this.layoutManager=(i=e.layoutManager)!==null&&i!==void 0?i:new gl,this.layoutManager.performLayout({type:Ni,target:this,targets:[...t],x:e.left,y:e.top})}canEnterGroup(t){return t===this||this.isDescendantOf(t)?(Ts("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(t)===-1||(Ts("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(t){return t.filter((e,i,o)=>this.canEnterGroup(e)&&o.indexOf(e)===i)}add(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];const o=this._filterObjectsBeforeEnteringGroup(e),a=super.add(...o);return this._onAfterObjectsChange(uh,o),a}insertAt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];const a=this._filterObjectsBeforeEnteringGroup(i),c=super.insertAt(t,...a);return this._onAfterObjectsChange(uh,a),c}remove(){const t=super.remove(...arguments);return this._onAfterObjectsChange(Zp,t),t}_onObjectAdded(t){this.enterGroup(t,!0),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t,e){this.exitGroup(t,e),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onAfterObjectsChange(t,e){this.layoutManager.performLayout({type:t,targets:e,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(t,e){const i=this[t];return super._set(t,e),t==="canvas"&&i!==e&&(this._objects||[]).forEach(o=>{o._set(t,e)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(t,e){let{target:i}=e;const o=this._activeObjects;if(t)o.push(i),this._set("dirty",!0);else if(o.length>0){const a=o.indexOf(i);a>-1&&(o.splice(a,1),this._set("dirty",!0))}}_watchObject(t,e){t&&this._watchObject(!1,e),t?(e.on("selected",this.__objectSelectionTracker),e.on("deselected",this.__objectSelectionDisposer)):(e.off("selected",this.__objectSelectionTracker),e.off("deselected",this.__objectSelectionDisposer))}enterGroup(t,e){t.group&&t.group.remove(t),t._set("parent",this),this._enterGroup(t,e)}_enterGroup(t,e){e&&rh(t,De(Un(this.calcTransformMatrix()),t.calcTransformMatrix())),this._shouldSetNestedCoords()&&t.setCoords(),t._set("group",this),t._set("canvas",this.canvas),this._watchObject(!0,t);const i=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();i&&(i===t||t.isDescendantOf(i))&&this._activeObjects.push(t)}exitGroup(t,e){this._exitGroup(t,e),t._set("parent",void 0),t._set("canvas",void 0)}_exitGroup(t,e){t._set("group",void 0),e||(rh(t,De(this.calcTransformMatrix(),t.calcTransformMatrix())),t.setCoords()),this._watchObject(!1,t);const i=this._activeObjects.length>0?this._activeObjects.indexOf(t):-1;i>-1&&this._activeObjects.splice(i,1)}shouldCache(){const t=ke.prototype.shouldCache.call(this);if(t){for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1}return t}willDrawShadow(){if(super.willDrawShadow())return!0;for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(t,e,i){this._renderBackground(t);for(let a=0;a<this._objects.length;a++){var o;const c=this._objects[a];(o=this.canvas)!==null&&o!==void 0&&o.preserveObjectStacking&&c.group!==this?(t.save(),t.transform(...Un(this.calcTransformMatrix())),c.render(t),t.restore()):c.group===this&&c.render(t)}this._drawClipPath(t,this.clipPath,i)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(t=>t.setCoords())}triggerLayout(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout({target:this,type:hh,...t})}render(t){this._transformDone=!0,super.render(t),this._transformDone=!1}__serializeObjects(t,e){const i=this.includeDefaultValues;return this._objects.filter(function(o){return!o.excludeFromExport}).map(function(o){const a=o.includeDefaultValues;o.includeDefaultValues=i;const c=o[t||"toObject"](e);return o.includeDefaultValues=a,c})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.layoutManager.toObject();return{...super.toObject(["subTargetCheck","interactive",...t]),...e.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:e}:{},objects:this.__serializeObjects("toObject",t)}}toString(){return`#<Group: (${this.complexity()})>`}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(t=>{this._watchObject(!1,t),t.dispose()}),super.dispose()}_createSVGBgRect(t){if(!this.backgroundColor)return"";const e=Zn.prototype._toSVG.call(this),i=e.indexOf("COMMON_PARTS");e[i]='for="group" ';const o=e.join("");return t?t(o):o}_toSVG(t){const e=["<g ","COMMON_PARTS",` >
`],i=this._createSVGBgRect(t);i&&e.push("		",i);for(let o=0;o<this._objects.length;o++)e.push("		",this._objects[o].toSVG(t));return e.push(`</g>
`),e}getSvgStyles(){const t=this.opacity!==void 0&&this.opacity!==1?`opacity: ${this.opacity};`:"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")}toClipPathSVG(t){const e=[],i=this._createSVGBgRect(t);i&&e.push("	",i);for(let o=0;o<this._objects.length;o++)e.push("	",this._objects[o].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}static fromObject(t,e){let{type:i,objects:o=[],layoutManager:a,...c}=t;return Promise.all([ul(o,e),kh(c,e)]).then(h=>{let[f,d]=h;const p=new this(f,{...c,...d,layoutManager:new Kk});if(a){const y=mt.getClass(a.type),v=mt.getClass(a.strategy);p.layoutManager=new y(new v)}else p.layoutManager=new gl;return p.layoutManager.subscribeTargets({type:Ni,target:p,targets:p.getObjects()}),p.setCoords(),p})}}V(dr,"type","Group"),V(dr,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),mt.setClass(dr);const Qk=(s,t)=>Math.min(t.width/s.width,t.height/s.height),Jk=(s,t)=>Math.max(t.width/s.width,t.height/s.height),ap="\\s*,?\\s*",Ya=`${ap}(${xr})`,tj=`${Ya}${Ya}${Ya}${ap}([01])${ap}([01])${Ya}${Ya}`,ej={m:"l",M:"L"},nj=(s,t,e,i,o,a,c,h,f,d,p)=>{const y=Hi(s),v=Ui(s),x=Hi(t),b=Ui(t),w=e*o*x-i*a*b+c,T=i*o*x+e*a*b+h;return["C",d+f*(-e*o*v-i*a*y),p+f*(-i*o*v+e*a*y),w+f*(e*o*b+i*a*x),T+f*(i*o*b-e*a*x),w,T]},C1=(s,t,e,i)=>{const o=Math.atan2(t,s),a=Math.atan2(i,e);return a>=o?a-o:2*Math.PI-(o-a)};function T1(s,t,e,i,o,a,c,h){let f;if(Bt.cachesBoundsOfCurve&&(f=[...arguments].join(),Wa.boundsOfCurveCache[f]))return Wa.boundsOfCurveCache[f];const d=Math.sqrt,p=Math.abs,y=[],v=[[0,0],[0,0]];let x=6*s-12*e+6*o,b=-3*s+9*e-9*o+3*c,w=3*e-3*s;for(let D=0;D<2;++D){if(D>0&&(x=6*t-12*i+6*a,b=-3*t+9*i-9*a+3*h,w=3*i-3*t),p(b)<1e-12){if(p(x)<1e-12)continue;const G=-w/x;0<G&&G<1&&y.push(G);continue}const j=x*x-4*w*b;if(j<0)continue;const R=d(j),z=(-x+R)/(2*b);0<z&&z<1&&y.push(z);const U=(-x-R)/(2*b);0<U&&U<1&&y.push(U)}let T=y.length;const E=T,M=b_(s,t,e,i,o,a,c,h);for(;T--;){const{x:D,y:j}=M(y[T]);v[0][T]=D,v[1][T]=j}v[0][E]=s,v[1][E]=t,v[0][E+1]=c,v[1][E+1]=h;const C=[new tt(Math.min(...v[0]),Math.min(...v[1])),new tt(Math.max(...v[0]),Math.max(...v[1]))];return Bt.cachesBoundsOfCurve&&(Wa.boundsOfCurveCache[f]=C),C}const ij=(s,t,e)=>{let[i,o,a,c,h,f,d,p]=e;const y=((v,x,b,w,T,E,M)=>{if(b===0||w===0)return[];let C=0,D=0,j=0;const R=Math.PI,z=M*Np,U=Ui(z),G=Hi(z),ut=.5*(-G*v-U*x),W=.5*(-G*x+U*v),Z=b**2,rt=w**2,N=W**2,I=ut**2,A=Z*rt-Z*N-rt*I;let L=Math.abs(b),H=Math.abs(w);if(A<0){const gt=Math.sqrt(1-A/(Z*rt));L*=gt,H*=gt}else j=(T===E?-1:1)*Math.sqrt(A/(Z*N+rt*I));const q=j*L*W/H,st=-j*H*ut/L,k=G*q-U*st+.5*v,P=U*q+G*st+.5*x;let et=C1(1,0,(ut-q)/L,(W-st)/H),nt=C1((ut-q)/L,(W-st)/H,(-ut-q)/L,(-W-st)/H);E===0&&nt>0?nt-=2*R:E===1&&nt<0&&(nt+=2*R);const ht=Math.ceil(Math.abs(nt/R*2)),dt=[],ft=nt/ht,X=8/3*Math.sin(ft/4)*Math.sin(ft/4)/Math.sin(ft/2);let ot=et+ft;for(let gt=0;gt<ht;gt++)dt[gt]=nj(et,ot,G,U,L,H,k,P,X,C,D),C=dt[gt][5],D=dt[gt][6],et=ot,ot+=ft;return dt})(d-s,p-t,o,a,h,f,c);for(let v=0,x=y.length;v<x;v++)y[v][1]+=s,y[v][2]+=t,y[v][3]+=s,y[v][4]+=t,y[v][5]+=s,y[v][6]+=t;return y},sj=s=>{let t=0,e=0,i=0,o=0;const a=[];let c,h=0,f=0;for(const d of s){const p=[...d];let y;switch(p[0]){case"l":p[1]+=t,p[2]+=e;case"L":t=p[1],e=p[2],y=["L",t,e];break;case"h":p[1]+=t;case"H":t=p[1],y=["L",t,e];break;case"v":p[1]+=e;case"V":e=p[1],y=["L",t,e];break;case"m":p[1]+=t,p[2]+=e;case"M":t=p[1],e=p[2],i=p[1],o=p[2],y=["M",t,e];break;case"c":p[1]+=t,p[2]+=e,p[3]+=t,p[4]+=e,p[5]+=t,p[6]+=e;case"C":h=p[3],f=p[4],t=p[5],e=p[6],y=["C",p[1],p[2],h,f,t,e];break;case"s":p[1]+=t,p[2]+=e,p[3]+=t,p[4]+=e;case"S":c==="C"?(h=2*t-h,f=2*e-f):(h=t,f=e),t=p[3],e=p[4],y=["C",h,f,p[1],p[2],t,e],h=y[3],f=y[4];break;case"q":p[1]+=t,p[2]+=e,p[3]+=t,p[4]+=e;case"Q":h=p[1],f=p[2],t=p[3],e=p[4],y=["Q",h,f,t,e];break;case"t":p[1]+=t,p[2]+=e;case"T":c==="Q"?(h=2*t-h,f=2*e-f):(h=t,f=e),t=p[1],e=p[2],y=["Q",h,f,t,e];break;case"a":p[6]+=t,p[7]+=e;case"A":ij(t,e,p).forEach(v=>a.push(v)),t=p[6],e=p[7];break;case"z":case"Z":t=i,e=o,y=["Z"]}y?(a.push(y),c=y[0]):c=""}return a},fh=(s,t,e,i)=>Math.sqrt((e-s)**2+(i-t)**2),b_=(s,t,e,i,o,a,c,h)=>f=>{const d=f**3,p=(x=>3*x**2*(1-x))(f),y=(x=>3*x*(1-x)**2)(f),v=(x=>(1-x)**3)(f);return new tt(c*d+o*p+e*y+s*v,h*d+a*p+i*y+t*v)},S_=s=>s**2,__=s=>2*s*(1-s),w_=s=>(1-s)**2,rj=(s,t,e,i,o,a,c,h)=>f=>{const d=S_(f),p=__(f),y=w_(f),v=3*(y*(e-s)+p*(o-e)+d*(c-o)),x=3*(y*(i-t)+p*(a-i)+d*(h-a));return Math.atan2(x,v)},oj=(s,t,e,i,o,a)=>c=>{const h=S_(c),f=__(c),d=w_(c);return new tt(o*h+e*f+s*d,a*h+i*f+t*d)},aj=(s,t,e,i,o,a)=>c=>{const h=1-c,f=2*(h*(e-s)+c*(o-e)),d=2*(h*(i-t)+c*(a-i));return Math.atan2(d,f)},E1=(s,t,e)=>{let i=new tt(t,e),o=0;for(let a=1;a<=100;a+=1){const c=s(a/100);o+=fh(i.x,i.y,c.x,c.y),i=c}return o},lj=(s,t)=>{let e,i=0,o=0,a={x:s.x,y:s.y},c={...a},h=.01,f=0;const d=s.iterator,p=s.angleFinder;for(;o<t&&h>1e-4;)c=d(i),f=i,e=fh(a.x,a.y,c.x,c.y),e+o>t?(i-=h,h/=2):(a=c,i+=h,o+=e);return{...c,angle:p(f)}},C_=s=>{let t,e,i=0,o=0,a=0,c=0,h=0;const f=[];for(const d of s){const p={x:o,y:a,command:d[0],length:0};switch(d[0]){case"M":e=p,e.x=c=o=d[1],e.y=h=a=d[2];break;case"L":e=p,e.length=fh(o,a,d[1],d[2]),o=d[1],a=d[2];break;case"C":t=b_(o,a,d[1],d[2],d[3],d[4],d[5],d[6]),e=p,e.iterator=t,e.angleFinder=rj(o,a,d[1],d[2],d[3],d[4],d[5],d[6]),e.length=E1(t,o,a),o=d[5],a=d[6];break;case"Q":t=oj(o,a,d[1],d[2],d[3],d[4]),e=p,e.iterator=t,e.angleFinder=aj(o,a,d[1],d[2],d[3],d[4]),e.length=E1(t,o,a),o=d[3],a=d[4];break;case"Z":e=p,e.destX=c,e.destY=h,e.length=fh(o,a,c,h),o=c,a=h}i+=e.length,f.push(e)}return f.push({length:i,x:o,y:a}),f},cj=function(s,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:C_(s),i=0;for(;t-e[i].length>0&&i<e.length-2;)t-=e[i].length,i++;const o=e[i],a=t/o.length,c=s[i];switch(o.command){case"M":return{x:o.x,y:o.y,angle:0};case"Z":return{...new tt(o.x,o.y).lerp(new tt(o.destX,o.destY),a),angle:Math.atan2(o.destY-o.y,o.destX-o.x)};case"L":return{...new tt(o.x,o.y).lerp(new tt(c[1],c[2]),a),angle:Math.atan2(c[2]-o.y,c[1]-o.x)};case"C":case"Q":return lj(o,t)}},uj=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),M1=new RegExp(tj,"g"),hj=new RegExp(xr,"gi"),fj={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},dj=s=>{var t;const e=[],i=(t=s.match(uj))!==null&&t!==void 0?t:[];for(const o of i){const a=o[0];if(a==="z"||a==="Z"){e.push([a]);continue}const c=fj[a.toLowerCase()];let h=[];if(a==="a"||a==="A"){M1.lastIndex=0;for(let f=null;f=M1.exec(o);)h.push(...f.slice(1))}else h=o.match(hj)||[];for(let f=0;f<h.length;f+=c){const d=new Array(c),p=ej[a];d[0]=f>0&&p?p:a;for(let y=0;y<c;y++)d[y+1]=parseFloat(h[f+y]);e.push(d)}}return e},gj=function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=new tt(s[0]),i=new tt(s[1]),o=1,a=0;const c=[],h=s.length,f=h>2;let d;for(f&&(o=s[2].x<i.x?-1:s[2].x===i.x?0:1,a=s[2].y<i.y?-1:s[2].y===i.y?0:1),c.push(["M",e.x-o*t,e.y-a*t]),d=1;d<h;d++){if(!e.eq(i)){const p=e.midPointFrom(i);c.push(["Q",e.x,e.y,p.x,p.y])}e=s[d],d+1<s.length&&(i=s[d+1])}return f&&(o=e.x>s[d-2].x?1:e.x===s[d-2].x?0:-1,a=e.y>s[d-2].y?1:e.y===s[d-2].y?0:-1),c.push(["L",e.x+o*t,e.y+a*t]),c},T_=(s,t)=>s.map(e=>e.map((i,o)=>o===0||t===void 0?i:Kt(i,t)).join(" ")).join(" ");function lp(s,t){const e=s.style;e&&Object.entries(t).forEach(i=>{let[o,a]=i;return e.setProperty(o,a)})}class pj extends WS{constructor(t){let{allowTouchScrolling:e=!1,containerClass:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),V(this,"upper",void 0),V(this,"container",void 0);const{el:o}=this.lower,a=this.createUpperCanvas();this.upper={el:a,ctx:a.getContext("2d")},this.applyCanvasStyle(o,{allowTouchScrolling:e}),this.applyCanvasStyle(a,{allowTouchScrolling:e,styles:{position:"absolute",left:"0",top:"0"}});const c=this.createContainerElement();c.classList.add(i),o.parentNode&&o.parentNode.replaceChild(c,o),c.append(o,a),this.container=c}createUpperCanvas(){const{el:t}=this.lower,e=Pi();return e.className=t.className,e.classList.remove("lower-canvas"),e.classList.add("upper-canvas"),e.setAttribute("data-fabric","top"),e.style.cssText=t.style.cssText,e.setAttribute("draggable","true"),e}createContainerElement(){const t=Lo().createElement("div");return t.setAttribute("data-fabric","wrapper"),lp(t,{position:"relative"}),l1(t),t}applyCanvasStyle(t,e){const{styles:i,allowTouchScrolling:o}=e;lp(t,{...i,"touch-action":o?"manipulation":Ke}),l1(t)}setDimensions(t,e){super.setDimensions(t,e);const{el:i,ctx:o}=this.upper;qS(i,o,t,e)}setCSSDimensions(t){super.setCSSDimensions(t),ep(this.upper.el,t),ep(this.container,t)}cleanupDOM(t){const e=this.container,{el:i}=this.lower,{el:o}=this.upper;super.cleanupDOM(t),e.removeChild(o),e.removeChild(i),e.parentNode&&e.parentNode.replaceChild(i,e)}dispose(){super.dispose(),ni().dispose(this.upper.el),delete this.upper,delete this.container}}const mj=(s,t,e,i)=>{const{target:o,offsetX:a,offsetY:c}=t,h=e-a,f=i-c,d=!Pn(o,"lockMovementX")&&o.left!==h,p=!Pn(o,"lockMovementY")&&o.top!==f;return d&&o.set(Yt,h),p&&o.set(Ze,f),(d||p)&&u_(zS,n_(s,t,e,i)),d||p};class Lh extends Cl{constructor(){super(...arguments),V(this,"_hoveredTargets",[]),V(this,"_currentTransform",null),V(this,"_groupSelector",null),V(this,"contextTopDirty",!1)}static getDefaults(){return{...super.getDefaults(),...Lh.ownDefaults}}get upperCanvasEl(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.el}get contextTop(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.ctx}get wrapperEl(){return this.elements.container}initElements(t){this.elements=new pj(t,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(t){this._objectsToRender=void 0,super._onObjectAdded(t)}_onObjectRemoved(t){this._objectsToRender=void 0,t===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[t]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[t]}),t.fire("deselected",{target:t})),t===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(t)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const t=this._activeObject;return!this.preserveObjectStacking&&t?this._objects.filter(e=>!e.group&&e!==t).concat(t):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()}renderTop(){const t=this.contextTop;this.clearContext(t),this.renderTopLayer(t),this.fire("after:render",{ctx:t})}setTargetFindTolerance(t){t=Math.round(t),this.targetFindTolerance=t;const e=this.getRetinaScaling(),i=Math.ceil((2*t+1)*e);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=i,this.pixelFindContext.scale(e,e)}isTargetTransparent(t,e,i){const o=this.targetFindTolerance,a=this.pixelFindContext;this.clearContext(a),a.save(),a.translate(-e+o,-i+o),a.transform(...this.viewportTransform);const c=t.selectionBackgroundColor;t.selectionBackgroundColor="",t.render(a),t.selectionBackgroundColor=c,a.restore();const h=Math.round(o*this.getRetinaScaling());return Tk(a,h,h,h)}_isSelectionKeyPressed(t){const e=this.selectionKey;return!!e&&(Array.isArray(e)?!!e.find(i=>!!i&&t[i]===!0):t[e])}_shouldClearSelection(t,e){const i=this.getActiveObjects(),o=this._activeObject;return!!(!e||e&&o&&i.length>1&&i.indexOf(e)===-1&&o!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&o&&o!==e)}_shouldCenterTransform(t,e,i){if(!t)return;let o;return e===Oh||e===Qe||e===wn||e===cl?o=this.centeredScaling||t.centeredScaling:e===Lp&&(o=this.centeredRotation||t.centeredRotation),o?!i:i}_getOriginFromCorner(t,e){const i={x:t.originX,y:t.originY};return e&&(["ml","tl","bl"].includes(e)?i.x=le:["mr","tr","br"].includes(e)&&(i.x=Yt),["tl","mt","tr"].includes(e)?i.y=Jg:["bl","mb","br"].includes(e)&&(i.y=Ze)),i}_setupCurrentTransform(t,e,i){var o;const a=e.group?jo(this.getScenePoint(t),void 0,e.group.calcTransformMatrix()):this.getScenePoint(t),{key:c="",control:h}=e.getActiveControl()||{},f=i&&h?(o=h.getActionHandler(t,e,h))===null||o===void 0?void 0:o.bind(h):mj,d=((U,G,ut,W)=>{if(!G||!U)return"drag";const Z=W.controls[G];return Z.getActionName(ut,Z,W)})(i,c,t,e),p=t[this.centeredKey],y=this._shouldCenterTransform(e,d,p)?{x:Dt,y:Dt}:this._getOriginFromCorner(e,c),{scaleX:v,scaleY:x,skewX:b,skewY:w,left:T,top:E,angle:M,width:C,height:D,cropX:j,cropY:R}=e,z={target:e,action:d,actionHandler:f,actionPerformed:!1,corner:c,scaleX:v,scaleY:x,skewX:b,skewY:w,offsetX:a.x-T,offsetY:a.y-E,originX:y.x,originY:y.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:ce(M),width:C,height:D,shiftKey:t.shiftKey,altKey:p,original:{...ZS(e),originX:y.x,originY:y.y,cropX:j,cropY:R}};this._currentTransform=z,this.fire("before:transform",{e:t,transform:z})}setCursor(t){this.upperCanvasEl.style.cursor=t}_drawSelection(t){const{x:e,y:i,deltaX:o,deltaY:a}=this._groupSelector,c=new tt(e,i).transform(this.viewportTransform),h=new tt(e+o,i+a).transform(this.viewportTransform),f=this.selectionLineWidth/2;let d=Math.min(c.x,h.x),p=Math.min(c.y,h.y),y=Math.max(c.x,h.x),v=Math.max(c.y,h.y);this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(d,p,y-d,v-p)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,d+=f,p+=f,y-=f,v-=f,ke.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(d,p,y-d,v-p))}findTarget(t){if(this._targetInfo)return this._targetInfo;if(this.skipTargetFind)return{subTargets:[],currentSubTargets:[]};const e=this.getScenePoint(t),i=this._activeObject,o=this.getActiveObjects(),a=this.searchPossibleTargets(this._objects,e),{subTargets:c,container:h,target:f}=a,d={...a,currentSubTargets:c,currentContainer:h,currentTarget:f};if(!i)return d;const p={...this.searchPossibleTargets([i],e),currentSubTargets:c,currentContainer:h,currentTarget:f};return i.findControl(this.getViewportPoint(t),np(t))?{...p,target:i}:p.target&&(o.length>1||!this.preserveObjectStacking||this.preserveObjectStacking&&t[this.altSelectionKey])?p:d}_pointIsInObjectSelectionArea(t,e){let i=t.getCoords();const o=this.getZoom(),a=t.padding/o;if(a){const[c,h,f,d]=i,p=Math.atan2(h.y-c.y,h.x-c.x),y=Hi(p)*a,v=Ui(p)*a,x=y+v,b=y-v;i=[new tt(c.x-b,c.y-x),new tt(h.x+x,h.y-b),new tt(f.x+b,f.y+x),new tt(d.x-x,d.y+b)]}return ie.isPointInPolygon(e,i)}_checkTarget(t,e){if(t&&t.visible&&t.evented&&this._pointIsInObjectSelectionArea(t,e)){if(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing)return!0;{const i=e.transform(this.viewportTransform);if(!this.isTargetTransparent(t,i.x,i.y))return!0}}return!1}_searchPossibleTargets(t,e,i){let o=t.length;for(;o--;){const a=t[o];if(this._checkTarget(a,e)){if(Hu(a)&&a.subTargetCheck){const{target:c}=this._searchPossibleTargets(a._objects,e,i);c&&i.push(c)}return{target:a,subTargets:i}}}return{subTargets:[]}}searchPossibleTargets(t,e){const i=this._searchPossibleTargets(t,e,[]);i.container=i.target;const{container:o,subTargets:a}=i;if(o&&Hu(o)&&o.interactive&&a[0]){for(let c=a.length-1;c>0;c--){const h=a[c];if(!Hu(h)||!h.interactive)return i.target=h,i}return i.target=a[0],i}return i}getViewportPoint(t){return this._viewportPoint?this._viewportPoint:this._getPointerImpl(t,!0)}getScenePoint(t){return this._scenePoint?this._scenePoint:this._getPointerImpl(t)}_getPointerImpl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=this.upperCanvasEl,o=i.getBoundingClientRect();let a=Y5(t),c=o.width||0,h=o.height||0;c&&h||(Ze in o&&Jg in o&&(h=Math.abs(o.top-o.bottom)),le in o&&Yt in o&&(c=Math.abs(o.right-o.left))),this.calcOffset(),a.x=a.x-this._offset.left,a.y=a.y-this._offset.top,e||(a=jo(a,void 0,this.viewportTransform));const f=this.getRetinaScaling();f!==1&&(a.x/=f,a.y/=f);const d=c===0||h===0?new tt(1,1):new tt(i.width/c,i.height/h);return a.multiply(d)}_setDimensionsImpl(t,e){this._resetTransformEventData(),super._setDimensionsImpl(t,e),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Pi(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const t=this._activeObject;return ir(t)?t.getObjects():t?[t]:[]}_fireSelectionEvents(t,e){let i=!1,o=!1;const a=this.getActiveObjects(),c=[],h=[];t.forEach(f=>{a.includes(f)||(i=!0,f.fire("deselected",{e,target:f}),h.push(f))}),a.forEach(f=>{t.includes(f)||(i=!0,f.fire("selected",{e,target:f}),c.push(f))}),t.length>0&&a.length>0?(o=!0,i&&this.fire("selection:updated",{e,selected:c,deselected:h})):a.length>0?(o=!0,this.fire("selection:created",{e,selected:c})):t.length>0&&(o=!0,this.fire("selection:cleared",{e,deselected:h})),o&&(this._objectsToRender=void 0)}setActiveObject(t,e){const i=this.getActiveObjects(),o=this._setActiveObject(t,e);return this._fireSelectionEvents(i,e),o}_setActiveObject(t,e){const i=this._activeObject;return i!==t&&!(!this._discardActiveObject(e,t)&&this._activeObject)&&!t.onSelect({e})&&(this._activeObject=t,ir(t)&&i!==t&&t.set("canvas",this),t.setCoords(),!0)}_discardActiveObject(t,e){const i=this._activeObject;return!!i&&!i.onDeselect({e:t,object:e})&&(this._currentTransform&&this._currentTransform.target===i&&this.endCurrentTransform(t),ir(i)&&i===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(t){const e=this.getActiveObjects(),i=this.getActiveObject();e.length&&this.fire("before:selection:cleared",{e:t,deselected:[i]});const o=this._discardActiveObject(t);return this._fireSelectionEvents(e,t),o}endCurrentTransform(t){const e=this._currentTransform;this._finalizeCurrentTransform(t),e&&e.target&&(e.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(t){const e=this._currentTransform,i=e.target,o={e:t,target:i,transform:e,action:e.action};i._scaling&&(i._scaling=!1),i.setCoords(),e.actionPerformed&&(this.fire("object:modified",o),i.fire(nh,o))}setViewportTransform(t){super.setViewportTransform(t);const e=this._activeObject;e&&e.setCoords()}destroy(){const t=this._activeObject;ir(t)&&(t.removeAll(),t.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(t){const e=this._activeObject;e&&e._renderControls(t)}_toObject(t,e,i){const o=this._realizeGroupTransformOnObject(t),a=super._toObject(t,e,i);return t.set(o),a}_realizeGroupTransformOnObject(t){const{group:e}=t;if(e&&ir(e)&&this._activeObject===e){const i=Po(t,["angle","flipX","flipY",Yt,Qe,wn,Bo,Ho,Ze]);return V5(t,e.calcOwnMatrix()),i}return{}}_setSVGObject(t,e,i){const o=this._realizeGroupTransformOnObject(e);super._setSVGObject(t,e,i),e.set(o)}}V(Lh,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!0,fireRightClick:!0,fireMiddleClick:!0,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!0});class yj{constructor(t){V(this,"targets",[]),V(this,"__disposer",void 0);const e=()=>{const{hiddenTextarea:o}=t.getActiveObject()||{};o&&o.focus()},i=t.upperCanvasEl;i.addEventListener("click",e),this.__disposer=()=>i.removeEventListener("click",e)}exitTextEditing(){this.target=void 0,this.targets.forEach(t=>{t.isEditing&&t.exitEditing()})}add(t){this.targets.push(t)}remove(t){this.unregister(t),ho(this.targets,t)}register(t){this.target=t}unregister(t){t===this.target&&(this.target=void 0)}onMouseMove(t){var e;!((e=this.target)===null||e===void 0)&&e.isEditing&&this.target.updateSelectionOnMouseMove(t)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const ln={passive:!1},tr=(s,t)=>({viewportPoint:s.getViewportPoint(t),scenePoint:s.getScenePoint(t)}),_s=function(s){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return s.addEventListener(...e)},bn=function(s){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return s.removeEventListener(...e)},vj={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class cp extends Lh{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),V(this,"_isClick",void 0),V(this,"textEditingManager",new yj(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(e=>{this[e]=this[e].bind(this)}),this.addOrRemove(_s)}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=this.upperCanvasEl,o=this._getEventPrefix();t($S(i),"resize",this._onResize),t(i,o+"down",this._onMouseDown),t(i,`${o}move`,this._onMouseMove,ln),t(i,`${o}out`,this._onMouseOut),t(i,`${o}enter`,this._onMouseEnter),t(i,"wheel",this._onMouseWheel,{passive:!1}),t(i,"contextmenu",this._onContextMenu),e||(t(i,"click",this._onClick),t(i,"dblclick",this._onClick)),t(i,"dragstart",this._onDragStart),t(i,"dragend",this._onDragEnd),t(i,"dragover",this._onDragOver),t(i,"dragenter",this._onDragEnter),t(i,"dragleave",this._onDragLeave),t(i,"drop",this._onDrop),this.enablePointerEvents||t(i,"touchstart",this._onTouchStart,ln)}removeListeners(){this.addOrRemove(bn);const t=this._getEventPrefix(),e=Ln(this.upperCanvasEl);bn(e,`${t}up`,this._onMouseUp),bn(e,"touchend",this._onTouchEnd,ln),bn(e,`${t}move`,this._onMouseMove,ln),bn(e,"touchmove",this._onMouseMove,ln),clearTimeout(this._willAddMouseDown)}_onMouseWheel(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()}_onMouseOut(t){const e=this._hoveredTarget,i={e:t,...tr(this,t)};this.fire("mouse:out",{...i,target:e}),this._hoveredTarget=void 0,e&&e.fire("mouseout",{...i}),this._hoveredTargets.forEach(o=>{this.fire("mouse:out",{...i,target:o}),o&&o.fire("mouseout",{...i})}),this._hoveredTargets=[]}_onMouseEnter(t){const{target:e}=this.findTarget(t);this._currentTransform||e||(this.fire("mouse:over",{e:t,...tr(this,t)}),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(t){this._isClick=!1;const e=this.getActiveObject();if(e&&e.onDragStart(t)){this._dragSource=e;const i={e:t,target:e};return this.fire("dragstart",i),e.fire("dragstart",i),void _s(this.upperCanvasEl,"drag",this._onDragProgress)}c1(t)}_renderDragEffects(t,e,i){let o=!1;const a=this._dropTarget;a&&a!==e&&a!==i&&(a.clearContextTop(),o=!0),e?.clearContextTop(),i!==e&&i?.clearContextTop();const c=this.contextTop;c.save(),c.transform(...this.viewportTransform),e&&(c.save(),e.transform(c),e.renderDragSourceEffect(t),c.restore(),o=!0),i&&(c.save(),i.transform(c),i.renderDropTargetEffect(t),c.restore(),o=!0),c.restore(),o&&(this.contextTopDirty=!0)}_onDragEnd(t){const{currentSubTargets:e}=this.findTarget(t),i=!!t.dataTransfer&&t.dataTransfer.dropEffect!==Ke,o=i?this._activeObject:void 0,a={e:t,target:this._dragSource,subTargets:e,dragSource:this._dragSource,didDrop:i,dropTarget:o};bn(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",a),this._dragSource&&this._dragSource.fire("dragend",a),delete this._dragSource,this._onMouseUp(t)}_onDragProgress(t){const e={e:t,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",e),this._dragSource&&this._dragSource.fire("drag",e)}_onDragOver(t){const e="dragover",{currentContainer:i,currentSubTargets:o}=this.findTarget(t),a=this._dragSource,c={e:t,target:i,subTargets:o,dragSource:a,canDrop:!1,dropTarget:void 0};let h;this.fire(e,c),this._fireEnterLeaveEvents(t,i,c),i&&(i.canDrop(t)&&(h=i),i.fire(e,c));for(let f=0;f<o.length;f++){const d=o[f];d.canDrop(t)&&(h=d),d.fire(e,c)}this._renderDragEffects(t,a,h),this._dropTarget=h}_onDragEnter(t){const{currentContainer:e,currentSubTargets:i}=this.findTarget(t),o={e:t,target:e,subTargets:i,dragSource:this._dragSource};this.fire("dragenter",o),this._fireEnterLeaveEvents(t,e,o)}_onDragLeave(t){const{currentSubTargets:e}=this.findTarget(t),i={e:t,target:this._draggedoverTarget,subTargets:e,dragSource:this._dragSource};this.fire("dragleave",i),this._fireEnterLeaveEvents(t,void 0,i),this._renderDragEffects(t,this._dragSource),this._dropTarget=void 0,this._hoveredTargets=[]}_onDrop(t){const{currentContainer:e,currentSubTargets:i}=this.findTarget(t),o=this._basicEventHandler("drop:before",{e:t,target:e,subTargets:i,dragSource:this._dragSource,...tr(this,t)});o.didDrop=!1,o.dropTarget=void 0,this._basicEventHandler("drop",o),this.fire("drop:after",o)}_onContextMenu(t){const{target:e,subTargets:i}=this.findTarget(t),o=this._basicEventHandler("contextmenu:before",{e:t,target:e,subTargets:i});return this.stopContextMenu&&c1(t),this._basicEventHandler("contextmenu",o),!1}_onClick(t){const e=t.detail;e>3||e<2||(this._cacheTransformEventData(t),e==2&&t.type==="dblclick"&&this._handleEvent(t,"dblclick"),e==3&&this._handleEvent(t,"tripleclick"),this._resetTransformEventData())}fireEventFromPointerEvent(t,e,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._cacheTransformEventData(t);const{target:a,subTargets:c}=this.findTarget(t),h={e:t,target:a,subTargets:c,...tr(this,t),transform:this._currentTransform,...o};this.fire(e,h),a&&a.fire(i,h);for(let f=0;f<c.length;f++)c[f]!==a&&c[f].fire(i,h);this._resetTransformEventData()}getPointerId(t){const e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1}_isMainEvent(t){return t.isPrimary===!0||t.isPrimary!==!1&&(t.type==="touchend"&&t.touches.length===0||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(t){this._cacheTransformEventData(t);let e=!this.allowTouchScrolling;const i=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t);const{target:o}=this.findTarget(t);(this.isDrawingMode||i&&o===i)&&(e=!0),e&&t.preventDefault();const a=this.upperCanvasEl,c=this._getEventPrefix(),h=Ln(a);_s(h,"touchend",this._onTouchEnd,ln),e&&_s(h,"touchmove",this._onMouseMove,ln),bn(a,`${c}down`,this._onMouseDown),this._resetTransformEventData()}_onMouseDown(t){this._cacheTransformEventData(t),this.__onMouseDown(t);const e=this.upperCanvasEl,i=this._getEventPrefix();bn(e,`${i}move`,this._onMouseMove,ln);const o=Ln(e);_s(o,`${i}up`,this._onMouseUp),_s(o,`${i}move`,this._onMouseMove,ln),this._resetTransformEventData()}_onTouchEnd(t){if(t.touches.length>0)return;this._cacheTransformEventData(t),this.__onMouseUp(t),this._resetTransformEventData(),delete this.mainTouchId;const e=this._getEventPrefix(),i=Ln(this.upperCanvasEl);bn(i,"touchend",this._onTouchEnd,ln),bn(i,"touchmove",this._onMouseMove,ln),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{_s(this.upperCanvasEl,`${e}down`,this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(t){this._cacheTransformEventData(t),this.__onMouseUp(t);const e=this.upperCanvasEl,i=this._getEventPrefix();if(this._isMainEvent(t)){const o=Ln(this.upperCanvasEl);bn(o,`${i}up`,this._onMouseUp),bn(o,`${i}move`,this._onMouseMove,ln),_s(e,`${i}move`,this._onMouseMove,ln)}this._resetTransformEventData()}_onMouseMove(t){this._cacheTransformEventData(t);const e=this.getActiveObject();!this.allowTouchScrolling&&(!e||!e.shouldStartDragging(t))&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t),this._resetTransformEventData()}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(t){const e=this.getActiveObject();return!!e!=!!t||e&&t&&e!==t}__onMouseUp(t){var e;this._handleEvent(t,"up:before");const i=this._currentTransform,o=this._isClick,{target:a}=this.findTarget(t),{button:c}=t;if(c)return void((this.fireMiddleClick&&c===1||this.fireRightClick&&c===2)&&this._handleEvent(t,"up"));if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);if(!this._isMainEvent(t))return;let h,f,d=!1;if(i&&(this._finalizeCurrentTransform(t),d=i.actionPerformed),!o){const p=a===this._activeObject;this.handleSelection(t),d||(d=this._shouldRender(a)||!p&&a===this._activeObject)}if(a){const p=a.findControl(this.getViewportPoint(t),np(t)),{key:y,control:v}=p||{};if(f=y,a.selectable&&a!==this._activeObject&&a.activeOn==="up")this.setActiveObject(a,t),d=!0;else if(v){const x=v.getMouseUpHandler(t,a,v);x&&(h=this.getScenePoint(t),x.call(v,t,i,h.x,h.y))}a.isMoving=!1}if(i&&(i.target!==a||i.corner!==f)){const p=i.target&&i.target.controls[i.corner],y=p&&p.getMouseUpHandler(t,i.target,p);h=h||this.getScenePoint(t),y&&y.call(p,t,i,h.x,h.y)}this._setCursorFromEvent(t,a),this._handleEvent(t,"up"),this._groupSelector=null,this._currentTransform=null,a&&(a.__corner=void 0),d?this.requestRenderAll():o||(e=this._activeObject)!==null&&e!==void 0&&e.isEditing||this.renderTop()}_basicEventHandler(t,e){const{target:i,subTargets:o=[]}=e;this.fire(t,e),i&&i.fire(t,e);for(let a=0;a<o.length;a++)o[a]!==i&&o[a].fire(t,e);return e}_handleEvent(t,e,i){const{target:o,subTargets:a}=this.findTarget(t),c={e:t,target:o,subTargets:a,...tr(this,t),transform:this._currentTransform,...e==="down:before"||e==="down"?i:{}};e!=="up:before"&&e!=="up"||(c.isClick=this._isClick),this.fire(`mouse:${e}`,c),o&&o.fire(`mouse${e}`,c);for(let h=0;h<a.length;h++)a[h]!==o&&a[h].fire(`mouse${e}`,c)}_onMouseDownInDrawingMode(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(t),this.requestRenderAll());const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(t){if(this._isCurrentlyDrawing){const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")}_onMouseUpInDrawingMode(t){const e=this.getScenePoint(t);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:t,pointer:e}):this._isCurrentlyDrawing=!1,this._handleEvent(t,"up")}__onMouseDown(t){this._isClick=!0,this._handleEvent(t,"down:before");let{target:e}=this.findTarget(t),i=!!e&&e===this._activeObject;const{button:o}=t;if(o)return void((this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(t,"down",{alreadySelected:i}));if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._isMainEvent(t)||this._currentTransform)return;let a=this._shouldRender(e),c=!1;if(this.handleMultiSelection(t,e)?(e=this._activeObject,c=!0,a=!0):this._shouldClearSelection(t,e)&&this.discardActiveObject(t),this.selection&&(!e||!e.selectable&&!e.isEditing&&e!==this._activeObject)){const h=this.getScenePoint(t);this._groupSelector={x:h.x,y:h.y,deltaY:0,deltaX:0}}if(i=!!e&&e===this._activeObject,e){e.selectable&&e.activeOn==="down"&&this.setActiveObject(e,t);const h=e.findControl(this.getViewportPoint(t),np(t));if(e===this._activeObject&&(h||!c)){this._setupCurrentTransform(t,e,i);const f=h?h.control:void 0,d=this.getScenePoint(t),p=f&&f.getMouseDownHandler(t,e,f);p&&p.call(f,t,this._currentTransform,d.x,d.y)}}a&&(this._objectsToRender=void 0),this._handleEvent(t,"down",{alreadySelected:i}),a&&this.requestRenderAll()}_resetTransformEventData(){this._targetInfo=this._viewportPoint=this._scenePoint=void 0}_cacheTransformEventData(t){this._resetTransformEventData(),this._viewportPoint=this.getViewportPoint(t),this._scenePoint=jo(this._viewportPoint,void 0,this.viewportTransform),this._targetInfo=this.findTarget(t),this._currentTransform&&(this._targetInfo.target=this._currentTransform.target)}__onMouseMove(t){if(this._isClick=!1,this._handleEvent(t,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!this._isMainEvent(t))return;const e=this._groupSelector;if(e){const i=this.getScenePoint(t);e.deltaX=i.x-e.x,e.deltaY=i.y-e.y,this.renderTop()}else if(this._currentTransform)this._transformObject(t);else{const{target:i}=this.findTarget(t);this._setCursorFromEvent(t,i),this._fireOverOutEvents(t,i)}this.textEditingManager.onMouseMove(t),this._handleEvent(t,"move")}_fireOverOutEvents(t,e){const{_hoveredTarget:i,_hoveredTargets:o}=this,{subTargets:a}=this.findTarget(t),c=Math.max(o.length,a.length);this.fireSyntheticInOutEvents("mouse",{e:t,target:e,oldTarget:i,fireCanvas:!0});for(let h=0;h<c;h++)a[h]===e||o[h]&&o[h]===i||this.fireSyntheticInOutEvents("mouse",{e:t,target:a[h],oldTarget:o[h]});this._hoveredTarget=e,this._hoveredTargets=a}_fireEnterLeaveEvents(t,e,i){const o=this._draggedoverTarget,a=this._hoveredTargets,{subTargets:c}=this.findTarget(t),h=Math.max(a.length,c.length);this.fireSyntheticInOutEvents("drag",{...i,target:e,oldTarget:o,fireCanvas:!0});for(let f=0;f<h;f++)this.fireSyntheticInOutEvents("drag",{...i,target:c[f],oldTarget:a[f]});this._draggedoverTarget=e}fireSyntheticInOutEvents(t,e){let{target:i,oldTarget:o,fireCanvas:a,e:c,...h}=e;const{targetIn:f,targetOut:d,canvasIn:p,canvasOut:y}=vj[t],v=o!==i;if(o&&v){const x={...h,e:c,target:o,nextTarget:i,...tr(this,c)};a&&this.fire(y,x),o.fire(d,x)}if(i&&v){const x={...h,e:c,target:i,previousTarget:o,...tr(this,c)};a&&this.fire(p,x),i.fire(f,x)}}_transformObject(t){const e=this.getScenePoint(t),i=this._currentTransform,o=i.target,a=o.group?jo(e,void 0,o.group.calcTransformMatrix()):e;i.shiftKey=t.shiftKey,i.altKey=!!this.centeredKey&&t[this.centeredKey],this._performTransformAction(t,i,a),i.actionPerformed&&this.requestRenderAll()}_performTransformAction(t,e,i){const{action:o,actionHandler:a,target:c}=e,h=!!a&&a(t,e,i.x,i.y);h&&c.setCoords(),o==="drag"&&h&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||h}_setCursorFromEvent(t,e){if(!e)return void this.setCursor(this.defaultCursor);let i=e.hoverCursor||this.hoverCursor;const o=ir(this._activeObject)?this._activeObject:null,a=(!o||e.group!==o)&&e.findControl(this.getViewportPoint(t));if(a){const{control:c,coord:h}=a;this.setCursor(c.cursorStyleHandler(t,c,e,h))}else{if(e.subTargetCheck){const{subTargets:c}=this.findTarget(t);c.concat().reverse().forEach(h=>{i=h.hoverCursor||i})}this.setCursor(i)}}handleMultiSelection(t,e){const i=this._activeObject,o=ir(i);if(i&&this._isSelectionKeyPressed(t)&&this.selection&&e&&e.selectable&&(i!==e||o)&&(o||!e.isDescendantOf(i)&&!i.isDescendantOf(e))&&!e.onSelect({e:t})&&!i.getActiveControl()){if(o){const a=i.getObjects();let c=[];if(e===i){const h=this.getScenePoint(t);let f=this.searchPossibleTargets(a,h);if(f.target?(e=f.target,c=f.subTargets):(f=this.searchPossibleTargets(this._objects,h),e=f.target,c=f.subTargets),!e||!e.selectable)return!1}e.group===i?(i.remove(e),this._hoveredTarget=e,this._hoveredTargets=c,i.size()===1&&this._setActiveObject(i.item(0),t)):(i.multiSelectAdd(e),this._hoveredTarget=i,this._hoveredTargets=c),this._fireSelectionEvents(a,t)}else{i.isEditing&&i.exitEditing();const a=new(mt.getClass("ActiveSelection"))([],{canvas:this});a.multiSelectAdd(i,e),this._hoveredTarget=a,this._setActiveObject(a,t),this._fireSelectionEvents([i],t)}return!0}return!1}handleSelection(t){if(!this.selection||!this._groupSelector)return!1;const{x:e,y:i,deltaX:o,deltaY:a}=this._groupSelector,c=new tt(e,i),h=c.add(new tt(o,a)),f=c.min(h),d=c.max(h).subtract(f),p=this.collectObjects({left:f.x,top:f.y,width:d.x,height:d.y},{includeIntersecting:!this.selectionFullyContained}),y=c.eq(h)?p[0]?[p[0]]:[]:p.length>1?p.filter(v=>!v.onSelect({e:t})).reverse():p;if(y.length===1)this.setActiveObject(y[0],t);else if(y.length>1){const v=mt.getClass("ActiveSelection");this.setActiveObject(new v(y,{canvas:this}),t)}return this._groupSelector=null,!0}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0;const{upper:i}=this.elements;i.ctx=void 0;const o=super.toCanvasElement(t,e);return i.ctx=i.el.getContext("2d"),o}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const E_={x1:0,y1:0,x2:0,y2:0},xj={...E_,r1:0,r2:0},mo=(s,t)=>isNaN(s)&&typeof t=="number"?t:s;function M_(s){return s&&/%$/.test(s)&&Number.isFinite(parseFloat(s))}function D_(s,t){const e=typeof s=="number"?s:typeof s=="string"?parseFloat(s)/(M_(s)?100:1):NaN;return No(0,mo(e,t),1)}const bj=/\s*;\s*/,Sj=/\s*:\s*/;function _j(s,t){let e,i;const o=s.getAttribute("style");if(o){const c=o.split(bj);c[c.length-1]===""&&c.pop();for(let h=c.length;h--;){const[f,d]=c[h].split(Sj).map(p=>p.trim());f==="stop-color"?e=d:f==="stop-opacity"&&(i=d)}}e=e||s.getAttribute("stop-color")||"rgb(0,0,0)",i=mo(parseFloat(i||s.getAttribute("stop-opacity")||""),1);const a=new Wt(e);return a.setAlpha(a.getAlpha()*i*t),{offset:D_(s.getAttribute("offset"),0),color:a.toRgba()}}function wj(s,t){const e=[],i=s.getElementsByTagName("stop"),o=D_(t,1);for(let a=i.length;a--;)e.push(_j(i[a],o));return e}function O_(s){return s.nodeName==="linearGradient"||s.nodeName==="LINEARGRADIENT"?"linear":"radial"}function A_(s){return s.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function kn(s,t){return s.getAttribute(t)}function Cj(s,t){return(function(e,i){let o,{width:a,height:c,gradientUnits:h}=i;return Object.entries(e).reduce((f,d)=>{let[p,y]=d;if(y==="Infinity")o=1;else if(y==="-Infinity")o=0;else{const v=typeof y=="string";o=v?parseFloat(y):y,v&&M_(y)&&(o*=.01,h==="pixels"&&(p!=="x1"&&p!=="x2"&&p!=="r2"||(o*=a),p!=="y1"&&p!=="y2"||(o*=c)))}return f[p]=o,f},{})})(O_(s)==="linear"?(function(e){return{x1:kn(e,"x1")||0,y1:kn(e,"y1")||0,x2:kn(e,"x2")||"100%",y2:kn(e,"y2")||0}})(s):(function(e){return{x1:kn(e,"fx")||kn(e,"cx")||"50%",y1:kn(e,"fy")||kn(e,"cy")||"50%",r1:0,x2:kn(e,"cx")||"50%",y2:kn(e,"cy")||"50%",r2:kn(e,"r")||"50%"}})(s),{...t,gradientUnits:A_(s)})}class lu{constructor(t){const{type:e="linear",gradientUnits:i="pixels",coords:o={},colorStops:a=[],offsetX:c=0,offsetY:h=0,gradientTransform:f,id:d}=t||{};Object.assign(this,{type:e,gradientUnits:i,coords:{...e==="radial"?xj:E_,...o},colorStops:a,offsetX:c,offsetY:h,gradientTransform:f,id:d?`${d}_${Es()}`:Es()})}addColorStop(t){for(const e in t)this.colorStops.push({offset:parseFloat(e),color:t[e]});return this}toObject(t){return{...Po(this,t),type:this.type,coords:{...this.coords},colorStops:this.colorStops.map(e=>({...e})),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0}}toSVG(t){let{additionalTransform:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[],o=this.gradientTransform?this.gradientTransform.concat():Ue.concat(),a=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",c=this.colorStops.map(y=>({...y})).sort((y,v)=>y.offset-v.offset);let h=-this.offsetX,f=-this.offsetY;var d;a==="objectBoundingBox"?(h/=t.width,f/=t.height):(h+=t.width/2,f+=t.height/2),(d=t)&&typeof d._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(h-=t.pathOffset.x,f-=t.pathOffset.y),o[4]-=h,o[5]-=f;const p=[`id="SVGID_${this.id}"`,`gradientUnits="${a}"`,`gradientTransform="${e?e+" ":""}${hl(o)}"`,""].join(" ");if(this.type==="linear"){const{x1:y,y1:v,x2:x,y2:b}=this.coords;i.push("<linearGradient ",p,' x1="',y,'" y1="',v,'" x2="',x,'" y2="',b,`">
`)}else if(this.type==="radial"){const{x1:y,y1:v,x2:x,y2:b,r1:w,r2:T}=this.coords,E=w>T;i.push("<radialGradient ",p,' cx="',E?y:x,'" cy="',E?v:b,'" r="',E?w:T,'" fx="',E?x:y,'" fy="',E?b:v,`">
`),E&&(c.reverse(),c.forEach(C=>{C.offset=1-C.offset}));const M=Math.min(w,T);if(M>0){const C=M/Math.max(w,T);c.forEach(D=>{D.offset+=C*(1-D.offset)})}}return c.forEach(y=>{let{color:v,offset:x}=y;i.push(`<stop offset="${100*x}%" style="stop-color:${v};"/>
`)}),i.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),i.join("")}toLive(t){const{x1:e,y1:i,x2:o,y2:a,r1:c,r2:h}=this.coords,f=this.type==="linear"?t.createLinearGradient(e,i,o,a):t.createRadialGradient(e,i,c,o,a,h);return this.colorStops.forEach(d=>{let{color:p,offset:y}=d;f.addColorStop(y,p)}),f}static async fromObject(t){const{colorStops:e,gradientTransform:i}=t;return new this({...t,colorStops:e?e.map(o=>({...o})):void 0,gradientTransform:i?[...i]:void 0})}static fromElement(t,e,i){const o=A_(t),a=e._findCenterFromElement();return new this({id:t.getAttribute("id")||void 0,type:O_(t),coords:Cj(t,{width:i.viewBoxWidth||i.width,height:i.viewBoxHeight||i.height}),colorStops:wj(t,i.opacity),gradientUnits:o,gradientTransform:rp(t.getAttribute("gradientTransform")||""),...o==="pixels"?{offsetX:e.width/2-a.x,offsetY:e.height/2-a.y}:{offsetX:0,offsetY:0}})}}V(lu,"type","Gradient"),mt.setClass(lu,"gradient"),mt.setClass(lu,"linear"),mt.setClass(lu,"radial");class Ag{get type(){return"pattern"}set type(t){Ts("warn","Setting type has no effect",t)}constructor(t){V(this,"repeat","repeat"),V(this,"offsetX",0),V(this,"offsetY",0),V(this,"crossOrigin",""),this.id=Es(),Object.assign(this,t)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(t){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?t.createPattern(this.source,this.repeat):null}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:e,crossOrigin:i}=this;return{...Po(this,t),type:"pattern",source:this.sourceToString(),repeat:e,crossOrigin:i,offsetX:Kt(this.offsetX,Bt.NUM_FRACTION_DIGITS),offsetY:Kt(this.offsetY,Bt.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null}}toSVG(t){let{width:e,height:i}=t;const{source:o,repeat:a,id:c}=this,h=mo(this.offsetX/e,0),f=mo(this.offsetY/i,0);return[`<pattern id="SVGID_${c}" x="${h}" y="${f}" width="${a==="repeat-y"||a==="no-repeat"?1+Math.abs(h||0):mo(o.width/e,0)}" height="${a==="repeat-x"||a==="no-repeat"?1+Math.abs(f||0):mo(o.height/i,0)}">`,`<image x="0" y="0" width="${o.width}" height="${o.height}" xlink:href="${this.sourceToString()}"></image>`,"</pattern>",""].join(`
`)}static async fromObject(t,e){let{type:i,source:o,patternTransform:a,...c}=t;const h=await Pu(o,{...e,crossOrigin:c.crossOrigin});return new this({...c,patternTransform:a&&a.slice(0),source:h})}}V(Ag,"type","Pattern"),mt.setClass(Ag),mt.setClass(Ag,"pattern");class Tj{constructor(t){V(this,"color","rgb(0, 0, 0)"),V(this,"width",1),V(this,"shadow",null),V(this,"strokeLineCap","round"),V(this,"strokeLineJoin","round"),V(this,"strokeMiterLimit",10),V(this,"strokeDashArray",null),V(this,"limitedToCanvasSize",!1),this.canvas=t}_setBrushStyles(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])}_saveAndTransform(t){const e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}needsFullRender(){return new Wt(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const t=this.canvas,e=this.shadow,i=t.contextTop,o=t.getZoom()*t.getRetinaScaling();i.shadowColor=e.color,i.shadowBlur=e.blur*o,i.shadowOffsetX=e.offsetX*o,i.shadowOffsetY=e.offsetY*o}_resetShadow(){const t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}_isOutSideCanvas(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}}class Cs extends ke{constructor(t){let{path:e,left:i,top:o,...a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Cs.ownDefaults),this.setOptions(a),this._setPath(t||[],!0),typeof i=="number"&&this.set(Yt,i),typeof o=="number"&&this.set(Ze,o)}_setPath(t,e){this.path=sj(Array.isArray(t)?t:dj(t)),this.setBoundingBox(e)}_findCenterFromElement(){const t=this._calcBoundsFromPath();return new tt(t.left+t.width/2,t.top+t.height/2)}_renderPathCommands(t){const e=-this.pathOffset.x,i=-this.pathOffset.y;t.beginPath();for(const o of this.path)switch(o[0]){case"L":t.lineTo(o[1]+e,o[2]+i);break;case"M":t.moveTo(o[1]+e,o[2]+i);break;case"C":t.bezierCurveTo(o[1]+e,o[2]+i,o[3]+e,o[4]+i,o[5]+e,o[6]+i);break;case"Q":t.quadraticCurveTo(o[1]+e,o[2]+i,o[3]+e,o[4]+i);break;case"Z":t.closePath()}}_render(t){this._renderPathCommands(t),this._renderPaintInOrder(t)}toString(){return`#<Path (${this.complexity()}): { "top": ${this.top}, "left": ${this.left} }>`}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject(t),path:this.path.map(e=>e.slice())}}toDatalessObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.toObject(t);return this.sourcePath&&(delete e.path,e.sourcePath=this.sourcePath),e}_toSVG(){return["<path ","COMMON_PARTS",`d="${T_(this.path,Bt.NUM_FRACTION_DIGITS)}" stroke-linecap="round" />
`]}_getOffsetTransform(){const t=Bt.NUM_FRACTION_DIGITS;return` translate(${Kt(-this.pathOffset.x,t)}, ${Kt(-this.pathOffset.y,t)})`}toClipPathSVG(t){const e=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}toSVG(t){const e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{width:e,height:i,pathOffset:o}=this._calcDimensions();this.set({width:e,height:i,pathOffset:o}),t&&this.setPositionByOrigin(o,Dt,Dt)}_calcBoundsFromPath(){const t=[];let e=0,i=0,o=0,a=0;for(const c of this.path)switch(c[0]){case"L":o=c[1],a=c[2],t.push({x:e,y:i},{x:o,y:a});break;case"M":o=c[1],a=c[2],e=o,i=a;break;case"C":t.push(...T1(o,a,c[1],c[2],c[3],c[4],c[5],c[6])),o=c[5],a=c[6];break;case"Q":t.push(...T1(o,a,c[1],c[2],c[1],c[2],c[3],c[4])),o=c[3],a=c[4];break;case"Z":o=e,a=i}return Li(t)}_calcDimensions(){const t=this._calcBoundsFromPath();return{...t,pathOffset:new tt(t.left+t.width/2,t.top+t.height/2)}}static fromObject(t){return this._fromObject(t,{extraParam:"path"})}static async fromElement(t,e,i){const{d:o,...a}=Xi(t,this.ATTRIBUTE_NAMES,i);return new this(o,{...a,...e,left:void 0,top:void 0})}}V(Cs,"type","Path"),V(Cs,"cacheProperties",[...Vi,"path","fillRule"]),V(Cs,"ATTRIBUTE_NAMES",[...Ds,"d"]),mt.setClass(Cs),mt.setSVGClass(Cs);class _o extends Tj{constructor(t){super(t),V(this,"decimate",.4),V(this,"drawStraightLine",!1),V(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(t,e,i){const o=e.midPointFrom(i);return t.quadraticCurveTo(e.x,e.y,o.x,o.y),o}onMouseDown(t,e){let{e:i}=e;this.canvas._isMainEvent(i)&&(this.drawStraightLine=!!this.straightLineKey&&i[this.straightLineKey],this._prepareForDrawing(t),this._addPoint(t),this._render())}onMouseMove(t,e){let{e:i}=e;if(this.canvas._isMainEvent(i)&&(this.drawStraightLine=!!this.straightLineKey&&i[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(t))&&this._addPoint(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const o=this._points,a=o.length,c=this.canvas.contextTop;this._saveAndTransform(c),this.oldEnd&&(c.beginPath(),c.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=_o.drawSegment(c,o[a-2],o[a-1]),c.stroke(),c.restore()}}onMouseUp(t){let{e}=t;return!this.canvas._isMainEvent(e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(t){this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)}_addPoint(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,e=this._points[0],i=this._points[1];if(this._saveAndTransform(t),t.beginPath(),this._points.length===2&&e.x===i.x&&e.y===i.y){const o=this.width/1e3;e.x-=o,i.x+=o}t.moveTo(e.x,e.y);for(let o=1;o<this._points.length;o++)_o.drawSegment(t,e,i),e=this._points[o],i=this._points[o+1];t.lineTo(e.x,e.y),t.stroke(),t.restore()}convertPointsToSVGPath(t){const e=this.width/1e3;return gj(t,e)}createPath(t){const e=new Cs(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new ti(this.shadow)),e}decimatePoints(t,e){if(t.length<=2)return t;let i,o=t[0];const a=this.canvas.getZoom(),c=Math.pow(e/a,2),h=t.length-1,f=[o];for(let d=1;d<h-1;d++)i=Math.pow(o.x-t[d].x,2)+Math.pow(o.y-t[d].y,2),i>=c&&(o=t[d],f.push(o));return f.push(t[h]),f}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const t=this.convertPointsToSVGPath(this._points);if((function(i){return T_(i)==="M 0 0 Q 0 0 0 0 L 0 0"})(t))return void this.canvas.requestRenderAll();const e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}}const k_=["radius","startAngle","endAngle","counterClockwise"];class Ai extends ke{static getDefaults(){return{...super.getDefaults(),...Ai.ownDefaults}}constructor(t){super(),Object.assign(this,Ai.ownDefaults),this.setOptions(t)}_set(t,e){return super._set(t,e),t==="radius"&&this.setRadius(e),this}_render(t){t.beginPath(),t.arc(0,0,this.radius,ce(this.startAngle),ce(this.endAngle),this.counterClockwise),this._renderPaintInOrder(t)}getRadiusX(){return this.get("radius")*this.get(Qe)}getRadiusY(){return this.get("radius")*this.get(wn)}setRadius(t){this.radius=t,this.set({width:2*t,height:2*t})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...k_,...t])}_toSVG(){const t=(this.endAngle-this.startAngle)%360;if(t===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',`${this.radius}`,`" />
`];{const{radius:e}=this,i=ce(this.startAngle),o=ce(this.endAngle),a=Hi(i)*e,c=Ui(i)*e,h=Hi(o)*e,f=Ui(o)*e;return[`<path d="M ${a} ${c} A ${e} ${e} 0 ${t>180?1:0} ${this.counterClockwise?0:1} ${h} ${f}" `,"COMMON_PARTS",` />
`]}}static async fromElement(t,e,i){const{left:o=0,top:a=0,radius:c=0,...h}=Xi(t,this.ATTRIBUTE_NAMES,i);return new this({...h,radius:c,left:o-c,top:a-c})}static fromObject(t){return super._fromObject(t)}}V(Ai,"type","Circle"),V(Ai,"cacheProperties",[...Vi,...k_]),V(Ai,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),V(Ai,"ATTRIBUTE_NAMES",["cx","cy","r",...Ds]),mt.setClass(Ai),mt.setSVGClass(Ai);const up=["x1","x2","y1","y2"];class sr extends ke{constructor(){let[t,e,i,o]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,sr.ownDefaults),this.setOptions(a),this.x1=t,this.x2=i,this.y1=e,this.y2=o,this._setWidthHeight();const{left:c,top:h}=a;typeof c=="number"&&this.set(Yt,c),typeof h=="number"&&this.set(Ze,h)}_setWidthHeight(){const{x1:t,y1:e,x2:i,y2:o}=this;this.width=Math.abs(i-t),this.height=Math.abs(o-e);const{left:a,top:c,width:h,height:f}=Li([{x:t,y:e},{x:i,y:o}]),d=new tt(a+h/2,c+f/2);this.setPositionByOrigin(d,Dt,Dt)}_set(t,e){return super._set(t,e),up.includes(t)&&this._setWidthHeight(),this}_render(t){t.beginPath();const e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;const i=t.strokeStyle;var o;_n(this.stroke)?t.strokeStyle=this.stroke.toLive(t):t.strokeStyle=(o=this.stroke)!==null&&o!==void 0?o:t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=i}_findCenterFromElement(){return new tt((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject(t),...this.calcLinePoints()}}_getNonTransformedDimensions(){const t=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(t.y-=this.strokeWidth),this.height===0&&(t.x-=this.strokeWidth)),t}calcLinePoints(){const{x1:t,x2:e,y1:i,y2:o,width:a,height:c}=this,h=t<=e?-1:1,f=i<=o?-1:1;return{x1:h*a/2,x2:h*-a/2,y1:f*c/2,y2:f*-c/2}}_toSVG(){const{x1:t,x2:e,y1:i,y2:o}=this.calcLinePoints();return["<line ","COMMON_PARTS",`x1="${t}" y1="${i}" x2="${e}" y2="${o}" />
`]}static async fromElement(t,e,i){const{x1:o=0,y1:a=0,x2:c=0,y2:h=0,...f}=Xi(t,this.ATTRIBUTE_NAMES,i);return new this([o,a,c,h],f)}static fromObject(t){let{x1:e,y1:i,x2:o,y2:a,...c}=t;return this._fromObject({...c,points:[e,i,o,a]},{extraParam:"points"})}}V(sr,"type","Line"),V(sr,"cacheProperties",[...Vi,...up]),V(sr,"ATTRIBUTE_NAMES",Ds.concat(up)),mt.setClass(sr),mt.setSVGClass(sr);class or extends ke{static getDefaults(){return{...super.getDefaults(),...or.ownDefaults}}constructor(t){super(),Object.assign(this,or.ownDefaults),this.setOptions(t)}_render(t){const e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderPaintInOrder(t)}_toSVG(){const t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',`${-t} ${e},0 ${-e},${t} ${e}`,'" />']}}V(or,"type","Triangle"),V(or,"ownDefaults",{width:100,height:100}),mt.setClass(or),mt.setSVGClass(or);const j_=["rx","ry"];class ki extends ke{static getDefaults(){return{...super.getDefaults(),...ki.ownDefaults}}constructor(t){super(),Object.assign(this,ki.ownDefaults),this.setOptions(t)}_set(t,e){switch(super._set(t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this}getRx(){return this.get("rx")*this.get(Qe)}getRy(){return this.get("ry")*this.get(wn)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...j_,...t])}_toSVG(){return["<ellipse ","COMMON_PARTS",`cx="0" cy="0" rx="${this.rx}" ry="${this.ry}" />
`]}_render(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,ko,!1),t.restore(),this._renderPaintInOrder(t)}static async fromElement(t,e,i){const o=Xi(t,this.ATTRIBUTE_NAMES,i);return o.left=(o.left||0)-o.rx,o.top=(o.top||0)-o.ry,new this(o)}}V(ki,"type","Ellipse"),V(ki,"cacheProperties",[...Vi,...j_]),V(ki,"ownDefaults",{rx:0,ry:0}),V(ki,"ATTRIBUTE_NAMES",[...Ds,"cx","cy","rx","ry"]),mt.setClass(ki),mt.setSVGClass(ki);const N_={exactBoundingBox:!1};class Rn extends ke{static getDefaults(){return{...super.getDefaults(),...Rn.ownDefaults}}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),V(this,"strokeDiff",void 0),Object.assign(this,Rn.ownDefaults),this.setOptions(e),this.points=t;const{left:i,top:o}=e;this.initialized=!0,this.setBoundingBox(!0),typeof i=="number"&&this.set(Yt,i),typeof o=="number"&&this.set(Ze,o)}isOpen(){return!0}_projectStrokeOnPoints(t){return Mk(this.points,t,this.isOpen())}_calcDimensions(t){t={scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth,...t||{}};const e=this.exactBoundingBox?this._projectStrokeOnPoints(t).map(d=>d.projectedPoint):this.points;if(e.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new tt,strokeOffset:new tt,strokeDiff:new tt};const i=Li(e),o=Ah({...t,scaleX:1,scaleY:1}),a=Li(this.points.map(d=>qe(d,o,!0))),c=new tt(this.scaleX,this.scaleY);let h=i.left+i.width/2,f=i.top+i.height/2;return this.exactBoundingBox&&(h-=f*Math.tan(ce(this.skewX)),f-=h*Math.tan(ce(this.skewY))),{...i,pathOffset:new tt(h,f),strokeOffset:new tt(a.left,a.top).subtract(new tt(i.left,i.top)).multiply(c),strokeDiff:new tt(i.width,i.height).subtract(new tt(a.width,a.height)).multiply(c)}}_findCenterFromElement(){const t=Li(this.points);return new tt(t.left+t.width/2,t.top+t.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{left:e,top:i,width:o,height:a,pathOffset:c,strokeOffset:h,strokeDiff:f}=this._calcDimensions();this.set({width:o,height:a,pathOffset:c,strokeOffset:h,strokeDiff:f}),t&&this.setPositionByOrigin(new tt(e+o/2,i+a/2),Dt,Dt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new tt(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let c;if(Object.keys(t).some(h=>this.strokeUniform||this.constructor.layoutProperties.includes(h))){var e,i;const{width:h,height:f}=this._calcDimensions(t);c=new tt((e=t.width)!==null&&e!==void 0?e:h,(i=t.height)!==null&&i!==void 0?i:f)}else{var o,a;c=new tt((o=t.width)!==null&&o!==void 0?o:this.width,(a=t.height)!==null&&a!==void 0?a:this.height)}return c.multiply(new tt(t.scaleX||this.scaleX,t.scaleY||this.scaleY))}return super._getTransformedDimensions(t)}_set(t,e){const i=this.initialized&&this[t]!==e,o=super._set(t,e);return this.exactBoundingBox&&i&&((t===Qe||t===wn)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(t))&&this.setDimensions(),o}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject(t),points:this.points.map(e=>{let{x:i,y:o}=e;return{x:i,y:o}})}}_toSVG(){const t=[],e=this.pathOffset.x,i=this.pathOffset.y,o=Bt.NUM_FRACTION_DIGITS;for(let a=0,c=this.points.length;a<c;a++)t.push(Kt(this.points[a].x-e,o),",",Kt(this.points[a].y-i,o)," ");return[`<${this.constructor.type.toLowerCase()} `,"COMMON_PARTS",`points="${t.join("")}" />
`]}_render(t){const e=this.points.length,i=this.pathOffset.x,o=this.pathOffset.y;if(e&&!isNaN(this.points[e-1].y)){t.beginPath(),t.moveTo(this.points[0].x-i,this.points[0].y-o);for(let a=0;a<e;a++){const c=this.points[a];t.lineTo(c.x-i,c.y-o)}!this.isOpen()&&t.closePath(),this._renderPaintInOrder(t)}}complexity(){return this.points.length}static async fromElement(t,e,i){const o=(function(f){if(!f)return[];const d=f.replace(/,/g," ").trim().split(/\s+/),p=[];for(let y=0;y<d.length;y+=2)p.push({x:parseFloat(d[y]),y:parseFloat(d[y+1])});return p})(t.getAttribute("points")),{left:a,top:c,...h}=Xi(t,this.ATTRIBUTE_NAMES,i);return new this(o,{...h,...e})}static fromObject(t){return this._fromObject(t,{extraParam:"points"})}}V(Rn,"ownDefaults",N_),V(Rn,"type","Polyline"),V(Rn,"layoutProperties",[Bo,Ho,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),V(Rn,"cacheProperties",[...Vi,"points"]),V(Rn,"ATTRIBUTE_NAMES",[...Ds]),mt.setClass(Rn),mt.setSVGClass(Rn);class cu extends Rn{isOpen(){return!1}}V(cu,"ownDefaults",N_),V(cu,"type","Polygon"),mt.setClass(cu),mt.setSVGClass(cu);class R_ extends ke{isEmptyStyles(t){if(!this.styles||t!==void 0&&!this.styles[t])return!0;const e=t===void 0?this.styles:{line:this.styles[t]};for(const i in e)for(const o in e[i])for(const a in e[i][o])return!1;return!0}styleHas(t,e){if(!this.styles||e!==void 0&&!this.styles[e])return!1;const i=e===void 0?this.styles:{0:this.styles[e]};for(const o in i)for(const a in i[o])if(i[o][a][t]!==void 0)return!0;return!1}cleanStyle(t){if(!this.styles)return!1;const e=this.styles;let i,o,a=0,c=!0,h=0;for(const f in e){i=0;for(const d in e[f]){const p=e[f][d]||{};a++,p[t]!==void 0?(o?p[t]!==o&&(c=!1):o=p[t],p[t]===this[t]&&delete p[t]):c=!1,Object.keys(p).length!==0?i++:delete e[f][d]}i===0&&delete e[f]}for(let f=0;f<this._textLines.length;f++)h+=this._textLines[f].length;c&&a===h&&(this[t]=o,this.removeStyle(t))}removeStyle(t){if(!this.styles)return;const e=this.styles;let i,o,a;for(o in e){for(a in i=e[o],i)delete i[a][t],Object.keys(i[a]).length===0&&delete i[a];Object.keys(i).length===0&&delete e[o]}}_extendStyles(t,e){const{lineIndex:i,charIndex:o}=this.get2DCursorLocation(t);this._getLineStyle(i)||this._setLineStyle(i);const a=Pp({...this._getStyleDeclaration(i,o),...e},c=>c!==void 0);this._setStyleDeclaration(i,o,a)}getSelectionStyles(t,e,i){const o=[];for(let a=t;a<(e||t);a++)o.push(this.getStyleAtPosition(a,i));return o}getStyleAtPosition(t,e){const{lineIndex:i,charIndex:o}=this.get2DCursorLocation(t);return e?this.getCompleteStyleDeclaration(i,o):this._getStyleDeclaration(i,o)}setSelectionStyles(t,e,i){for(let o=e;o<(i||e);o++)this._extendStyles(o,t);this._forceClearCache=!0}_getStyleDeclaration(t,e){var i;const o=this.styles&&this.styles[t];return o&&(i=o[e])!==null&&i!==void 0?i:{}}getCompleteStyleDeclaration(t,e){return{...Po(this,this.constructor._styleProperties),...this._getStyleDeclaration(t,e)}}_setStyleDeclaration(t,e,i){this.styles[t][e]=i}_deleteStyleDeclaration(t,e){delete this.styles[t][e]}_getLineStyle(t){return!!this.styles[t]}_setLineStyle(t){this.styles[t]={}}_deleteLineStyle(t){delete this.styles[t]}}V(R_,"_styleProperties",Z5);const Ej=/  +/g,Mj=/"/g;function kg(s,t,e,i,o){return`		${(function(a,c){let{left:h,top:f,width:d,height:p}=c,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Bt.NUM_FRACTION_DIGITS;const v=fl(Se,a,!1),[x,b,w,T]=[h,f,d,p].map(E=>Kt(E,y));return`<rect ${v} x="${x}" y="${b}" width="${w}" height="${T}"></rect>`})(s,{left:t,top:e,width:i,height:o})}
`}let jg;class Le extends R_{static getDefaults(){return{...super.getDefaults(),...Le.ownDefaults}}constructor(t,e){super(),V(this,"__charBounds",[]),Object.assign(this,Le.ownDefaults),this.setOptions(e),this.styles||(this.styles={}),this.text=t,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const t=this.path;t&&(t.segmentsInfo=C_(t.path))}_splitText(){const t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Qn)&&this.enlargeSpaces()}enlargeSpaces(){let t,e,i,o,a,c,h;for(let f=0,d=this._textLines.length;f<d;f++)if((this.textAlign===Qn||f!==d-1&&!this.isEndOfWrapping(f))&&(o=0,a=this._textLines[f],e=this.getLineWidth(f),e<this.width&&(h=this.textLines[f].match(this._reSpacesAndTabs)))){i=h.length,t=(this.width-e)/i;for(let p=0;p<=a.length;p++)c=this.__charBounds[f][p],this._reSpaceAndTab.test(a[p])?(c.width+=t,c.kernedWidth+=t,c.left+=o,o+=t):c.left+=o}}isEndOfWrapping(t){return t===this._textLines.length-1}missingNewlineOffset(t){return 1}get2DCursorLocation(t,e){const i=e?this._unwrappedTextLines:this._textLines;let o;for(o=0;o<i.length;o++){if(t<=i[o].length)return{lineIndex:o,charIndex:t};t-=i[o].length+this.missingNewlineOffset(o,e)}return{lineIndex:o-1,charIndex:i[o-1].length<t?i[o-1].length:t}}toString(){return`#<Text (${this.complexity()}): { "text": "${this.text}", "fontFamily": "${this.fontFamily}" }>`}_getCacheCanvasDimensions(){const t=super._getCacheCanvasDimensions(),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t}_render(t){const e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")}_renderText(t){this.paintFirst===un?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))}_setTextStyles(t,e,i){if(t.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Dt:t.textBaseline="middle";break;case"ascender":t.textBaseline=Ze;break;case"descender":t.textBaseline=Jg}t.font=this._getFontDeclaration(e,i)}calcTextWidth(){let t=this.getLineWidth(0);for(let e=1,i=this._textLines.length;e<i;e++){const o=this.getLineWidth(e);o>t&&(t=o)}return t}_renderTextLine(t,e,i,o,a,c){this._renderChars(t,e,i,o,a,c)}_renderTextLinesBackground(t){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const e=t.fillStyle,i=this._getLeftOffset();let o=this._getTopOffset();for(let a=0,c=this._textLines.length;a<c;a++){const h=this.getHeightOfLine(a);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",a)){o+=h;continue}const f=this._textLines[a].length,d=this._getLineLeftOffset(a);let p,y,v=0,x=0,b=this.getValueOfPropertyAt(a,0,"textBackgroundColor");const w=this.getHeightOfLineImpl(a);for(let T=0;T<f;T++){const E=this.__charBounds[a][T];y=this.getValueOfPropertyAt(a,T,"textBackgroundColor"),this.path?(t.save(),t.translate(E.renderLeft,E.renderTop),t.rotate(E.angle),t.fillStyle=y,y&&t.fillRect(-E.width/2,-w*(1-this._fontSizeFraction),E.width,w),t.restore()):y!==b?(p=i+d+x,this.direction===Oi&&(p=this.width-p-v),t.fillStyle=b,b&&t.fillRect(p,o,v,w),x=E.left,v=E.width,b=y):v+=E.kernedWidth}y&&!this.path&&(p=i+d+x,this.direction===Oi&&(p=this.width-p-v),t.fillStyle=y,t.fillRect(p,o,v,w)),o+=h}t.fillStyle=e,this._removeShadow(t)}_measureChar(t,e,i,o){const a=Wa.getFontCache(e),c=this._getFontDeclaration(e),h=i?i+t:t,f=i&&c===this._getFontDeclaration(o),d=e.fontSize/this.CACHE_FONT_SIZE;let p,y,v,x;if(i&&a.has(i)&&(v=a.get(i)),a.has(t)&&(x=p=a.get(t)),f&&a.has(h)&&(y=a.get(h),x=y-v),p===void 0||v===void 0||y===void 0){const b=(function(){return jg||(jg=Cn({width:0,height:0}).getContext("2d")),jg})();this._setTextStyles(b,e,!0),p===void 0&&(x=p=b.measureText(t).width,a.set(t,p)),v===void 0&&f&&i&&(v=b.measureText(i).width,a.set(i,v)),f&&y===void 0&&(y=b.measureText(h).width,a.set(h,y),x=y-v)}return{width:p*d,kernedWidth:x*d}}getHeightOfChar(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")}measureLine(t){const e=this._measureLine(t);return this.charSpacing!==0&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e}_measureLine(t){let e,i,o=0;const a=this.pathSide===le,c=this.path,h=this._textLines[t],f=h.length,d=new Array(f);this.__charBounds[t]=d;for(let p=0;p<f;p++){const y=h[p];i=this._getGraphemeBox(y,t,p,e),d[p]=i,o+=i.kernedWidth,e=y}if(d[f]={left:i?i.left+i.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},c&&c.segmentsInfo){let p=0;const y=c.segmentsInfo[c.segmentsInfo.length-1].length;switch(this.textAlign){case Yt:p=a?y-o:0;break;case Dt:p=(y-o)/2;break;case le:p=a?0:y-o}p+=this.pathStartOffset*(a?-1:1);for(let v=a?f-1:0;a?v>=0:v<f;a?v--:v++)i=d[v],p>y?p%=y:p<0&&(p+=y),this._setGraphemeOnPath(p,i),p+=i.kernedWidth}return{width:o,numOfSpaces:0}}_setGraphemeOnPath(t,e){const i=t+e.kernedWidth/2,o=this.path,a=cj(o.path,i,o.segmentsInfo);e.renderLeft=a.x-o.pathOffset.x,e.renderTop=a.y-o.pathOffset.y,e.angle=a.angle+(this.pathSide===le?Math.PI:0)}_getGraphemeBox(t,e,i,o,a){const c=this.getCompleteStyleDeclaration(e,i),h=o?this.getCompleteStyleDeclaration(e,i-1):{},f=this._measureChar(t,c,o,h);let d,p=f.kernedWidth,y=f.width;this.charSpacing!==0&&(d=this._getWidthOfCharSpacing(),y+=d,p+=d);const v={width:y,left:0,height:c.fontSize,kernedWidth:p,deltaY:c.deltaY};if(i>0&&!a){const x=this.__charBounds[e][i-1];v.left=x.left+x.width+f.kernedWidth-f.width}return v}getHeightOfLineImpl(t){const e=this.__lineHeights;if(e[t])return e[t];let i=this.getHeightOfChar(t,0);for(let o=1,a=this._textLines[t].length;o<a;o++)i=Math.max(this.getHeightOfChar(t,o),i);return e[t]=i*this._fontSizeMult}getHeightOfLine(t){return this.getHeightOfLineImpl(t)*this.lineHeight}calcTextHeight(){let t=0;for(let e=0,i=this._textLines.length;e<i;e++)t+=e===i-1?this.getHeightOfLineImpl(e):this.getHeightOfLine(e);return t}_getLeftOffset(){return this.direction===nr?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(t,e){t.save();let i=0;const o=this._getLeftOffset(),a=this._getTopOffset();for(let c=0,h=this._textLines.length;c<h;c++)this._renderTextLine(e,t,this._textLines[c],o+this._getLineLeftOffset(c),a+i+this.getHeightOfLineImpl(c),c),i+=this.getHeightOfLine(c);t.restore()}_renderTextFill(t){(this.fill||this.styleHas(Se))&&this._renderTextCommon(t,"fillText")}_renderTextStroke(t){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())}_renderChars(t,e,i,o,a,c){const h=this.textAlign.includes(Qn),f=this.path,d=!h&&this.charSpacing===0&&this.isEmptyStyles(c)&&!f,p=this.direction===nr,y=this.direction===nr?1:-1,v=e.direction;let x,b,w,T,E,M="",C=0;if(e.save(),v!==this.direction&&(e.canvas.setAttribute("dir",p?nr:Oi),e.direction=p?nr:Oi,e.textAlign=p?Yt:le),a-=this.getHeightOfLineImpl(c)*this._fontSizeFraction,d)return this._renderChar(t,e,c,0,i.join(""),o,a),void e.restore();for(let D=0,j=i.length-1;D<=j;D++)T=D===j||this.charSpacing||f,M+=i[D],w=this.__charBounds[c][D],C===0?(o+=y*(w.kernedWidth-w.width),C+=w.width):C+=w.kernedWidth,h&&!T&&this._reSpaceAndTab.test(i[D])&&(T=!0),T||(x=x||this.getCompleteStyleDeclaration(c,D),b=this.getCompleteStyleDeclaration(c,D+1),T=qp(x,b,!1)),T&&(f?(e.save(),e.translate(w.renderLeft,w.renderTop),e.rotate(w.angle),this._renderChar(t,e,c,D,M,-C/2,0),e.restore()):(E=o,this._renderChar(t,e,c,D,M,E,a)),M="",x=b,o+=y*C,C=0);e.restore()}_applyPatternGradientTransformText(t){const e=this.width+this.strokeWidth,i=this.height+this.strokeWidth,o=Cn({width:e,height:i}),a=o.getContext("2d");return o.width=e,o.height=i,a.beginPath(),a.moveTo(0,0),a.lineTo(e,0),a.lineTo(e,i),a.lineTo(0,i),a.closePath(),a.translate(e/2,i/2),a.fillStyle=t.toLive(a),this._applyPatternGradientTransform(a,t),a.fill(),a.createPattern(o,"no-repeat")}handleFiller(t,e,i){let o,a;return _n(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?(o=-this.width/2,a=-this.height/2,t.translate(o,a),t[e]=this._applyPatternGradientTransformText(i),{offsetX:o,offsetY:a}):(t[e]=i.toLive(t),this._applyPatternGradientTransform(t,i)):(t[e]=i,{offsetX:0,offsetY:0})}_setStrokeStyles(t,e){let{stroke:i,strokeWidth:o}=e;return t.lineWidth=o,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",i)}_setFillStyles(t,e){let{fill:i}=e;return this.handleFiller(t,"fillStyle",i)}_renderChar(t,e,i,o,a,c,h){const f=this._getStyleDeclaration(i,o),d=this.getCompleteStyleDeclaration(i,o),p=t==="fillText"&&d.fill,y=t==="strokeText"&&d.stroke&&d.strokeWidth;if(y||p){if(e.save(),e.font=this._getFontDeclaration(d),f.textBackgroundColor&&this._removeShadow(e),f.deltaY&&(h+=f.deltaY),p){const v=this._setFillStyles(e,d);e.fillText(a,c-v.offsetX,h-v.offsetY)}if(y){const v=this._setStrokeStyles(e,d);e.strokeText(a,c-v.offsetX,h-v.offsetY)}e.restore()}}setSuperscript(t,e){this._setScript(t,e,this.superscript)}setSubscript(t,e){this._setScript(t,e,this.subscript)}_setScript(t,e,i){const o=this.get2DCursorLocation(t,!0),a=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"fontSize"),c=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"deltaY"),h={fontSize:a*i.size,deltaY:c+a*i.baseline};this.setSelectionStyles(h,t,e)}_getLineLeftOffset(t){const e=this.getLineWidth(t),i=this.width-e,o=this.textAlign,a=this.direction,c=this.isEndOfWrapping(t);let h=0;return o===Qn||o===Qa&&!c||o===Ka&&!c||o===ch&&!c?0:(o===Dt&&(h=i/2),o===le&&(h=i),o===Qa&&(h=i/2),o===Ka&&(h=i),a===Oi&&(o===le||o===Ka?h=0:o===Yt||o===ch?h=-i:o!==Dt&&o!==Qa||(h=-i/2)),h)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];const{width:e}=this.measureLine(t);return this.__lineWidths[t]=e,e}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(t,e,i){var o;return(o=this._getStyleDeclaration(t,e)[i])!==null&&o!==void 0?o:this[i]}_renderTextDecoration(t,e){if(!this[e]&&!this.styleHas(e))return;let i=this._getTopOffset();const o=this._getLeftOffset(),a=this.path,c=this._getWidthOfCharSpacing(),h=e==="linethrough"?.5:e==="overline"?1:0,f=this.offsets[e];for(let d=0,p=this._textLines.length;d<p;d++){const y=this.getHeightOfLine(d);if(!this[e]&&!this.styleHas(e,d)){i+=y;continue}const v=this._textLines[d],x=y/this.lineHeight,b=this._getLineLeftOffset(d);let w=0,T=0,E=this.getValueOfPropertyAt(d,0,e),M=this.getValueOfPropertyAt(d,0,Se),C=this.getValueOfPropertyAt(d,0,vr),D=E,j=M,R=C;const z=i+x*(1-this._fontSizeFraction);let U=this.getHeightOfChar(d,0),G=this.getValueOfPropertyAt(d,0,"deltaY");for(let Z=0,rt=v.length;Z<rt;Z++){const N=this.__charBounds[d][Z];D=this.getValueOfPropertyAt(d,Z,e),j=this.getValueOfPropertyAt(d,Z,Se),R=this.getValueOfPropertyAt(d,Z,vr);const I=this.getHeightOfChar(d,Z),A=this.getValueOfPropertyAt(d,Z,"deltaY");if(a&&D&&j){const L=this.fontSize*R/1e3;t.save(),t.fillStyle=M,t.translate(N.renderLeft,N.renderTop),t.rotate(N.angle),t.fillRect(-N.kernedWidth/2,f*I+A-h*L,N.kernedWidth,L),t.restore()}else if((D!==E||j!==M||I!==U||R!==C||A!==G)&&T>0){const L=this.fontSize*C/1e3;let H=o+b+w;this.direction===Oi&&(H=this.width-H-T),E&&M&&C&&(t.fillStyle=M,t.fillRect(H,z+f*U+G-h*L,T,L)),w=N.left,T=N.width,E=D,C=R,M=j,U=I,G=A}else T+=N.kernedWidth}let ut=o+b+w;this.direction===Oi&&(ut=this.width-ut-T),t.fillStyle=j;const W=this.fontSize*R/1e3;D&&j&&R&&t.fillRect(ut,z+f*U+G-h*W,T-c,W),i+=y}this._removeShadow(t)}_getFontDeclaration(){let{fontFamily:t=this.fontFamily,fontStyle:e=this.fontStyle,fontWeight:i=this.fontWeight,fontSize:o=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;const c=t.includes("'")||t.includes('"')||t.includes(",")||Le.genericFonts.includes(t.toLowerCase())?t:`"${t}"`;return[e,i,`${a?this.CACHE_FONT_SIZE:o}px`,c].join(" ")}render(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(t)))}graphemeSplit(t){return $p(t)}_splitTextIntoLines(t){const e=t.split(this._reNewline),i=new Array(e.length),o=[`
`];let a=[];for(let c=0;c<e.length;c++)i[c]=this.graphemeSplit(e[c]),a=a.concat(i[c],o);return a.pop(),{_unwrappedLines:i,lines:e,graphemeText:a,graphemeLines:i}}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject([...l_,...t]),styles:kk(this.styles,this.text),...this.path?{path:this.path.toObject()}:{}}}set(t,e){const{textLayoutProperties:i}=this.constructor;super.set(t,e);let o=!1,a=!1;if(typeof t=="object")for(const c in t)c==="path"&&this.setPathInfo(),o=o||i.includes(c),a=a||c==="path";else o=i.includes(t),a=t==="path";return a&&this.setPathInfo(),o&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(t,e,i){const o=Xi(t,Le.ATTRIBUTE_NAMES,i),{textAnchor:a=Yt,textDecoration:c="",dx:h=0,dy:f=0,top:d=0,left:p=0,fontSize:y=Rp,strokeWidth:v=1,...x}={...e,...o},b=new this(lh(t.textContent||"").trim(),{left:p+h,top:d+f,underline:c.includes("underline"),overline:c.includes("overline"),linethrough:c.includes("line-through"),strokeWidth:0,fontSize:y,...x}),w=b.getScaledHeight()/b.height,T=((b.height+b.strokeWidth)*b.lineHeight-b.height)*w,E=b.getScaledHeight()+T;let M=0;return a===Dt&&(M=b.getScaledWidth()/2),a===le&&(M=b.getScaledWidth()),b.set({left:b.left-M,top:b.top-(E-b.fontSize*(.07+b._fontSizeFraction))/b.lineHeight,strokeWidth:v}),b}static fromObject(t){return this._fromObject({...t,styles:jk(t.styles||{},t.text)},{extraParam:"text"})}}V(Le,"textLayoutProperties",a_),V(Le,"cacheProperties",[...Vi,...l_]),V(Le,"ownDefaults",K5),V(Le,"type","Text"),V(Le,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),V(Le,"ATTRIBUTE_NAMES",Ds.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),p_(Le,[class extends s_{_toSVG(){const s=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(s.textTop,s.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(s){const t=this._createBaseSVGMarkup(this._toSVG(),{reviver:s,noStyle:!0,withShadow:!0}),e=this.path;return e?t+e._createBaseSVGMarkup(e._toSVG(),{reviver:s,withShadow:!0,additionalTransform:hl(this.calcOwnMatrix())}):t}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(s){let{textBgRects:t,textSpans:e}=s;const i=this.getSvgTextDecoration(this);return[t.join(""),'		<text xml:space="preserve" ',`font-family="${this.fontFamily.replace(Mj,"'")}" `,`font-size="${this.fontSize}" `,this.fontStyle?`font-style="${this.fontStyle}" `:"",this.fontWeight?`font-weight="${this.fontWeight}" `:"",i?`text-decoration="${i}" `:"",this.direction==="rtl"?`direction="${this.direction}" `:"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.join(""),`</text>
`]}_getSVGTextAndBg(s,t){const e=[],i=[];let o,a=s;this.backgroundColor&&i.push(...kg(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let c=0,h=this._textLines.length;c<h;c++)o=this._getLineLeftOffset(c),this.direction==="rtl"&&(o+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",c))&&this._setSVGTextLineBg(i,c,t+o,a),this._setSVGTextLineText(e,c,t+o,a),a+=this.getHeightOfLine(c);return{textSpans:e,textBgRects:i}}_createTextCharSpan(s,t,e,i,o){const a=Bt.NUM_FRACTION_DIGITS,c=this.getSvgSpanStyles(t,s!==s.trim()||!!s.match(Ej)),h=c?`style="${c}"`:"",f=t.deltaY,d=f?` dy="${Kt(f,a)}" `:"",{angle:p,renderLeft:y,renderTop:v,width:x}=o;let b="";if(y!==void 0){const w=x/2;p&&(b=` rotate="${Kt(Ms(p),a)}"`);const T=Uo({angle:Ms(p)});T[4]=y,T[5]=v;const E=new tt(-w,0).transform(T);e=E.x,i=E.y}return`<tspan x="${Kt(e,a)}" y="${Kt(i,a)}" ${d}${b}${h}>${Dk(s)}</tspan>`}_setSVGTextLineText(s,t,e,i){const o=this.getHeightOfLine(t),a=this.textAlign.includes(Qn),c=this._textLines[t];let h,f,d,p,y,v="",x=0;i+=o*(1-this._fontSizeFraction)/this.lineHeight;for(let b=0,w=c.length-1;b<=w;b++)y=b===w||this.charSpacing||this.path,v+=c[b],d=this.__charBounds[t][b],x===0?(e+=d.kernedWidth-d.width,x+=d.width):x+=d.kernedWidth,a&&!y&&this._reSpaceAndTab.test(c[b])&&(y=!0),y||(h=h||this.getCompleteStyleDeclaration(t,b),f=this.getCompleteStyleDeclaration(t,b+1),y=qp(h,f,!0)),y&&(p=this._getStyleDeclaration(t,b),s.push(this._createTextCharSpan(v,p,e,i,d)),v="",h=f,this.direction==="rtl"?e-=x:e+=x,x=0)}_setSVGTextLineBg(s,t,e,i){const o=this._textLines[t],a=this.getHeightOfLine(t)/this.lineHeight;let c,h=0,f=0,d=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let p=0;p<o.length;p++){const{left:y,width:v,kernedWidth:x}=this.__charBounds[t][p];c=this.getValueOfPropertyAt(t,p,"textBackgroundColor"),c!==d?(d&&s.push(...kg(d,e+f,i,h,a)),f=y,h=v,d=c):h+=x}c&&s.push(...kg(d,e+f,i,h,a))}getSvgStyles(s){return`${super.getSvgStyles(s)} text-decoration-thickness: ${Kt(this.textDecorationThickness*this.getObjectScaling().y/10,Bt.NUM_FRACTION_DIGITS)}%; white-space: pre;`}getSvgSpanStyles(s,t){const{fontFamily:e,strokeWidth:i,stroke:o,fill:a,fontSize:c,fontStyle:h,fontWeight:f,textDecorationThickness:d,linethrough:p,overline:y,underline:v}=s,x=this.getSvgTextDecoration({underline:v??this.underline,overline:y??this.overline,linethrough:p??this.linethrough}),b=d||this.textDecorationThickness;return[o?fl(un,o):"",i?`stroke-width: ${i}; `:"",e?`font-family: ${e.includes("'")||e.includes('"')?e:`'${e}'`}; `:"",c?`font-size: ${c}px; `:"",h?`font-style: ${h}; `:"",f?`font-weight: ${f}; `:"",x?`text-decoration: ${x}; text-decoration-thickness: ${Kt(b*this.getObjectScaling().y/10,Bt.NUM_FRACTION_DIGITS)}%; `:"",a?fl(Se,a):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(s){return["overline","underline","line-through"].filter(t=>s[t.replace("-","")]).join(" ")}}]),mt.setClass(Le),mt.setSVGClass(Le);class Dj{constructor(t){V(this,"target",void 0),V(this,"__mouseDownInPlace",!1),V(this,"__dragStartFired",!1),V(this,"__isDraggingOver",!1),V(this,"__dragStartSelection",void 0),V(this,"__dragImageDisposer",void 0),V(this,"_dispose",void 0),this.target=t;const e=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{e.forEach(i=>i()),this._dispose=void 0}}isPointerOverSelection(t){const e=this.target,i=e.getSelectionStartFromPointer(t);return e.isEditing&&i>=e.selectionStart&&i<=e.selectionEnd&&e.selectionStart<e.selectionEnd}start(t){return this.__mouseDownInPlace=this.isPointerOverSelection(t)}isActive(){return this.__mouseDownInPlace}end(t){const e=this.isActive();return e&&!this.__dragStartFired&&(this.target.setCursorByClick(t),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,e}getDragStartSelection(){return this.__dragStartSelection}setDragImage(t,e){var i;let{selectionStart:o,selectionEnd:a}=e;const c=this.target,h=c.canvas,f=new tt(c.flipX?-1:1,c.flipY?-1:1),d=c._getCursorBoundaries(o),p=new tt(d.left+d.leftOffset,d.top+d.topOffset).multiply(f).transform(c.calcTransformMatrix()),y=h.getScenePoint(t).subtract(p),v=c.getCanvasRetinaScaling(),x=c.getBoundingRect(),b=p.subtract(new tt(x.left,x.top)),w=h.viewportTransform,T=b.add(y).transform(w,!0),E=c.backgroundColor,M=Gp(c.styles);c.backgroundColor="";const C={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};c.setSelectionStyles(C,0,o),c.setSelectionStyles(C,a,c.text.length),c.dirty=!0;const D=c.toCanvasElement({enableRetinaScaling:h.enableRetinaScaling,viewportTransform:!0});c.backgroundColor=E,c.styles=M,c.dirty=!0,lp(D,{position:"fixed",left:-D.width+"px",border:Ke,width:D.width/v+"px",height:D.height/v+"px"}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{D.remove()},Ln(t.target||this.target.hiddenTextarea).body.appendChild(D),(i=t.dataTransfer)===null||i===void 0||i.setDragImage(D,T.x,T.y)}onDragStart(t){this.__dragStartFired=!0;const e=this.target,i=this.isActive();if(i&&t.dataTransfer){const o=this.__dragStartSelection={selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},a=e._text.slice(o.selectionStart,o.selectionEnd).join(""),c={text:e.text,value:a,...o};t.dataTransfer.setData("text/plain",a),t.dataTransfer.setData("application/fabric",JSON.stringify({value:a,styles:e.getSelectionStyles(o.selectionStart,o.selectionEnd,!0)})),t.dataTransfer.effectAllowed="copyMove",this.setDragImage(t,c)}return e.abortCursorAnimation(),i}canDrop(t){if(this.target.editable&&!this.target.getActiveControl()&&!t.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const e=this.target.getSelectionStartFromPointer(t),i=this.__dragStartSelection;return e<i.selectionStart||e>i.selectionEnd}return!0}return!1}targetCanDrop(t){return this.target.canDrop(t)}dragEnterHandler(t){let{e}=t;const i=this.targetCanDrop(e);!this.__isDraggingOver&&i&&(this.__isDraggingOver=!0)}dragOverHandler(t){const{e}=t,i=this.targetCanDrop(e);!this.__isDraggingOver&&i?this.__isDraggingOver=!0:this.__isDraggingOver&&!i&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(e.preventDefault(),t.canDrop=!0,t.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(t){var e;const{e:i}=t,o=i.defaultPrevented;this.__isDraggingOver=!1,i.preventDefault();let a=(e=i.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain");if(a&&!o){const c=this.target,h=c.canvas;let f=c.getSelectionStartFromPointer(i);const{styles:d}=i.dataTransfer.types.includes("application/fabric")?JSON.parse(i.dataTransfer.getData("application/fabric")):{},p=a[Math.max(0,a.length-1)],y=0;if(this.__dragStartSelection){const v=this.__dragStartSelection.selectionStart,x=this.__dragStartSelection.selectionEnd;f>v&&f<=x?f=v:f>x&&(f-=x-v),c.removeChars(v,x),delete this.__dragStartSelection}c._reNewline.test(p)&&(c._reNewline.test(c._text[f])||f===c._text.length)&&(a=a.trimEnd()),t.didDrop=!0,t.dropTarget=c,c.insertChars(a,d,f),h.setActiveObject(c),c.enterEditing(i),c.selectionStart=Math.min(f+y,c._text.length),c.selectionEnd=Math.min(c.selectionStart+a.length,c._text.length),c.hiddenTextarea.value=c.text,c._updateTextarea(),c.hiddenTextarea.focus(),c.fire(eh,{index:f+y,action:"drop"}),h.fire("text:changed",{target:c}),h.contextTopDirty=!0,h.requestRenderAll()}}dragEndHandler(t){let{e}=t;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var i;const o=this.target,a=this.target.canvas,{selectionStart:c,selectionEnd:h}=this.__dragStartSelection,f=((i=e.dataTransfer)===null||i===void 0?void 0:i.dropEffect)||Ke;f===Ke?(o.selectionStart=c,o.selectionEnd=h,o._updateTextarea(),o.hiddenTextarea.focus()):(o.clearContextTop(),f==="move"&&(o.removeChars(c,h),o.selectionStart=o.selectionEnd=c,o.hiddenTextarea&&(o.hiddenTextarea.value=o.text),o._updateTextarea(),o.fire(eh,{index:c,action:"dragend"}),a.fire("text:changed",{target:o}),a.requestRenderAll()),o.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const D1=/[ \n\.,;!\?\-]/;class Oj extends Le{constructor(){super(...arguments),V(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(t){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(t)}_animateCursor(t){let{toValue:e,duration:i,delay:o,onComplete:a}=t;return c_({startValue:this._currentCursorOpacity,endValue:e,duration:i,delay:o,onComplete:a,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:c=>{this._currentCursorOpacity=c,this.renderCursorOrSelection()}})}_tick(t){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(t||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var t;(t=this._currentTickCompleteState)===null||t===void 0||t.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(t){this.abortCursorAnimation(),this._tick(t?0:this.cursorDelay)}abortCursorAnimation(){let t=!1;[this._currentTickState,this._currentTickCompleteState].forEach(e=>{e&&!e.isDone()&&(t=!0,e.abort())}),this._currentCursorOpacity=1,t&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(t=>!t||t.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(t){let e=0,i=t-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i--;for(;/\S/.test(this._text[i])&&i>-1;)e++,i--;return t-e}findWordBoundaryRight(t){let e=0,i=t;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i++;for(;/\S/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e}findLineBoundaryLeft(t){let e=0,i=t-1;for(;!/\n/.test(this._text[i])&&i>-1;)e++,i--;return t-e}findLineBoundaryRight(t){let e=0,i=t;for(;!/\n/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e}searchWordBoundary(t,e){const i=this._text;let o=t>0&&this._reSpace.test(i[t])&&(e===-1||!zp.test(i[t-1]))?t-1:t,a=i[o];for(;o>0&&o<i.length&&!D1.test(a);)o+=e,a=i[o];return e===-1&&D1.test(a)&&o++,o}selectWord(t){t=t??this.selectionStart;const e=this.searchWordBoundary(t,-1),i=Math.max(e,this.searchWordBoundary(t,1));this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(t){t=t??this.selectionStart;const e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(t){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",t?{e:t}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:t}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(t){if(this.getActiveControl())return;const e=this.hiddenTextarea;Ln(e).activeElement!==e&&e.focus();const i=this.getSelectionStartFromPointer(t),o=this.selectionStart,a=this.selectionEnd;(i===this.__selectionStartOnMouseDown&&o!==a||o!==i&&a!==i)&&(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===o&&this.selectionEnd===a||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(t,e,i){const o=i.slice(0,t),a=this.graphemeSplit(o).length;if(t===e)return{selectionStart:a,selectionEnd:a};const c=i.slice(t,e);return{selectionStart:a,selectionEnd:a+this.graphemeSplit(c).length}}fromGraphemeToStringSelection(t,e,i){const o=i.slice(0,t).join("").length;return t===e?{selectionStart:o,selectionEnd:o}:{selectionStart:o,selectionEnd:o+i.slice(t,e).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){const{hiddenTextarea:t,direction:e,textAlign:i,inCompositionMode:o}=this;if(!t)return;const a=i!==Qn?i.replace("justify-",""):e===nr?Yt:le,c=this.getPositionByOrigin(a,"top");this.cursorOffsetCache={},this.text=t.value,this.set("dirty",!0),this.initDimensions(),this.setPositionByOrigin(c,a,"top"),this.setCoords();const h=this.fromStringToGraphemeSelection(t.selectionStart,t.selectionEnd,t.value);this.selectionEnd=this.selectionStart=h.selectionEnd,o||(this.selectionStart=h.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),i=this.get2DCursorLocation(t),o=i.lineIndex,a=i.charIndex,c=this.getValueOfPropertyAt(o,a,"fontSize")*this.lineHeight,h=e.leftOffset,f=this.getCanvasRetinaScaling(),d=this.canvas.upperCanvasEl,p=d.width/f,y=d.height/f,v=p-c,x=y-c,b=new tt(e.left+h,e.top+e.topOffset+c).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new tt(d.clientWidth/p,d.clientHeight/y));return b.x<0&&(b.x=0),b.x>v&&(b.x=v),b.y<0&&(b.y=0),b.y>x&&(b.y=x),b.x+=this.canvas._offset.left,b.y+=this.canvas._offset.top,{left:`${b.x}px`,top:`${b.y}px`,fontSize:`${c}px`,charHeight:c}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}exitEditingImpl(){const t=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const t=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),t&&this.fire(nh),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const t in this.styles)this._textLines[t]||delete this.styles[t]}removeStyleFromTo(t,e){const{lineIndex:i,charIndex:o}=this.get2DCursorLocation(t,!0),{lineIndex:a,charIndex:c}=this.get2DCursorLocation(e,!0);if(i!==a){if(this.styles[i])for(let h=o;h<this._unwrappedTextLines[i].length;h++)delete this.styles[i][h];if(this.styles[a])for(let h=c;h<this._unwrappedTextLines[a].length;h++){const f=this.styles[a][h];f&&(this.styles[i]||(this.styles[i]={}),this.styles[i][o+h-c]=f)}for(let h=i+1;h<=a;h++)delete this.styles[h];this.shiftLineStyles(a,i-a)}else if(this.styles[i]){const h=this.styles[i],f=c-o;for(let d=o;d<c;d++)delete h[d];for(const d in this.styles[i]){const p=parseInt(d,10);p>=c&&(h[p-f]=h[d],delete h[d])}}}shiftLineStyles(t,e){const i=Object.assign({},this.styles);for(const o in this.styles){const a=parseInt(o,10);a>t&&(this.styles[a+e]=i[a],i[a-e]||delete this.styles[a])}}insertNewlineStyleObject(t,e,i,o){const a={},c=this._unwrappedTextLines[t].length,h=c===e;let f=!1;i||(i=1),this.shiftLineStyles(t,i);const d=this.styles[t]?this.styles[t][e===0?e:e-1]:void 0;for(const y in this.styles[t]){const v=parseInt(y,10);v>=e&&(f=!0,a[v-e]=this.styles[t][y],h&&e===0||delete this.styles[t][y])}let p=!1;for(f&&!h&&(this.styles[t+i]=a,p=!0),(p||c>e)&&i--;i>0;)o&&o[i-1]?this.styles[t+i]={0:{...o[i-1]}}:d?this.styles[t+i]={0:{...d}}:delete this.styles[t+i],i--;this._forceClearCache=!0}insertCharStyleObject(t,e,i,o){this.styles||(this.styles={});const a=this.styles[t],c=a?{...a}:{};i||(i=1);for(const f in c){const d=parseInt(f,10);d>=e&&(a[d+i]=c[d],c[d-i]||delete a[d])}if(this._forceClearCache=!0,o){for(;i--;)Object.keys(o[i]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+i]={...o[i]});return}if(!a)return;const h=a[e?e-1:1];for(;h&&i--;)this.styles[t][e+i]={...h}}insertNewStyleBlock(t,e,i){const o=this.get2DCursorLocation(e,!0),a=[0];let c,h=0;for(let f=0;f<t.length;f++)t[f]===`
`?(h++,a[h]=0):a[h]++;for(a[0]>0&&(this.insertCharStyleObject(o.lineIndex,o.charIndex,a[0],i),i=i&&i.slice(a[0]+1)),h&&this.insertNewlineStyleObject(o.lineIndex,o.charIndex+a[0],h),c=1;c<h;c++)a[c]>0?this.insertCharStyleObject(o.lineIndex+c,0,a[c],i):i&&this.styles[o.lineIndex+c]&&i[0]&&(this.styles[o.lineIndex+c][0]=i[0]),i=i&&i.slice(a[c]+1);a[c]>0&&this.insertCharStyleObject(o.lineIndex+c,0,a[c],i)}removeChars(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t+1;this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(t,e,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i;o>i&&this.removeStyleFromTo(i,o);const a=this.graphemeSplit(t);this.insertNewStyleBlock(a,i,e),this._text=[...this._text.slice(0,i),...a,...this._text.slice(o)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(t,e,i){i<=t?(e===t?this._selectionDirection=Yt:this._selectionDirection===le&&(this._selectionDirection=Yt,this.selectionEnd=t),this.selectionStart=i):i>t&&i<e?this._selectionDirection===le?this.selectionEnd=i:this.selectionStart=i:(e===t?this._selectionDirection=le:this._selectionDirection===Yt&&(this._selectionDirection=le,this.selectionStart=e),this.selectionEnd=i)}}class Aj extends Oj{initHiddenTextarea(){const t=this.canvas&&Ln(this.canvas.getElement())||Lo(),e=t.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map(c=>{let[h,f]=c;return e.setAttribute(h,f)});const{top:i,left:o,fontSize:a}=this._calcTextareaPosition();e.style.cssText=`position: absolute; top: ${i}; left: ${o}; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ${a};`,(this.hiddenTextareaContainer||t.body).appendChild(e),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(c=>{let[h,f]=c;return e.addEventListener(h,this[f].bind(this))}),this.hiddenTextarea=e}blur(){this.abortCursorAnimation()}onKeyDown(t){if(!this.isEditing)return;const e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(t){const e=this.fromPaste,{value:i,selectionStart:o,selectionEnd:a}=this.hiddenTextarea;if(this.fromPaste=!1,t&&t.stopPropagation(),!this.isEditing)return;const c=()=>{this.updateFromTextArea(),this.fire(eh),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void c();const h=this._splitTextIntoLines(i).graphemeText,f=this._text.length,d=h.length,p=this.selectionStart,y=this.selectionEnd,v=p!==y;let x,b,w,T,E=d-f;const M=this.fromStringToGraphemeSelection(o,a,i),C=p>M.selectionStart;v?(b=this._text.slice(p,y),E+=y-p):d<f&&(b=C?this._text.slice(y+E,y):this._text.slice(p,p-E));const D=h.slice(M.selectionEnd-E,M.selectionEnd);if(b&&b.length&&(D.length&&(x=this.getSelectionStyles(p,p+1,!1),x=D.map(()=>x[0])),v?(w=p,T=y):C?(w=y-b.length,T=y):(w=y,T=y+b.length),this.removeStyleFromTo(w,T)),D.length){const{copyPasteData:j}=ni();e&&D.join("")===j.copiedText&&!Bt.disableStyleCopyPaste&&(x=j.copiedTextStyle),this.insertNewStyleBlock(D,p,x)}c()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(t){let{target:e}=t;const{selectionStart:i,selectionEnd:o}=e;this.compositionStart=i,this.compositionEnd=o,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:t}=ni();t.copiedText=this.getSelectedText(),Bt.disableStyleCopyPaste?t.copiedTextStyle=void 0:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(t,e){let i,o=this._getLineLeftOffset(t);return e>0&&(i=this.__charBounds[t][e-1],o+=i.left+i.width),o}getDownCursorOffset(t,e){const i=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(i),a=o.lineIndex;if(a===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-i;const c=o.charIndex,h=this._getWidthBeforeCursor(a,c),f=this._getIndexOnLine(a+1,h);return this._textLines[a].slice(c).length+f+1+this.missingNewlineOffset(a)}_getSelectionForOffset(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart}getUpCursorOffset(t,e){const i=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(i),a=o.lineIndex;if(a===0||t.metaKey||t.keyCode===33)return-i;const c=o.charIndex,h=this._getWidthBeforeCursor(a,c),f=this._getIndexOnLine(a-1,h),d=this._textLines[a].slice(0,c),p=this.missingNewlineOffset(a-1);return-this._textLines[a-1].length+f-d.length+(1-p)}_getIndexOnLine(t,e){const i=this._textLines[t];let o,a,c=this._getLineLeftOffset(t),h=0;for(let f=0,d=i.length;f<d;f++)if(o=this.__charBounds[t][f].width,c+=o,c>e){a=!0;const p=c-o,y=c,v=Math.abs(p-e);h=Math.abs(y-e)<v?f:f-1;break}return a||(h=i.length-1),h}moveCursorDown(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)}moveCursorUp(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)}_moveCursorUpOrDown(t,e){const i=this[`get${t}CursorOffset`](e,this._selectionDirection===le);if(e.shiftKey?this.moveCursorWithShift(i):this.moveCursorWithoutShift(i),i!==0){const o=this.text.length;this.selectionStart=No(0,this.selectionStart,o),this.selectionEnd=No(0,this.selectionEnd,o),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(t){const e=this._selectionDirection===Yt?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0}moveCursorWithoutShift(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0}moveCursorLeft(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)}_move(t,e,i){let o;if(t.altKey)o=this[`findWordBoundary${i}`](this[e]);else{if(!t.metaKey&&t.keyCode!==35&&t.keyCode!==36)return this[e]+=i==="Left"?-1:1,!0;o=this[`findLineBoundary${i}`](this[e])}return o!==void 0&&this[e]!==o&&(this[e]=o,!0)}_moveLeft(t,e){return this._move(t,e,"Left")}_moveRight(t,e){return this._move(t,e,"Right")}moveCursorLeftWithoutShift(t){let e=!0;return this._selectionDirection=Yt,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e}moveCursorLeftWithShift(t){return this._selectionDirection===le&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Yt,this._moveLeft(t,"selectionStart")):void 0}moveCursorRight(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)}_moveCursorLeftOrRight(t,e){const i=`moveCursor${t}${e.shiftKey?"WithShift":"WithoutShift"}`;this._currentCursorOpacity=1,this[i](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(t){return this._selectionDirection===Yt&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=le,this._moveRight(t,"selectionEnd")):void 0}moveCursorRightWithoutShift(t){let e=!0;return this._selectionDirection=le,this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e}}const O1=s=>!!s.button;class kj extends Aj{constructor(){super(...arguments),V(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new Dj(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(t){return this.draggableTextDelegate.onDragStart(t)}canDrop(t){return this.draggableTextDelegate.canDrop(t)}doubleClickHandler(t){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}tripleClickHandler(t){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}_mouseDownHandler(t){let{e,alreadySelected:i}=t;this.canvas&&this.editable&&!O1(e)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(e)||(this.canvas.textEditingManager.register(this),i&&(this.inCompositionMode=!1,this.setCursorByClick(e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=i||this.isEditing)))}mouseUpHandler(t){let{e,transform:i}=t;const o=this.draggableTextDelegate.end(e);if(this.canvas){this.canvas.textEditingManager.unregister(this);const a=this.canvas._activeObject;if(a&&a!==this)return}!this.editable||this.group&&!this.group.interactive||i&&i.actionPerformed||O1(e)||o||this.selected&&!this.getActiveControl()&&(this.enterEditing(e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(t){const e=this.getSelectionStartFromPointer(t),i=this.selectionStart,o=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(i,o,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(t){const e=this.canvas.getScenePoint(t).transform(Un(this.calcTransformMatrix())).add(new tt(-this._getLeftOffset(),-this._getTopOffset()));let i=0,o=0,a=0;for(let d=0;d<this._textLines.length&&i<=e.y;d++)i+=this.getHeightOfLine(d),a=d,d>0&&(o+=this._textLines[d-1].length+this.missingNewlineOffset(d-1));let c=Math.abs(this._getLineLeftOffset(a));const h=this._textLines[a].length,f=this.__charBounds[a];for(let d=0;d<h;d++){const p=c+f[d].kernedWidth;if(e.x<=p){Math.abs(e.x-p)<=Math.abs(e.x-c)&&o++;break}c=p,o++}return Math.min(this.flipX?h-o:o,this._text.length)}}const uu="moveCursorUp",hu="moveCursorDown",fu="moveCursorLeft",du="moveCursorRight",gu="exitEditing",A1=(s,t)=>{const e=t.getRetinaScaling();s.setTransform(e,0,0,e,0,0);const i=t.viewportTransform;s.transform(i[0],i[1],i[2],i[3],i[4],i[5])},jj={selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:gu,27:gu,33:uu,34:hu,35:du,36:fu,37:fu,38:uu,39:du,40:hu},keysMapRtl:{9:gu,27:gu,33:uu,34:hu,35:fu,36:du,37:du,38:uu,39:fu,40:hu},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"},_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1};class Ri extends kj{static getDefaults(){return{...super.getDefaults(),...Ri.ownDefaults}}get type(){const t=super.type;return t==="itext"?"i-text":t}constructor(t,e){super(t,{...Ri.ownDefaults,...e}),this.initBehavior()}_set(t,e){return this.isEditing&&this._savedProps&&t in this._savedProps?(this._savedProps[t]=e,this):(t==="canvas"&&(this.canvas instanceof cp&&this.canvas.textEditingManager.remove(this),e instanceof cp&&e.textEditingManager.add(this)),super._set(t,e))}setSelectionStart(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)}setSelectionEnd(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)}_updateAndFire(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,i=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(t,e,i)}setSelectionStyles(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(t,e,i)}get2DCursorLocation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(t,e)}render(t){super.render(t),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(t){const e=this.isEditing;this.isEditing=!1;const i=super.toCanvasElement(t);return this.isEditing=e,i}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const t=this.clearContextTop(!0);if(!t)return;const e=this._getCursorBoundaries(),i=this.findAncestorsWithClipPath(),o=i.length>0;let a,c=t;if(o){a=Cn(t.canvas),c=a.getContext("2d"),A1(c,this.canvas);const h=this.calcTransformMatrix();c.transform(h[0],h[1],h[2],h[3],h[4],h[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(c,e):this.renderCursor(c,e),o)for(const h of i){const f=h.clipPath,d=Cn(t.canvas),p=d.getContext("2d");if(A1(p,this.canvas),!f.absolutePositioned){const y=h.calcTransformMatrix();p.transform(y[0],y[1],y[2],y[3],y[4],y[5])}f.transform(p),f.drawObject(p,!0,{}),this.drawClipPathOnCache(c,f,d)}o&&(t.setTransform(1,0,0,1,0,0),t.drawImage(a,0,0)),this.canvas.contextTopDirty=!0,t.restore()}findAncestorsWithClipPath(){const t=[];let e=this;for(;e;)e.clipPath&&t.push(e),e=e.parent;return t}_getCursorBoundaries(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;const i=this._getLeftOffset(),o=this._getTopOffset(),a=this._getCursorBoundariesOffsets(t,e);return{left:i,top:o,leftOffset:a.left,topOffset:a.top}}_getCursorBoundariesOffsets(t,e){return e?this.__getCursorBoundariesOffsets(t):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(t)}__getCursorBoundariesOffsets(t){let e=0,i=0;const{charIndex:o,lineIndex:a}=this.get2DCursorLocation(t),{textAlign:c,direction:h}=this;for(let y=0;y<a;y++)e+=this.getHeightOfLine(y);const f=this._getLineLeftOffset(a),d=this.__charBounds[a][o];d&&(i=d.left),this.charSpacing!==0&&o===this._textLines[a].length&&(i-=this._getWidthOfCharSpacing());let p=f+(i>0?i:0);return h===Oi&&(c===le||c===Qn||c===Ka?p*=-1:c===Yt||c===ch?p=f-(i>0?i:0):c!==Dt&&c!==Qa||(p=f-(i>0?i:0))),{top:e,left:p}}renderCursorAt(t){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(t,!0),t)}renderCursor(t,e){this._renderCursor(t,e,this.selectionStart)}getCursorRenderingData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(t);const i=this.get2DCursorLocation(t),o=i.lineIndex,a=i.charIndex>0?i.charIndex-1:0,c=this.getValueOfPropertyAt(o,a,"fontSize"),h=this.getObjectScaling().x*this.canvas.getZoom(),f=this.cursorWidth/h,d=this.getValueOfPropertyAt(o,a,"deltaY"),p=e.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(o)/this.lineHeight-c*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(o,a,"fill"),opacity:this._currentCursorOpacity,left:e.left+e.leftOffset-f/2,top:p+e.top+d,width:f,height:c}}_renderCursor(t,e,i){const{color:o,opacity:a,left:c,top:h,width:f,height:d}=this.getCursorRenderingData(i,e);t.fillStyle=o,t.globalAlpha=a,t.fillRect(c,h,f,d)}renderSelection(t,e){const i={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(t,i,e)}renderDragSourceEffect(){const t=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,t,this._getCursorBoundaries(t.selectionStart,!0))}renderDropTargetEffect(t){const e=this.getSelectionStartFromPointer(t);this.renderCursorAt(e)}_renderSelection(t,e,i){const{textAlign:o,direction:a}=this,c=e.selectionStart,h=e.selectionEnd,f=o.includes(Qn),d=this.get2DCursorLocation(c),p=this.get2DCursorLocation(h),y=d.lineIndex,v=p.lineIndex,x=d.charIndex<0?0:d.charIndex,b=p.charIndex<0?0:p.charIndex;for(let w=y;w<=v;w++){const T=this._getLineLeftOffset(w)||0;let E=this.getHeightOfLine(w),M=0,C=0,D=0;if(w===y&&(C=this.__charBounds[y][x].left),w>=y&&w<v)D=f&&!this.isEndOfWrapping(w)?this.width:this.getLineWidth(w)||5;else if(w===v)if(b===0)D=this.__charBounds[v][b].left;else{const G=this._getWidthOfCharSpacing();D=this.__charBounds[v][b-1].left+this.__charBounds[v][b-1].width-G}M=E,(this.lineHeight<1||w===v&&this.lineHeight>1)&&(E/=this.lineHeight);let j=i.left+T+C,R=E,z=0;const U=D-C;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",R=1,z=E):t.fillStyle=this.selectionColor,a===Oi&&(o===le||o===Qn||o===Ka?j=this.width-j-U:o===Yt||o===ch?j=i.left+T-D:o!==Dt&&o!==Qa||(j=i.left+T-D)),t.fillRect(j,i.top+i.topOffset+z,U,R),i.topOffset+=M}}getCurrentCharFontSize(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")}getCurrentCharColor(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,Se)}_getCurrentCharIndex(){const t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}V(Ri,"ownDefaults",jj),V(Ri,"type","IText"),mt.setClass(Ri),mt.setClass(Ri,"i-text");class ar extends Ri{static getDefaults(){return{...super.getDefaults(),...ar.ownDefaults}}constructor(t,e){super(t,{...ar.ownDefaults,...e})}static createControls(){return{controls:Ck()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Qn)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(t){let e=0,i=0,o=0;const a={};for(let c=0;c<t.graphemeLines.length;c++)t.graphemeText[o]===`
`&&c>0?(i=0,o++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[o])&&c>0&&(i++,o++),a[c]={line:e,offset:i},o+=t.graphemeLines[c].length,i+=t.graphemeLines[c].length;return a}styleHas(t,e){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[e];i&&(e=i.line)}return super.styleHas(t,e)}isEmptyStyles(t){if(!this.styles)return!0;let e,i=0,o=t+1,a=!1;const c=this._styleMap[t],h=this._styleMap[t+1];c&&(t=c.line,i=c.offset),h&&(o=h.line,a=o===t,e=h.offset);const f=t===void 0?this.styles:{line:this.styles[t]};for(const d in f)for(const p in f[d]){const y=parseInt(p,10);if(y>=i&&(!a||y<e))for(const v in f[d][p])return!1}return!0}_getStyleDeclaration(t,e){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[t];if(!i)return{};t=i.line,e=i.offset+e}return super._getStyleDeclaration(t,e)}_setStyleDeclaration(t,e,i){const o=this._styleMap[t];super._setStyleDeclaration(o.line,o.offset+e,i)}_deleteStyleDeclaration(t,e){const i=this._styleMap[t];super._deleteStyleDeclaration(i.line,i.offset+e)}_getLineStyle(t){const e=this._styleMap[t];return!!this.styles[e.line]}_setLineStyle(t){const e=this._styleMap[t];super._setLineStyle(e.line)}_wrapText(t,e){this.isWrapping=!0;const i=this.getGraphemeDataForRender(t),o=[];for(let a=0;a<i.wordsData.length;a++)o.push(...this._wrapLine(a,e,i));return this.isWrapping=!1,o}getGraphemeDataForRender(t){const e=this.splitByGrapheme,i=e?"":" ";let o=0;return{wordsData:t.map((a,c)=>{let h=0;const f=e?this.graphemeSplit(a):this.wordSplit(a);return f.length===0?[{word:[],width:0}]:f.map(d=>{const p=e?[d]:this.graphemeSplit(d),y=this._measureWord(p,c,h);return o=Math.max(y,o),h+=p.length+i.length,{word:p,width:y}})}),largestWordWidth:o}}_measureWord(t,e){let i,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=0;for(let c=0,h=t.length;c<h;c++)a+=this._getGraphemeBox(t[c],e,c+o,i,!0).kernedWidth,i=t[c];return a}wordSplit(t){return t.split(this._wordJoiners)}_wrapLine(t,e,i){let{largestWordWidth:o,wordsData:a}=i,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const h=this._getWidthOfCharSpacing(),f=this.splitByGrapheme,d=[],p=f?"":" ";let y=0,v=[],x=0,b=0,w=!0;e-=c;const T=Math.max(e,o,this.dynamicMinWidth),E=a[t];let M;for(x=0,M=0;M<E.length;M++){const{word:C,width:D}=E[M];x+=C.length,y+=b+D-h,y>T&&!w?(d.push(v),v=[],y=D,w=!0):y+=h,w||f||v.push(p),v=v.concat(C),b=f?0:this._measureWord([p],t,x),x++,w=!1}return M&&d.push(v),o+c>this.dynamicMinWidth&&(this.dynamicMinWidth=o-h+c),d}isEndOfWrapping(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line}missingNewlineOffset(t,e){return this.splitByGrapheme&&!e?this.isEndOfWrapping(t)?1:0:1}_splitTextIntoLines(t){const e=super._splitTextIntoLines(t),i=this._wrapText(e.lines,this.width),o=new Array(i.length);for(let a=0;a<i.length;a++)o[a]=i[a].join("");return e.lines=o,e.graphemeLines=i,e}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const t=new Map;for(const e in this._styleMap){const i=parseInt(e,10);if(this._textLines[i]){const o=this._styleMap[e].line;t.set(`${o}`,!0)}}for(const e in this.styles)t.has(e)||delete this.styles[e]}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...t])}}V(ar,"type","Textbox"),V(ar,"textLayoutProperties",[...Ri.textLayoutProperties,"width"]),V(ar,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),mt.setClass(ar);class k1 extends zh{shouldPerformLayout(t){return!!t.target.clipPath&&super.shouldPerformLayout(t)}shouldLayoutClipPath(){return!1}calcLayoutResult(t,e){const{target:i}=t,{clipPath:o,group:a}=i;if(!o||!this.shouldPerformLayout(t))return;const{width:c,height:h}=Li(v_(i,o)),f=new tt(c,h);if(o.absolutePositioned)return{center:jo(o.getRelativeCenterPoint(),void 0,a?a.calcTransformMatrix():void 0),size:f};{const d=o.getRelativeCenterPoint().transform(i.calcOwnMatrix(),!0);if(this.shouldPerformLayout(t)){const{center:p=new tt,correction:y=new tt}=this.calcBoundingBox(e,t)||{};return{center:p.add(d),correction:y.subtract(d),size:f}}return{center:i.getRelativeCenterPoint().add(d),size:f}}}}V(k1,"type","clip-path"),mt.setClass(k1);class j1 extends zh{getInitialSize(t,e){let{target:i}=t,{size:o}=e;return new tt(i.width||o.x,i.height||o.y)}}V(j1,"type","fixed"),mt.setClass(j1);class Nj extends gl{subscribeTargets(t){const e=t.target;t.targets.reduce((i,o)=>(o.parent&&i.add(o.parent),i),new Set).forEach(i=>{i.layoutManager.subscribeTargets({target:i,targets:[e]})})}unsubscribeTargets(t){const e=t.target,i=e.getObjects();t.targets.reduce((o,a)=>(a.parent&&o.add(a.parent),o),new Set).forEach(o=>{!i.some(a=>a.parent===o)&&o.layoutManager.unsubscribeTargets({target:o,targets:[e]})})}}class lr extends dr{static getDefaults(){return{...super.getDefaults(),...lr.ownDefaults}}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,lr.ownDefaults),this.setOptions(e);const{left:i,top:o,layoutManager:a}=e;this.groupInit(t,{left:i,top:o,layoutManager:a??new Nj})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.multiSelectionStacking==="selection-order"?this.add(...e):e.forEach(o=>{const a=this._objects.findIndex(h=>h.isInFrontOf(o)),c=a===-1?this.size():a;this.insertAt(c,o)})}canEnterGroup(t){return this.getObjects().some(e=>e.isDescendantOf(t)||t.isDescendantOf(e))?(Ts("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(t)}enterGroup(t,e){t.parent&&t.parent===t.group?t.parent._exitGroup(t):t.group&&t.parent!==t.group&&t.group.remove(t),this._enterGroup(t,e)}exitGroup(t,e){this._exitGroup(t,e),t.parent&&t.parent._enterGroup(t,!0)}_onAfterObjectsChange(t,e){super._onAfterObjectsChange(t,e);const i=new Set;e.forEach(o=>{const{parent:a}=o;a&&i.add(a)}),t===Zp?i.forEach(o=>{o._onAfterObjectsChange(uh,e)}):i.forEach(o=>{o._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return`#<ActiveSelection: (${this.complexity()})>`}shouldCache(){return!1}isOnACache(){return!1}_renderControls(t,e,i){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const o={hasControls:!1,...i,forActiveSelection:!0};for(let a=0;a<this._objects.length;a++)this._objects[a]._renderControls(t,o);super._renderControls(t,e),t.restore()}}V(lr,"type","ActiveSelection"),V(lr,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),mt.setClass(lr),mt.setClass(lr,"activeSelection");class Rj{constructor(){V(this,"resources",{})}applyFilters(t,e,i,o,a){const c=a.getContext("2d",{willReadFrequently:!0,desynchronized:!0});if(!c)return;c.drawImage(e,0,0,i,o);const h={sourceWidth:i,sourceHeight:o,imageData:c.getImageData(0,0,i,o),originalEl:e,originalImageData:c.getImageData(0,0,i,o),canvasEl:a,ctx:c,filterBackend:this};t.forEach(d=>{d.applyTo(h)});const{imageData:f}=h;return f.width===i&&f.height===o||(a.width=f.width,a.height=f.height),c.putImageData(f,0,0),h}}class z_{constructor(){let{tileSize:t=Bt.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};V(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),V(this,"resources",{}),this.tileSize=t,this.setupGLContext(t,t),this.captureGPUInfo()}setupGLContext(t,e){this.dispose(),this.createWebGLCanvas(t,e)}createWebGLCanvas(t,e){const i=Cn({width:t,height:e}),o=i.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});o&&(o.clearColor(0,0,0,0),this.canvas=i,this.gl=o)}applyFilters(t,e,i,o,a,c){const h=this.gl,f=a.getContext("2d");if(!h||!f)return;let d;c&&(d=this.getCachedTexture(c,e));const p={originalWidth:e.width||e.naturalWidth||0,originalHeight:e.height||e.naturalHeight||0,sourceWidth:i,sourceHeight:o,destinationWidth:i,destinationHeight:o,context:h,sourceTexture:this.createTexture(h,i,o,d?void 0:e),targetTexture:this.createTexture(h,i,o),originalTexture:d||this.createTexture(h,i,o,d?void 0:e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:a},y=h.createFramebuffer();return h.bindFramebuffer(h.FRAMEBUFFER,y),t.forEach(v=>{v&&v.applyTo(p)}),(function(v){const x=v.targetCanvas,b=x.width,w=x.height,T=v.destinationWidth,E=v.destinationHeight;b===T&&w===E||(x.width=T,x.height=E)})(p),this.copyGLTo2D(h,p),h.bindTexture(h.TEXTURE_2D,null),h.deleteTexture(p.sourceTexture),h.deleteTexture(p.targetTexture),h.deleteFramebuffer(y),f.setTransform(1,0,0,1,0,0),p}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(t,e,i,o,a){const{NEAREST:c,TEXTURE_2D:h,RGBA:f,UNSIGNED_BYTE:d,CLAMP_TO_EDGE:p,TEXTURE_MAG_FILTER:y,TEXTURE_MIN_FILTER:v,TEXTURE_WRAP_S:x,TEXTURE_WRAP_T:b}=t,w=t.createTexture();return t.bindTexture(h,w),t.texParameteri(h,y,a||c),t.texParameteri(h,v,a||c),t.texParameteri(h,x,p),t.texParameteri(h,b,p),o?t.texImage2D(h,0,f,f,d,o):t.texImage2D(h,0,f,e,i,0,f,d,null),w}getCachedTexture(t,e,i){const{textureCache:o}=this;if(o[t])return o[t];{const a=this.createTexture(this.gl,e.width,e.height,e,i);return a&&(o[t]=a),a}}evictCachesForKey(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])}copyGLTo2D(t,e){const i=t.canvas,o=e.targetCanvas,a=o.getContext("2d");if(!a)return;a.translate(0,o.height),a.scale(1,-1);const c=i.height-o.height;a.drawImage(i,0,c,o.width,o.height,0,0,o.width,o.height)}copyGLTo2DPutImageData(t,e){const i=e.targetCanvas.getContext("2d"),o=e.destinationWidth,a=e.destinationHeight,c=o*a*4;if(!i)return;const h=new Uint8Array(this.imageBuffer,0,c),f=new Uint8ClampedArray(this.imageBuffer,0,c);t.readPixels(0,0,o,a,t.RGBA,t.UNSIGNED_BYTE,h);const d=new ImageData(f,o,a);i.putImageData(d,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const t=this.gl,e={renderer:"",vendor:""};if(!t)return e;const i=t.getExtension("WEBGL_debug_renderer_info");if(i){const o=t.getParameter(i.UNMASKED_RENDERER_WEBGL),a=t.getParameter(i.UNMASKED_VENDOR_WEBGL);o&&(e.renderer=o.toLowerCase()),a&&(e.vendor=a.toLowerCase())}return this.gpuInfo=e,e}}let Ng;function zj(){const{WebGLProbe:s}=ni();return s.queryWebGL(Pi()),Bt.enableGLFiltering&&s.isSupported(Bt.textureSize)?new z_({tileSize:Bt.textureSize}):new Rj}function Rg(){return!Ng&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Ng=zj()),Ng}const L_=["cropX","cropY"];class Sn extends ke{static getDefaults(){return{...super.getDefaults(),...Sn.ownDefaults}}constructor(t,e){super(),V(this,"_lastScaleX",1),V(this,"_lastScaleY",1),V(this,"_filterScalingX",1),V(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Sn.ownDefaults),this.setOptions(e),this.cacheKey=`texture${Es()}`,this.setElement(typeof t=="string"?(this.canvas&&Ln(this.canvas.getElement())||Lo()).getElementById(t):t,e)}getElement(){return this._element}setElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._element=t,this._originalElement=t,this._setWidthHeight(e),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(t){const e=Rg(!1);e instanceof z_&&e.evictCachesForKey(t)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(t=>{const e=this[t];e&&ni().dispose(e),this[t]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const t=this.getElement();return t?{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}:{width:0,height:0}}_stroke(t){if(!this.stroke||this.strokeWidth===0)return;const e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=[];return this.filters.forEach(i=>{i&&e.push(i.toObject())}),{...super.toObject([...L_,...t]),src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:e,...this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{}}}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const t=[],e=this._element,i=-this.width/2,o=-this.height/2;let a=[],c=[],h="",f="";if(!e)return[];if(this.hasCrop()){const d=Es();a.push('<clipPath id="imageCrop_'+d+`">
`,'	<rect x="'+i+'" y="'+o+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),h=' clip-path="url(#imageCrop_'+d+')" '}if(this.imageSmoothing||(f=' image-rendering="optimizeSpeed"'),t.push("	<image ","COMMON_PARTS",`xlink:href="${this.getSvgSrc(!0)}" x="${i-this.cropX}" y="${o-this.cropY}" width="${e.width||e.naturalWidth}" height="${e.height||e.naturalHeight}"${f}${h}></image>
`),this.stroke||this.strokeDashArray){const d=this.fill;this.fill=null,c=[`	<rect x="${i}" y="${o}" width="${this.width}" height="${this.height}" style="${this.getSvgStyles()}" />
`],this.fill=d}return a=this.paintFirst!==Se?a.concat(c,t):a.concat(t,c),a}getSrc(t){const e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src")||"":e.src:this.src||""}getSvgSrc(t){return this.getSrc(t)}setSrc(t){let{crossOrigin:e,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Pu(t,{crossOrigin:e,signal:i}).then(o=>{e!==void 0&&this.set({crossOrigin:e}),this.setElement(o)})}toString(){return`#<Image: { src: "${this.getSrc()}" }>`}applyResizeFilters(){const t=this.resizeFilter,e=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),o=i.x,a=i.y,c=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||o>e&&a>e)return this._element=c,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=o,void(this._lastScaleY=a);const h=Cn(c),{width:f,height:d}=c;this._element=h,this._lastScaleX=t.scaleX=o,this._lastScaleY=t.scaleY=a,Rg().applyFilters([t],c,f,d,this._element),this._filterScalingX=h.width/this._originalElement.width,this._filterScalingY=h.height/this._originalElement.height}applyFilters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(t=t.filter(a=>a&&!a.isNeutralState()),this.set("dirty",!0),this.removeTexture(`${this.cacheKey}_filtered`),t.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const e=this._originalElement,i=e.naturalWidth||e.width,o=e.naturalHeight||e.height;if(this._element===this._originalElement){const a=Cn({width:i,height:o});this._element=a,this._filteredEl=a}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,o),this._lastScaleX=1,this._lastScaleY=1);Rg().applyFilters(t,this._originalElement,i,o,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(t){t.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)}drawCacheOnCanvas(t){t.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(t)}shouldCache(){return this.needsItsOwnCache()}_renderFill(t){const e=this._element;if(!e)return;const i=this._filterScalingX,o=this._filterScalingY,a=this.width,c=this.height,h=Math.max(this.cropX,0),f=Math.max(this.cropY,0),d=e.naturalWidth||e.width,p=e.naturalHeight||e.height,y=h*i,v=f*o,x=Math.min(a*i,d-y),b=Math.min(c*o,p-v),w=-a/2,T=-c/2,E=Math.min(a,d/i-h),M=Math.min(c,p/o-f);e&&t.drawImage(e,y,v,x,b,w,T,E,M)}_needsResize(){const t=this.getTotalObjectScaling();return t.x!==this._lastScaleX||t.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:t,height:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=this.getOriginalSize();this.width=t||i.width,this.height=e||i.height}parsePreserveAspectRatioAttribute(){const t=W5(this.preserveAspectRatio||""),e=this.width,i=this.height,o={width:e,height:i};let a,c=this._element.width,h=this._element.height,f=1,d=1,p=0,y=0,v=0,x=0;return!t||t.alignX===Ke&&t.alignY===Ke?(f=e/c,d=i/h):(t.meetOrSlice==="meet"&&(f=d=Qk(this._element,o),a=(e-c*f)/2,t.alignX==="Min"&&(p=-a),t.alignX==="Max"&&(p=a),a=(i-h*d)/2,t.alignY==="Min"&&(y=-a),t.alignY==="Max"&&(y=a)),t.meetOrSlice==="slice"&&(f=d=Jk(this._element,o),a=c-e/f,t.alignX==="Mid"&&(v=a/2),t.alignX==="Max"&&(v=a),a=h-i/d,t.alignY==="Mid"&&(x=a/2),t.alignY==="Max"&&(x=a),c=e/f,h=i/d)),{width:c,height:h,scaleX:f,scaleY:d,offsetLeft:p,offsetTop:y,cropX:v,cropY:x}}static fromObject(t,e){let{filters:i,resizeFilter:o,src:a,crossOrigin:c,type:h,...f}=t;return Promise.all([Pu(a,{...e,crossOrigin:c}),i&&ul(i,e),o?ul([o],e):[],kh(f,e)]).then(d=>{let[p,y=[],[v],x={}]=d;return new this(p,{...f,src:a,filters:y,resizeFilter:v,...x})})}static fromURL(t){let{crossOrigin:e=null,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return Pu(t,{crossOrigin:e,signal:i}).then(a=>new this(a,o))}static async fromElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const o=Xi(t,this.ATTRIBUTE_NAMES,i);return this.fromURL(o["xlink:href"]||o.href,e,o).catch(a=>(Ts("log","Unable to parse Image",a),null))}}V(Sn,"type","Image"),V(Sn,"cacheProperties",[...Vi,...L_]),V(Sn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),V(Sn,"ATTRIBUTE_NAMES",[...Ds,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),mt.setClass(Sn),mt.setSVGClass(Sn);Nh(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const Bh=s=>s.webgl!==void 0,Kp="precision highp float",Lj=`
    ${Kp};
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`,Bj=new RegExp(Kp,"g");class ve{get type(){return this.constructor.type}constructor(){let{type:t,...e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return Lj}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:o="highp"}}=ni();o!=="highp"&&(e=e.replace(Bj,Kp.replace("highp",o)));const a=t.createShader(t.VERTEX_SHADER),c=t.createShader(t.FRAGMENT_SHADER),h=t.createProgram();if(!a||!c||!h)throw new Kn("Vertex, fragment shader or program creation error");if(t.shaderSource(a,i),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS))throw new Kn(`Vertex shader compile error for ${this.type}: ${t.getShaderInfoLog(a)}`);if(t.shaderSource(c,e),t.compileShader(c),!t.getShaderParameter(c,t.COMPILE_STATUS))throw new Kn(`Fragment shader compile error for ${this.type}: ${t.getShaderInfoLog(c)}`);if(t.attachShader(h,a),t.attachShader(h,c),t.linkProgram(h),!t.getProgramParameter(h,t.LINK_STATUS))throw new Kn(`Shader link error for "${this.type}" ${t.getProgramInfoLog(h)}`);const f=this.getUniformLocations(t,h)||{};return f.uStepW=t.getUniformLocation(h,"uStepW"),f.uStepH=t.getUniformLocation(h,"uStepH"),{program:h,attributeLocations:this.getAttributeLocations(t,h),uniformLocations:f}}getAttributeLocations(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}}getUniformLocations(t,e){const i=this.constructor.uniformLocations,o={};for(let a=0;a<i.length;a++)o[i[a]]=t.getUniformLocation(e,i[a]);return o}sendAttributeData(t,e,i){const o=e.aPosition,a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW)}_setupFrameBuffer(t){const e=t.context;if(t.passes>1){const i=t.destinationWidth,o=t.destinationHeight;t.sourceWidth===i&&t.sourceHeight===o||(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,i,o)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)}else e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish()}_swapTextures(t){t.passes--,t.pass++;const e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e}isNeutralState(t){return!1}applyTo(t){Bh(t)?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){}getCacheKey(){return this.type}retrieveShader(t){const e=this.getCacheKey();return t.programCache[e]||(t.programCache[e]=this.createProgram(t.context)),t.programCache[e]}applyToWebGL(t){const e=t.context,i=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(i.program),this.sendAttributeData(e,i.attributeLocations,t.aPosition),e.uniform1f(i.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(i.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,i.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(t,e,i){t.activeTexture(i),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)}unbindAdditionalTexture(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)}sendUniformData(t,e){}createHelpLayer(t){if(!t.helpLayer){const{sourceWidth:e,sourceHeight:i}=t,o=Cn({width:e,height:i});t.helpLayer=o}}toObject(){const t=Object.keys(this.constructor.defaults||{});return{type:this.type,...t.reduce((e,i)=>(e[i]=this[i],e),{})}}toJSON(){return this.toObject()}static async fromObject(t,e){let{type:i,...o}=t;return new this(o)}}V(ve,"type","BaseFilter"),V(ve,"uniformLocations",[]);const Hj={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class pu extends ve{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          ${Hj[this.mode]}
        }
      }
      `}applyTo2d(t){let{imageData:{data:e}}=t;const i=new Wt(this.color).getSource(),o=this.alpha,a=i[0]*o,c=i[1]*o,h=i[2]*o,f=1-o;for(let d=0;d<e.length;d+=4){const p=e[d],y=e[d+1],v=e[d+2];let x,b,w;switch(this.mode){case"multiply":x=p*a/255,b=y*c/255,w=v*h/255;break;case"screen":x=255-(255-p)*(255-a)/255,b=255-(255-y)*(255-c)/255,w=255-(255-v)*(255-h)/255;break;case"add":x=p+a,b=y+c,w=v+h;break;case"difference":x=Math.abs(p-a),b=Math.abs(y-c),w=Math.abs(v-h);break;case"subtract":x=p-a,b=y-c,w=v-h;break;case"darken":x=Math.min(p,a),b=Math.min(y,c),w=Math.min(v,h);break;case"lighten":x=Math.max(p,a),b=Math.max(y,c),w=Math.max(v,h);break;case"overlay":x=a<128?2*p*a/255:255-2*(255-p)*(255-a)/255,b=c<128?2*y*c/255:255-2*(255-y)*(255-c)/255,w=h<128?2*v*h/255:255-2*(255-v)*(255-h)/255;break;case"exclusion":x=a+p-2*a*p/255,b=c+y-2*c*y/255,w=h+v-2*h*v/255;break;case"tint":x=a+p*f,b=c+y*f,w=h+v*f}e[d]=x,e[d+1]=b,e[d+2]=w}}sendUniformData(t,e){const i=new Wt(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,t.uniform4fv(e.uColor,i)}}V(pu,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),V(pu,"type","BlendColor"),V(pu,"uniformLocations",["uColor"]),mt.setClass(pu);const Uj={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `};class mu extends ve{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return Uj[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(t){const e=t.context,i=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,i,e.TEXTURE1),super.applyToWebGL(t),this.unbindAdditionalTexture(e,e.TEXTURE1)}createTexture(t,e){return t.getCachedTexture(e.cacheKey,e.getElement())}calculateMatrix(){const t=this.image,{width:e,height:i}=t.getElement();return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/i,1]}applyTo2d(t){let{imageData:{data:e,width:i,height:o},filterBackend:{resources:a}}=t;const c=this.image;a.blendImage||(a.blendImage=Pi());const h=a.blendImage,f=h.getContext("2d");h.width!==i||h.height!==o?(h.width=i,h.height=o):f.clearRect(0,0,i,o),f.setTransform(c.scaleX,0,0,c.scaleY,c.left,c.top),f.drawImage(c.getElement(),0,0,i,o);const d=f.getImageData(0,0,i,o).data;for(let p=0;p<e.length;p+=4){const y=e[p],v=e[p+1],x=e[p+2],b=e[p+3],w=d[p],T=d[p+1],E=d[p+2],M=d[p+3];switch(this.mode){case"multiply":e[p]=y*w/255,e[p+1]=v*T/255,e[p+2]=x*E/255,e[p+3]=b*M/255;break;case"mask":e[p+3]=M}}}sendUniformData(t,e){const i=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,i)}toObject(){return{...super.toObject(),image:this.image&&this.image.toObject()}}static async fromObject(t,e){let{type:i,image:o,...a}=t;return Sn.fromObject(o,e).then(c=>new this({...a,image:c}))}}V(mu,"type","BlendImage"),V(mu,"defaults",{mode:"multiply",alpha:1}),V(mu,"uniformLocations",["uTransformMatrix","uImage"]),mt.setClass(mu);class yu extends ve{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(t){Bh(t)?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){let{imageData:{data:e,width:i,height:o}}=t;this.aspectRatio=i/o,this.horizontal=!0;let a=this.getBlurValue()*i;const c=new Uint8ClampedArray(e),h=15,f=4*i;for(let d=0;d<e.length;d+=4){let p=0,y=0,v=0,x=0,b=0;const w=d-d%f,T=w+f;for(let E=-14;E<h;E++){const M=E/h,C=4*Math.floor(a*M),D=1-Math.abs(M);let j=d+C;j<w?j=w:j>T&&(j=T);const R=e[j+3]*D;p+=e[j]*R,y+=e[j+1]*R,v+=e[j+2]*R,x+=R,b+=D}c[d]=p/x,c[d+1]=y/x,c[d+2]=v/x,c[d+3]=x/b}this.horizontal=!1,a=this.getBlurValue()*o;for(let d=0;d<c.length;d+=4){let p=0,y=0,v=0,x=0,b=0;const w=d%f,T=c.length-f+w;for(let E=-14;E<h;E++){const M=E/h,C=Math.floor(a*M)*f,D=1-Math.abs(M);let j=d+C;j<w?j=w:j>T&&(j=T);const R=c[j+3]*D;p+=c[j]*R,y+=c[j+1]*R,v+=c[j+2]*R,x+=R,b+=D}e[d]=p/x,e[d+1]=y/x,e[d+2]=v/x,e[d+3]=x/b}}sendUniformData(t,e){const i=this.chooseRightDelta();t.uniform2fv(e.uDelta,i)}isNeutralState(){return this.blur===0}getBlurValue(){let t=1;const{horizontal:e,aspectRatio:i}=this;return e?i>1&&(t=1/i):i<1&&(t=i),t*this.blur*.12}chooseRightDelta(){const t=this.getBlurValue();return this.horizontal?[t,0]:[0,t]}}V(yu,"type","Blur"),V(yu,"defaults",{blur:0}),V(yu,"uniformLocations",["uDelta"]),mt.setClass(yu);class vu extends ve{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=Math.round(255*this.brightness);for(let o=0;o<e.length;o+=4)e[o]+=i,e[o+1]+=i,e[o+2]+=i}isNeutralState(){return this.brightness===0}sendUniformData(t,e){t.uniform1f(e.uBrightness,this.brightness)}}V(vu,"type","Brightness"),V(vu,"defaults",{brightness:0}),V(vu,"uniformLocations",["uBrightness"]),mt.setClass(vu);const B_={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class yo extends ve{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(t){const e=t.imageData.data,i=this.matrix,o=this.colorsOnly;for(let a=0;a<e.length;a+=4){const c=e[a],h=e[a+1],f=e[a+2];if(e[a]=c*i[0]+h*i[1]+f*i[2]+255*i[4],e[a+1]=c*i[5]+h*i[6]+f*i[7]+255*i[9],e[a+2]=c*i[10]+h*i[11]+f*i[12]+255*i[14],!o){const d=e[a+3];e[a]+=d*i[3],e[a+1]+=d*i[8],e[a+2]+=d*i[13],e[a+3]=c*i[15]+h*i[16]+f*i[17]+d*i[18]+255*i[19]}}}sendUniformData(t,e){const i=this.matrix,o=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],a=[i[4],i[9],i[14],i[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,o),t.uniform4fv(e.uConstants,a)}toObject(){return{...super.toObject(),matrix:[...this.matrix]}}}function br(s,t){var e;const i=(V(e=class extends yo{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",s),V(e,"defaults",{colorsOnly:!1,matrix:t}),e);return mt.setClass(i,s),i}V(yo,"type","ColorMatrix"),V(yo,"defaults",B_),V(yo,"uniformLocations",["uColorMatrix","uConstants"]),mt.setClass(yo);br("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);br("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);br("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);br("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);br("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);br("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);br("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class N1 extends ve{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.subFilters=t.subFilters||[]}applyTo(t){Bh(t)&&(t.passes+=this.subFilters.length-1),this.subFilters.forEach(e=>{e.applyTo(t)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(t=>t.toObject())}}isNeutralState(){return!this.subFilters.some(t=>!t.isNeutralState())}static fromObject(t,e){return Promise.all((t.subFilters||[]).map(i=>mt.getClass(i.type).fromObject(i,e))).then(i=>new this({subFilters:i}))}}V(N1,"type","Composed"),mt.setClass(N1);class xu extends ve{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(t){let{imageData:{data:e}}=t;const i=Math.floor(255*this.contrast),o=259*(i+255)/(255*(259-i));for(let a=0;a<e.length;a+=4)e[a]=o*(e[a]-128)+128,e[a+1]=o*(e[a+1]-128)+128,e[a+2]=o*(e[a+2]-128)+128}sendUniformData(t,e){t.uniform1f(e.uContrast,this.contrast)}}V(xu,"type","Contrast"),V(xu,"defaults",{contrast:0}),V(xu,"uniformLocations",["uContrast"]),mt.setClass(xu);const Pj={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class bu extends ve{getCacheKey(){return`${this.type}_${Math.sqrt(this.matrix.length)}_${this.opaque?1:0}`}getFragmentSource(){return Pj[this.getCacheKey()]}applyTo2d(t){const e=t.imageData,i=e.data,o=this.matrix,a=Math.round(Math.sqrt(o.length)),c=Math.floor(a/2),h=e.width,f=e.height,d=t.ctx.createImageData(h,f),p=d.data,y=this.opaque?1:0;let v,x,b,w,T,E,M,C,D,j,R,z,U;for(R=0;R<f;R++)for(j=0;j<h;j++){for(T=4*(R*h+j),v=0,x=0,b=0,w=0,U=0;U<a;U++)for(z=0;z<a;z++)M=R+U-c,E=j+z-c,M<0||M>=f||E<0||E>=h||(C=4*(M*h+E),D=o[U*a+z],v+=i[C]*D,x+=i[C+1]*D,b+=i[C+2]*D,y||(w+=i[C+3]*D));p[T]=v,p[T+1]=x,p[T+2]=b,p[T+3]=y?i[T+3]:w}t.imageData=d}sendUniformData(t,e){t.uniform1fv(e.uMatrix,this.matrix)}toObject(){return{...super.toObject(),opaque:this.opaque,matrix:[...this.matrix]}}}V(bu,"type","Convolute"),V(bu,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),V(bu,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),mt.setClass(bu);const H_="Gamma";class Su extends ve{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.gamma=t.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(t){let{imageData:{data:e}}=t;const i=this.gamma,o=1/i[0],a=1/i[1],c=1/i[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const h=this.rgbValues;for(let f=0;f<256;f++)h.r[f]=255*Math.pow(f/255,o),h.g[f]=255*Math.pow(f/255,a),h.b[f]=255*Math.pow(f/255,c);for(let f=0;f<e.length;f+=4)e[f]=h.r[e[f]],e[f+1]=h.g[e[f+1]],e[f+2]=h.b[e[f+2]]}sendUniformData(t,e){t.uniform3fv(e.uGamma,this.gamma)}isNeutralState(){const{gamma:t}=this;return t[0]===1&&t[1]===1&&t[2]===1}toObject(){return{type:H_,gamma:this.gamma.concat()}}}V(Su,"type",H_),V(Su,"defaults",{gamma:[1,1,1]}),V(Su,"uniformLocations",["uGamma"]),mt.setClass(Su);const Yj={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class _u extends ve{applyTo2d(t){let{imageData:{data:e}}=t;for(let i,o=0;o<e.length;o+=4){const a=e[o],c=e[o+1],h=e[o+2];switch(this.mode){case"average":i=(a+c+h)/3;break;case"lightness":i=(Math.min(a,c,h)+Math.max(a,c,h))/2;break;case"luminosity":i=.21*a+.72*c+.07*h}e[o+2]=e[o+1]=e[o]=i}}getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return Yj[this.mode]}sendUniformData(t,e){t.uniform1i(e.uMode,1)}isNeutralState(){return!1}}V(_u,"type","Grayscale"),V(_u,"defaults",{mode:"average"}),V(_u,"uniformLocations",["uMode"]),mt.setClass(_u);const Vj={...B_,rotation:0};class zg extends yo{calculateMatrix(){const t=this.rotation*Math.PI,e=Hi(t),i=Ui(t),o=1/3,a=Math.sqrt(o)*i,c=1-e;this.matrix=[e+c/3,o*c-a,o*c+a,0,0,o*c+a,e+o*c,o*c-a,0,0,o*c-a,o*c+a,e+o*c,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(t){this.calculateMatrix(),super.applyTo(t)}toObject(){return{type:this.type,rotation:this.rotation}}}V(zg,"type","HueRotation"),V(zg,"defaults",Vj),mt.setClass(zg);class wu extends ve{applyTo2d(t){let{imageData:{data:e}}=t;for(let i=0;i<e.length;i+=4)e[i]=255-e[i],e[i+1]=255-e[i+1],e[i+2]=255-e[i+2],this.alpha&&(e[i+3]=255-e[i+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(t,e){t.uniform1i(e.uInvert,Number(this.invert)),t.uniform1i(e.uAlpha,Number(this.alpha))}}V(wu,"type","Invert"),V(wu,"defaults",{alpha:!1,invert:!0}),V(wu,"uniformLocations",["uInvert","uAlpha"]),mt.setClass(wu);class Cu extends ve{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=this.noise;for(let o=0;o<e.length;o+=4){const a=(.5-Math.random())*i;e[o]+=a,e[o+1]+=a,e[o+2]+=a}}sendUniformData(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())}isNeutralState(){return this.noise===0}}V(Cu,"type","Noise"),V(Cu,"defaults",{noise:0}),V(Cu,"uniformLocations",["uNoise","uSeed"]),mt.setClass(Cu);class Tu extends ve{applyTo2d(t){let{imageData:{data:e,width:i,height:o}}=t;for(let a=0;a<o;a+=this.blocksize)for(let c=0;c<i;c+=this.blocksize){const h=4*a*i+4*c,f=e[h],d=e[h+1],p=e[h+2],y=e[h+3];for(let v=a;v<Math.min(a+this.blocksize,o);v++)for(let x=c;x<Math.min(c+this.blocksize,i);x++){const b=4*v*i+4*x;e[b]=f,e[b+1]=d,e[b+2]=p,e[b+3]=y}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}V(Tu,"type","Pixelate"),V(Tu,"defaults",{blocksize:4}),V(Tu,"uniformLocations",["uBlocksize"]),mt.setClass(Tu);class Eu extends ve{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=255*this.distance,o=new Wt(this.color).getSource(),a=[o[0]-i,o[1]-i,o[2]-i],c=[o[0]+i,o[1]+i,o[2]+i];for(let h=0;h<e.length;h+=4){const f=e[h],d=e[h+1],p=e[h+2];f>a[0]&&d>a[1]&&p>a[2]&&f<c[0]&&d<c[1]&&p<c[2]&&(e[h+3]=0)}}sendUniformData(t,e){const i=new Wt(this.color).getSource(),o=this.distance,a=[0+i[0]/255-o,0+i[1]/255-o,0+i[2]/255-o,1],c=[i[0]/255+o,i[1]/255+o,i[2]/255+o,1];t.uniform4fv(e.uLow,a),t.uniform4fv(e.uHigh,c)}}V(Eu,"type","RemoveColor"),V(Eu,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),V(Eu,"uniformLocations",["uLow","uHigh"]),mt.setClass(Eu);class Mu extends ve{sendUniformData(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)}getFilterWindow(){const t=this.tempScale;return Math.ceil(this.lanczosLobes/t)}getCacheKey(){const t=this.getFilterWindow();return`${this.type}_${t}`}getFragmentSource(){const t=this.getFilterWindow();return this.generateShader(t)}getTaps(){const t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,i=this.getFilterWindow(),o=new Array(i);for(let a=1;a<=i;a++)o[a-1]=t(a*e);return o}generateShader(t){const e=new Array(t);for(let i=1;i<=t;i++)e[i-1]=`${i}.0 * uDelta`;return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[${t}];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        ${e.map((i,o)=>`
              color += texture2D(uTexture, vTexCoord + ${i}) * uTaps[${o}] + texture2D(uTexture, vTexCoord - ${i}) * uTaps[${o}];
              sum += 2.0 * uTaps[${o}];
            `).join(`
`)}
        gl_FragColor = color / sum;
      }
    `}applyToForWebgl(t){t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,super.applyTo(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,super.applyTo(t),t.sourceHeight=t.destinationHeight}applyTo(t){Bh(t)?this.applyToForWebgl(t):this.applyTo2d(t)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(t){return e=>{if(e>=t||e<=-t)return 0;if(e<11920929e-14&&e>-11920929e-14)return 1;const i=(e*=Math.PI)/t;return Math.sin(e)/e*Math.sin(i)/i}}applyTo2d(t){const e=t.imageData,i=this.scaleX,o=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/o;const a=e.width,c=e.height,h=Math.round(a*i),f=Math.round(c*o);let d;d=this.resizeType==="sliceHack"?this.sliceByTwo(t,a,c,h,f):this.resizeType==="hermite"?this.hermiteFastResize(t,a,c,h,f):this.resizeType==="bilinear"?this.bilinearFiltering(t,a,c,h,f):this.resizeType==="lanczos"?this.lanczosResize(t,a,c,h,f):new ImageData(h,f),t.imageData=d}sliceByTwo(t,e,i,o,a){const c=t.imageData,h=.5;let f=!1,d=!1,p=e*h,y=i*h;const v=t.filterBackend.resources;let x=0,b=0;const w=e;let T=0;v.sliceByTwo||(v.sliceByTwo=Pi());const E=v.sliceByTwo;(E.width<1.5*e||E.height<i)&&(E.width=1.5*e,E.height=i);const M=E.getContext("2d");for(M.clearRect(0,0,1.5*e,i),M.putImageData(c,0,0),o=Math.floor(o),a=Math.floor(a);!f||!d;)e=p,i=y,o<Math.floor(p*h)?p=Math.floor(p*h):(p=o,f=!0),a<Math.floor(y*h)?y=Math.floor(y*h):(y=a,d=!0),M.drawImage(E,x,b,e,i,w,T,p,y),x=w,b=T,T+=y;return M.getImageData(x,b,o,a)}lanczosResize(t,e,i,o,a){const c=t.imageData.data,h=t.ctx.createImageData(o,a),f=h.data,d=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,y=this.rcpScaleY,v=2/this.rcpScaleX,x=2/this.rcpScaleY,b=Math.ceil(p*this.lanczosLobes/2),w=Math.ceil(y*this.lanczosLobes/2),T={},E={x:0,y:0},M={x:0,y:0};return(function C(D){let j,R,z,U,G,ut,W,Z,rt,N,I;for(E.x=(D+.5)*p,M.x=Math.floor(E.x),j=0;j<a;j++){for(E.y=(j+.5)*y,M.y=Math.floor(E.y),G=0,ut=0,W=0,Z=0,rt=0,R=M.x-b;R<=M.x+b;R++)if(!(R<0||R>=e)){N=Math.floor(1e3*Math.abs(R-E.x)),T[N]||(T[N]={});for(let A=M.y-w;A<=M.y+w;A++)A<0||A>=i||(I=Math.floor(1e3*Math.abs(A-E.y)),T[N][I]||(T[N][I]=d(Math.sqrt(Math.pow(N*v,2)+Math.pow(I*x,2))/1e3)),z=T[N][I],z>0&&(U=4*(A*e+R),G+=z,ut+=z*c[U],W+=z*c[U+1],Z+=z*c[U+2],rt+=z*c[U+3]))}U=4*(j*o+D),f[U]=ut/G,f[U+1]=W/G,f[U+2]=Z/G,f[U+3]=rt/G}return++D<o?C(D):h})(0)}bilinearFiltering(t,e,i,o,a){let c,h,f,d,p,y,v,x,b,w,T,E,M,C=0;const D=this.rcpScaleX,j=this.rcpScaleY,R=4*(e-1),z=t.imageData.data,U=t.ctx.createImageData(o,a),G=U.data;for(v=0;v<a;v++)for(x=0;x<o;x++)for(p=Math.floor(D*x),y=Math.floor(j*v),b=D*x-p,w=j*v-y,M=4*(y*e+p),T=0;T<4;T++)c=z[M+T],h=z[M+4+T],f=z[M+R+T],d=z[M+R+4+T],E=c*(1-b)*(1-w)+h*b*(1-w)+f*w*(1-b)+d*b*w,G[C++]=E;return U}hermiteFastResize(t,e,i,o,a){const c=this.rcpScaleX,h=this.rcpScaleY,f=Math.ceil(c/2),d=Math.ceil(h/2),p=t.imageData.data,y=t.ctx.createImageData(o,a),v=y.data;for(let x=0;x<a;x++)for(let b=0;b<o;b++){const w=4*(b+x*o);let T=0,E=0,M=0,C=0,D=0,j=0,R=0;const z=(x+.5)*h;for(let U=Math.floor(x*h);U<(x+1)*h;U++){const G=Math.abs(z-(U+.5))/d,ut=(b+.5)*c,W=G*G;for(let Z=Math.floor(b*c);Z<(b+1)*c;Z++){let rt=Math.abs(ut-(Z+.5))/f;const N=Math.sqrt(W+rt*rt);N>1&&N<-1||(T=2*N*N*N-3*N*N+1,T>0&&(rt=4*(Z+U*e),R+=T*p[rt+3],M+=T,p[rt+3]<255&&(T=T*p[rt+3]/250),C+=T*p[rt],D+=T*p[rt+1],j+=T*p[rt+2],E+=T))}}v[w]=C/E,v[w+1]=D/E,v[w+2]=j/E,v[w+3]=R/M}return y}}V(Mu,"type","Resize"),V(Mu,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),V(Mu,"uniformLocations",["uDelta","uTaps"]),mt.setClass(Mu);class Du extends ve{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=-this.saturation;for(let o=0;o<e.length;o+=4){const a=e[o],c=e[o+1],h=e[o+2],f=Math.max(a,c,h);e[o]+=f!==a?(f-a)*i:0,e[o+1]+=f!==c?(f-c)*i:0,e[o+2]+=f!==h?(f-h)*i:0}}sendUniformData(t,e){t.uniform1f(e.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}V(Du,"type","Saturation"),V(Du,"defaults",{saturation:0}),V(Du,"uniformLocations",["uSaturation"]),mt.setClass(Du);class Ou extends ve{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=-this.vibrance;for(let o=0;o<e.length;o+=4){const a=e[o],c=e[o+1],h=e[o+2],f=Math.max(a,c,h),d=(a+c+h)/3,p=2*Math.abs(f-d)/255*i;e[o]+=f!==a?(f-a)*p:0,e[o+1]+=f!==c?(f-c)*p:0,e[o+2]+=f!==h?(f-h)*p:0}}sendUniformData(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}V(Ou,"type","Vibrance"),V(Ou,"defaults",{vibrance:0}),V(Ou,"uniformLocations",["uVibrance"]),mt.setClass(Ou);const R1=[{label:"Red",value:"rgba(255, 0, 0, 0.7)"},{label:"Green",value:"rgba(0, 200, 0, 0.7)"},{label:"Blue",value:"rgba(0, 100, 255, 0.7)"},{label:"Yellow",value:"rgba(255, 220, 0, 0.7)"}],z1={Red:"#ff0000",Green:"#00c800",Blue:"#0064ff",Yellow:"#ffdc00"};function Xj({selectedNode:s}){const t=Y.useRef(null),e=Y.useRef(null),i=Y.useRef(null),o=Mt(M=>M.updateNodeParams),[a,c]=Y.useState("pen"),[h,f]=Y.useState(20),[d,p]=Y.useState(R1[0]),[y,v]=Y.useState(!1),x=s?.result?.image??null,b=s?.type==="MODIFIER";Y.useEffect(()=>{if(!t.current||!i.current)return;const C=i.current.clientWidth,D=Math.max(200,C*.75),j=new cp(t.current,{width:C,height:D,backgroundColor:"transparent",isDrawingMode:!0});return j.freeDrawingBrush=new _o(j),j.freeDrawingBrush.color=d.value,j.freeDrawingBrush.width=h,e.current=j,()=>{j.dispose(),e.current=null}},[s?.id]),Y.useEffect(()=>{const M=e.current;!M||!x||Sn.fromURL(x).then(C=>{const D=M.getWidth(),j=M.getHeight(),R=D/(C.width??D),z=j/(C.height??j),U=Math.min(R,z);C.set({scaleX:U,scaleY:U,originX:"center",originY:"center",left:D/2,top:j/2}),M.backgroundImage=C,M.renderAll()})},[x]),Y.useEffect(()=>{const M=e.current;M&&(a==="pen"?(M.isDrawingMode=!0,M.freeDrawingBrush=new _o(M),M.freeDrawingBrush.color=d.value,M.freeDrawingBrush.width=h):a==="eraser"?(M.isDrawingMode=!0,M.freeDrawingBrush=new _o(M),M.freeDrawingBrush.color="rgba(0, 0, 0, 1)",M.freeDrawingBrush.width=h):a==="move"&&(M.isDrawingMode=!1,M.selection=!0))},[a,h,d]),Y.useEffect(()=>{const M=e.current;if(!M)return;const C=D=>{a==="eraser"&&D.path&&(D.path.globalCompositeOperation="destination-out",M.renderAll())};return M.on("path:created",C),()=>{M.off("path:created",C)}},[a]);const w=Y.useCallback(()=>{const M=e.current;if(!M||!s||!b)return;const C=M.backgroundImage;M.backgroundImage=void 0,M.renderAll();const D=M.toDataURL({format:"png"});M.backgroundImage=C,M.renderAll(),o(s.id,{mask:D})},[s,b,o]);Y.useEffect(()=>{const M=e.current;if(!M)return;const C=()=>w();return M.on("path:created",C),M.on("object:modified",C),()=>{M.off("path:created",C),M.off("object:modified",C)}},[w]);const T=Y.useCallback(()=>{const M=e.current;if(!M)return;const C=M.backgroundImage;M.clear(),M.backgroundImage=C,M.renderAll(),s&&b&&o(s.id,{mask:null})},[s,b,o]);if(Y.useEffect(()=>{const M=C=>{const D=e.current;if(!D)return;const j=C.clipboardData?.items;if(j){for(const R of j)if(R.type.startsWith("image/")){const z=R.getAsFile();if(!z)continue;const U=new FileReader;U.onload=()=>{const G=U.result;Sn.fromURL(G).then(ut=>{ut.set({left:50,top:50,scaleX:.5,scaleY:.5}),D.add(ut),D.setActiveObject(ut),D.renderAll()})},U.readAsDataURL(z),C.preventDefault();break}}};return window.addEventListener("paste",M),()=>window.removeEventListener("paste",M)},[]),!s)return _.jsx("div",{className:"flex items-center justify-center",style:{minHeight:200,color:"#555555",fontSize:13},children:"Select a node to start drawing"});if(!x)return _.jsx("div",{className:"flex items-center justify-center",style:{minHeight:200,color:"#555555",fontSize:13},children:"Run the pipeline first to get a result image"});const E=[{id:"pen",icon:FC,label:"Pen"},{id:"eraser",icon:_C,label:"Eraser"},{id:"move",icon:VC,label:"Move"}];return _.jsxs("div",{style:{minHeight:200},children:[_.jsxs("div",{className:"flex items-center gap-1 px-3 py-2",style:{borderBottom:"1px solid #222233"},children:[E.map(M=>{const C=M.icon,D=a===M.id;return _.jsx("button",{onClick:()=>c(M.id),title:M.label,className:"flex items-center justify-center rounded transition-colors duration-150",style:{width:32,height:32,backgroundColor:D?"#00c9a7":"transparent",color:D?"#ffffff":"#888888"},onMouseEnter:j=>{D||(j.currentTarget.style.backgroundColor="#2a2a36")},onMouseLeave:j=>{D||(j.currentTarget.style.backgroundColor="transparent")},children:_.jsx(C,{size:16})},M.id)}),_.jsx("button",{onClick:T,title:"Delete all",className:"flex items-center justify-center rounded transition-colors duration-150",style:{width:32,height:32,color:"#888888"},onMouseEnter:M=>M.currentTarget.style.backgroundColor="#2a2a36",onMouseLeave:M=>M.currentTarget.style.backgroundColor="transparent",children:_.jsx(aT,{size:16})}),_.jsx("div",{style:{width:1,height:20,backgroundColor:"#333340",margin:"0 4px"}}),_.jsx("span",{style:{color:"#888888",fontSize:11,marginRight:4},children:"Size:"}),_.jsx("input",{type:"range",min:1,max:80,value:h,onChange:M=>f(Number(M.target.value)),className:"draw-slider",style:{width:60,accentColor:"#00c9a7"}}),_.jsx("div",{style:{width:1,height:20,backgroundColor:"#333340",margin:"0 4px"}}),_.jsxs("div",{className:"relative",children:[_.jsxs("button",{onClick:()=>v(!y),className:"flex items-center gap-1.5 rounded px-2 py-1 transition-colors duration-150",style:{backgroundColor:"#1e1e2a",border:"1px solid #333340",borderRadius:4},children:[_.jsx("div",{className:"rounded-full",style:{width:8,height:8,backgroundColor:z1[d.label]}}),_.jsx("span",{style:{color:"#cccccc",fontSize:12},children:d.label}),_.jsx(dh,{size:12,style:{color:"#666666"}})]}),y&&_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>v(!1)}),_.jsx("div",{className:"absolute left-0 top-full z-50 mt-1 rounded py-1",style:{backgroundColor:"#1e1e2a",border:"1px solid #333340",boxShadow:"0 4px 16px rgba(0,0,0,0.6)",minWidth:100},children:R1.map(M=>_.jsxs("button",{className:"flex w-full items-center gap-2 px-3 py-1.5 text-left transition-colors duration-100",style:{color:"#cccccc",fontSize:12},onMouseEnter:C=>C.currentTarget.style.backgroundColor="#2a2a36",onMouseLeave:C=>C.currentTarget.style.backgroundColor="transparent",onClick:()=>{p(M),v(!1)},children:[_.jsx("div",{className:"rounded-full",style:{width:8,height:8,backgroundColor:z1[M.label]}}),M.label]},M.label))})]})]})]}),_.jsx("div",{ref:i,className:"relative",style:{backgroundColor:"#111118"},children:_.jsx("canvas",{ref:t})})]})}const Fj=[{value:"RENDER:main",label:"1. Main renderer"},{value:"MODIFIER",label:"2. Details editor"},{value:"UPSCALE",label:"3. Creative upscaler"},{value:"VIDEO",label:"4. Image to video"},{value:"RENDER:experimental-exterior",label:"(experimental) Exterior render"},{value:"RENDER:experimental-interior",label:"(experimental) Interior render"}];function Ij(s){return s.type==="RENDER"?`RENDER:${s.params.engine}`:s.type}function Va({label:s,value:t,options:e,onChange:i}){const[o,a]=Y.useState(!1),c=e.find(h=>h.value===t)?.label??t;return _.jsxs("div",{className:"mb-3",children:[_.jsx("div",{style:{color:"#cccccc",fontSize:13,marginBottom:4},children:s}),_.jsxs("div",{className:"relative",children:[_.jsxs("button",{className:"flex w-full items-center justify-between px-3 transition-colors duration-150",style:{height:36,backgroundColor:"#1e1e2a",border:"1px solid #333340",borderRadius:6,color:"#cccccc",fontSize:13},onClick:()=>a(!o),children:[_.jsx("span",{className:"truncate",children:c}),_.jsx(dh,{size:14,style:{color:"#888888",flexShrink:0}})]}),o&&_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)}),_.jsx("div",{className:"absolute left-0 right-0 z-40 mt-1 overflow-hidden rounded-md py-1",style:{backgroundColor:"#1e1e2a",border:"1px solid #333340",boxShadow:"0 4px 16px rgba(0,0,0,0.5)"},children:e.map(h=>_.jsxs("button",{className:"flex w-full items-center gap-2 px-3 py-2 text-left text-sm transition-colors duration-100",style:{color:"#cccccc"},onMouseEnter:f=>f.currentTarget.style.backgroundColor="#2a2a36",onMouseLeave:f=>f.currentTarget.style.backgroundColor="transparent",onClick:()=>{i(h.value),a(!1)},children:[h.value===t&&_.jsx("div",{style:{width:3,height:20,backgroundColor:"#00c9a7",borderRadius:2,marginLeft:-8,marginRight:5}}),h.label]},h.value))})]})]})]})}function Au({label:s,value:t,min:e=0,max:i=1,step:o=.01,onChange:a}){const c=(t-e)/(i-e)*100;return _.jsxs("div",{className:"mb-3",children:[_.jsxs("div",{className:"flex items-center justify-between",style:{marginBottom:4},children:[_.jsx("span",{style:{color:"#cccccc",fontSize:13},children:s}),_.jsx("span",{style:{color:"#ffffff",fontSize:13},children:t.toFixed(2)})]}),_.jsxs("div",{className:"relative",style:{height:20},children:[_.jsx("input",{type:"range",min:e,max:i,step:o,value:t,onChange:h=>a(parseFloat(h.target.value)),className:"absolute inset-0 w-full cursor-pointer opacity-0",style:{height:20}}),_.jsx("div",{className:"pointer-events-none absolute top-1/2 w-full -translate-y-1/2",style:{height:4,backgroundColor:"#333340",borderRadius:2},children:_.jsx("div",{style:{width:`${c}%`,height:"100%",backgroundColor:"#00c9a7",borderRadius:2}})}),_.jsx("div",{className:"pointer-events-none absolute top-1/2 -translate-x-1/2 -translate-y-1/2",style:{left:`${c}%`,width:12,height:12,borderRadius:"50%",backgroundColor:"#00c9a7"}})]})]})}function Gj({selectedNode:s}){const[t,e]=Y.useState(!1),i=Mt(c=>c.updateNodeParams),o=Y.useCallback(c=>{if(s&&c.startsWith("RENDER:")){const h=c.split(":")[1];i(s.id,{engine:h})}},[s,i]);if(!s||s.type==="SOURCE"||s.type==="COMPARE")return _.jsxs("div",{style:{borderBottom:"1px solid #222233"},children:[_.jsxs("div",{className:"flex items-center gap-2 px-4",style:{height:40},children:[_.jsx(Lg,{size:16,style:{color:"#888888"}}),_.jsx("span",{className:"flex-1 text-sm",style:{color:"#ffffff",fontWeight:500},children:"Render settings"}),_.jsx(Vu,{size:16,style:{color:"#888888"}})]}),_.jsx("div",{className:"px-4 pb-3",style:{color:"#555555",fontSize:12},children:s?"Not applicable for this node":"Select a node to configure"})]});const a=t?dh:Vu;return _.jsxs("div",{style:{borderBottom:"1px solid #222233"},children:[_.jsxs("button",{className:"flex w-full items-center gap-2 px-4",style:{height:40},onClick:()=>e(!t),children:[_.jsx(Lg,{size:16,style:{color:"#888888"}}),_.jsx("span",{className:"flex-1 text-left text-sm",style:{color:"#ffffff",fontWeight:500},children:"Render settings"}),_.jsx(a,{size:16,style:{color:"#888888"}})]}),!t&&_.jsxs("div",{className:"px-4 pb-3",children:[s.type==="RENDER"&&_.jsx(Va,{label:"Render Mode",value:Ij(s),options:Fj,onChange:o}),s.type==="MODIFIER"&&_.jsxs("div",{className:"mb-3",children:[_.jsx("div",{style:{color:"#cccccc",fontSize:13,marginBottom:4},children:"Render Mode"}),_.jsx("div",{className:"flex items-center px-3",style:{height:36,backgroundColor:"#1e1e2a",border:"1px solid #333340",borderRadius:6,color:"#888888",fontSize:13},children:"2. Details editor"})]}),s.type==="UPSCALE"&&_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"mb-3",children:[_.jsx("div",{style:{color:"#cccccc",fontSize:13,marginBottom:4},children:"Render Mode"}),_.jsx("div",{className:"flex items-center px-3",style:{height:36,backgroundColor:"#1e1e2a",border:"1px solid #333340",borderRadius:6,color:"#888888",fontSize:13},children:"3. Creative upscaler"})]}),_.jsx(Va,{label:"Upscale",value:String(s.params.scale),options:[{value:"2",label:"2x"},{value:"4",label:"4x"}],onChange:c=>i(s.id,{scale:parseInt(c)})}),_.jsx(Va,{label:"Optimized for",value:s.params.optimizedFor,options:[{value:"standard",label:"Standard"},{value:"detail",label:"Detail"},{value:"smooth",label:"Smooth"}],onChange:c=>i(s.id,{optimizedFor:c})}),_.jsx(Au,{label:"Creativity",value:s.params.creativity,onChange:c=>i(s.id,{creativity:c})}),_.jsx(Au,{label:"Detail strength",value:s.params.detailStrength,onChange:c=>i(s.id,{detailStrength:c})}),_.jsx(Au,{label:"Similarity",value:s.params.similarity,onChange:c=>i(s.id,{similarity:c})}),_.jsx(Au,{label:"Prompt strength",value:s.params.promptStrength,onChange:c=>i(s.id,{promptStrength:c})})]}),s.type==="VIDEO"&&_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"mb-3",children:[_.jsx("div",{style:{color:"#cccccc",fontSize:13,marginBottom:4},children:"Render Mode"}),_.jsx("div",{className:"flex items-center px-3",style:{height:36,backgroundColor:"#1e1e2a",border:"1px solid #333340",borderRadius:6,color:"#888888",fontSize:13},children:"4. Image to video"})]}),_.jsx(Va,{label:"Engine",value:s.params.engine,options:[{value:"kling",label:"Kling v2.1"},{value:"seedance",label:"Seedance"}],onChange:c=>i(s.id,{engine:c})}),_.jsx(Va,{label:"Video duration",value:String(s.params.duration),options:[{value:"5",label:"5 seconds"},{value:"10",label:"10 seconds"}],onChange:c=>i(s.id,{duration:parseInt(c)})})]})]})]})}const $j=[{id:"screen-to-render",name:"Screen to render",icon:"screen-to-render",category:"render",applicableNodeTypes:["RENDER"],mergeMode:"replace",basePrompt:"Create photorealistic image",negativePrompt:"cartoon, illustration, sketch, low quality, blurry",visualConstraints:"Preserve exact geometry, camera angle, and spatial layout from the source image.",forbiddenChanges:"Do not add or remove architectural elements. Do not change room proportions."},{id:"image-to-sketch",name:"Image to sketch",icon:"image-to-sketch",category:"render",applicableNodeTypes:["RENDER"],mergeMode:"replace",basePrompt:"Convert to architectural sketch drawing",negativePrompt:"photorealistic, photograph, color photo",visualConstraints:"Maintain architectural proportions and perspective.",forbiddenChanges:"Do not alter building geometry."},{id:"top-view",name:"Top view",icon:"top-view",category:"render",applicableNodeTypes:["RENDER"],mergeMode:"replace",basePrompt:"Generate top-down orthographic view",negativePrompt:"perspective distortion, vanishing point, angled view",visualConstraints:"Bird's eye view, parallel projection.",forbiddenChanges:"Do not add perspective."},{id:"side-view",name:"Side view",icon:"side-view",category:"render",applicableNodeTypes:["RENDER"],mergeMode:"replace",basePrompt:"Generate side elevation view",negativePrompt:"top view, perspective, aerial",visualConstraints:"Orthographic side elevation.",forbiddenChanges:"Do not rotate the viewpoint."},{id:"another-view",name:"Another view",icon:"another-view",category:"render",applicableNodeTypes:["RENDER"],mergeMode:"replace",basePrompt:"Generate an alternative camera angle of the same scene",negativePrompt:"identical angle, same viewpoint",visualConstraints:"Maintain the same room, furniture, and style.",forbiddenChanges:"Do not change the interior design or objects."},{id:"enhance-realism",name:"Enhance realism",icon:"enhance-realism",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Photorealistic architectural visualization. Enhance material realism, global illumination, reflections, and micro-details. Natural lighting, physically based rendering quality.",negativePrompt:"cartoon, illustration, low quality, oversaturated",visualConstraints:"Preserve exact geometry, camera angle, and object placement.",forbiddenChanges:"Do NOT add or remove objects. Do NOT change room layout or furniture positions."},{id:"volumetric-rays",name:"Volumetric rays",icon:"volumetric-rays",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Add cinematic volumetric light rays. Sunlight scattering through space with realistic atmospheric particles. Soft god rays.",negativePrompt:"overexposure, dramatic color shift, artificial lighting, harsh shadows",visualConstraints:"Preserve all geometry and composition.",forbiddenChanges:"Do NOT change lighting direction. Do NOT alter room geometry."},{id:"make-brighter",name:"Make brighter",icon:"make-brighter",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Increase overall exposure and brightness. Preserve color balance and material fidelity.",negativePrompt:"blown highlights, overexposure, washed out, color shift",visualConstraints:"Maintain original lighting direction and shadow positions.",forbiddenChanges:"Do NOT change lighting direction, color temperature, or shadow geometry."},{id:"closeup",name:"Closeup",icon:"closeup",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Create a close-up shot of the main subject. Shallow depth of field, realistic lens compression. Focus on material detail and texture quality.",negativePrompt:"wide angle, distant view, blurry subject, unfocused",visualConstraints:"Maintain original style and lighting.",forbiddenChanges:"Do NOT change materials or style."},{id:"axonometry",name:"Axonometry",icon:"axonometry",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Generate axonometric architectural visualization. Parallel projection. Clean edges, neutral lighting, technical clarity.",negativePrompt:"perspective distortion, vanishing point, artistic, painterly",visualConstraints:"No perspective distortion.",forbiddenChanges:"Do NOT add artistic effects or stylization."},{id:"winter",name:"Winter",icon:"winter",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Change season to winter. Snow accumulation on horizontal surfaces. Cold daylight atmosphere. Bare trees, frost on windows.",negativePrompt:"summer, green foliage, warm tones, sunny",visualConstraints:"Preserve architecture and camera position.",forbiddenChanges:"Do NOT change building geometry or camera angle."},{id:"autumn",name:"Autumn",icon:"autumn",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Change season to autumn. Warm golden and orange foliage. Soft warm-toned daylight.",negativePrompt:"winter, snow, summer green, cold tones",visualConstraints:"Preserve architecture and camera position.",forbiddenChanges:"Do NOT change building geometry or camera angle."},{id:"technical-drawings",name:"Technical drawings",icon:"technical-drawings",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Architectural technical drawing style. Monochrome or limited color palette. Clear linework, no artistic shading. Orthographic or axonometric projection.",negativePrompt:"photorealistic, color photo, artistic, painterly, textures",visualConstraints:"Maintain exact proportions and dimensions.",forbiddenChanges:"Do NOT add artistic effects. Do NOT add color beyond line weights."},{id:"logo",name:"Logo",icon:"logo",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Transform the image into a clean logo-style illustration. Flat colors, simplified shapes. Transparent or white background.",negativePrompt:"photorealistic, textures, lighting effects, gradients, shadows",visualConstraints:"Simplified geometric shapes.",forbiddenChanges:"Do NOT preserve photorealistic textures."},{id:"day-to-night",name:"Day to night",icon:"day-to-night",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Convert daytime scene to nighttime. Artificial lighting visible from interior. Natural night sky illumination. Warm window glow.",negativePrompt:"daylight, sunny, bright sky, daytime",visualConstraints:"Preserve geometry and composition.",forbiddenChanges:"Do NOT change building geometry or furniture."},{id:"night-to-day",name:"Night to day",icon:"night-to-day",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Convert nighttime scene to daytime. Natural daylight illumination. Clear or partly cloudy sky.",negativePrompt:"night, dark, artificial lighting only, stars",visualConstraints:"Preserve geometry and composition.",forbiddenChanges:"Do NOT change building geometry or furniture."},{id:"add-people",name:"Add people",icon:"add-people",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Add realistic people naturally integrated into the scene. Correct scale, perspective, and lighting. People should not block key architectural elements.",negativePrompt:"mannequins, cartoon people, oversized, floating",visualConstraints:"Match lighting and perspective of the existing scene.",forbiddenChanges:"Do NOT alter architecture or furniture."},{id:"add-blurred-people",name:"Add blurred people",icon:"add-blurred-people",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Add motion-blurred people for realism. Long exposure effect. People walking naturally through the space.",negativePrompt:"sharp people, static poses, mannequins",visualConstraints:"Match lighting and perspective.",forbiddenChanges:"Do NOT alter architecture or furniture."},{id:"add-blurred-cars",name:"Add blurred cars",icon:"add-blurred-cars",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Add motion-blurred cars on roads. Long exposure effect for dynamic movement.",negativePrompt:"static cars, parked, sharp focus on vehicles",visualConstraints:"Match road perspective and scene scale.",forbiddenChanges:"Do NOT alter buildings or landscape."},{id:"add-cars",name:"Add cars",icon:"add-cars",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Add realistic parked cars matching scene context. Correct scale and perspective.",negativePrompt:"floating cars, oversized, cartoon",visualConstraints:"Match lighting and perspective.",forbiddenChanges:"Do NOT alter buildings."},{id:"add-flowers",name:"Add flowers",icon:"add-flowers",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Add natural flowers subtly integrated into the scene. Respect scale, season, and climate.",negativePrompt:"oversized flowers, artificial, plastic",visualConstraints:"Do not obstruct architecture.",forbiddenChanges:"Do NOT change architecture or major scene elements."},{id:"add-grass",name:"Add grass",icon:"add-grass",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Add natural grass and ground cover. Realistic lawn texture, appropriate for the climate.",negativePrompt:"artificial turf, oversaturated green, unrealistic",visualConstraints:"Match terrain and scene context.",forbiddenChanges:"Do NOT change architecture or hardscape."},{id:"add-trees",name:"Add trees",icon:"add-trees",category:"modifier",applicableNodeTypes:["MODIFIER"],mergeMode:"replace",basePrompt:"Add realistic trees appropriate to the climate and scene. Correct scale and natural placement.",negativePrompt:"cartoon trees, floating, oversized, indoor trees outside",visualConstraints:"Match season and climate.",forbiddenChanges:"Do NOT obstruct key architectural views."},{id:"upscale",name:"Upscale",icon:"upscale",category:"upscale",applicableNodeTypes:["UPSCALE"],mergeMode:"replace",basePrompt:"Upscale",negativePrompt:"",visualConstraints:"Preserve all details from original.",forbiddenChanges:"Do NOT alter content or composition."},{id:"zoom-in-video",name:"Zoom in",icon:"zoom-in-video",category:"video",applicableNodeTypes:["VIDEO"],mergeMode:"replace",basePrompt:"Zoom in",negativePrompt:"",visualConstraints:"Smooth camera motion.",forbiddenChanges:"Do NOT change scene content."},{id:"move-forward",name:"Move forward",icon:"move-forward",category:"video",applicableNodeTypes:["VIDEO"],mergeMode:"replace",basePrompt:"Move forward",negativePrompt:"",visualConstraints:"Smooth forward dolly motion.",forbiddenChanges:"Do NOT change scene content."},{id:"orbit",name:"Orbit",icon:"orbit",category:"video",applicableNodeTypes:["VIDEO"],mergeMode:"replace",basePrompt:"Orbit camera around subject",negativePrompt:"",visualConstraints:"Smooth orbital motion.",forbiddenChanges:"Do NOT change scene content."},{id:"pan-left",name:"Pan left",icon:"pan-left",category:"video",applicableNodeTypes:["VIDEO"],mergeMode:"replace",basePrompt:"Pan camera left",negativePrompt:"",visualConstraints:"Smooth lateral motion.",forbiddenChanges:"Do NOT change scene content."}];function qj(s){return $j.filter(t=>t.applicableNodeTypes.includes(s))}function Wj({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("path",{d:"M10 14 L20 8 L30 14 L30 26 L20 32 L10 26 Z",strokeDasharray:"3 2"}),_.jsx("path",{d:"M20 8 L20 20",strokeDasharray:"3 2"}),_.jsx("path",{d:"M10 14 L20 20 L30 14",strokeDasharray:"3 2"}),_.jsx("path",{d:"M32 20 L38 20 M35 17 L38 20 L35 23",strokeDasharray:"none"})]})}function Zj({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("path",{d:"M8 16 L18 10 L28 16 L28 26 L18 32 L8 26 Z"}),_.jsx("path",{d:"M18 10 L18 22"}),_.jsx("path",{d:"M8 16 L18 22 L28 16"}),_.jsx("path",{d:"M30 8 L36 14 L32 18 L26 12 Z"}),_.jsx("path",{d:"M26 12 L24 20"})]})}function Kj({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("path",{d:"M10 15 L20 10 L30 15 L20 20 Z"}),_.jsx("path",{d:"M10 15 L10 25 L20 30 L30 25 L30 15"}),_.jsx("path",{d:"M20 20 L20 30"}),_.jsx("path",{d:"M20 2 L20 8 M17 5 L20 8 L23 5"})]})}function Qj({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("rect",{x:"10",y:"10",width:"20",height:"20",rx:"1"}),_.jsx("path",{d:"M10 20 L30 20"}),_.jsx("path",{d:"M20 10 L20 30"}),_.jsx("path",{d:"M34 20 L38 20 M36 17 L38 20 L36 23"})]})}function Jj({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("path",{d:"M12 16 L20 12 L28 16 L28 24 L20 28 L12 24 Z"}),_.jsx("path",{d:"M20 12 L20 20"}),_.jsx("path",{d:"M12 16 L20 20 L28 16"}),_.jsx("path",{d:"M32 10 C36 14, 36 22, 32 26"}),_.jsx("path",{d:"M30 8 L32 10 L34 8"})]})}function tN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("path",{d:"M10 16 L18 12 L26 16 L26 24 L18 28 L10 24 Z"}),_.jsx("path",{d:"M18 12 L18 20"}),_.jsx("path",{d:"M10 16 L18 20 L26 16"}),_.jsx("path",{d:"M32 8 L32 14 M29 11 L35 11"}),_.jsx("path",{d:"M34 22 L34 26 M32 24 L36 24"})]})}function eN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("rect",{x:"8",y:"12",width:"24",height:"4",rx:"2"}),_.jsx("rect",{x:"8",y:"20",width:"18",height:"4",rx:"2"}),_.jsx("rect",{x:"8",y:"28",width:"12",height:"4",rx:"2"}),_.jsx("circle",{cx:"33",cy:"8",r:"3"}),_.jsx("path",{d:"M33 3 L33 4 M33 12 L33 13 M28 8 L29 8 M37 8 L38 8"})]})}function nN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("path",{d:"M20 6 L34 14 L34 28 L20 36 L6 28 L6 14 Z"}),_.jsx("path",{d:"M20 6 L20 20"}),_.jsx("path",{d:"M6 14 L20 22 L34 14"}),_.jsx("path",{d:"M20 22 L20 36"})]})}function iN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("rect",{x:"6",y:"6",width:"28",height:"28",rx:"1"}),_.jsx("path",{d:"M6 15.3 L34 15.3 M6 24.7 L34 24.7"}),_.jsx("path",{d:"M15.3 6 L15.3 34 M24.7 6 L24.7 34"}),_.jsx("path",{d:"M8 38 L32 38 M8 36 L8 38 M32 36 L32 38"})]})}function sN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("rect",{x:"8",y:"12",width:"10",height:"16",rx:"5"}),_.jsx("rect",{x:"22",y:"12",width:"10",height:"16",rx:"5"}),_.jsx("path",{d:"M18 20 L22 20"})]})}function rN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("circle",{cx:"20",cy:"12",r:"5",strokeDasharray:"2 2"}),_.jsx("path",{d:"M12 34 L15 22 L20 20 L25 22 L28 34",strokeDasharray:"2 2"}),_.jsx("path",{d:"M6 16 L10 16 M6 24 L10 24 M6 32 L10 32",opacity:"0.5"})]})}function oN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("path",{d:"M8 22 L12 16 L28 16 L32 22 L34 22 L34 28 L6 28 L6 22 Z",strokeDasharray:"2 2"}),_.jsx("circle",{cx:"13",cy:"28",r:"3",strokeDasharray:"2 2"}),_.jsx("circle",{cx:"27",cy:"28",r:"3",strokeDasharray:"2 2"}),_.jsx("path",{d:"M2 18 L6 18 M2 22 L6 22 M2 26 L6 26",opacity:"0.5"})]})}function aN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("path",{d:"M4 32 L14 16 L22 26 L28 18 L36 32 Z"}),_.jsx("circle",{cx:"30",cy:"10",r:"4"}),_.jsx("path",{d:"M4 4 L12 12 M4 4 L10 4 M4 4 L4 10"}),_.jsx("path",{d:"M36 4 L28 12 M36 4 L30 4 M36 4 L36 10"})]})}function lN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("path",{d:"M4 36 L20 12 L36 36"}),_.jsx("path",{d:"M12 36 L20 18 L28 36"}),_.jsx("path",{d:"M20 4 L20 14 M16 8 L20 4 L24 8"})]})}function cN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("ellipse",{cx:"20",cy:"20",rx:"14",ry:"8"}),_.jsx("circle",{cx:"20",cy:"20",r:"3"}),_.jsx("path",{d:"M34 20 L32 16 M34 20 L30 20"})]})}function uN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("rect",{x:"10",y:"10",width:"20",height:"20",rx:"2"}),_.jsx("path",{d:"M2 20 L8 20 M5 17 L2 20 L5 23"}),_.jsx("path",{d:"M14 16 L26 16 M14 20 L26 20 M14 24 L26 24",opacity:"0.5"})]})}function hN({className:s}){return _.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:s,children:[_.jsx("rect",{x:"6",y:"14",width:"16",height:"16",rx:"1"}),_.jsx("rect",{x:"16",y:"6",width:"20",height:"20",rx:"1",strokeDasharray:"3 2"}),_.jsx("circle",{cx:"30",cy:"30",r:"5"}),_.jsx("path",{d:"M34 34 L38 38"}),_.jsx("path",{d:"M28 30 L32 30 M30 28 L30 32"})]})}function fN(s,t){const i={width:t,height:t};switch(s){case"screen-to-render":return _.jsx(Wj,{className:"",...i});case"image-to-sketch":return _.jsx(Zj,{className:"",...i});case"top-view":return _.jsx(Kj,{className:"",...i});case"side-view":return _.jsx(Qj,{className:"",...i});case"another-view":return _.jsx(Jj,{className:"",...i});case"enhance-realism":return _.jsx(tN,{className:"",...i});case"volumetric-rays":return _.jsx(Gv,{size:t});case"make-brighter":return _.jsx(eN,{className:"",...i});case"closeup":return _.jsx(ZC,{size:t});case"axonometry":return _.jsx(nN,{className:"",...i});case"winter":return _.jsx(tT,{size:t});case"autumn":return _.jsx(jC,{size:t});case"technical-drawings":return _.jsx(iN,{className:"",...i});case"logo":return _.jsx(sN,{className:"",...i});case"day-to-night":return _.jsx(Gv,{size:t*.6,style:{display:"inline",marginRight:2}});case"night-to-day":return _.jsx(PC,{size:t*.6,style:{display:"inline",marginRight:2}});case"add-people":return _.jsx(V1,{size:t});case"add-blurred-people":return _.jsx(rN,{className:"",...i});case"add-blurred-cars":return _.jsx(oN,{className:"",...i});case"add-cars":return _.jsx(cC,{size:t});case"add-flowers":return _.jsx(CC,{size:t});case"add-grass":return _.jsx(nT,{size:t});case"add-trees":return _.jsx(cT,{size:t});case"upscale":return _.jsx(hN,{className:"",...i});case"zoom-in-video":return _.jsx(aN,{className:"",...i});case"move-forward":return _.jsx(lN,{className:"",...i});case"orbit":return _.jsx(cN,{className:"",...i});case"pan-left":return _.jsx(uN,{className:"",...i});default:return _.jsx(RC,{size:t})}}function dN({preset:s,isSelected:t,onClick:e}){return _.jsxs("button",{className:"flex flex-col items-center justify-center gap-1.5 rounded-lg p-2 transition-colors duration-150",style:{backgroundColor:"#1e1e2a",border:t?"1px solid #00c9a7":"1px solid transparent",color:"#aaaaaa",minHeight:80},onMouseEnter:i=>{i.currentTarget.style.backgroundColor="#2a2a36",i.currentTarget.style.color="#ffffff"},onMouseLeave:i=>{i.currentTarget.style.backgroundColor="#1e1e2a",i.currentTarget.style.color=t?"#ffffff":"#aaaaaa"},onClick:e,children:[_.jsx("div",{style:{width:40,height:40},className:"flex items-center justify-center",children:fN(s.id,32)}),_.jsx("span",{className:"w-full truncate text-center",style:{fontSize:11,color:"#cccccc"},children:s.name})]})}function gN({selectedNode:s}){const[t,e]=Y.useState(!1),i=je(p=>p.setPromptText),o=Mt(p=>p.updateNodeParams),[a,c]=Y.useState(null),h=s?qj(s.type):[],f=Y.useCallback(p=>{s&&(c(p.id),i(p.basePrompt),"prompt"in s.params&&o(s.id,{prompt:p.basePrompt,presetId:p.id}))},[s,i,o]),d=t?dh:Vu;return!s||s.type==="SOURCE"||s.type==="COMPARE"?_.jsxs("div",{children:[_.jsxs("div",{className:"flex items-center gap-2 px-4",style:{height:40},children:[_.jsx(Iv,{size:16,style:{color:"#888888"}}),_.jsx("span",{className:"flex-1 text-sm",style:{color:"#ffffff",fontWeight:500},children:"Prompt Presets"}),_.jsx(Vu,{size:16,style:{color:"#888888"}})]}),_.jsx("div",{className:"px-4 pb-3",style:{color:"#555555",fontSize:12},children:s?"Not applicable for this node":"Select a node to see presets"})]}):_.jsxs("div",{children:[_.jsxs("button",{className:"flex w-full items-center gap-2 px-4",style:{height:40},onClick:()=>e(!t),children:[_.jsx(Iv,{size:16,style:{color:"#888888"}}),_.jsx("span",{className:"flex-1 text-left text-sm",style:{color:"#ffffff",fontWeight:500},children:"Prompt Presets"}),_.jsx(d,{size:16,style:{color:"#888888"}})]}),!t&&_.jsx("div",{className:"grid grid-cols-3 gap-2 px-4 pb-4",children:h.map(p=>_.jsx(dN,{preset:p,isSelected:a===p.id,onClick:()=>f(p)},p.id))})]})}const pN=[{id:"preview",label:"Preview"},{id:"compare",label:"Compare"},{id:"draw",label:"Draw"}];function mN(){const s=je(a=>a.activeTab),t=je(a=>a.setActiveTab),e=Mt(a=>a.selectedNodeId),i=Mt(a=>a.nodes),o=e?i.find(a=>a.id===e)??null:null;return _.jsxs("aside",{className:"flex h-full flex-col overflow-y-auto",style:{width:320,minWidth:320,backgroundColor:"#1a1a24",borderLeft:"1px solid #222233"},children:[_.jsx("div",{className:"flex items-center justify-end px-3",style:{height:36},children:_.jsxs("button",{className:"flex items-center gap-1.5 transition-colors duration-150",style:{color:"#888888",fontSize:12},onMouseEnter:a=>a.currentTarget.style.color="#ffffff",onMouseLeave:a=>a.currentTarget.style.color="#888888",children:[_.jsx(BC,{size:14}),"Enlarge"]})}),_.jsx("div",{className:"flex gap-6 px-4",style:{height:40,borderBottom:"1px solid #222233"},children:pN.map(a=>{const c=s===a.id;return _.jsxs("button",{onClick:()=>t(a.id),className:"relative pb-2 text-sm transition-colors duration-150",style:{color:c?"#ffffff":"#666666",fontWeight:c?500:400},children:[a.label,c&&_.jsx("div",{className:"absolute bottom-0 left-0 right-0",style:{height:2,backgroundColor:"#ffffff"}})]},a.id)})}),_.jsxs("div",{style:{borderBottom:"1px solid #222233"},children:[s==="preview"&&_.jsx(C5,{selectedNode:o}),s==="compare"&&_.jsx(T5,{}),s==="draw"&&_.jsx(Xj,{selectedNode:o})]}),_.jsx(Gj,{selectedNode:o}),_.jsx(gN,{selectedNode:o})]})}function yN(){const s=je(x=>x.promptText),t=je(x=>x.setPromptText),e=Mt(x=>x.selectedNodeId),i=Mt(x=>x.nodes),o=Mt(x=>x.updateNodeParams),a=e?i.find(x=>x.id===e)??null:null,c=a!==null&&"prompt"in a.params,h=c?a.params.prompt:null,f=Y.useRef(null);Y.useEffect(()=>{e!==f.current&&(f.current=e,h!==null&&t(h))},[e,h,t]);const d=Y.useRef(null),p=Y.useCallback(x=>{!e||!c||(d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{o(e,{prompt:x})},400))},[e,c,o]);Y.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[e]);const y=x=>{t(x),p(x)},v=()=>{t(""),d.current&&clearTimeout(d.current),e&&c&&o(e,{prompt:""})};return _.jsxs("div",{className:"relative flex flex-1 items-center px-3",children:[_.jsx("input",{type:"text",value:s,onChange:x=>y(x.target.value),placeholder:"Enter your image prompt here...",className:"h-9 w-full rounded-md px-3 pr-8 text-sm outline-none",style:{backgroundColor:"#111118",border:"1px solid #333340",color:"#ffffff",fontSize:14}}),s&&_.jsx("button",{onClick:v,className:"absolute right-5 flex items-center justify-center transition-colors duration-150",style:{color:"#666666"},onMouseEnter:x=>x.currentTarget.style.color="#ffffff",onMouseLeave:x=>x.currentTarget.style.color="#666666",children:_.jsx(X1,{size:14})})]})}function vN({credits:s,disabled:t,isRunning:e,onClick:i}){return _.jsxs("div",{className:"flex flex-col items-center px-3",children:[_.jsxs("button",{onClick:i,disabled:t,className:"flex h-9 items-center gap-1.5 rounded-md px-5 text-sm font-bold transition-colors duration-150",style:{backgroundColor:t?"#333340":"#00c9a7",color:t?"#666666":"#ffffff",minWidth:100,cursor:t?"not-allowed":"pointer"},onMouseEnter:o=>{t||(o.currentTarget.style.backgroundColor="#00ddb8")},onMouseLeave:o=>{t||(o.currentTarget.style.backgroundColor="#00c9a7")},children:[e?_.jsx(Y1,{size:14,className:"animate-spin"}):_.jsx(hC,{size:14}),e?"Running...":"Make"]}),_.jsxs("span",{style:{color:"#666666",fontSize:11},children:["Credits: ",s]})]})}function xN(s){const t=Date.now(),e=new Date(s).getTime(),i=t-e,o=Math.floor(i/6e4);if(o<1)return"Just now";if(o===1)return"1 minute ago";if(o<60)return`${o} minutes ago`;const a=Math.floor(o/60);if(a===1)return"1 hour ago";if(a<24)return`${a} hours ago`;const c=Math.floor(a/24);return c===1?"1 day ago":`${c} days ago`}function bN(s,t){const e=document.createElement("a");e.href=s,e.download=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)}function SN({snapshot:s}){const[t,e]=Y.useState(!1),i=Dp(h=>h.restoreSnapshot),o=s.thumbnails[s.thumbnails.length-1]??null,a=()=>{const h=i(s.id);if(!h)return;const{nodes:f,edges:d}=h.graph;Mt.setState({nodes:f,edges:d,selectedNodeId:null})},c=()=>{if(!o)return;const h=new Date(s.timestamp).toISOString().slice(0,19).replace(/:/g,"-");bN(o,`vizmaker-${h}.png`)};return _.jsxs("div",{className:"relative overflow-hidden rounded",style:{backgroundColor:"#1a1a24"},onMouseEnter:()=>e(!0),onMouseLeave:()=>e(!1),children:[_.jsx("div",{className:"flex items-center justify-center",style:{height:140,backgroundColor:"#111118"},children:o?_.jsx("img",{src:o,alt:"History thumbnail",className:"h-full w-full object-cover",draggable:!1}):_.jsx("span",{style:{color:"#444444",fontSize:12},children:"No image"})}),t&&_.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-2 bg-black/50",children:[_.jsxs("button",{onClick:a,className:"flex items-center gap-1.5 rounded px-3 py-1.5 text-xs transition-colors duration-100",style:{backgroundColor:"#1a1a24",color:"#ffffff"},onMouseEnter:h=>h.currentTarget.style.backgroundColor="#2a2a36",onMouseLeave:h=>h.currentTarget.style.backgroundColor="#1a1a24",children:[_.jsx(aC,{size:12}),"Use"]}),o&&_.jsxs("button",{onClick:c,className:"flex items-center gap-1.5 rounded px-3 py-1.5 text-xs transition-colors duration-100",style:{backgroundColor:"#1a1a24",color:"#ffffff"},onMouseEnter:h=>h.currentTarget.style.backgroundColor="#2a2a36",onMouseLeave:h=>h.currentTarget.style.backgroundColor="#1a1a24",children:[_.jsx(bC,{size:12}),"Save"]})]}),_.jsxs("div",{className:"flex items-center gap-1 px-2 py-1.5",style:{borderTop:"1px solid #222233"},children:[_.jsx(vC,{size:10,style:{color:"#888888"}}),_.jsx("span",{style:{color:"#888888",fontSize:11},children:xN(s.timestamp)})]})]})}function _N(){const s=Dp(h=>h.snapshots),[t,e]=Y.useState(!0),[i,o]=Y.useState(12),a=s.slice(0,i),c=i<s.length;return _.jsxs("div",{className:"flex h-full flex-1 flex-col overflow-y-auto px-6 py-4",children:[_.jsx("h1",{className:"mb-4",style:{color:"#ffffff",fontSize:24,fontWeight:700},children:"History"}),t&&_.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-md px-4 py-2.5",style:{backgroundColor:"#1a1a24"},children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(AC,{size:14,style:{color:"#4488ff"}}),_.jsx("span",{style:{color:"#888888",fontSize:13},children:"Hint: You can get more details about generated image by clicking on the image"})]}),_.jsx("button",{onClick:()=>e(!1),className:"transition-colors duration-150",style:{color:"#666666"},onMouseEnter:h=>h.currentTarget.style.color="#ffffff",onMouseLeave:h=>h.currentTarget.style.color="#666666",children:_.jsx(X1,{size:14})})]}),s.length===0?_.jsx("div",{className:"flex flex-1 items-center justify-center",style:{color:"#555555",fontSize:14},children:"No history yet. Run a pipeline to generate results."}):_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"grid gap-1",style:{gridTemplateColumns:"repeat(6, 1fr)"},children:a.map(h=>_.jsx(SN,{snapshot:h},h.id))}),c&&_.jsx("div",{className:"mt-6 flex justify-center",children:_.jsx("button",{onClick:()=>o(h=>h+12),className:"rounded-md px-6 py-2 text-sm transition-colors duration-150",style:{backgroundColor:"#333340",color:"#cccccc",borderRadius:6},onMouseEnter:h=>h.currentTarget.style.backgroundColor="#444450",onMouseLeave:h=>h.currentTarget.style.backgroundColor="#333340",children:"Load More"})})]})]})}const U_="http://localhost:9876",wN=3e3,CN=2e3;function TN(){return{modelName:"SketchUp",sceneId:"",fov:35,eye:[0,0,0],target:[0,0,0],up:[0,0,1],shadow:!1,style:"default"}}function EN(s){return s.startsWith("data:")?s:`data:image/png;base64,${s}`}async function P_(s,t){const e=new AbortController,i=setTimeout(()=>e.abort(),CN);try{return await fetch(s,{...t,signal:e.signal})}finally{clearTimeout(i)}}let Ja=null,L1=null;async function MN(){try{const s=await P_(`${U_}/api/ping`);return s.ok?(await s.json()).status==="ok":!1}catch{return!1}}async function DN(){try{const s=await P_(`${U_}/api/data`);if(!s.ok)return null;const t=await s.json();if(!t.source)return null;const e=t.source.slice(0,100);return e===L1?null:(L1=e,t.source)}catch{return null}}function ON(s){const t=EN(s),e=Mt.getState(),i=e.nodes.find(o=>o.type==="SOURCE"&&o.params.origin==="sketchup");if(i)e.updateNodeParams(i.id,{image:t}),e.updateNodeResult(i.id,{image:t,timestamp:new Date().toISOString(),cacheKey:""});else{const o={x:100,y:200};e.createSourceNode(t,"sketchup",o,{sceneMeta:TN(),cameraLocked:!0})}}async function B1(){const s=je.getState().setSketchUpStatus;if(await MN()){s("connected");const e=await DN();e&&ON(e)}else s("disconnected")}function AN(){Ja===null&&(je.getState().setSketchUpStatus("connecting"),B1(),Ja=setInterval(B1,wN))}function kN(){Ja!==null&&(clearInterval(Ja),Ja=null),je.getState().setSketchUpStatus("disconnected")}function jN(s){switch(s){case"connected":return"#00c9a7";case"connecting":return"#ffaa00";case"disconnected":return"#666666"}}function NN(s){switch(s){case"connected":return"Connected";case"connecting":return"Connecting...";case"disconnected":return"Offline"}}function RN(){const s=Mt(x=>x.selectedNodeId),t=Mt(x=>x.nodes),e=th(x=>x.isRunning),i=th(x=>x.error),o=Op(x=>x.balance),a=je(x=>x.activeSidebarItem),c=je(x=>x.sketchUpStatus);Y.useEffect(()=>(AN(),()=>kN()),[]);const h=Y.useMemo(()=>s?v5(s):0,[s,t]),f=h>o,p=e||!s||f,y=Y.useCallback(async()=>{!s||e||await NS(s)},[s,e]);Y.useEffect(()=>{function x(b){if(b.metaKey||b.ctrlKey){if(b.key==="z"&&!b.shiftKey){b.preventDefault();const{nodes:T,edges:E,selectedNodeId:M}=Mt.getState(),C=Kg.getState().undo({nodes:structuredClone(T),edges:structuredClone(E),selectedNodeId:M});C&&Mt.setState({nodes:C.nodes,edges:C.edges,selectedNodeId:C.selectedNodeId})}if(b.key==="z"&&b.shiftKey||b.key==="y"&&!b.shiftKey){b.preventDefault();const{nodes:T,edges:E,selectedNodeId:M}=Mt.getState(),C=Kg.getState().redo({nodes:structuredClone(T),edges:structuredClone(E),selectedNodeId:M});C&&Mt.setState({nodes:C.nodes,edges:C.edges,selectedNodeId:C.selectedNodeId})}}}return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[]);const v=a==="history";return _.jsxs("div",{className:"flex h-full w-full flex-col",children:[_.jsxs("div",{className:"flex shrink-0 items-center px-4",style:{height:28,backgroundColor:"#0a0a14",borderBottom:"1px solid #222233"},children:[_.jsx("span",{style:{color:"#888888",fontSize:12},children:"VizMaker"}),_.jsx("span",{style:{color:"#444444",fontSize:12,margin:"0 8px"},children:"|"}),_.jsxs("span",{style:{color:"#888888",fontSize:12},children:["SketchUp:"," ",_.jsx("span",{style:{color:jN(c)},children:NN(c)})]})]}),_.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[_.jsx(xT,{}),_.jsx("div",{className:"flex flex-1 flex-col overflow-hidden",children:v?_.jsx(_N,{}):_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[_.jsx(w5,{}),_.jsx(mN,{})]}),_.jsxs("div",{className:"relative flex shrink-0 items-center",style:{height:52,backgroundColor:"#1a1a24",borderTop:"1px solid #222233"},children:[_.jsx(yN,{}),_.jsx(vN,{credits:h,disabled:p,isRunning:e,onClick:y}),i&&_.jsx("div",{className:"absolute bottom-full left-1/2 mb-2 -translate-x-1/2 rounded-md px-3 py-1.5 text-xs",style:{backgroundColor:"#ff444433",color:"#ff4444",border:"1px solid #ff4444"},children:i}),e&&_.jsx("div",{className:"absolute bottom-0 left-0 right-0",style:{height:2},children:_.jsx("div",{className:"h-full animate-pulse",style:{background:"linear-gradient(90deg, #ff4466, #ff6688)",width:"100%"}})})]})]})})]})]})}function zN(){return _.jsx(RN,{})}tC.createRoot(document.getElementById("root")).render(_.jsx(Y.StrictMode,{children:_.jsx(zN,{})}));
